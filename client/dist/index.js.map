{"version":3,"file":"index.js","sources":["../node_modules/rxjs/dist/esm5/internal/util/isFunction.js","../node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js","../node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js","../node_modules/rxjs/dist/esm5/internal/util/arrRemove.js","../node_modules/rxjs/dist/esm5/internal/Subscription.js","../node_modules/rxjs/dist/esm5/internal/config.js","../node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js","../node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js","../node_modules/rxjs/dist/esm5/internal/util/noop.js","../node_modules/rxjs/dist/esm5/internal/Subscriber.js","../node_modules/rxjs/dist/esm5/internal/symbol/observable.js","../node_modules/rxjs/dist/esm5/internal/util/identity.js","../node_modules/rxjs/dist/esm5/internal/util/pipe.js","../node_modules/rxjs/dist/esm5/internal/Observable.js","../node_modules/rxjs/dist/esm5/internal/util/lift.js","../node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js","../node_modules/rxjs/dist/esm5/internal/observable/empty.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js","../node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js","../node_modules/rxjs/dist/esm5/internal/util/isPromise.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js","../node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js","../node_modules/rxjs/dist/esm5/internal/symbol/iterator.js","../node_modules/rxjs/dist/esm5/internal/util/caughtSchedule.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js","../node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js","../node_modules/rxjs/dist/esm5/internal/util/isIterable.js","../node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js","../node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js","../node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js","../node_modules/rxjs/dist/esm5/internal/observable/from.js","../node_modules/rxjs/dist/esm5/internal/observable/fromArray.js","../node_modules/rxjs/dist/esm5/internal/util/isScheduler.js","../node_modules/rxjs/dist/esm5/internal/util/args.js","../node_modules/rxjs/dist/esm5/internal/observable/of.js","../node_modules/rxjs/dist/esm5/internal/observable/throwError.js","../node_modules/rxjs/dist/esm5/internal/operators/map.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeInternals.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js","../node_modules/rxjs/dist/esm5/internal/operators/filter.js","../node_modules/rxjs/dist/esm5/internal/operators/scanInternals.js","../node_modules/rxjs/dist/esm5/internal/operators/reduce.js","../node_modules/rxjs/dist/esm5/internal/operators/toArray.js","../node_modules/rxjs/dist/esm5/internal/operators/take.js","../node_modules/rxjs/dist/esm5/internal/operators/tap.js","../src/types.ts","../src/utils.ts","../src/faceRecognition.ts","../src/faceDetectionUI.ts","../src/livenessDetectionSession.ts","../node_modules/@tensorflow/tfjs-core/dist/tf-core.esm.js","../node_modules/face-api.js/build/es6/classes/Dimensions.js","../node_modules/face-api.js/build/es6/utils/index.js","../node_modules/face-api.js/build/es6/classes/Point.js","../node_modules/face-api.js/build/es6/classes/Box.js","../node_modules/face-api.js/build/es6/classes/BoundingBox.js","../node_modules/face-api.js/build/es6/classes/ObjectDetection.js","../node_modules/face-api.js/build/es6/classes/FaceDetection.js","../node_modules/face-api.js/build/es6/ops/iou.js","../node_modules/face-api.js/build/es6/ops/minBbox.js","../node_modules/face-api.js/build/es6/ops/nonMaxSuppression.js","../node_modules/face-api.js/build/es6/ops/normalize.js","../node_modules/face-api.js/build/es6/ops/padToSquare.js","../node_modules/face-api.js/build/es6/ops/index.js","../node_modules/face-api.js/build/es6/classes/Rect.js","../node_modules/face-api.js/build/es6/classes/FaceLandmarks.js","../node_modules/face-api.js/build/es6/classes/FaceLandmarks5.js","../node_modules/face-api.js/build/es6/classes/FaceLandmarks68.js","../node_modules/face-api.js/build/es6/classes/FaceMatch.js","../node_modules/face-api.js/build/es6/classes/LabeledBox.js","../node_modules/face-api.js/build/es6/classes/LabeledFaceDescriptors.js","../node_modules/face-api.js/build/es6/classes/PredictedBox.js","../node_modules/face-api.js/build/es6/factories/WithFaceDetection.js","../node_modules/face-api.js/build/es6/env/createBrowserEnv.js","../node_modules/face-api.js/build/es6/env/createFileSystem.js","../node_modules/face-api.js/build/es6/env/createNodejsEnv.js","../node_modules/face-api.js/build/es6/env/isBrowser.js","../node_modules/face-api.js/build/es6/env/isNodejs.js","../node_modules/face-api.js/build/es6/env/index.js","../node_modules/face-api.js/build/es6/dom/resolveInput.js","../node_modules/face-api.js/build/es6/dom/getContext2dOrThrow.js","../node_modules/face-api.js/build/es6/draw/DrawTextField.js","../node_modules/face-api.js/build/es6/dom/isMediaLoaded.js","../node_modules/face-api.js/build/es6/dom/awaitMediaLoaded.js","../node_modules/face-api.js/build/es6/dom/getMediaDimensions.js","../node_modules/face-api.js/build/es6/dom/createCanvas.js","../node_modules/face-api.js/build/es6/dom/imageTensorToCanvas.js","../node_modules/face-api.js/build/es6/dom/isMediaElement.js","../node_modules/face-api.js/build/es6/dom/imageToSquare.js","../node_modules/face-api.js/build/es6/dom/NetInput.js","../node_modules/face-api.js/build/es6/dom/toNetInput.js","../node_modules/face-api.js/build/es6/dom/extractFaces.js","../node_modules/face-api.js/build/es6/dom/extractFaceTensors.js","../node_modules/face-api.js/build/es6/dom/fetchOrThrow.js","../node_modules/face-api.js/build/es6/dom/fetchJson.js","../node_modules/face-api.js/build/es6/common/getModelUris.js","../node_modules/face-api.js/build/es6/dom/loadWeightMap.js","../node_modules/face-api.js/build/es6/NeuralNetwork.js","../node_modules/face-api.js/build/es6/common/depthwiseSeparableConv.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/denseBlock.js","../node_modules/face-api.js/build/es6/common/convLayer.js","../node_modules/face-api.js/build/es6/common/disposeUnusedWeightTensors.js","../node_modules/face-api.js/build/es6/common/extractConvParamsFactory.js","../node_modules/face-api.js/build/es6/common/extractFCParamsFactory.js","../node_modules/face-api.js/build/es6/common/types.js","../node_modules/face-api.js/build/es6/common/extractSeparableConvParamsFactory.js","../node_modules/face-api.js/build/es6/common/extractWeightEntryFactory.js","../node_modules/face-api.js/build/es6/common/extractWeightsFactory.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/extractorsFactory.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/extractParams.js","../node_modules/face-api.js/build/es6/common/loadConvParamsFactory.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/loadParamsFactory.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/FaceFeatureExtractor.js","../node_modules/face-api.js/build/es6/common/fullyConnectedLayer.js","../node_modules/face-api.js/build/es6/faceProcessor/extractParams.js","../node_modules/face-api.js/build/es6/faceProcessor/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/faceProcessor/util.js","../node_modules/face-api.js/build/es6/faceProcessor/FaceProcessor.js","../node_modules/face-api.js/build/es6/faceExpressionNet/FaceExpressions.js","../node_modules/face-api.js/build/es6/faceExpressionNet/FaceExpressionNet.js","../node_modules/face-api.js/build/es6/factories/WithFaceExpressions.js","../node_modules/face-api.js/build/es6/factories/WithFaceLandmarks.js","../node_modules/face-api.js/build/es6/xception/extractParams.js","../node_modules/face-api.js/build/es6/xception/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/xception/TinyXception.js","../node_modules/face-api.js/build/es6/ageGenderNet/extractParams.js","../node_modules/face-api.js/build/es6/ageGenderNet/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/ageGenderNet/types.js","../node_modules/face-api.js/build/es6/ageGenderNet/AgeGenderNet.js","../node_modules/face-api.js/build/es6/faceLandmarkNet/FaceLandmark68NetBase.js","../node_modules/face-api.js/build/es6/faceLandmarkNet/FaceLandmark68Net.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/extractParamsFromWeigthMapTiny.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/extractParamsTiny.js","../node_modules/face-api.js/build/es6/faceFeatureExtractor/TinyFaceFeatureExtractor.js","../node_modules/face-api.js/build/es6/faceLandmarkNet/FaceLandmark68TinyNet.js","../node_modules/face-api.js/build/es6/faceLandmarkNet/index.js","../node_modules/face-api.js/build/es6/faceRecognitionNet/scaleLayer.js","../node_modules/face-api.js/build/es6/faceRecognitionNet/convLayer.js","../node_modules/face-api.js/build/es6/faceRecognitionNet/extractParams.js","../node_modules/face-api.js/build/es6/faceRecognitionNet/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/faceRecognitionNet/residualLayer.js","../node_modules/face-api.js/build/es6/faceRecognitionNet/FaceRecognitionNet.js","../node_modules/face-api.js/build/es6/factories/WithFaceDescriptor.js","../node_modules/face-api.js/build/es6/factories/WithAge.js","../node_modules/face-api.js/build/es6/factories/WithGender.js","../node_modules/face-api.js/build/es6/mtcnn/MtcnnOptions.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/extractParams.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/pointwiseConvLayer.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/mobileNetV1.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/nonMaxSuppression.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/outputLayer.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/boxPredictionLayer.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/predictionLayer.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/SsdMobilenetv1Options.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/SsdMobilenetv1.js","../node_modules/face-api.js/build/es6/ssdMobilenetv1/index.js","../node_modules/face-api.js/build/es6/tinyYolov2/const.js","../node_modules/face-api.js/build/es6/tinyYolov2/config.js","../node_modules/face-api.js/build/es6/tinyYolov2/leaky.js","../node_modules/face-api.js/build/es6/tinyYolov2/convWithBatchNorm.js","../node_modules/face-api.js/build/es6/tinyYolov2/depthwiseSeparableConv.js","../node_modules/face-api.js/build/es6/tinyYolov2/extractParams.js","../node_modules/face-api.js/build/es6/tinyYolov2/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/tinyYolov2/TinyYolov2Options.js","../node_modules/face-api.js/build/es6/tinyYolov2/TinyYolov2Base.js","../node_modules/face-api.js/build/es6/tinyYolov2/TinyYolov2.js","../node_modules/face-api.js/build/es6/tinyFaceDetector/TinyFaceDetectorOptions.js","../node_modules/face-api.js/build/es6/globalApi/ComposableTask.js","../node_modules/face-api.js/build/es6/globalApi/extractFacesAndComputeResults.js","../node_modules/face-api.js/build/es6/mtcnn/bgrToRgbTensor.js","../node_modules/face-api.js/build/es6/mtcnn/config.js","../node_modules/face-api.js/build/es6/mtcnn/extractParams.js","../node_modules/face-api.js/build/es6/mtcnn/extractParamsFromWeigthMap.js","../node_modules/face-api.js/build/es6/mtcnn/getSizesForScale.js","../node_modules/face-api.js/build/es6/mtcnn/pyramidDown.js","../node_modules/face-api.js/build/es6/mtcnn/MtcnnBox.js","../node_modules/face-api.js/build/es6/mtcnn/normalize.js","../node_modules/face-api.js/build/es6/mtcnn/prelu.js","../node_modules/face-api.js/build/es6/mtcnn/sharedLayers.js","../node_modules/face-api.js/build/es6/mtcnn/PNet.js","../node_modules/face-api.js/build/es6/mtcnn/stage1.js","../node_modules/face-api.js/build/es6/mtcnn/extractImagePatches.js","../node_modules/face-api.js/build/es6/mtcnn/RNet.js","../node_modules/face-api.js/build/es6/mtcnn/stage2.js","../node_modules/face-api.js/build/es6/mtcnn/ONet.js","../node_modules/face-api.js/build/es6/mtcnn/stage3.js","../node_modules/face-api.js/build/es6/mtcnn/Mtcnn.js","../node_modules/face-api.js/build/es6/tinyFaceDetector/const.js","../node_modules/face-api.js/build/es6/tinyFaceDetector/TinyFaceDetector.js","../node_modules/face-api.js/build/es6/globalApi/nets.js","../node_modules/face-api.js/build/es6/globalApi/PredictFaceExpressionsTask.js","../node_modules/face-api.js/build/es6/globalApi/PredictAgeAndGenderTask.js","../node_modules/face-api.js/build/es6/globalApi/ComputeFaceDescriptorsTasks.js","../node_modules/face-api.js/build/es6/globalApi/DetectFaceLandmarksTasks.js","../node_modules/face-api.js/build/es6/globalApi/DetectFacesTasks.js","../node_modules/face-api.js/build/es6/globalApi/detectFaces.js","../node_modules/face-api.js/build/es6/euclideanDistance.js","../node_modules/face-api.js/build/es6/globalApi/FaceMatcher.js","../src/landmarkStandardization.ts","../src/faceAngle.ts","../src/faceAngleNoseTip.ts","../src/faceDetector.ts","../src/faceDetection.ts","../node_modules/@microblink/blinkid-in-browser-sdk/es/blinkid-sdk.js","../src/idCapture.ts","../node_modules/qrcode-generator-es6/index.js","../src/qrCodeGenerator.ts","../src/normalDistribution.ts","../src/testFaceDetector.ts","../src/livenessCheck.ts","../src/trustmaticLivenessCheck.ts"],"sourcesContent":["export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map","export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map","import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map","export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map","import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._teardowns = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialTeardown = this.initialTeardown;\n            if (isFunction(initialTeardown)) {\n                try {\n                    initialTeardown();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _teardowns = this._teardowns;\n            if (_teardowns) {\n                this._teardowns = null;\n                try {\n                    for (var _teardowns_1 = __values(_teardowns), _teardowns_1_1 = _teardowns_1.next(); !_teardowns_1_1.done; _teardowns_1_1 = _teardowns_1.next()) {\n                        var teardown_1 = _teardowns_1_1.value;\n                        try {\n                            execTeardown(teardown_1);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_teardowns_1_1 && !_teardowns_1_1.done && (_b = _teardowns_1.return)) _b.call(_teardowns_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execTeardown(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._teardowns = (_a = this._teardowns) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _teardowns = this._teardowns;\n        _teardowns && arrRemove(_teardowns, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execTeardown(teardown) {\n    if (isFunction(teardown)) {\n        teardown();\n    }\n    else {\n        teardown.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map","export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) || setTimeout).apply(void 0, __spreadArray([], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map","import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map","export function noop() { }\n//# sourceMappingURL=noop.js.map","import { __extends, __read, __spreadArray } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var next;\n        if (isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            (next = observerOrNext.next, error = observerOrNext.error, complete = observerOrNext.complete);\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n            }\n            else {\n                context_1 = observerOrNext;\n            }\n            next = next === null || next === void 0 ? void 0 : next.bind(context_1);\n            error = error === null || error === void 0 ? void 0 : error.bind(context_1);\n            complete = complete === null || complete === void 0 ? void 0 : complete.bind(context_1);\n        }\n        _this.destination = {\n            next: next ? wrapForErrorHandling(next, _this) : noop,\n            error: wrapForErrorHandling(error !== null && error !== void 0 ? error : defaultErrorHandler, _this),\n            complete: complete ? wrapForErrorHandling(complete, _this) : noop,\n        };\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction wrapForErrorHandling(handler, instance) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        try {\n            handler.apply(void 0, __spreadArray([], __read(args)));\n        }\n        catch (err) {\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                if (instance._syncErrorHack_isSubscribing) {\n                    instance.__syncError = err;\n                }\n                else {\n                    throw err;\n                }\n            }\n            else {\n                reportUnhandledError(err);\n            }\n        }\n    };\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map","export var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","export function identity(x) {\n    return x;\n}\n//# sourceMappingURL=identity.js.map","import { identity } from './identity';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map","import { SafeSubscriber, Subscriber } from './Subscriber';\nimport { isSubscription } from './Subscription';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nimport { isFunction } from './util/isFunction';\nvar Observable = (function () {\n    function Observable(subscribe) {\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new SafeSubscriber(observerOrNext, error, complete);\n        if (config.useDeprecatedSynchronousErrorHandling) {\n            this._deprecatedSyncErrorSubscribe(subscriber);\n        }\n        else {\n            var _a = this, operator = _a.operator, source = _a.source;\n            subscriber.add(operator\n                ?\n                    operator.call(subscriber, source)\n                : source\n                    ?\n                        this._subscribe(subscriber)\n                    :\n                        this._trySubscribe(subscriber));\n        }\n        return subscriber;\n    };\n    Observable.prototype._deprecatedSyncErrorSubscribe = function (subscriber) {\n        var localSubscriber = subscriber;\n        localSubscriber._syncErrorHack_isSubscribing = true;\n        var operator = this.operator;\n        if (operator) {\n            subscriber.add(operator.call(subscriber, this.source));\n        }\n        else {\n            try {\n                subscriber.add(this._subscribe(subscriber));\n            }\n            catch (err) {\n                localSubscriber.__syncError = err;\n            }\n        }\n        var dest = localSubscriber;\n        while (dest) {\n            if ('__syncError' in dest) {\n                try {\n                    throw dest.__syncError;\n                }\n                finally {\n                    subscriber.unsubscribe();\n                }\n            }\n            dest = dest.destination;\n        }\n        localSubscriber._syncErrorHack_isSubscribing = false;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.error(err);\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                try {\n                    next(value);\n                }\n                catch (err) {\n                    reject(err);\n                    subscription === null || subscription === void 0 ? void 0 : subscription.unsubscribe();\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var _a;\n        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        return operations.length ? pipeFromArray(operations)(this) : this;\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    var _a;\n    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : config.Promise) !== null && _a !== void 0 ? _a : Promise;\n}\nfunction isObserver(value) {\n    return value && isFunction(value.next) && isFunction(value.error) && isFunction(value.complete);\n}\nfunction isSubscriber(value) {\n    return (value && value instanceof Subscriber) || (isObserver(value) && isSubscription(value));\n}\n//# sourceMappingURL=Observable.js.map","import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map","import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        var closed = this.closed;\n        _super.prototype.unsubscribe.call(this);\n        !closed && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map","import { Observable } from '../Observable';\nexport var EMPTY = new Observable(function (subscriber) { return subscriber.complete(); });\nexport function empty(scheduler) {\n    return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\nfunction emptyScheduled(scheduler) {\n    return new Observable(function (subscriber) { return scheduler.schedule(function () { return subscriber.complete(); }); });\n}\n//# sourceMappingURL=empty.js.map","import { Observable } from '../Observable';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var i = 0;\n        return scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n            }\n            else {\n                subscriber.next(input[i++]);\n                if (!subscriber.closed) {\n                    this.schedule();\n                }\n            }\n        });\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map","export var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","import { isFunction } from \"./isFunction\";\nexport function isPromise(value) {\n    return isFunction(value === null || value === void 0 ? void 0 : value.then);\n}\n//# sourceMappingURL=isPromise.js.map","import { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport function scheduleObservable(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var sub = new Subscription();\n        sub.add(scheduler.schedule(function () {\n            var observable = input[Symbol_observable]();\n            sub.add(observable.subscribe({\n                next: function (value) { sub.add(scheduler.schedule(function () { return subscriber.next(value); })); },\n                error: function (err) { sub.add(scheduler.schedule(function () { return subscriber.error(err); })); },\n                complete: function () { sub.add(scheduler.schedule(function () { return subscriber.complete(); })); },\n            }));\n        }));\n        return sub;\n    });\n}\n//# sourceMappingURL=scheduleObservable.js.map","import { Observable } from '../Observable';\nexport function schedulePromise(input, scheduler) {\n    return new Observable(function (subscriber) {\n        return scheduler.schedule(function () {\n            return input.then(function (value) {\n                subscriber.add(scheduler.schedule(function () {\n                    subscriber.next(value);\n                    subscriber.add(scheduler.schedule(function () { return subscriber.complete(); }));\n                }));\n            }, function (err) {\n                subscriber.add(scheduler.schedule(function () { return subscriber.error(err); }));\n            });\n        });\n    });\n}\n//# sourceMappingURL=schedulePromise.js.map","export function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = getSymbolIterator();\n//# sourceMappingURL=iterator.js.map","export function caughtSchedule(subscriber, scheduler, execute, delay) {\n    if (delay === void 0) { delay = 0; }\n    var subscription = scheduler.schedule(function () {\n        try {\n            execute.call(this);\n        }\n        catch (err) {\n            subscriber.error(err);\n        }\n    }, delay);\n    subscriber.add(subscription);\n    return subscription;\n}\n//# sourceMappingURL=caughtSchedule.js.map","import { Observable } from '../Observable';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from '../util/isFunction';\nimport { caughtSchedule } from '../util/caughtSchedule';\nexport function scheduleIterable(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var iterator;\n        subscriber.add(scheduler.schedule(function () {\n            iterator = input[Symbol_iterator]();\n            caughtSchedule(subscriber, scheduler, function () {\n                var _a = iterator.next(), value = _a.value, done = _a.done;\n                if (done) {\n                    subscriber.complete();\n                }\n                else {\n                    subscriber.next(value);\n                    this.schedule();\n                }\n            });\n        }));\n        return function () { return isFunction(iterator === null || iterator === void 0 ? void 0 : iterator.return) && iterator.return(); };\n    });\n}\n//# sourceMappingURL=scheduleIterable.js.map","import { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nexport function scheduleAsyncIterable(input, scheduler) {\n    if (!input) {\n        throw new Error('Iterable cannot be null');\n    }\n    return new Observable(function (subscriber) {\n        var sub = new Subscription();\n        sub.add(scheduler.schedule(function () {\n            var iterator = input[Symbol.asyncIterator]();\n            sub.add(scheduler.schedule(function () {\n                var _this = this;\n                iterator.next().then(function (result) {\n                    if (result.done) {\n                        subscriber.complete();\n                    }\n                    else {\n                        subscriber.next(result.value);\n                        _this.schedule();\n                    }\n                });\n            }));\n        }));\n        return sub;\n    });\n}\n//# sourceMappingURL=scheduleAsyncIterable.js.map","import { observable as Symbol_observable } from '../symbol/observable';\nimport { isFunction } from './isFunction';\nexport function isInteropObservable(input) {\n    return isFunction(input[Symbol_observable]);\n}\n//# sourceMappingURL=isInteropObservable.js.map","import { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from './isFunction';\nexport function isIterable(input) {\n    return isFunction(input === null || input === void 0 ? void 0 : input[Symbol_iterator]);\n}\n//# sourceMappingURL=isIterable.js.map","import { isFunction } from './isFunction';\nexport function isAsyncIterable(obj) {\n    return Symbol.asyncIterator && isFunction(obj === null || obj === void 0 ? void 0 : obj[Symbol.asyncIterator]);\n}\n//# sourceMappingURL=isAsyncIterable.js.map","export function createInvalidObservableTypeError(input) {\n    return new TypeError(\"You provided \" + (input !== null && typeof input === 'object' ? 'an invalid object' : \"'\" + input + \"'\") + \" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.\");\n}\n//# sourceMappingURL=throwUnobservableError.js.map","import { __asyncGenerator, __await, __generator } from \"tslib\";\nimport { isFunction } from './isFunction';\nexport function readableStreamLikeToAsyncGenerator(readableStream) {\n    return __asyncGenerator(this, arguments, function readableStreamLikeToAsyncGenerator_1() {\n        var reader, _a, value, done;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    reader = readableStream.getReader();\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, , 9, 10]);\n                    _b.label = 2;\n                case 2:\n                    if (!true) return [3, 8];\n                    return [4, __await(reader.read())];\n                case 3:\n                    _a = _b.sent(), value = _a.value, done = _a.done;\n                    if (!done) return [3, 5];\n                    return [4, __await(void 0)];\n                case 4: return [2, _b.sent()];\n                case 5: return [4, __await(value)];\n                case 6: return [4, _b.sent()];\n                case 7:\n                    _b.sent();\n                    return [3, 2];\n                case 8: return [3, 10];\n                case 9:\n                    reader.releaseLock();\n                    return [7];\n                case 10: return [2];\n            }\n        });\n    });\n}\nexport function isReadableStreamLike(obj) {\n    return isFunction(obj === null || obj === void 0 ? void 0 : obj.getReader);\n}\n//# sourceMappingURL=isReadableStreamLike.js.map","import { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nexport function scheduleReadableStreamLike(input, scheduler) {\n    return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input), scheduler);\n}\n//# sourceMappingURL=scheduleReadableStreamLike.js.map","import { scheduleObservable } from './scheduleObservable';\nimport { schedulePromise } from './schedulePromise';\nimport { scheduleArray } from './scheduleArray';\nimport { scheduleIterable } from './scheduleIterable';\nimport { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isIterable } from '../util/isIterable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isReadableStreamLike } from '../util/isReadableStreamLike';\nimport { scheduleReadableStreamLike } from './scheduleReadableStreamLike';\nexport function scheduled(input, scheduler) {\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return scheduleObservable(input, scheduler);\n        }\n        if (isArrayLike(input)) {\n            return scheduleArray(input, scheduler);\n        }\n        if (isPromise(input)) {\n            return schedulePromise(input, scheduler);\n        }\n        if (isAsyncIterable(input)) {\n            return scheduleAsyncIterable(input, scheduler);\n        }\n        if (isIterable(input)) {\n            return scheduleIterable(input, scheduler);\n        }\n        if (isReadableStreamLike(input)) {\n            return scheduleReadableStreamLike(input, scheduler);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\n//# sourceMappingURL=scheduled.js.map","import { __asyncValues, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isPromise } from '../util/isPromise';\nimport { observable as Symbol_observable } from '../symbol/observable';\nimport { Observable } from '../Observable';\nimport { scheduled } from '../scheduled/scheduled';\nimport { isFunction } from '../util/isFunction';\nimport { reportUnhandledError } from '../util/reportUnhandledError';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isIterable } from '../util/isIterable';\nimport { isReadableStreamLike, readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nexport function from(input, scheduler) {\n    return scheduler ? scheduled(input, scheduler) : innerFrom(input);\n}\nexport function innerFrom(input) {\n    if (input instanceof Observable) {\n        return input;\n    }\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return fromInteropObservable(input);\n        }\n        if (isArrayLike(input)) {\n            return fromArrayLike(input);\n        }\n        if (isPromise(input)) {\n            return fromPromise(input);\n        }\n        if (isAsyncIterable(input)) {\n            return fromAsyncIterable(input);\n        }\n        if (isIterable(input)) {\n            return fromIterable(input);\n        }\n        if (isReadableStreamLike(input)) {\n            return fromReadableStreamLike(input);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\nfunction fromInteropObservable(obj) {\n    return new Observable(function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (isFunction(obs.subscribe)) {\n            return obs.subscribe(subscriber);\n        }\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    });\n}\nexport function fromArrayLike(array) {\n    return new Observable(function (subscriber) {\n        for (var i = 0; i < array.length && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    });\n}\nfunction fromPromise(promise) {\n    return new Observable(function (subscriber) {\n        promise\n            .then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, reportUnhandledError);\n    });\n}\nfunction fromIterable(iterable) {\n    return new Observable(function (subscriber) {\n        var e_1, _a;\n        try {\n            for (var iterable_1 = __values(iterable), iterable_1_1 = iterable_1.next(); !iterable_1_1.done; iterable_1_1 = iterable_1.next()) {\n                var value = iterable_1_1.value;\n                subscriber.next(value);\n                if (subscriber.closed) {\n                    return;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) _a.call(iterable_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        subscriber.complete();\n    });\n}\nfunction fromAsyncIterable(asyncIterable) {\n    return new Observable(function (subscriber) {\n        process(asyncIterable, subscriber).catch(function (err) { return subscriber.error(err); });\n    });\n}\nfunction fromReadableStreamLike(readableStream) {\n    return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream));\n}\nfunction process(asyncIterable, subscriber) {\n    var asyncIterable_1, asyncIterable_1_1;\n    var e_2, _a;\n    return __awaiter(this, void 0, void 0, function () {\n        var value, e_2_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 5, 6, 11]);\n                    asyncIterable_1 = __asyncValues(asyncIterable);\n                    _b.label = 1;\n                case 1: return [4, asyncIterable_1.next()];\n                case 2:\n                    if (!(asyncIterable_1_1 = _b.sent(), !asyncIterable_1_1.done)) return [3, 4];\n                    value = asyncIterable_1_1.value;\n                    subscriber.next(value);\n                    if (subscriber.closed) {\n                        return [2];\n                    }\n                    _b.label = 3;\n                case 3: return [3, 1];\n                case 4: return [3, 11];\n                case 5:\n                    e_2_1 = _b.sent();\n                    e_2 = { error: e_2_1 };\n                    return [3, 11];\n                case 6:\n                    _b.trys.push([6, , 9, 10]);\n                    if (!(asyncIterable_1_1 && !asyncIterable_1_1.done && (_a = asyncIterable_1.return))) return [3, 8];\n                    return [4, _a.call(asyncIterable_1)];\n                case 7:\n                    _b.sent();\n                    _b.label = 8;\n                case 8: return [3, 10];\n                case 9:\n                    if (e_2) throw e_2.error;\n                    return [7];\n                case 10: return [7];\n                case 11:\n                    subscriber.complete();\n                    return [2];\n            }\n        });\n    });\n}\n//# sourceMappingURL=from.js.map","import { scheduleArray } from '../scheduled/scheduleArray';\nimport { fromArrayLike } from './from';\nexport function internalFromArray(input, scheduler) {\n    return scheduler ? scheduleArray(input, scheduler) : fromArrayLike(input);\n}\n//# sourceMappingURL=fromArray.js.map","import { isFunction } from './isFunction';\nexport function isScheduler(value) {\n    return value && isFunction(value.schedule);\n}\n//# sourceMappingURL=isScheduler.js.map","import { isFunction } from './isFunction';\nimport { isScheduler } from './isScheduler';\nfunction last(arr) {\n    return arr[arr.length - 1];\n}\nexport function popResultSelector(args) {\n    return isFunction(last(args)) ? args.pop() : undefined;\n}\nexport function popScheduler(args) {\n    return isScheduler(last(args)) ? args.pop() : undefined;\n}\nexport function popNumber(args, defaultValue) {\n    return typeof last(args) === 'number' ? args.pop() : defaultValue;\n}\n//# sourceMappingURL=args.js.map","import { internalFromArray } from './fromArray';\nimport { scheduleArray } from '../scheduled/scheduleArray';\nimport { popScheduler } from '../util/args';\nexport function of() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    return scheduler ? scheduleArray(args, scheduler) : internalFromArray(args);\n}\n//# sourceMappingURL=of.js.map","import { Observable } from '../Observable';\nimport { isFunction } from '../util/isFunction';\nexport function throwError(errorOrErrorFactory, scheduler) {\n    var errorFactory = isFunction(errorOrErrorFactory) ? errorOrErrorFactory : function () { return errorOrErrorFactory; };\n    var init = function (subscriber) { return subscriber.error(errorFactory()); };\n    return new Observable(scheduler ? function (subscriber) { return scheduler.schedule(init, 0, subscriber); } : init);\n}\n//# sourceMappingURL=throwError.js.map","import { operate } from '../util/lift';\nimport { OperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(new OperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","import { innerFrom } from '../observable/from';\nimport { OperatorSubscriber } from './OperatorSubscriber';\nexport function mergeInternals(source, subscriber, project, concurrent, onBeforeNext, expand, innerSubScheduler, additionalTeardown) {\n    var buffer = [];\n    var active = 0;\n    var index = 0;\n    var isComplete = false;\n    var checkComplete = function () {\n        if (isComplete && !buffer.length && !active) {\n            subscriber.complete();\n        }\n    };\n    var outerNext = function (value) { return (active < concurrent ? doInnerSub(value) : buffer.push(value)); };\n    var doInnerSub = function (value) {\n        expand && subscriber.next(value);\n        active++;\n        var innerComplete = false;\n        innerFrom(project(value, index++)).subscribe(new OperatorSubscriber(subscriber, function (innerValue) {\n            onBeforeNext === null || onBeforeNext === void 0 ? void 0 : onBeforeNext(innerValue);\n            if (expand) {\n                outerNext(innerValue);\n            }\n            else {\n                subscriber.next(innerValue);\n            }\n        }, function () {\n            innerComplete = true;\n        }, undefined, function () {\n            if (innerComplete) {\n                try {\n                    active--;\n                    var _loop_1 = function () {\n                        var bufferedValue = buffer.shift();\n                        innerSubScheduler ? subscriber.add(innerSubScheduler.schedule(function () { return doInnerSub(bufferedValue); })) : doInnerSub(bufferedValue);\n                    };\n                    while (buffer.length && active < concurrent) {\n                        _loop_1();\n                    }\n                    checkComplete();\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }\n        }));\n    };\n    source.subscribe(new OperatorSubscriber(subscriber, outerNext, function () {\n        isComplete = true;\n        checkComplete();\n    }));\n    return function () {\n        additionalTeardown === null || additionalTeardown === void 0 ? void 0 : additionalTeardown();\n    };\n}\n//# sourceMappingURL=mergeInternals.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/from';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function (a, i) { return map(function (b, ii) { return resultSelector(a, b, i, ii); })(innerFrom(project(a, i))); }, concurrent);\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return operate(function (source, subscriber) { return mergeInternals(source, subscriber, project, concurrent); });\n}\n//# sourceMappingURL=mergeMap.js.map","import { operate } from '../util/lift';\nimport { OperatorSubscriber } from './OperatorSubscriber';\nexport function filter(predicate, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(new OperatorSubscriber(subscriber, function (value) { return predicate.call(thisArg, value, index++) && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=filter.js.map","import { OperatorSubscriber } from './OperatorSubscriber';\nexport function scanInternals(accumulator, seed, hasSeed, emitOnNext, emitBeforeComplete) {\n    return function (source, subscriber) {\n        var hasState = hasSeed;\n        var state = seed;\n        var index = 0;\n        source.subscribe(new OperatorSubscriber(subscriber, function (value) {\n            var i = index++;\n            state = hasState\n                ?\n                    accumulator(state, value, i)\n                :\n                    ((hasState = true), value);\n            emitOnNext && subscriber.next(state);\n        }, emitBeforeComplete &&\n            (function () {\n                hasState && subscriber.next(state);\n                subscriber.complete();\n            })));\n    };\n}\n//# sourceMappingURL=scanInternals.js.map","import { scanInternals } from './scanInternals';\nimport { operate } from '../util/lift';\nexport function reduce(accumulator, seed) {\n    return operate(scanInternals(accumulator, seed, arguments.length >= 2, false, true));\n}\n//# sourceMappingURL=reduce.js.map","import { reduce } from './reduce';\nimport { operate } from '../util/lift';\nvar arrReducer = function (arr, value) { return (arr.push(value), arr); };\nexport function toArray() {\n    return operate(function (source, subscriber) {\n        reduce(arrReducer, [])(source).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=toArray.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { OperatorSubscriber } from './OperatorSubscriber';\nexport function take(count) {\n    return count <= 0\n        ?\n            function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var seen = 0;\n            source.subscribe(new OperatorSubscriber(subscriber, function (value) {\n                if (++seen <= count) {\n                    subscriber.next(value);\n                    if (count <= seen) {\n                        subscriber.complete();\n                    }\n                }\n            }));\n        });\n}\n//# sourceMappingURL=take.js.map","import { isFunction } from '../util/isFunction';\nimport { operate } from '../util/lift';\nimport { OperatorSubscriber } from './OperatorSubscriber';\nimport { identity } from '../util/identity';\nexport function tap(observerOrNext, error, complete) {\n    var tapObserver = isFunction(observerOrNext) || error || complete ? { next: observerOrNext, error: error, complete: complete } : observerOrNext;\n    return tapObserver\n        ? operate(function (source, subscriber) {\n            source.subscribe(new OperatorSubscriber(subscriber, function (value) {\n                var _a;\n                (_a = tapObserver.next) === null || _a === void 0 ? void 0 : _a.call(tapObserver, value);\n                subscriber.next(value);\n            }, function () {\n                var _a;\n                (_a = tapObserver.complete) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                subscriber.complete();\n            }, function (err) {\n                var _a;\n                (_a = tapObserver.error) === null || _a === void 0 ? void 0 : _a.call(tapObserver, err);\n                subscriber.error(err);\n            }));\n        })\n        :\n            identity;\n}\n//# sourceMappingURL=tap.js.map","'use strict';\n\nimport { \n    BlinkIdMultiSideRecognizerResult,\n    IdBarcodeRecognizerResult, \n    BlinkIdMultiSideRecognizer,\n    IdBarcodeRecognizer,\n    BlinkIdSingleSideRecognizerResult,\n    BlinkIdSingleSideRecognizer\n} from \"@microblink/blinkid-in-browser-sdk\"\nimport { cropImage, resizeImage, sizeOfImageSource } from \"./utils\"\n\n/**\n * @category ID capture\n */\nexport type IdCaptureStatus = \"pass\" | \"review\" | \"fail\"\n\n/**\n * @category ID capture\n */\nexport interface IdCaptureResponse {\n    error?: any\n    result: {\n        front?: DocumentFrontPage,\n        back?: DocumentBackPage,\n        passport?: PassportDocument\n    }\n    warnings?: Warning[]\n    status: IdCaptureStatus\n}\n\n/**\n * @category ID capture\n */\nexport interface Address {\n    street: string\n    city: string\n    postalCode: string\n    jurisdiction: string\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport interface IDDocument {\n    documentNumber: string\n    firstName: string\n    lastName: string\n    warnings: Set<Warning>\n    dateOfBirth: DocumentDate\n    dateOfExpiry: DocumentDate\n    recognizer: RecognizerType\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport interface DatedDocument {\n    dateOfIssue: DocumentDate\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport interface ImageDocument {\n    image: string\n    faces: {\n        x: number,\n        y: number,\n        width: number,\n        height: number,\n        quality: number,\n        template: string\n    }[]\n    imageAnalysis: ImageQuality\n    imageSize: Size\n}\n\n/**\n * @internal\n */\nexport interface ImageQuality {\n    brightness: number\n    contrast: number\n    sharpness: number\n}\n\n/**\n * @category ID capture\n */\nexport type RecognizerType = \"BLINK_ID\" | \"USDL\" | \"PASSPORT\"\n\n/**\n * @category ID capture\n */\nexport interface DocumentDate {\n    day: number\n    month: number\n    year: number\n    successfullyParsed?: boolean\n    originalString?: string\n}\n\n/**\n * @category ID capture\n */\nexport interface ClassInfo {\n    country: string\n    region: string\n    type: string\n    countryName: string\n    isoAlpha3CountryCode: string\n    isoAlpha2CountryCode: string\n    isoNumericCountryCode: string\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport interface DocumentFrontPage extends IDDocument, ImageDocument, DatedDocument {\n    classInfo: ClassInfo\n    fullName: string\n    address: string\n    authenticityScores: {[k: string]: number}\n    authenticityScore: number\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport interface DocumentBackPage extends IDDocument, DatedDocument {\n    barcode: string\n    issuerIdentificationNumber: string\n    fullName: string\n    address: Address\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport interface PassportDocument extends IDDocument, ImageDocument {\n    rawMRZString: string\n    issuer: string\n    nationality: string\n    mrtdVerified: boolean\n    recognitionStatus: string\n}\n\n/**\n * @category ID capture\n * @internal\n */\nexport type CapturedDocument<T extends RecognizerType> = T extends \"PASSPORT\" ? PassportDocument : T extends \"USDL\" ? DocumentBackPage : DocumentFrontPage\n\n/**\n * @category ID capture\n */\nexport enum DocumentPages {\n    FRONT = \"front\",\n    BACK = \"back\",\n    FRONT_AND_BACK = \"front and back\"\n}\n\n/**\n * @category ID capture\n */\nexport enum DocumentSide {\n    FRONT = \"front\",\n    BACK = \"back\"\n}\n\n/**\n * @category ID capture\n */\nexport class IdCaptureResult {\n    face?: RecognizableFace\n    pages: DocumentPages\n    result: SupportedRecognizerResult\n\n    constructor(result: SupportedRecognizerResult, pages: DocumentPages, face?: RecognizableFace) {\n        this.result = result\n        this.pages = pages\n        this.face = face\n    }\n\n    documentImage(side: DocumentSide, cropToDocument: boolean = false, maxSize?: number): Promise<ImageData> {\n        let imageData: ImageData\n        if (side == DocumentSide.FRONT && (<BlinkIdMultiSideRecognizerResult>this.result).fullDocumentFrontImage?.rawImage) {\n            imageData = (<BlinkIdMultiSideRecognizerResult>this.result).fullDocumentFrontImage.rawImage!\n        } else if (side == DocumentSide.FRONT && (<BlinkIdSingleSideRecognizerResult>this.result).fullDocumentImage?.rawImage) {\n            imageData = (<BlinkIdSingleSideRecognizerResult>this.result).fullDocumentImage.rawImage!\n        } else if (side == DocumentSide.BACK && (<BlinkIdMultiSideRecognizerResult>this.result).fullDocumentBackImage?.rawImage) {\n            imageData = (<BlinkIdMultiSideRecognizerResult>this.result).fullDocumentBackImage.rawImage!\n        } else {\n            throw new Error(\"Image unavailable\")\n        }\n        let dx: number = 0\n        let dy: number = 0\n        let width: number = imageData.width\n        let height: number = imageData.height\n        if (cropToDocument) {\n            dx = 0 - width / 12\n            dy = 0 - height / 12\n            width /= 1.2\n            height /= 1.2\n        } else if (!maxSize) {\n            return Promise.resolve(imageData)\n        }\n        const canvas = document.createElement(\"canvas\")\n        canvas.width = width\n        canvas.height = height\n        const context = canvas.getContext(\"2d\")\n        context!.putImageData(imageData, dx, dy)\n        if (!maxSize) {\n            return Promise.resolve(context!.getImageData(0, 0, width, height))\n        }\n        return resizeImage(context!.getImageData(0, 0, width, height), maxSize)\n    }\n}\n\nexport class Warning {\n\n    readonly code: number\n    readonly description: string\n\n    constructor(code: number, description: string) {\n        this.code = code\n        this.description = description\n    }\n}\n\n/**\n * @category ID capture\n */\nexport type SupportedRecognizerResult = BlinkIdMultiSideRecognizerResult|BlinkIdSingleSideRecognizerResult|IdBarcodeRecognizerResult\n\ntype SupportedWrappedRecognizer = BlinkIdMultiSideRecognizer|BlinkIdSingleSideRecognizer|IdBarcodeRecognizer\n\n/**\n * @category ID capture\n */\nexport type SupportedRecognizer = SupportedWrappedRecognizer\n\n/**\n * @internal\n */\nexport type ProgressListener = (progress: number) => void\n\n/**\n * Image source\n */\nexport type ImageSource = HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | Blob | ImageData | string\n\n/**\n * @category Face recognition\n */\nexport type RecognizableFaceDetectionInput = {\n    [k: string]: {\n        image: ImageSource\n        faceRect?: Rect\n    }\n}\n\n/**\n * @category Face recognition\n */\nexport type RecognizableFaceDetectionOutput = {\n    [k: string]: RecognizableFace\n}\n\n/**\n * ID capture UI interface\n * \n * Facilitates the implementation of a custom user interface for ID capture sessions\n * @category ID capture\n */\nexport interface IdCaptureUI {\n    /**\n     * Video element to display the camera feed\n     */\n    readonly video: HTMLVideoElement\n    /**\n     * Trigger an ID capture event\n     * \n     * The trigger method will be called by the ID capture throughout the session. \n     * It's up to your class to handle the triggers.\n     * @param event Triggered event\n     */\n    trigger(event: IdCaptureEvent): void\n    /**\n     * Set a listener for the given event type\n     * @param eventType Event type to listen for\n     * @param callback Callback to be invoked when the event is triggered\n     */\n    on<Event extends IdCaptureEvent>(eventType: IdCaptureEventType, callback: (event: Event) => void): void\n}\n\n/**\n * @category ID capture\n */\nexport type IdCaptureEvent = {\n    type: IdCaptureEventType\n}\n\n/**\n * @category ID capture\n */\nexport type IdCaptureProgressEvent = IdCaptureEvent & {\n    progress: number\n}\n\n/**\n * ID capture event types\n * @category ID capture\n */\nexport enum IdCaptureEventType {\n    /**\n     * ID capture session has been cancelled (e.g., user clicking on a cancel button)\n     */\n    CANCEL = \"cancel\",\n    /**\n     * Page of an ID document has been captured\n     */\n    PAGE_CAPTURED = \"page captured\",\n    /**\n     * ID capture session requested to capture the next page of the ID document\n     */\n    NEXT_PAGE_REQUESTED = \"next page requested\",\n    /**\n     * Camera is too far from the document\n     */\n    CAMERA_TOO_FAR = \"camera too far\",\n    /**\n     * Camera is too close to the document\n     */\n    CAMERA_TOO_CLOSE = \"camera too close\",\n    /**\n     * Camera is pointing at the document at an angle\n     */\n    CAMERA_ANGLED = \"camera angled\",\n    /**\n     * ID capture session is looking for a face on the document\n     */\n    FINDING_FACE = \"finding face\",\n    /**\n     * ID capture is capturing the document\n     */\n    CAPTURING = \"capturing\",\n    /**\n     * ID capture session ended\n     */\n    CAPTURE_ENDED = \"capture ended\",\n    /**\n     * ID capture session started\n     */\n    CAPTURE_STARTED = \"capture started\",\n    /**\n     * ID capture library loading progressed\n     */\n    LOADING_PROGRESSED = \"loading progressed\",\n    /**\n     * ID capture library has been loaded\n     */\n    LOADED = \"loaded\",\n    /**\n     * Failed to load the ID capture library\n     */\n    LOADING_FAILED = \"loading failed\"\n}\n\n/**\n * Face that contains a template that can be used for face recognition\n * @category Face recognition\n */\nexport interface RecognizableFace {\n    /**\n     * Distance of the face from the left side of the image (percent of image width)\n     */\n    x: number\n    /**\n     * Distance of the face from the top side of the image (percent of image height)\n     */\n    y: number\n    /**\n     * Width of the face (percent of image width)\n     */\n    width: number,\n    /**\n     * Height of the face (percent of image height)\n     */\n    height: number,\n    /**\n     * Quality of the detected face  ranges from 0 (worst) to 10 (best)\n     */\n    quality: number\n    /**\n     * Face roll angle (degrees)\n     */\n    rotation: number\n    /**\n     * Base64-encoded face recognition template\n     */\n    template: string\n}\n\n/**\n * Axis\n * @category Face detection\n * @internal\n */\nexport enum Axis {\n    /**\n     * Yaw axis\n     */\n    YAW,\n    /**\n     * Pitch axis\n     */\n    PITCH\n}\n\nexport interface Size {\n    width: number,\n    height: number\n}\n\n/**\n * Face alignment status\n * @category Face detection\n * @internal\n */\nexport enum FaceAlignmentStatus {\n    FOUND,\n    FIXED,\n    ALIGNED,\n    MISALIGNED\n}\n\n/**\n * Bearing\n * @category Face detection\n */\nexport enum Bearing {\n    STRAIGHT,\n    LEFT,\n    RIGHT,\n    UP,\n    DOWN,\n    LEFT_UP,\n    RIGHT_UP,\n    LEFT_DOWN,\n    RIGHT_DOWN\n}\n\n/**\n * @category ID capture\n */\nexport type RecognizerName = \"BlinkIdCombinedRecognizer\" | \"BlinkIdRecognizer\" | \"IdBarcodeRecognizer\"\n\n/**\n * @category ID capture\n */\nexport type IdCaptureUIFactory = () => IdCaptureUI\n\n\nexport type Range<Type> = {\n    from: Type,\n    to: Type\n}\n\n/**\n * @category Face detection\n */\nexport type FaceRequirements = {\n    imageSize: Size\n    ideal: {\n        bounds: Rect,\n        angle: Angle\n    }\n    accepted: {\n        left: Range<number>\n        top: Range<number>\n        right: Range<number>\n        bottom: Range<number>\n        yaw: Range<number>\n        pitch: Range<number>\n    }\n}\n\n/**\n * @category Face detection\n */\nexport type FaceRequirementListener = {\n    onChange: (requirements: FaceRequirements) => void\n}\n\n/**\n * @category Face detection\n */\nexport type FaceCaptureCallback = (faceCapture: FaceCapture) => void\n/**\n * Angle\n * @internal\n */\n\nexport class Angle {\n    /**\n     * Yaw\n     */\n    yaw: number;\n    /**\n     * Pitch\n     */\n    pitch: number;\n    /**\n     * Roll\n     */\n    roll: number;\n    /**\n     * Constructor\n     * @param yaw Yaw\n     * @param pitch Pitch\n     * @param roll Roll\n     */\n    constructor(yaw?: number, pitch?: number, roll?: number) {\n        this.yaw = yaw || 0;\n        this.pitch = pitch || 0;\n        this.roll = roll || 0;\n    }\n\n    /**\n     * Arc tangent of the pitch and yaw (used for displaying the angle on screen)\n     */\n    get screenAngle(): number {\n        return Math.atan2(this.pitch, 0 - this.yaw);\n    }\n}\n/**\n * Point\n * @internal\n */\n\nexport class Point {\n    /**\n     * Horizontal coordinate\n     */\n    x: number;\n    /**\n     * Vertical coordinate\n     */\n    y: number;\n\n    /**\n     * Constructor\n     * @param x Horizontal coordinate\n     * @param y Vertical coordinate\n     */\n    constructor(x?: number, y?: number) {\n        this.x = x || 0;\n        this.y = y || 0;\n    }\n}\n\n/**\n * Rectangle\n * @internal\n */\n\nexport class Rect {\n    /**\n     * Left edge of the rectangle\n     */\n    x: number;\n    /**\n     * Top edge of the rectangle\n     */\n    y: number;\n    /**\n     * Top edge of the rectangle\n     */\n    width: number;\n    /**\n     * Rectangle height\n     */\n    height: number;\n\n    /**\n     * Constructor\n     * @param x Left edge of the rectangle\n     * @param y Top edge of the rectangle\n     * @param width Top edge of the rectangle\n     * @param height Rectangle height\n     */\n    constructor(x: number, y: number, width: number, height: number) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n\n    /**\n     * Inset all edges of the rectangle by the given amounts\n     * @param xInset Horizontal inset\n     * @param yInset Vertical inset\n     */\n    inset(xInset: number, yInset: number) {\n        this.x += xInset;\n        this.y += yInset;\n        this.width -= xInset * 2;\n        this.height -= yInset * 2;\n    }\n\n    /**\n     * Find out whether this rectangle contains another rectangle\n     * @param rect Challenge rectangle\n     * @returns `true` if this rectangle contains the challenge rectangle\n     */\n    contains(rect: Rect): boolean {\n        return this.x <= rect.x && this.y <= rect.y && this.right >= rect.right && this.bottom >= rect.bottom;\n    }\n\n    /**\n     * Center of the rectangle\n     */\n    get center(): Point {\n        return new Point(this.x + this.width / 2, this.y + this.height / 2);\n    }\n\n    /**\n     * Scale rectangle by the given scale factor and return a new rectangle\n     * @param scaleX Horizontal scale\n     * @param scaleY Vertical scale (optional, if not specified scaleX will be used)\n     * @returns New rectangle that is this rectangle scaled by the scale values\n     */\n    scaledBy(scaleX: number, scaleY?: number): Rect {\n        if (scaleY === undefined || scaleY == null) {\n            scaleY = scaleX;\n        }\n        return new Rect(\n            this.x * scaleX,\n            this.y * scaleY,\n            this.width * scaleX,\n            this.height * scaleY\n        );\n    }\n\n    /**\n     * @param planeWidth Width of the plane in which the rectangle should be mirrored\n     * @returns Rectangle mirrored horizontally along the plane's vertical axis\n     */\n    mirrored(planeWidth: number): Rect {\n        return new Rect(planeWidth - this.x - this.width, this.y, this.width, this.height);\n    }\n\n    get right(): number {\n        return this.x + this.width;\n    }\n\n    get bottom(): number {\n        return this.y + this.height;\n    }\n\n    equals = (other: Rect): boolean => {\n        if (this.x != other.x) {\n            return false;\n        }\n        if (this.y != other.y) {\n            return false;\n        }\n        if (this.width != other.width) {\n            return false;\n        }\n        if (this.height != other.height) {\n            return false;\n        }\n        return true;\n    };\n}\n\n/**\n * Extents of a face within a view\n * @remarks\n * Used by liveness detection session to determine the area where to show the face in relation to the containing view\n * @category Face detection\n */\n\n\nexport class FaceExtents {\n    /**\n     * Proportion of view width, e.g., 0.65 is 65% of the view width\n     */\n    readonly proportionOfViewWidth: number;\n    /**\n     * Proportion of view height, e.g., 0.85 is 85% of the view height\n     */\n    readonly proportionOfViewHeight: number;\n    /**\n     * Constructor\n     * @param proportionOfViewWidth Proportion of view width\n     * @param proportionOfViewHeight Proportion of view height\n     */\n    constructor(proportionOfViewWidth: number, proportionOfViewHeight: number) {\n        this.proportionOfViewWidth = proportionOfViewWidth;\n        this.proportionOfViewHeight = proportionOfViewHeight;\n    }\n}\n\n/**\n * Capture of a live face\n * @category Face detection\n */\n\nexport class FaceCapture {\n    /**\n     * Image in which the face was detected\n     */\n    readonly image: Blob;\n    /**\n     * Face or `null` if no face is detected in the image\n     */\n    readonly face: Face|null;\n    /**\n     * Bearing requested at the time of capture\n     */\n    requestedBearing?: Bearing;\n    /**\n     * Smoothed bounds of the face and of the faces captured previously in the session\n     */\n    faceBounds?: Rect;\n    /**\n     * Smoothed angle of the face and of the faces captured previously in the session\n     * @internal\n     */\n    faceAngle?: Angle;\n    /**\n     * Face alignment status at time of capture\n     * @internal\n     */\n    faceAlignmentStatus?: FaceAlignmentStatus;\n    /**\n     * Difference between the angle of the requested bearing and the angle of the detected face\n     * @internal\n     */\n    offsetAngleFromBearing?: Angle;\n\n    /**\n     * Number between 0 and 1 representing the trajectory to the requested bearing angle.\n     * `1` means the face is moving straight towards the requested bearing.\n     * `0` means the face is moving in the opposite direction than the requested bearing.\n     */\n    angleTrajectory: number | undefined;\n\n    angleDistance = 0;\n\n    /**\n     * Image cropped to the bounds of the detected face\n     */\n    readonly faceImage: Blob;\n    readonly imageSize: Size;\n    readonly time: number;\n\n    /**\n     * Constructor\n     * @param image Image in which the face was detected\n     * @param face Face or `null` if no face was detected in the image\n     * @internal\n     */\n    private constructor(image: Blob, face: Face|null, imageSize: Size, faceImage: Blob) {\n        this.image = image;\n        this.face = face;\n        this.imageSize = imageSize;\n        this.faceImage = faceImage;\n        this.time = Date.now();\n    }\n\n    static async create(image: Blob, face: Face|null): Promise<FaceCapture> {\n        const faceImage = await cropImage(image, face ? face.bounds : undefined);\n        const imageSize = await sizeOfImageSource(image);\n        return new FaceCapture(image, face, imageSize, faceImage);\n    }\n}\n\n/**\n * Face detected in an image\n * @category Face detection\n */\n\n\nexport class Face {\n    /**\n     * Bounds of the face\n     */\n    bounds: Rect;\n    /**\n     * Angle of the face\n     */\n    angle: Angle;\n    /**\n     * Face template (used for face recognition)\n     */\n    template?: string;\n\n    /**\n     * Constructor\n     * @param bounds Bounds\n     * @param angle Angle\n     * @internal\n     */\n    constructor(bounds: Rect, angle: Angle) {\n        this.bounds = bounds;\n        this.angle = angle;\n    }\n}\n\n","'use strict';\n\nimport { LivenessDetectionSessionSettings } from \"./livenessDetectionSession\";\nimport { Angle, Axis, Bearing, ImageSource, Rect, Size } from \"./types\"\nimport { Subscriber } from \"rxjs\"\n\n/**\n * Circular (ring) buffer implementation\n * \n * @typeParam Type - Type of value the buffer contains\n * @internal\n */\nexport class CircularBuffer<Type> {\n    private buffer: Array<Type> = []\n    private capacity: number\n    /**\n     * Constructor\n     * @param capacity Capacity of the buffer\n     */\n    constructor(capacity: number) {\n        this.capacity = capacity\n    }\n    /**\n     * Enqueue (add) an element into the buffer\n     * \n     * If the buffer is full the first value in the buffer will be discarded\n     * @param value Element to add to the buffer\n     */\n    enqueue(value: Type) {\n        if (this.buffer.length == this.capacity) {\n            this.buffer.shift()\n        }\n        this.buffer.push(value)\n    }\n    /**\n     * Dequeue (remove) the first element from the buffer and return it\n     * @returns First element in the buffer or `null` if the buffer is empty\n     */\n    dequeue(): Type|undefined {\n        if (this.buffer.length == 0) {\n            return undefined\n        }\n        return this.buffer.shift()\n    }\n    /**\n     * Number of elements in the buffer\n     */\n    get length(): number {\n        return this.buffer.length\n    }\n    /**\n     * `true` if the buffer is empty\n     */\n    get isEmpty(): boolean {\n        return this.buffer.length == 0\n    }\n    /**\n     * Last element in the buffer or `undefined` if the buffer is empty\n     */\n    get lastElement(): Type|undefined {\n        if (this.buffer.length > 0) {\n            return this.buffer[this.buffer.length-1]\n        }\n        return undefined\n    }\n    /**\n     * `true` if the buffer is full\n     */\n    get isFull(): boolean {\n        return this.buffer.length == this.capacity\n    }\n    /**\n     * Get an element in the buffer\n     * @param index Index of the element \n     * @returns Element at the given index or `undefined` if the buffer doesn't contain an element at the given index\n     */\n    get(index: number): Type|undefined {\n        if (index < 0 || index >= this.buffer.length) {\n            return undefined\n        }\n        return this.buffer[index]\n    }\n    /**\n     * Clear the buffer\n     */\n    clear() {\n        this.buffer = []\n    }\n    /**\n     * @param fn Function to use for reducing the buffer to a single value\n     * @returns Result of applying the supplied function to each element of the array\n     */\n    reduce(fn: (previousValue: Type, currentValue: Type, currentIndex: number, array: Type[]) => Type) {\n        if (this.buffer.length == 0) {\n            return null\n        }\n        if (this.buffer.length == 1) {\n            return this.buffer[0]\n        }\n        return this.buffer.reduce(fn)\n    }\n}\n\n/**\n * Evaluates angles in relation to bearings\n * @internal\n */\nexport class AngleBearingEvaluation {\n\n    settings: LivenessDetectionSessionSettings\n    pitchThresholdTolerance: number\n    yawThresholdTolerance: number\n\n    constructor(settings: LivenessDetectionSessionSettings, pitchThresholdTolerance: number, yawThresholdTolerance: number) {\n        this.settings = settings\n        this.pitchThresholdTolerance = pitchThresholdTolerance\n        this.yawThresholdTolerance = yawThresholdTolerance\n    }\n\n    thresholdAngleForAxis(axis: Axis): number {\n        if (axis == Axis.PITCH) {\n            return this.settings.pitchThreshold\n        } else {\n            return this.settings.yawThreshold\n        }\n    }\n\n    angleForBearing(bearing: Bearing): Angle {\n        const pitchDistance: number = this.thresholdAngleForAxis(Axis.PITCH)\n        const yawDistance: number = this.thresholdAngleForAxis(Axis.YAW)\n        const angle = new Angle()\n        switch (bearing) {\n            case Bearing.UP:\n            case Bearing.LEFT_UP:\n            case Bearing.RIGHT_UP:\n                angle.pitch = 0 - pitchDistance\n                break\n            case Bearing.DOWN:\n            case Bearing.LEFT_DOWN:\n            case Bearing.RIGHT_DOWN:\n                angle.pitch = pitchDistance\n                break\n        }\n        switch (bearing) {\n            case Bearing.LEFT:\n            case Bearing.LEFT_DOWN:\n            case Bearing.LEFT_UP:\n                angle.yaw = yawDistance\n                break;\n            case Bearing.RIGHT:\n            case Bearing.RIGHT_DOWN:\n            case Bearing.RIGHT_UP:\n                angle.yaw = 0 - yawDistance\n                break\n        }\n        return angle\n    }\n\n    thresholdAngleToleranceForAxis(axis: Axis): number {\n        if (axis == Axis.PITCH) {\n            return this.pitchThresholdTolerance\n        } else {\n            return this.yawThresholdTolerance\n        }\n    }\n\n    angleMatchesBearing(angle: Angle, bearing: Bearing): boolean {\n        const minAngle: Angle = this.minAngleForBearing.call(this, bearing)\n        const maxAngle: Angle = this.maxAngleForBearing.call(this, bearing)\n        return angle.pitch > minAngle.pitch && angle.pitch < maxAngle.pitch && angle.yaw > minAngle.yaw && angle.yaw < maxAngle.yaw\n    }\n\n    isAngleBetweenBearings(angle: Angle, fromBearing: Bearing, toBearing: Bearing): boolean {\n        if (this.angleMatchesBearing(angle, fromBearing) || this.angleMatchesBearing(angle, toBearing)) {\n            return true\n        }\n        const fromAngle: Angle = this.angleForBearing(fromBearing)\n        const toAngle: Angle = this.angleForBearing(toBearing)\n        const radius: number = Math.max(this.thresholdAngleForAxis(Axis.PITCH), this.thresholdAngleForAxis(Axis.YAW))\n        const angleRad: number = Math.atan2(toAngle.pitch-fromAngle.pitch, toAngle.yaw-fromAngle.yaw) + Math.PI*0.5\n        const cosRad: number = Math.cos(angleRad) * radius\n        const sinRad: number = Math.sin(angleRad) * radius\n        const startRight: Angle = new Angle(fromAngle.yaw + cosRad, fromAngle.pitch + sinRad)\n        const startLeft: Angle = new Angle(fromAngle.yaw - cosRad, fromAngle.pitch - sinRad)\n        const endRight: Angle = new Angle(toAngle.yaw + cosRad, toAngle.pitch + sinRad)\n        const endLeft: Angle = new Angle(toAngle.yaw - cosRad, toAngle.pitch - sinRad)\n        const isNotRightOfRight = !this.isPointToRightOfPlaneBetweenPoints(angle, startRight, endRight)\n        const isLeftOfLeft = this.isPointToRightOfPlaneBetweenPoints(angle, startLeft, endLeft)\n        const isRightOfStart = this.isPointToRightOfPlaneBetweenPoints(angle, startRight, startLeft)\n        const isInsideCircle = this.isPointInsideCircleCentredInPointWithRadius(angle, fromAngle, radius)\n        return isNotRightOfRight && isLeftOfLeft && (isRightOfStart || isInsideCircle)\n    }\n\n    offsetFromAngleToBearing(angle: Angle, bearing: Bearing): Angle {\n        const result: Angle = new Angle()\n        if (!this.angleMatchesBearing(angle, bearing)) {\n            const bearingAngle: Angle = this.angleForBearing(bearing)\n            result.yaw = (bearingAngle.yaw - angle.yaw) / (this.thresholdAngleForAxis(Axis.YAW) + this.thresholdAngleToleranceForAxis(Axis.YAW))\n            result.pitch = (bearingAngle.pitch - angle.pitch) / (this.thresholdAngleForAxis(Axis.PITCH) + this.thresholdAngleToleranceForAxis(Axis.PITCH))\n        }\n        return result\n    }\n\n    private isPointToRightOfPlaneBetweenPoints(angle: Angle, start: Angle, end: Angle): boolean {\n        const d: number = (angle.yaw - start.yaw) * (end.pitch - start.pitch) - (angle.pitch - start.pitch) * (end.yaw - start.yaw)\n        return d <= 0\n    }\n\n    isPointInsideCircleCentredInPointWithRadius(angle: Angle, centre: Angle, radius: number): boolean {\n        return Math.hypot(angle.yaw-centre.yaw, angle.pitch-centre.pitch) < radius\n    }\n\n    minAngleForBearing(bearing: Bearing): Angle {\n        const pitchDistance: number = this.thresholdAngleForAxis(Axis.PITCH)\n        const pitchTolerance: number = this.thresholdAngleToleranceForAxis(Axis.PITCH)\n        const yawDistance: number = this.thresholdAngleForAxis(Axis.YAW)\n        const yawTolerance: number = this.thresholdAngleToleranceForAxis(Axis.YAW)\n        const angle: Angle = new Angle()\n        switch (bearing) {\n            case Bearing.UP:\n            case Bearing.LEFT_UP:\n            case Bearing.RIGHT_UP:\n                angle.pitch = Number.NEGATIVE_INFINITY\n                break\n            case Bearing.DOWN:\n            case Bearing.LEFT_DOWN:\n            case Bearing.RIGHT_DOWN:\n                angle.pitch = pitchDistance - pitchTolerance\n                break\n            default:\n                angle.pitch = 0 - pitchDistance + pitchTolerance\n        }\n        switch (bearing) {\n            case Bearing.LEFT:\n            case Bearing.LEFT_DOWN:\n            case Bearing.LEFT_UP:\n                angle.yaw = yawDistance - yawTolerance\n                break\n            case Bearing.RIGHT:\n            case Bearing.RIGHT_DOWN:\n            case Bearing.RIGHT_UP:\n                angle.yaw = Number.NEGATIVE_INFINITY\n                break\n            default:\n                angle.yaw = 0 - yawDistance + yawTolerance\n        }\n        return angle\n    }\n\n    maxAngleForBearing(bearing: Bearing): Angle {\n        const pitchDistance: number = this.thresholdAngleForAxis(Axis.PITCH)\n        const pitchTolerance: number = this.thresholdAngleToleranceForAxis(Axis.PITCH)\n        const yawDistance: number = this.thresholdAngleForAxis(Axis.YAW)\n        const yawTolerance: number = this.thresholdAngleToleranceForAxis(Axis.YAW)\n        const angle: Angle = new Angle()\n        switch (bearing) {\n            case Bearing.UP:\n            case Bearing.LEFT_UP:\n            case Bearing.RIGHT_UP:\n                angle.pitch = 0 - pitchDistance + pitchTolerance\n                break\n            case Bearing.DOWN:\n            case Bearing.LEFT_DOWN:\n            case Bearing.RIGHT_DOWN:\n                angle.pitch = Number.POSITIVE_INFINITY\n                break\n            default:\n                angle.pitch = pitchDistance - pitchTolerance\n        }\n        switch (bearing) {\n            case Bearing.LEFT:\n            case Bearing.LEFT_DOWN:\n            case Bearing.LEFT_UP:\n                angle.yaw = Number.POSITIVE_INFINITY\n                break\n            case Bearing.RIGHT:\n            case Bearing.RIGHT_DOWN:\n            case Bearing.RIGHT_UP:\n                angle.yaw = 0 - yawDistance + yawTolerance\n                break\n            default:\n                angle.yaw = yawDistance - yawTolerance\n        }\n        return angle\n    }\n}\n\n/**\n * @internal\n */\nexport class Smoothing {\n    buffer: CircularBuffer<number>\n    private _smoothedValue: number|undefined\n\n    constructor(bufferSize: number) {\n        this.buffer = new CircularBuffer(bufferSize)\n    }\n\n    addSample(value: number) {\n        this.buffer.enqueue(value)\n        this._smoothedValue = this.calculateSmoothedValue()\n    }\n\n    removeFirstSample(): number|undefined {\n        return this.buffer.dequeue()\n    }\n\n    get smoothedValue(): number|undefined {\n        return this._smoothedValue\n    }\n\n    private calculateSmoothedValue(): number|undefined {\n        if (this.buffer.length == 0) {\n            return undefined\n        }\n        const val: number|null = this.buffer.reduce(function(previous, next) {\n            return previous + next\n        })\n        if (val) {\n            return val / this.buffer.length\n        }\n        return undefined;\n    }\n\n    reset() {\n        this.buffer.clear()\n        this._smoothedValue = undefined\n    }\n}\n\n/**\n * @internal\n */\nexport type ObservableNextEvent<T> = {\n    type: \"next\",\n    value: T\n}\n\n/**\n * @internal\n */\nexport type ObservableErrorEvent = {\n    type: \"error\",\n    error: any\n}\n\n/**\n * @internal\n */\nexport type ObservableCompleteEvent = {\n    type: \"complete\"\n}\n\ntype ObservableEvent<T> = ObservableNextEvent<T> | ObservableErrorEvent | ObservableCompleteEvent\n\n/**\n * @internal\n */\nexport function emitRxEvent<T>(subscriber: Subscriber<T>, event: ObservableEvent<T>): void {\n    if (subscriber.closed) {\n        return\n    }\n    if (event.type == \"next\") {\n        subscriber.next((event as ObservableNextEvent<T>).value)\n    } else if (event.type == \"error\") {\n        subscriber.error((event as ObservableErrorEvent).error)\n    } else if (event.type == \"complete\") {\n        subscriber.complete()\n    }\n}\n\n/**\n * @internal\n */\nexport class RectSmoothing {\n\n    private xSmoothing: Smoothing\n    private ySmoothing: Smoothing\n    private widthSmoothing: Smoothing\n    private heightSmoothing: Smoothing\n    private _smoothedValue: Rect|undefined\n\n    constructor(bufferSize: number) {\n        this.xSmoothing = new Smoothing(bufferSize)\n        this.ySmoothing = new Smoothing(bufferSize)\n        this.widthSmoothing = new Smoothing(bufferSize)\n        this.heightSmoothing = new Smoothing(bufferSize)\n    }\n\n    addSample(value: Rect) {\n        this.xSmoothing.addSample(value.x)\n        this.ySmoothing.addSample(value.y)\n        this.widthSmoothing.addSample(value.width)\n        this.heightSmoothing.addSample(value.height)\n        this._smoothedValue = this.calculateSmoothedValue()\n    }\n\n    get smoothedValue(): Rect|undefined {\n        return this._smoothedValue\n    }\n\n    reset() {\n        this.xSmoothing.reset()\n        this.ySmoothing.reset()\n        this.widthSmoothing.reset()\n        this.heightSmoothing.reset()\n        this._smoothedValue = undefined\n    }\n\n    removeFirstSample() {\n        this.xSmoothing.removeFirstSample()\n        this.ySmoothing.removeFirstSample()\n        this.widthSmoothing.removeFirstSample()\n        this.heightSmoothing.removeFirstSample()\n    }\n    \n    private calculateSmoothedValue(): Rect|undefined {\n        if (this.xSmoothing.smoothedValue === undefined || this.ySmoothing.smoothedValue === undefined || this.widthSmoothing.smoothedValue === undefined || this.heightSmoothing.smoothedValue === undefined) {\n            return undefined\n        }\n        return new Rect(\n            this.xSmoothing.smoothedValue,\n            this.ySmoothing.smoothedValue,\n            this.widthSmoothing.smoothedValue,\n            this.heightSmoothing.smoothedValue\n        )\n    }\n}\n\n/**\n * @internal\n */\nexport class AngleSmoothing {\n    \n    private yawSmoothing: Smoothing\n    private pitchSmoothing: Smoothing\n    private _smoothedValue: Angle|undefined\n\n    constructor(bufferSize: number) {\n        this.yawSmoothing = new Smoothing(bufferSize)\n        this.pitchSmoothing = new Smoothing(bufferSize)\n        this._smoothedValue = undefined\n    }\n\n    private calculateSmoothedValue(): Angle|undefined {\n        if (this.yawSmoothing.smoothedValue === undefined) {\n            return undefined\n        }\n        return new Angle(\n            this.yawSmoothing.smoothedValue,\n            this.pitchSmoothing.smoothedValue\n        )\n    }\n\n    get smoothedValue(): Angle|undefined {\n        return this._smoothedValue\n    }\n\n    addSample(value: Angle) {\n        this.yawSmoothing.addSample(value.yaw)\n        this.pitchSmoothing.addSample(value.pitch)\n        this._smoothedValue = this.calculateSmoothedValue()\n    }\n\n    reset() {\n        this.yawSmoothing.reset()\n        this.pitchSmoothing.reset()\n        this._smoothedValue = undefined\n    }\n\n    removeFirstSample() {\n        this.yawSmoothing.removeFirstSample()\n        this.pitchSmoothing.removeFirstSample()\n    }\n}\n\n/**\n * Clamp a number so that it's between {@code 0-limit} and {@code limit}\n * @param a Number to clamp\n * @param limit Value to limit the clamped number to\n * @returns Clamped number\n * @internal\n */\nexport function clamp(a: number, limit: number): number {\n    if (a < 0-limit) {\n        return 0-limit\n    }\n    if (a > limit) {\n        return limit\n    }\n    return a\n}\n\n/**\n * \n * @param imageSource \n * @returns \n * @internal\n */\nexport async function blobFromImageSource(imageSource: ImageSource, cropRect?: Rect): Promise<Blob> {\n    if ((imageSource instanceof Blob) && !cropRect) {\n        return Promise.resolve(imageSource)\n    }\n    let canvas = await canvasFromImageSource(imageSource)\n    if (cropRect) {\n        const context = canvas.getContext(\"2d\")\n        const imageData = context!.getImageData(cropRect.x, cropRect.y, cropRect.width, cropRect.height)\n        canvas = await canvasFromImageSource(imageData)\n    }\n    return canvasToBlob(canvas)\n}\n\n/**\n * \n * @param canvas Canvas to extract the blob from\n * @returns Promise resolving to a blob containing the canvas image\n */\nexport function canvasToBlob(canvas: HTMLCanvasElement): Promise<Blob> {\n    if (!canvas) {\n        return Promise.reject(new Error(\"Invalid canvas\"))\n    }\n    return new Promise((resolve, reject) => {\n        canvas.toBlob((blob: Blob|null) => {\n            if (blob) {\n                resolve(blob)\n            } else {\n                reject(new Error(\"Failed to convert canvas to blob\"))\n            }\n        })\n    })\n}\n\n/**\n * Resize image\n * @param image Blob containing an image \n * @param maxSize The image will be scaled so that its longer side is at most maxSize\n * @returns Promise resolving to a blob containing the resized image\n * @internal\n */\nexport async function resizeImage(image: ImageData, maxSize: number): Promise<ImageData> {\n    const scale: number = Math.min(maxSize / Math.max(image.width, image.height), 1)\n    if (scale <= 1) {\n        return image\n    }\n    let canvas = document.createElement(\"canvas\")\n    canvas.width = image.width\n    canvas.height = image.height\n    let context = canvas.getContext(\"2d\")\n    context!.putImageData(image, 0, 0)\n    const blob = await canvasToBlob(canvas)\n    const imgSrc = URL.createObjectURL(blob)\n    try {\n        const width = image.width * scale\n        const height = image.height * scale\n        const img = await loadImage(imgSrc)\n        canvas = document.createElement(\"canvas\")\n        canvas.width = width\n        canvas.height = height\n        context = canvas.getContext(\"2d\")\n        context!.drawImage(img, 0, 0, width, height)\n        return context!.getImageData(0, 0, width, height)\n    } finally {\n        URL.revokeObjectURL(imgSrc)\n    }\n}\n\nexport async function cropImage(imageSource: ImageSource, cropRect?: Rect): Promise<Blob> {\n    const canvas = await canvasFromImageSource(imageSource, cropRect)\n    return canvasToBlob(canvas)\n}\n\n/**\n * \n * @param imageSource \n * @returns \n * @internal\n */\nexport async function canvasFromImageSource(imageSource: ImageSource, cropRect?: Rect): Promise<HTMLCanvasElement> {\n    if (imageSource instanceof HTMLCanvasElement) {\n        return imageSource\n    }\n    const imageSize = await sizeOfImageSource(imageSource)\n    if (!cropRect) {\n        cropRect = new Rect(0, 0, imageSize.width, imageSize.height)\n    }\n    const canvas = document.createElement(\"canvas\")\n    canvas.width = cropRect.width\n    canvas.height = cropRect.height\n    const context = canvas.getContext(\"2d\")\n    if (imageSource instanceof ImageData) {\n        context!.putImageData(imageSource, 0-cropRect.x, 0-cropRect.y)\n    } else if (imageSource instanceof HTMLImageElement || imageSource instanceof HTMLVideoElement) {\n        context!.drawImage(imageSource, 0-cropRect.x, 0-cropRect.y)\n    } else if (imageSource instanceof Blob) {\n        const src = URL.createObjectURL(imageSource)\n        try {\n            const img = await loadImage(src)\n            context!.drawImage(img, 0-cropRect.x, 0-cropRect.y)\n        } finally {\n            URL.revokeObjectURL(src)\n        }\n        return canvas\n    } else if (typeof imageSource == \"string\") {\n        const img = await loadImage(imageSource)\n        context!.drawImage(img, 0-cropRect.x, 0-cropRect.y)\n        return canvas\n    } else {\n        throw new Error(\"Invalid image source\")\n    }\n    return canvas\n}\n\n/**\n * \n * @param imageSource\n * @returns \n * @internal\n * @deprecated\n */\nexport async function imageFromImageSource(imageSource: ImageSource): Promise<HTMLImageElement> {\n    if (imageSource instanceof HTMLImageElement) {\n        return Promise.resolve(imageSource)\n    }\n    const blob = await blobFromImageSource(imageSource)\n    return new Promise((resolve, reject) => {\n        const img = document.createElement(\"img\")\n        const reader = new FileReader()\n        reader.onload = () => {\n            img.src = reader.result as string\n            resolve(img)\n        }\n        reader.onerror = () => {\n            reject(new Error(\"Failed to load image\"))\n        }\n        reader.readAsDataURL(blob)\n    })\n}\n\n/**\n * \n * @param imageSource \n * @returns \n * @internal\n */\nexport async function sizeOfImageSource(imageSource: ImageSource): Promise<Size> {\n    if (imageSource instanceof HTMLCanvasElement) {\n        return {\n            \"width\": imageSource.width,\n            \"height\": imageSource.height\n        }\n    }\n    if (imageSource instanceof ImageData) {\n        return {\n            \"width\": imageSource.width,\n            \"height\": imageSource.height\n        }\n    }\n    if (imageSource instanceof HTMLVideoElement) {\n        return {\n            \"width\": imageSource.videoWidth,\n            \"height\": imageSource.videoHeight\n        }\n    }\n    const onImageSize = (image: HTMLImageElement): Size => {\n        return {\n            \"width\": image.naturalWidth,\n            \"height\": image.naturalHeight\n        }\n    }\n    if (imageSource instanceof HTMLImageElement) {\n        await (imageSource as HTMLImageElement).decode()\n        return onImageSize(imageSource as HTMLImageElement)\n    } else if (imageSource instanceof Blob) {\n        const src = URL.createObjectURL(imageSource as Blob)\n        try {\n            const img = await loadImage(src)\n            return onImageSize(img)\n        } finally {\n            URL.revokeObjectURL(src)\n        }\n    } else if (typeof imageSource == \"string\") {\n        const img = await loadImage(imageSource)\n        return onImageSize(img)\n    } else {\n        throw new Error(\"Invalid image source\")\n    }\n}\n\nexport function loadImage(src: string, image?: HTMLImageElement): Promise<HTMLImageElement> {\n    if (!image) {\n        image = document.createElement(\"img\")\n    }\n    return new Promise((resolve, reject) => {\n        image!.onload = () => {\n            resolve(image!)\n        }\n        image!.onerror = reject\n        image!.src = src\n    })\n}","'use strict';\n\n/**\n * Ver-ID face recognition\n * @packageDocumentation\n */\n\nimport { blobFromImageSource, sizeOfImageSource } from \"./utils\"\nimport { Rect } from \"./types\";\nimport { RecognizableFace, RecognizableFaceDetectionInput, RecognizableFaceDetectionOutput, Size, ImageSource } from \"./types\"\n\n/**\n * Face recognition\n * @category Face recognition\n */\nexport class FaceRecognition {\n\n    /**\n     * Base URL of the server that accepts the face detection and comparison calls\n     */\n    readonly serviceURL: string\n\n    /**\n     * Constructor\n     * @param serviceURL Base URL of the server that accepts the face detection and comparison calls\n     */\n    constructor(serviceURL?: string) {\n        this.serviceURL = serviceURL ? serviceURL.replace(/[\\/\\s]+$/, \"\") : \"\"\n    }\n    \n    public async detectRecognizableFacesInImages(images: RecognizableFaceDetectionInput): Promise<RecognizableFaceDetectionOutput> {\n        if (Object.values(images).length == 0) {\n            return {}\n        }\n        const formData = new FormData()\n        const cropRects: {[k: string]: Rect} = {}\n        const imageSizes: {[k: string]: Size} = {}\n        await Promise.all(Object.entries(images).map(async (entry) => {\n            const imageSize = await sizeOfImageSource(entry[1].image)\n            const cropRect = this.adjustImageCropRect(imageSize, entry[1].faceRect)\n            cropRects[entry[0]] = cropRect\n            imageSizes[entry[0]] = imageSize\n            const blob = await blobFromImageSource(entry[1].image, cropRect)\n            formData.append(entry[0], blob)\n        }))\n        const response = await fetch(this.serviceURL+\"/detect_face\", {\n            \"method\": \"POST\",\n            \"mode\": \"cors\",\n            \"cache\": \"no-cache\",\n            \"body\": formData\n        })\n        if (response.status != 200) {\n            throw new Error(\"Failed to detect recognizable faces\")\n        }\n        const json: {name: string, face: RecognizableFace}[] = (await response.json()).filter((entry: {face?: RecognizableFace|null}) => entry.face != null)\n        const out: RecognizableFaceDetectionOutput = {}\n        json.forEach((entry) => {\n            const face = entry.face\n            const rect = this.faceCoordinatesToPixels(face, imageSizes[entry.name], cropRects[entry.name])\n            face.x = rect.x\n            face.y = rect.y\n            face.width = rect.width\n            face.height = rect.height\n            out[entry.name] = face\n        })\n        return out\n    }\n\n    /**\n     * Detect a face that can be used for face recognition\n     * @param image Image in which to detect the face. Can be either an Image or a base-64 encoded jpeg or data URL\n     * @param faceRect Optional expected bounds of a face in the image\n     * @returns Promise that delivers a face that can be used for face recognition\n     */\n    public async detectRecognizableFace(image: ImageSource, faceRect?: Rect): Promise<RecognizableFace> {\n        const body: Blob = await blobFromImageSource(image, faceRect)\n        const response = await fetch(this.serviceURL+\"/detect_face\", {\n            \"method\": \"POST\",\n            \"mode\": \"cors\",\n            \"cache\": \"no-cache\",\n            \"headers\": {\n                \"Content-Type\": body.type\n            },\n            \"body\": body\n        })\n        if (response.status != 200) {\n            throw new Error(\"Failed to extract recognition template from face\")\n        }\n        const json: RecognizableFace = await response.json()\n        if (!json.x || !json.y || !json.width || !json.height || !json.template) {\n            throw new Error(\"Failed to detect face in image\")\n        }\n        const imageSize = await sizeOfImageSource(image)\n        const cropRect = this.adjustImageCropRect(imageSize, faceRect)\n        const facePixelRect = this.faceCoordinatesToPixels(json, imageSize, cropRect)\n        json.x = facePixelRect.x\n        json.y = facePixelRect.y\n        json.width = facePixelRect.width\n        json.height = facePixelRect.height\n        return json\n    }\n\n    /**\n     * Detect a face that can be used for face recognition\n     * @param image Image in which to detect the face. Can be either an Image or a base-64 encoded jpeg or data URL\n     * @param faceRect Optional bounds of a face in the image\n     * @deprecated Please use {@linkcode detectRecognizableFace} instead\n     * @returns Promise that delivers a face that can be used for face recognition\n     * @internal\n     */\n    public async createRecognizableFace(image: HTMLImageElement | string, faceRect?: Rect): Promise<RecognizableFace> {\n        return this.detectRecognizableFace(image, faceRect)\n    }\n\n    private faceCoordinatesToPixels(face: RecognizableFace, imageSize: Size, cropRect: Rect): Rect {\n        const facePixelRect = {\n            x: cropRect.x + face.x / 100 * cropRect.width,\n            y: cropRect.y + face.y / 100 * cropRect.height,\n            width: face.width / 100 * cropRect.width,\n            height: face.height / 100 * cropRect.height\n        }\n        return new Rect(\n            facePixelRect.x / imageSize.width * 100,\n            facePixelRect.y / imageSize.height * 100,\n            facePixelRect.width / imageSize.width * 100,\n            facePixelRect.height / imageSize.height * 100\n        )\n    }\n\n    private adjustImageCropRect(imageSize: Size, cropRect?: Rect): Rect {\n        if (!cropRect) {\n            return new Rect(0, 0, imageSize.width, imageSize.height)\n        }\n        const adjustedCropRect: Rect = new Rect(cropRect.x, cropRect.y, cropRect.width, cropRect.height)\n        adjustedCropRect.x = Math.max(adjustedCropRect.x - adjustedCropRect.width * 0.1, 0)\n        adjustedCropRect.y = Math.max(adjustedCropRect.y - adjustedCropRect.height * 0.1, 0)\n        adjustedCropRect.width *= 1.2\n        adjustedCropRect.height *= 1.2\n        if (adjustedCropRect.x + adjustedCropRect.width > imageSize.width) {\n            adjustedCropRect.width = imageSize.width - adjustedCropRect.x\n        }\n        if (adjustedCropRect.y + adjustedCropRect.height > imageSize.height) {\n            adjustedCropRect.height = imageSize.height - adjustedCropRect.y\n        }\n        return adjustedCropRect\n    }\n\n    /**\n     * Compare face templates and return similarity score\n     * @param template1 Face template\n     * @param template2 Face template\n     * @returns Similarity score between the two templates\n     */\n    public compareFaceTemplates(template1: string, template2: string): Promise<number> {\n        if (!template1 || !template2) {\n            throw new Error(\"Missing face templates\")\n        }\n        return this.compareFaceTemplateToTemplates(template1, [template2])\n    }\n\n    public async compareFaceTemplateToTemplates(template: string, templates: string[]): Promise<number> {\n        const response: Response = await fetch(this.serviceURL+\"/compare_faces\", {\n            \"method\": \"POST\",\n            \"mode\": \"cors\",\n            \"cache\": \"no-cache\",\n            \"headers\": {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"text/plain\"\n            },\n            \"body\": JSON.stringify({target: template, faces: templates})\n        })\n        if (response.status >= 400) {\n            throw new Error(\"Face comparison failed\")\n        }\n        const score: string = await response.text()\n        return parseFloat(score)\n    }\n}","'use strict';\n\nimport { FaceCapture } from \"./types\";\nimport { LivenessDetectionSessionSettings } from \"./livenessDetectionSession\";\nimport { FaceAlignmentStatus } from \"./types\"\nimport { sizeOfImageSource } from \"./utils\"\nimport { Rect } from \"./types\";\n\n/**\n * @category Face detection\n */\nexport interface LivenessDetectionSessionUI {\n    readonly video: HTMLVideoElement\n    trigger(event: LivenessDetectionSessionEvent): void\n    on<Event extends LivenessDetectionSessionEvent>(eventType: LivenessDetectionSessionEventType, callback: (event: Event) => void): void\n}\n\n/**\n * @category Face detection\n */\nexport type LivenessDetectionSessionBaseEvent = {\n    type: LivenessDetectionSessionEventType\n}\n\n/**\n * @category Face detection\n */\nexport enum LivenessDetectionSessionEventType {\n    LOADED = \"face detection loaded\",\n    FACE_CAPTURED = \"face captured\",\n    CAPTURE_FINISHED = \"capture finished\",\n    CLOSE = \"close\",\n    CANCEL = \"cancel\"\n}\n\n/**\n * @category Face detection\n */\nexport type LivenessDetectionSessionSimpleEvent = {\n    type: LivenessDetectionSessionEventType.LOADED | LivenessDetectionSessionEventType.CLOSE | LivenessDetectionSessionEventType.CANCEL | LivenessDetectionSessionEventType.CAPTURE_FINISHED\n} & LivenessDetectionSessionBaseEvent\n\n/**\n * @category Face detection\n */\nexport type LivenessDetectionSessionFaceCapturedEvent = {\n    type: LivenessDetectionSessionEventType.FACE_CAPTURED\n    capture: FaceCapture\n} & LivenessDetectionSessionBaseEvent\n\n/**\n * @category Face detection\n */\nexport type LivenessDetectionSessionEvent = LivenessDetectionSessionFaceCapturedEvent | LivenessDetectionSessionSimpleEvent\n\n/**\n * @category Face detection\n */\nexport class VerIDLivenessDetectionSessionUI implements LivenessDetectionSessionUI {\n    \n    private cameraOverlayCanvas: HTMLCanvasElement\n    private cameraOverlayContext: CanvasRenderingContext2D\n    private videoContainer: HTMLDivElement\n    private cancelButton: HTMLAnchorElement\n    private eventListeners: {[k in LivenessDetectionSessionEventType]?: (event: LivenessDetectionSessionEvent) => void} = {}\n    private hasFaceBeenAligned = false\n    private processingIndicator: HTMLDivElement\n    private _video: HTMLVideoElement\n    readonly settings: LivenessDetectionSessionSettings\n\n    constructor(settings: LivenessDetectionSessionSettings) {\n        this.settings = settings\n\n        this.cameraOverlayCanvas = document.createElement(\"canvas\")\n        this.cameraOverlayCanvas.style.position = \"absolute\"\n        this.cameraOverlayCanvas.style.left = \"0px\"\n        this.cameraOverlayCanvas.style.top = \"0px\"\n        this.cameraOverlayContext = this.cameraOverlayCanvas.getContext(\"2d\")!\n        this.cameraOverlayCanvas.style.visibility = \"hidden\"\n\n        this.videoContainer = document.createElement(\"div\")\n        this.videoContainer.style.position = \"fixed\"\n        this.videoContainer.style.left = \"0px\"\n        this.videoContainer.style.top = \"0px\"\n        this.videoContainer.style.right = \"0px\"\n        this.videoContainer.style.bottom = \"0px\"\n        this.videoContainer.style.backgroundColor = \"black\"\n        document.body.appendChild(this.videoContainer)\n\n        this._video = document.createElement(\"video\")\n        this.video.setAttribute(\"autoplay\", \"autoplay\")\n        this.video.setAttribute(\"muted\", \"muted\")\n        this.video.setAttribute(\"playsinline\", \"playsinline\")\n        this.video.style.position = \"absolute\"\n        this.video.style.left = \"0px\"\n        this.video.style.top = \"0px\"\n        this.video.style.right = \"0px\"\n        this.video.style.bottom = \"0px\"\n        this.video.style.width = \"100%\"\n        this.video.style.height = \"100%\"\n        if (settings.useFrontCamera) {\n            this.video.style.transform = \"scaleX(-1)\"\n        }\n\n        this.cancelButton = document.createElement(\"a\")\n        this.cancelButton.href = \"javascript:void(0)\"\n        this.cancelButton.innerText = \"Cancel\"\n        this.cancelButton.style.textShadow = \"0px 1px 5px rgba(0, 0, 0, 0.5)\"\n        this.cancelButton.style.fontFamily = \"Helvetica, Arial, sans-serif\"\n        this.cancelButton.style.color = \"white\"\n        this.cancelButton.style.textDecoration = \"none\"\n        this.cancelButton.style.position = \"absolute\"\n        this.cancelButton.style.bottom = \" 16px\"\n        this.cancelButton.style.left = \"8px\"\n        this.cancelButton.style.right = \"8px\"\n        this.cancelButton.style.textAlign = \"center\"\n        this.cancelButton.onclick = () => {\n            this.trigger({\"type\": LivenessDetectionSessionEventType.CANCEL})\n        }\n\n        this.processingIndicator = document.createElement(\"div\")\n        this.processingIndicator.innerText = \"Loading face detection\"\n        this.processingIndicator.style.fontFamily = \"Helvetica, Arial, sans-serif\"\n        this.processingIndicator.style.color = \"white\"\n        this.processingIndicator.style.position = \"absolute\"\n        this.processingIndicator.style.display = \"flex\"\n        this.processingIndicator.style.alignItems = \"center\"\n        this.processingIndicator.style.textAlign = \"center\"\n        this.processingIndicator.style.height = \"100%\"\n        this.processingIndicator.style.width = \"200px\"\n        this.processingIndicator.style.margin = \"0px auto\"\n        this.processingIndicator.style.left = \"16px\"\n        this.processingIndicator.style.right = \"16px\"\n        \n        this.videoContainer.appendChild(this.video)\n        this.videoContainer.appendChild(this.cameraOverlayCanvas)\n        this.videoContainer.appendChild(this.processingIndicator)\n        this.videoContainer.appendChild(this.cancelButton)\n    }\n\n    get video() {\n        return this._video\n    }\n\n    trigger(event: LivenessDetectionSessionEvent) {\n        switch (event.type) {\n            case LivenessDetectionSessionEventType.LOADED:\n                this.processingIndicator.style.display = \"none\"\n                this.cameraOverlayCanvas.style.visibility = \"visible\"\n                break\n            case LivenessDetectionSessionEventType.FACE_CAPTURED:\n                this.drawDetectedFace(event.capture)\n                break\n            case LivenessDetectionSessionEventType.CLOSE:\n                this.processingIndicator.style.display = \"none\"\n                this.cleanup()\n                break\n            case LivenessDetectionSessionEventType.CANCEL:\n                this.processingIndicator.style.display = \"none\"\n                break\n            case LivenessDetectionSessionEventType.CAPTURE_FINISHED:\n                this.showCaptureFinished()\n                break\n        }\n        if (this.eventListeners[event.type]) {\n            this.eventListeners[event.type]!(event)\n        }\n    }\n\n    on<Event extends LivenessDetectionSessionEvent>(eventType: LivenessDetectionSessionEventType, callback: (event: Event) => void) {\n        if (callback) {\n            // @ts-ignore\n            this.eventListeners[eventType] = callback\n        } else {\n            delete this.eventListeners[eventType]\n        }\n    }\n\n    private drawDetectedFace = async (capture: FaceCapture): Promise<void> => {\n        const capturedImageSize = await sizeOfImageSource(capture.image)\n        const scale = Math.min(this.videoContainer.clientWidth / capturedImageSize.width, this.videoContainer.clientHeight / capturedImageSize.height)\n        this.cameraOverlayCanvas.width = capturedImageSize.width * scale\n        this.cameraOverlayCanvas.height = capturedImageSize.height * scale\n        this.cameraOverlayCanvas.style.left = ((this.videoContainer.clientWidth - this.cameraOverlayCanvas.width) / 2)+\"px\"\n        this.cameraOverlayCanvas.style.top = ((this.videoContainer.clientHeight - this.cameraOverlayCanvas.height) / 2)+\"px\"\n        this.cameraOverlayContext.clearRect(0, 0, this.cameraOverlayCanvas.width, this.cameraOverlayCanvas.height)\n        let ovalColor: string\n        let textColor: string\n        if (capture.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED || capture.faceAlignmentStatus == FaceAlignmentStatus.FIXED) {\n            this.hasFaceBeenAligned = true\n            ovalColor = \"green\"\n            textColor = \"white\"\n        } else {\n            ovalColor = \"white\"\n            textColor = \"black\"\n        }\n        this.cameraOverlayContext.strokeStyle = ovalColor\n        this.cameraOverlayContext.lineCap = \"round\"\n        this.cameraOverlayContext.lineJoin = \"round\"\n        let faceRect: Rect\n        let cutoutRect: Rect\n        if (capture.faceBounds) {\n            cutoutRect = capture.faceBounds.scaledBy(scale)\n            if (this.settings.useFrontCamera) {\n                cutoutRect = cutoutRect.mirrored(capturedImageSize.width * scale)\n            }\n            if (this.hasFaceBeenAligned) {\n                faceRect = cutoutRect\n            } else {\n                faceRect = this.settings.expectedFaceRect({\"width\": this.cameraOverlayCanvas.width, \"height\": this.cameraOverlayCanvas.height})\n            }\n            if (capture.offsetAngleFromBearing) {\n                const angle: number = Math.atan2(capture.offsetAngleFromBearing.pitch, capture.offsetAngleFromBearing.yaw)\n                const distance: number = Math.hypot(capture.offsetAngleFromBearing.yaw, 0 - capture.offsetAngleFromBearing.pitch) * 2 * 1.7\n                const arrowLength: number = faceRect.width / 5\n                const arrowStemLength: number = Math.min(Math.max(arrowLength * distance, arrowLength * 0.75), arrowLength * 1.7)\n                const arrowAngle: number = 40 * (Math.PI/180)\n                const arrowTipX: number = faceRect.center.x + Math.cos(angle) * arrowLength / 2\n                const arrowTipY: number = faceRect.center.y + Math.sin(angle) * arrowLength / 2\n                const arrowPoint1X: number = arrowTipX + Math.cos(angle + Math.PI - arrowAngle) * arrowLength * 0.6\n                const arrowPoint1Y: number = arrowTipY + Math.sin(angle + Math.PI - arrowAngle) * arrowLength * 0.6\n                const arrowPoint2X: number = arrowTipX + Math.cos(angle + Math.PI + arrowAngle) * arrowLength * 0.6\n                const arrowPoint2Y: number = arrowTipY + Math.sin(angle + Math.PI + arrowAngle) * arrowLength * 0.6\n                const arrowStartX: number = arrowTipX + Math.cos(angle + Math.PI) * arrowStemLength\n                const arrowStartY: number = arrowTipY + Math.sin(angle + Math.PI) * arrowStemLength\n\n                this.cameraOverlayContext.lineWidth = 0.038 * faceRect.width\n                this.cameraOverlayContext.beginPath()\n                this.cameraOverlayContext.moveTo(arrowPoint1X, arrowPoint1Y)\n                this.cameraOverlayContext.lineTo(arrowTipX, arrowTipY)\n                this.cameraOverlayContext.lineTo(arrowPoint2X, arrowPoint2Y)\n                this.cameraOverlayContext.moveTo(arrowTipX, arrowTipY)\n                this.cameraOverlayContext.lineTo(arrowStartX, arrowStartY)\n                this.cameraOverlayContext.stroke()\n            }\n        } else {\n            faceRect = cutoutRect = this.settings.expectedFaceRect({\"width\": this.cameraOverlayCanvas.width, \"height\": this.cameraOverlayCanvas.height})\n        }\n        if (!this.hasFaceBeenAligned) {\n            const cutoutPath = new Path2D()\n            cutoutPath.rect(0, 0, this.cameraOverlayCanvas.width, this.cameraOverlayCanvas.height)\n            cutoutPath.ellipse(cutoutRect.center.x, cutoutRect.center.y, cutoutRect.width / 2, cutoutRect.height / 2, 0, 0, Math.PI * 2, true)\n            this.cameraOverlayContext.beginPath()\n            this.cameraOverlayContext.fillStyle = \"#00000099\"\n            this.cameraOverlayContext.fill(cutoutPath, \"evenodd\")\n            this.cameraOverlayContext.fillStyle = \"transparent\"\n        }\n        this.cameraOverlayContext.lineWidth = 0.038 * faceRect.width\n        this.cameraOverlayContext.beginPath()\n        this.cameraOverlayContext.ellipse(faceRect.x + faceRect.width / 2, faceRect.y + faceRect.height / 2, faceRect.width /2, faceRect.height / 2, 0, 0, Math.PI * 2)\n        this.cameraOverlayContext.stroke()\n        \n        let prompt: string\n        switch (capture.faceAlignmentStatus) {\n            case FaceAlignmentStatus.FIXED:\n            case FaceAlignmentStatus.ALIGNED:\n                prompt = \"Great, hold it\"\n                break\n            case FaceAlignmentStatus.MISALIGNED:\n                prompt = \"Slowly turn to follow the arrow\"\n                break\n            default:\n                prompt = \"Align your face with the oval\"\n        }\n        const textSize = 24\n        const textY: number = Math.max(faceRect.y - this.cameraOverlayContext.lineWidth * 2, textSize)\n        this.cameraOverlayContext.font = textSize+\"px Helvetica, Arial, sans-serif\"\n        this.cameraOverlayContext.textAlign = \"center\"\n        const textWidth: number = this.cameraOverlayContext.measureText(prompt).width\n        const cornerRadius = 8\n        const textRect: Rect = new Rect(\n            this.cameraOverlayCanvas.width / 2 - textWidth / 2 - cornerRadius,\n            textY - textSize,\n            textWidth + cornerRadius * 2,\n            textSize + cornerRadius\n        )\n        this.cameraOverlayContext.beginPath()\n        this.cameraOverlayContext.moveTo(textRect.x + cornerRadius, textRect.y)\n        this.cameraOverlayContext.lineTo(textRect.x + textRect.width - cornerRadius, textRect.y)\n        this.cameraOverlayContext.quadraticCurveTo(textRect.x + textRect.width, textRect.y, textRect.x + textRect.width, textRect.y + cornerRadius)\n        this.cameraOverlayContext.lineTo(textRect.x + textRect.width, textRect.y + textRect.height - cornerRadius)\n        this.cameraOverlayContext.quadraticCurveTo(textRect.x + textRect.width, textRect.y + textRect.height, textRect.x + textRect.width - cornerRadius, textRect.y + textRect.height)\n        this.cameraOverlayContext.lineTo(textRect.x + cornerRadius, textRect.y + textRect.height)\n        this.cameraOverlayContext.quadraticCurveTo(textRect.x, textRect.y + textRect.height, textRect.x, textRect.y + textRect.height - cornerRadius)\n        this.cameraOverlayContext.lineTo(textRect.x, textRect.y + cornerRadius)\n        this.cameraOverlayContext.quadraticCurveTo(textRect.x, textRect.y, textRect.x + cornerRadius, textRect.y)\n        this.cameraOverlayContext.closePath()\n        this.cameraOverlayContext.fillStyle = ovalColor\n        this.cameraOverlayContext.fill()\n        this.cameraOverlayContext.fillStyle = textColor\n        this.cameraOverlayContext.fillText(prompt, this.cameraOverlayCanvas.width / 2, textY)\n    }\n\n    private cleanup = () => {\n        if (this.videoContainer.parentElement) {\n            this.videoContainer.parentElement.removeChild(this.videoContainer)\n        }\n        this.cancelButton.onclick = () => {}\n        this._video.onplay = () => {}\n        this._video\n    }\n\n    private showCaptureFinished = () => {\n        this.video.style.display = \"none\"\n        this.cameraOverlayCanvas.style.display = \"none\"\n        this.processingIndicator.innerText = \"Evaluating captured images\"\n        this.processingIndicator.style.display = \"flex\"\n    }\n}","'use strict';\n\nimport { Observable, from, of, throwError } from \"rxjs\"\nimport { FaceRecognition } from \"./faceRecognition\"\nimport { LivenessDetectionSessionResult } from \"./faceDetection\"\nimport { LivenessDetectionSessionEventType, LivenessDetectionSessionUI, VerIDLivenessDetectionSessionUI } from \"./faceDetectionUI\"\nimport { Face, FaceCapture, Rect, Angle, FaceExtents, Bearing, FaceAlignmentStatus, FaceRequirements, RecognizableFaceDetectionInput, RecognizableFaceDetectionOutput, Size, FaceRequirementListener, FaceCaptureCallback, RecognizableFace } from \"./types\"\nimport { AngleBearingEvaluation, AngleSmoothing, CircularBuffer, RectSmoothing } from \"./utils\"\nimport { FaceDetector } from \"./faceDetector\"\nimport { LivenessCheck } from \"./livenessCheck\"\n\n/**\n * @category Face detection\n */\nexport class LivenessDetectionSession {\n    public readonly ui: LivenessDetectionSessionUI\n    public readonly startTime: number = new Date().getTime()\n    public readonly settings: LivenessDetectionSessionSettings\n    /**\n     * @internal\n     */\n    readonly controlFaceCaptures: FaceCapture[] = []\n    public faceRecognition: FaceRecognition\n    public faceDetector!: FaceDetector\n    public faceDetectionCallback: FaceCaptureCallback|undefined\n    public faceCaptureCallback: FaceCaptureCallback|undefined\n    public livenessCheck: LivenessCheck|undefined\n    /**\n     * @internal\n     */\n    lastCaptureTime: number | null = null\n\n    private readonly faceBuffer: CircularBuffer<Face>\n    private faceAlignmentStatus: FaceAlignmentStatus = FaceAlignmentStatus.FOUND\n    private fixTime: number | null = null\n    private alignedFaceCount = 0\n    private angleHistory: Angle[] = []\n    private bearingGenerator: IterableIterator<Bearing>\n    private bearingIterator: IteratorResult<unknown, any>\n    private previousBearing: Bearing = Bearing.STRAIGHT\n    private closed = false\n    private readonly angleBearingEvaluation: AngleBearingEvaluation\n    private readonly faceBoundsSmoothing: RectSmoothing = new RectSmoothing(5)\n    private readonly faceAngleSmoothing: AngleSmoothing = new AngleSmoothing(5)\n    private hasFaceBeenAligned = false\n    // @ts-ignore\n    private mediaRecorder!: MediaRecorder\n    private videoType: string | undefined\n    private faceRequirementListeners: Set<FaceRequirementListener> = new Set<FaceRequirementListener>()\n    private imageSize!: Size\n    private pendingFaceRequirementsNotificationBearing: Bearing|null = null\n    private videoTrack!: MediaStreamTrack\n    private previousFaceAngle: Angle|null = null\n\n    public constructor(settings?: LivenessDetectionSessionSettings, faceRecognition?: FaceRecognition) {\n        if (!settings) {\n            settings = new LivenessDetectionSessionSettings()\n        }\n        this.settings = settings\n        this.ui = settings.createUI()\n        this.faceRecognition = faceRecognition || new FaceRecognition()\n        this.faceBuffer =  new CircularBuffer<Face>(settings.faceCaptureFaceCount)\n        this.angleBearingEvaluation = new AngleBearingEvaluation(settings, 5, 5)\n        this.bearingGenerator = this.nextCaptureBearing.apply(this)\n        this.bearingIterator = this.bearingGenerator.next()\n    }\n\n    public readonly registerFaceRequirementListener = (listener: FaceRequirementListener) => {\n        this.faceRequirementListeners.add(listener)\n        if (this.imageSize) {\n            listener.onChange(this.faceRequirements(this.imageSize, this.bearingIterator.value))\n        }\n    }\n\n    public readonly unregisterFaceRequirementListener = (listener: FaceRequirementListener) => {\n        this.faceRequirementListeners.delete(listener)\n    }\n\n    /**\n     * @internal\n     */\n    get requestedBearing(): Bearing {\n        return this.bearingIterator.value || Bearing.STRAIGHT\n    }\n    /**\n     * @internal\n     */\n    readonly setupVideo = async (): Promise<void> => {\n        if (!(\"mediaDevices\" in navigator)) {\n            return Promise.reject(new Error(\"Unsupported browser\"))\n        }\n\n        const constraints: MediaTrackSupportedConstraints = navigator.mediaDevices.getSupportedConstraints();\n        const getUserMediaOptions: MediaStreamConstraints = {\n            \"audio\": false,\n            \"video\": true\n        }\n        if (constraints.facingMode) {\n            getUserMediaOptions.video = {\n                \"facingMode\": this.settings.useFrontCamera ? \"user\" : \"environment\"\n            }\n        }\n        if (constraints.width) {\n            const videoHeight = 720\n            if (typeof(getUserMediaOptions.video) === \"boolean\") {\n                getUserMediaOptions.video = {\n                    \"height\": videoHeight\n                }\n            } else {\n                getUserMediaOptions.video!.height = videoHeight\n            }\n        }\n        const stream = await navigator.mediaDevices.getUserMedia(getUserMediaOptions)\n        this.videoTrack = stream.getVideoTracks()[0]\n        const videoSize: Size = {\n            width: this.videoTrack.getSettings().width!,\n            height: this.videoTrack.getSettings().height!\n        }\n        if (\"srcObject\" in this.ui.video) {\n            this.ui.video.srcObject = stream;\n        } else {\n            // @ts-ignore: Alternative API\n            this.ui.video.src = URL.createObjectURL(stream);\n        }\n        this.onVideoSize(videoSize)\n        this.onMediaStreamAvailable(stream)\n    }\n\n    /**\n     * @internal\n     */\n    readonly faceAngleMatchesRequirements = (angle: Angle, requirements: FaceRequirements): boolean => {\n        return angle.yaw >= requirements.accepted.yaw.from && angle.yaw <= requirements.accepted.yaw.to && angle.pitch >= requirements.accepted.pitch.from && angle.pitch <= requirements.accepted.pitch.to\n    }\n\n    /**\n     * @internal\n     */\n    readonly faceRequirements = (imageSize: Size, bearing: Bearing = this.bearingIterator.value): FaceRequirements => {\n        const minAngle = this.angleBearingEvaluation.minAngleForBearing(bearing)\n        const maxAngle = this.angleBearingEvaluation.maxAngleForBearing(bearing)\n        const requirements: FaceRequirements = {\n            imageSize: imageSize,\n            ideal: {\n                bounds: this.settings.expectedFaceRect(imageSize),\n                angle: this.angleBearingEvaluation.angleForBearing(bearing)\n            },\n            accepted: {\n                left: {\n                    from: Number.NEGATIVE_INFINITY,\n                    to: Number.POSITIVE_INFINITY\n                },\n                top: {\n                    from: Number.NEGATIVE_INFINITY,\n                    to: Number.POSITIVE_INFINITY\n                },\n                right: {\n                    from: Number.NEGATIVE_INFINITY,\n                    to: Number.POSITIVE_INFINITY\n                },\n                bottom: {\n                    from: Number.NEGATIVE_INFINITY,\n                    to: Number.POSITIVE_INFINITY\n                },\n                yaw: {\n                    from: minAngle.yaw,\n                    to: maxAngle.yaw\n                },\n                pitch: {\n                    from: minAngle.pitch,\n                    to: maxAngle.pitch\n                }\n            }\n        }\n        if (!this.hasFaceBeenAligned) {\n            const expectedFaceBounds = this.settings.expectedFaceRect(imageSize)\n            const maxRect: Rect = new Rect(0, 0, imageSize.width, imageSize.height)\n            const inset = expectedFaceBounds.width * 0.25\n            const minRect: Rect = new Rect(expectedFaceBounds.x + inset, expectedFaceBounds.y + inset, expectedFaceBounds.width - inset * 2, expectedFaceBounds.height - inset * 2)\n            requirements.accepted.left.from = maxRect.x\n            requirements.accepted.left.to = minRect.x\n            requirements.accepted.top.from = maxRect.y\n            requirements.accepted.top.to = minRect.y\n            requirements.accepted.right.from = minRect.right\n            requirements.accepted.right.to = maxRect.right\n            requirements.accepted.bottom.from = minRect.bottom\n            requirements.accepted.bottom.to = maxRect.bottom\n        }\n        return requirements\n    }\n\n    /**\n     * @internal\n     */\n    readonly isFaceFixedInImageSize = (actualFaceBounds: Rect, imageSize: Size): boolean => {\n        const requirements = this.faceRequirements(imageSize)\n        return actualFaceBounds.x >= requirements.accepted.left.from \n            && actualFaceBounds.x <= requirements.accepted.left.to \n            && actualFaceBounds.y >= requirements.accepted.top.from \n            && actualFaceBounds.y <= requirements.accepted.top.to\n            && actualFaceBounds.right >= requirements.accepted.right.from\n            && actualFaceBounds.right <= requirements.accepted.right.to\n            && actualFaceBounds.bottom >= requirements.accepted.bottom.from\n            && actualFaceBounds.bottom <= requirements.accepted.bottom.to;\n    }\n\n    /**\n     * @internal\n     */\n    readonly detectFacePresence = (capture: FaceCapture): FaceCapture => {\n        if (capture.face) {\n            this.faceBuffer.enqueue(capture.face)\n            this.faceBoundsSmoothing.addSample(capture.face.bounds)\n            this.faceAngleSmoothing.addSample(capture.face.angle)\n        } else if (this.alignedFaceCount > 0 && this.alignedFaceCount < this.settings.faceCaptureFaceCount) {\n            const isFaceBufferEmpty = this.faceBuffer.isEmpty\n            this.faceBuffer.dequeue()\n            if (!isFaceBufferEmpty && this.faceBuffer.isEmpty) {\n                throw new Error(\"Face lost\")\n            }\n            this.faceBoundsSmoothing.removeFirstSample()\n            this.faceAngleSmoothing.removeFirstSample()\n        }\n        capture.faceBounds = this.faceBoundsSmoothing.smoothedValue\n        capture.faceAngle = this.faceAngleSmoothing.smoothedValue\n        this.recordAngleDistanceAndTrajectory(capture)\n        return capture\n    }\n\n    /**\n     * @internal\n     */\n    readonly detectFaceAlignment = (capture: FaceCapture): FaceCapture => {\n        if (!this.faceBuffer.isEmpty) {\n            this.setFaceAlignmentFromFace(this.faceBuffer.lastElement!, capture)\n        } else {\n            this.faceAlignmentStatus = FaceAlignmentStatus.FOUND\n        }\n        capture.faceAlignmentStatus = this.faceAlignmentStatus\n        return capture\n    }\n\n    /**\n     * @internal\n     */\n    readonly detectSpoofAttempt = (capture: FaceCapture): FaceCapture => {\n        const face: Face|undefined = this.faceBuffer.lastElement\n        if (!face) {\n            this.angleHistory = []\n            return capture\n        }\n        if (capture.faceAlignmentStatus != FaceAlignmentStatus.ALIGNED) {\n            this.angleHistory.push(face.angle)\n            return capture\n        }\n        if (this.movedOpposite()) {\n            throw new Error(\"Moved opposite\")\n        }\n        this.angleHistory = []\n        return capture\n    }\n\n    /**\n     * @internal\n     */\n    readonly createFaceCapture = (capture: FaceCapture): Observable<FaceCapture> => {\n        if (capture.requestedBearing == Bearing.STRAIGHT && (!capture.face || !capture.face.template)) {\n            const bounds: Rect|undefined = capture.face ? capture.face.bounds : undefined\n            return from(this.faceRecognition.detectRecognizableFace(capture.image, bounds).then((recognizableFace: RecognizableFace) => {\n                if (capture.face) {\n                    capture.face.template = recognizableFace.template\n                }\n                return capture\n            }))\n        } else {\n            return of(capture)\n        }\n    }\n\n    /**\n     * @internal\n     */\n    readonly checkLiveness = (result: LivenessDetectionSessionResult): Observable<LivenessDetectionSessionResult> => {\n        if (!this.livenessCheck) {\n            return of(result)\n        }\n        const capture = result.faceCaptures.find(capture => capture.requestedBearing == Bearing.STRAIGHT)\n        if (!capture) {\n            return throwError(() => new Error(\"Failed to extract face capture\"))\n        }\n        return from(this.livenessCheck.checkLiveness(capture.image).then(score => {\n            result.livenessScore = score\n            if (score < 0.5) {\n                throw new Error(\"Liveness check failed (score \"+score.toFixed(2)+\")\")\n            }\n            return result\n        }))\n    }\n\n    /**\n     * @internal\n     */\n    readonly resultFromCaptures = (captures: FaceCapture[]): Observable<LivenessDetectionSessionResult> => {\n        let promise: Promise<any> = Promise.resolve()\n        if (this.controlFaceCaptures.length > 0) {\n            const faceDetectionInput: RecognizableFaceDetectionInput = {}\n            try {\n                let i = 1\n                this.controlFaceCaptures.forEach(capture => {\n                    faceDetectionInput[\"image_\"+(i++)] = {image: capture.image, faceRect: capture.face?.bounds}\n                })\n            } catch (error) {\n                return throwError(() => error)\n            }\n            promise = this.faceRecognition.detectRecognizableFacesInImages(faceDetectionInput).then((response: RecognizableFaceDetectionOutput) => {\n                if (Object.values(response).length == 0) {\n                    return this.settings.controlFaceSimilarityThreshold\n                }\n                if (captures.filter(capture => capture.face && capture.face.template && capture.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED).length == 0) {\n                    return this.settings.controlFaceSimilarityThreshold\n                }\n                return this.compareControlFacesToCaptureFaces(response, captures)\n            }).then((score: number) => {\n                if (score < this.settings.controlFaceSimilarityThreshold) {\n                    throw new Error(\"Detected possible spoof attempt\")\n                }\n            })\n        }\n        captures.sort((a: FaceCapture, b: FaceCapture) => {\n            return a.time - b.time\n        })\n        if (this.settings.recordSessionVideo && this.mediaRecorder) {\n            promise = promise.then(() => this.getVideoURL()).then(videoURL => new LivenessDetectionSessionResult(new Date(this.startTime), captures, videoURL))\n        } else {\n            promise = promise.then(() => new LivenessDetectionSessionResult(new Date(this.startTime), captures))\n        }\n        return from(promise)\n    }\n\n    /**\n     * @internal\n     */\n    readonly onVideoSize = (videoSize: Size) => {\n        this.imageSize = videoSize\n        if (this.pendingFaceRequirementsNotificationBearing !== null) {\n            const bearing = this.pendingFaceRequirementsNotificationBearing\n            this.pendingFaceRequirementsNotificationBearing = null\n            this.notifyFaceRequirementListeners(bearing)\n        }\n    }\n\n    /**\n     * @internal\n     */\n    readonly onMediaStreamAvailable = (stream: MediaStream) => {        \n        if (!this.settings.recordSessionVideo || !(\"MediaRecorder\" in window)) {\n            return\n        }\n        const videoTypes = [\"video/mp4\", \"video/mpeg\"]\n        for (let videoType of videoTypes) {\n            // @ts-ignore\n            if (MediaRecorder.isTypeSupported(videoType)) {\n                this.videoType = videoType\n                break\n            }\n        }\n        if (!this.videoType) {\n            return\n        }\n        // @ts-ignore\n        this.mediaRecorder = new MediaRecorder(stream)\n        this.mediaRecorder.start()\n    }\n\n    public readonly close = () => {\n        if (!this.closed) {\n            this.closed = true\n            this.cleanup()\n            requestAnimationFrame(() => {\n                this.ui.trigger({\"type\":LivenessDetectionSessionEventType.CLOSE})\n            })\n        }\n    }\n\n    public get isClosed(): boolean {\n        return this.closed\n    }\n\n    protected cleanup = (): void => {\n        if (this.videoTrack) {\n            this.videoTrack.stop()\n        }\n        this.faceAlignmentStatus = FaceAlignmentStatus.FOUND\n        // this.faces.clear()\n        this.faceBuffer.clear()\n        this.angleHistory = []\n        this.alignedFaceCount = 0\n        this.fixTime = null\n        this.hasFaceBeenAligned = false\n        this.previousBearing = Bearing.STRAIGHT\n        this.previousFaceAngle = null\n        this.bearingGenerator = this.nextCaptureBearing()\n        this.bearingIterator = this.bearingGenerator.next()\n    }\n\n    protected selectNextBearing = (availableBearings: Bearing[]): Bearing => {\n        return availableBearings[Math.floor(Math.random()*availableBearings.length)]\n    }\n\n    private getVideoURL = (): Promise<string> => {\n        if (!this.settings.recordSessionVideo || !(\"MediaRecorder\" in window) || !this.mediaRecorder) {\n            return Promise.reject(new Error(\"Video recording disabled or unavailable\"))\n        }\n        return new Promise((resolve, reject) => {\n            this.mediaRecorder.ondataavailable = (event: any) => {\n                const blob = new Blob([event.data], {\n                    type: this.videoType\n                })\n                const fileReader: FileReader = new FileReader()\n                fileReader.onloadend = () => {\n                    resolve(fileReader.result as string)\n                }\n                fileReader.onerror = () => {\n                    reject(new Error(\"Failed to read video\"))\n                }\n                fileReader.readAsDataURL(blob)\n            }\n            this.mediaRecorder.onerror = () => {\n                reject(new Error(\"Failed to record video\"))\n            }\n            this.mediaRecorder.stop()\n        })\n    }\n\n    private async compareControlFacesToCaptureFaces(controlFaces: RecognizableFaceDetectionOutput, captures: FaceCapture[]): Promise<number> {\n        const captureTemplates: string[] = captures.filter(capture => capture.face && capture.face.template && capture.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED).map(capture => capture.face?.template).filter(val => val !== undefined) as string[]\n        const controlTemplates: string[] = Object.values(controlFaces).map(face => face.template)\n        const scores = await Promise.all(captureTemplates.map(template => this.faceRecognition.compareFaceTemplateToTemplates(template, controlTemplates)))\n        if (scores.length == 0) {\n            return 0\n        }\n        if (scores.length == 1) {\n            return scores[0]\n        }\n        return scores.reduce((previous, current) => Math.min(previous, current))\n    }\n\n    // private movedTooFast = (): boolean => {\n    //     if (this.previousBearing != this.bearingIterator.value) {\n    //         const previousAngle: Angle = this.angleBearingEvaluation.angleForBearing(this.previousBearing)\n    //         const currentAngle: Angle = this.angleBearingEvaluation.angleForBearing(this.bearingIterator.value)\n    //         const startYaw: number = Math.min(previousAngle.yaw, currentAngle.yaw)\n    //         const endYaw: number = Math.max(previousAngle.yaw, currentAngle.yaw)\n    //         const yawTolerance: number = this.angleBearingEvaluation.thresholdAngleToleranceForAxis(Axis.YAW)\n    //         let movedTooFast: boolean = this.angleHistory.length > 1\n    //         for (const angle of this.angleHistory) {\n    //             if (angle.yaw > startYaw - yawTolerance && angle.yaw < endYaw + yawTolerance) {\n    //                 movedTooFast = false\n    //             }\n    //         }\n    //         return movedTooFast\n    //     }\n    //     return false\n    // }\n\n    private movedOpposite = (): boolean => {\n        if (this.previousBearing != this.bearingIterator.value) {\n            for (const angle of this.angleHistory) {\n                if (!this.angleBearingEvaluation.isAngleBetweenBearings(angle, this.previousBearing, this.bearingIterator.value)) {\n                    return true\n                }\n            }\n        }\n        return false\n    }\n\n    private areAllBufferedFacesAligned = (capture: FaceCapture): boolean => {\n        for (let i=0; i<this.faceBuffer.length; i++) {\n            const f: Face|undefined = this.faceBuffer.get(i)\n            if (!f)  {\n                return false\n            }\n            if (!this.faceAngleMatchesRequirements(f.angle, this.faceRequirements(capture.imageSize))) {\n                return false\n            }\n        }\n        return true\n    }\n\n    private setFaceAlignmentFromFace = (face: Face, capture: FaceCapture): void => {\n        const now: number = new Date().getTime()/1000\n        if (this.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED) {\n            this.faceAlignmentStatus = FaceAlignmentStatus.FIXED\n            this.fixTime = now\n        }\n        // this.faces.enqueue(face)\n        if (this.faceAlignmentStatus == FaceAlignmentStatus.FOUND && this.isFaceFixedInImageSize(face.bounds, capture.imageSize)) {\n            this.fixTime = now\n            this.faceAlignmentStatus = FaceAlignmentStatus.FIXED\n        } else if (this.fixTime && now - this.fixTime > this.settings.pauseDuration && this.faceBuffer.isFull) {\n            if (!this.areAllBufferedFacesAligned(capture)) {\n                this.faceAlignmentStatus = FaceAlignmentStatus.MISALIGNED\n                capture.offsetAngleFromBearing = this.angleBearingEvaluation.offsetFromAngleToBearing(capture.faceAngle ? capture.faceAngle : new Angle(), this.bearingIterator.value)\n            } else {\n                // this.faces.clear()\n                this.faceBuffer.clear()\n                this.faceAlignmentStatus = FaceAlignmentStatus.ALIGNED\n                this.fixTime = now\n                this.alignedFaceCount += 1\n                this.previousBearing = this.bearingIterator.value\n                this.bearingIterator = this.bearingGenerator.next()\n            }\n        }\n    }\n\n    // private hasFaceMovedTooFar = (faceAngle: Angle, faceBounds: Rect, imageSize: Size): boolean => {\n    //     const requestedAngle: number = this.angleBearingEvaluation.angleForBearing(this.bearingIterator.value).screenAngle\n    //     const detectedAngle: number = faceAngle.screenAngle\n    //     const deg45: number = 45 * (Math.PI/180)\n    //     const inset: number = 0 - Math.min(imageSize.width, imageSize.height) * 0.05\n    //     const rect: Rect = new Rect(0, 0, imageSize.width, imageSize.height)\n    //     rect.inset(inset, inset)\n    //     return rect.contains(faceBounds) && detectedAngle > requestedAngle - deg45 && detectedAngle < requestedAngle + deg45\n    // }\n\n    private recordAngleDistanceAndTrajectory = (capture: FaceCapture): void => {\n        capture.angleTrajectory = undefined\n        capture.angleDistance = 0\n        if (capture.faceAngle) {\n            if (this.previousFaceAngle) {\n                const target = this.angleBearingEvaluation.angleForBearing(this.bearingIterator.value)\n                const previousToTarget = Math.atan2(this.previousFaceAngle.pitch-target.pitch, this.previousFaceAngle.yaw-target.yaw)\n                const previousToCurrent = Math.atan2(this.previousFaceAngle.pitch-capture.faceAngle.pitch, this.previousFaceAngle.yaw-capture.faceAngle.yaw)\n                const previousBearingAngle = this.angleBearingEvaluation.angleForBearing(this.previousBearing)\n                const requestedBearingAngle = this.angleBearingEvaluation.angleForBearing(this.bearingIterator.value)\n                const angleDistance = Math.hypot(requestedBearingAngle.pitch-previousBearingAngle.pitch, requestedBearingAngle.yaw-previousBearingAngle.yaw)\n                if (angleDistance != 0) {\n                    const faceAngleDistance = Math.hypot(requestedBearingAngle.pitch-capture.faceAngle.pitch, requestedBearingAngle.yaw-capture.faceAngle.yaw)                    \n                    capture.angleDistance = Math.min(faceAngleDistance / angleDistance, 1)\n                }\n                capture.angleTrajectory = 1 - Math.abs((previousToTarget - previousToCurrent) / Math.PI)\n            }\n            this.previousFaceAngle = capture.faceAngle\n        } else {\n            this.previousFaceAngle = null;\n        }\n    }\n\n    private *nextCaptureBearing(): IterableIterator<Bearing> {\n        let nextBearing: Bearing = Bearing.STRAIGHT\n        this.notifyFaceRequirementListeners(nextBearing)\n        yield nextBearing\n        for (let i=1; i<this.settings.faceCaptureCount; i++) {\n            let availableBearings = this.settings.bearings.filter((bearing: Bearing) => bearing != nextBearing && this.angleBearingEvaluation.angleForBearing(bearing).yaw != this.angleBearingEvaluation.angleForBearing(nextBearing).yaw)\n            if (availableBearings.length == 0) {\n                availableBearings = this.settings.bearings.filter((bearing: Bearing) => bearing != nextBearing)\n            }\n            if (availableBearings.length > 0) {\n                nextBearing = this.selectNextBearing(availableBearings)\n            }\n            this.notifyFaceRequirementListeners(nextBearing)\n            if (i < this.settings.faceCaptureCount - 1) {\n                yield nextBearing\n            } else {\n                return nextBearing\n            }\n        }\n    }\n\n    private notifyFaceRequirementListeners = (bearing: Bearing) => {\n        if (!this.imageSize) {\n            this.pendingFaceRequirementsNotificationBearing = bearing\n            return\n        }\n        for (const listener of this.faceRequirementListeners) {\n            listener.onChange(this.faceRequirements(this.imageSize, bearing))\n        }\n    }\n}\n\n/**\n * @category Face detection testing\n */\nexport class MockLivenessDetectionSession extends LivenessDetectionSession {\n\n    readonly setupVideo = (): Promise<void> => {\n        const videoURL = \"/images/camera_placeholder.mp4\"\n        return new Promise((resolve, reject) => {\n            this.ui.video.onloadedmetadata = () => {\n                const videoSize = {\n                    width: this.ui.video.videoWidth,\n                    height: this.ui.video.videoHeight\n                }\n                this.onVideoSize(videoSize)\n            }\n            this.ui.video.oncanplaythrough = () => {\n                this.ui.video.play().then(resolve).catch(reject)\n            }\n            this.ui.video.onerror = () => {\n                reject(new Error(\"Failed to load video from \"+videoURL))\n            }\n            fetch(videoURL).then(response => {\n                if (!response.ok) {\n                    throw new Error(\"Received status \"+response.status+\" when fetching video\")\n                }\n                return response.blob()\n            }).then(videoBlob => {\n                if (\"srcObject\" in this.ui.video) {\n                    this.ui.video.srcObject = videoBlob;\n                } else {\n                    // @ts-ignore: Alternative API\n                    this.ui.video.src = URL.createObjectURL(videoBlob);\n                }\n                resolve()\n            }).catch(reject)\n        })\n    }\n}\n\n/**\n * Liveness detection session settings\n * @category Face detection\n */\n\nexport class LivenessDetectionSessionSettings {\n    /**\n     * Whether to use the device's front-facing (selfie) camera\n     * @defaultValue `true`\n     */\n    useFrontCamera = true;\n    /**\n     * How many face captures should be collected in a session\n     * @defaultValue `2`\n     */\n    faceCaptureCount = 2;\n    /**\n     * Maximum session duration (seconds)\n     * @defaultValue `30`\n     */\n    maxDuration = 30;\n    /**\n     * Horizontal (yaw) threshold where face is considered to be at an angle\n     *\n     * For example, a value of 15 indicates that a face with yaw -15 and below is oriented left and a face with yaw 15 or above is oriented right\n     * @defaultValue `28`\n     */\n    yawThreshold = 28;\n    /**\n     * Vertical (pitch) threshold where face is considered to be at an angle\n     *\n     * For example, a value of 15 indicates that a face with pitch -15 and below is oriented up and a face with pitch 15 or above is oriented down\n     * @defaultValue `10`\n     */\n    pitchThreshold = 10;\n    /**\n     * Number of faces to collect per face capture\n     * @defaultValue `2`\n     */\n    faceCaptureFaceCount = 3;\n    /**\n     * When the face is fixed the face detection will pause to allow enough time for the user to read the on-screen instructions\n     *\n     * Decreasing the pause time will shorten the session but may lead to a frustrating user experience if the user isn't allowed enough time to read the prompts\n     * @defaultValue `0.5`\n     */\n    pauseDuration = 0.5;\n    /**\n     * Where a face is expected in relation to the camera frame\n     * @defaultValue `FaceExtents(0.65, 0.85)`\n     */\n    expectedFaceExtents: FaceExtents = new FaceExtents(0.65, 0.85);\n    /**\n     * Bearings the user may be asked to assume during the session\n     *\n     * Note that the user will unlikely be asked to assume all the bearings in the set. The array is simply a pool from which the session will draw a random member.\n     * @defaultValue `[Bearing.STRAIGHT, Bearing.LEFT, Bearing.RIGHT, Bearing.LEFT_UP, Bearing.RIGHT_UP]`\n     */\n    bearings = [Bearing.STRAIGHT, Bearing.LEFT, Bearing.RIGHT, Bearing.LEFT_UP, Bearing.RIGHT_UP];\n\n    /**\n     * Set to `true` to record a video of the session\n     *\n     * Note that some older browsers may not be capable of recording video\n     * @defaultValue `false`\n     */\n    recordSessionVideo = false;\n\n    /**\n     * Background: Once the initial aligned face is detected the session will start capturing \"control\" faces at interval set in the `controlFaceCaptureInterval` property until `maxControlFaceCount` faces are collected or the session finishes.\n     * These control faces are then compared to the aligned face to ensure that the person performing the liveness detection is the same person as the one on the aligned face.\n     * This prevents attacks where a picture is presented to the camera and a live person finishes the liveness detection.\n     * @defaultValue `3.7`\n     */\n    controlFaceSimilarityThreshold = 3.7;\n\n    /**\n     * Interval at which to capture \"control\" faces.\n     * See `controlFaceSimilarityThreshold` for an explanation.\n     * @defaultValue `500`\n     */\n    controlFaceCaptureInterval = 500;\n\n    /**\n     * Number of \"control\" faces to capture during a session.\n     * See `controlFaceSimilarityThreshold` for an explanation.\n     * @defaultValue `4`\n     */\n    maxControlFaceCount = 4;\n\n    /**\n     * Set your own function if you wish to supply your own graphical user interface for the session.\n     * @returns Function that supplies an instance of `FaceCaptureUI`\n     */\n    createUI: () => LivenessDetectionSessionUI = () => new VerIDLivenessDetectionSessionUI(this);\n\n    /**\n     * @param imageSize Image size\n     * @returns Boundary of where the session expects a face in a given image size.\n     */\n    readonly expectedFaceRect = (imageSize: Size): Rect => {\n        const faceRect = new Rect(0, 0, 0, 0);\n        if (imageSize.width > imageSize.height) {\n            faceRect.height = imageSize.height * this.expectedFaceExtents.proportionOfViewHeight;\n            faceRect.width = faceRect.height / 1.25;\n        } else {\n            faceRect.width = imageSize.width * this.expectedFaceExtents.proportionOfViewWidth;\n            faceRect.height = faceRect.width * 1.25;\n        }\n        faceRect.x = imageSize.width / 2 - faceRect.width / 2;\n        faceRect.y = imageSize.height / 2 - faceRect.height / 2;\n        return faceRect;\n    };\n\n    /**\n     * Minimum face detection speed in frames per second.\n     * If the device cannot detect faces fast enough the session will fail with an error.\n     * @defaultValue `3.5`\n     */\n    minFPS = 3.5;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nvar t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};function e(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,s)}u((r=r.apply(t,e||[])).next())}))}function r(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var o=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn(\"Platform \"+this.platformName+\" has already been set. Overwriting the platform with \"+e+\".\"),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn(\"Setting feature override from URL \"+t+\": \"+r+\".\"),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,\"features\",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error(\"Cannot set flag \"+t+\" as it has not been registered.\");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error(\"Cannot evaluate flag '\"+t+\"': no evaluation function found.\");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n,r=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return a(n,e[0],e[1]),e.join(\"=\")})),n);if(\"tfjsflags\"in r)r.tfjsflags.split(\",\").forEach((function(e){var n=e.split(\":\"),r=n[0],o=n[1];t.urlFlags[r]=function(t,e){if(\"true\"===(e=e.toLowerCase())||\"false\"===e)return\"true\"===e;if(\"\"+ +e===e)return+e;throw new Error(\"Could not parse value flag value \"+e+\" for flag \"+t+\".\")}(r,o)}))}},t}();function a(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||\"\")}function i(){return s}var s=null;var u=new Map,c=new Map;function l(t,e){var n=g(t,e);return u.get(n)}function h(t){return c.get(t)}function f(t){for(var e=u.entries(),n=[];;){var r=e.next(),o=r.done,a=r.value;if(o)break;var i=a[0],s=a[1];i.split(\"_\")[0]===t&&n.push(s)}return n}function d(t){var e=t.kernelName,n=t.backendName,r=g(e,n);if(u.has(r))throw new Error(\"The kernel '\"+e+\"' for backend '\"+n+\"' is already registered\");u.set(r,t)}function p(t){var e=t.kernelName;c.has(e)&&console.warn(\"Overriding the gradient for '\"+e+\"'\"),c.set(e,t)}function v(t,e){var n=g(t,e);if(!u.has(n))throw new Error(\"The kernel '\"+t+\"' for backend '\"+e+\"' is not registered\");u.delete(n)}function m(t){if(!c.has(t))throw new Error(\"The gradient '\"+t+\"' for backend is not registered\");c.delete(t)}function g(t,e){return e+\"_\"+t}function y(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function x(t,e,n){return Math.max(t,Math.min(e,n))}function b(t){return t%2==0?t:t+1}function w(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function C(t,e){if(!t)throw new Error(\"string\"==typeof e?e:e())}function E(t,e,n){void 0===n&&(n=\"\"),C(S(t,e),(function(){return n+\" Shapes \"+t+\" and \"+e+\" must match\"}))}function R(t){C(null!=t,(function(){return\"The input to the tensor constructor must be a non-null value.\"}))}function I(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||V(t)&&!n)for(var r=0;r<t.length;++r)I(t[r],e,n);else e.push(t);return e}function k(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function S(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function A(t){return t%1==0}function D(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function T(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function N(t,e){return e<=t.length?t:t+\" \".repeat(e-t.length)}function F(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,o){var a=0,i=function(){if(t())r();else{a++;var s=e(a);null!=n&&a>=n?o():setTimeout(i,s)}};i()}))}function _(t,e){for(var n=1,r=-1,o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(-1===t[o]){if(-1!==r)throw Error(\"Shapes can only have 1 implicit size. Found -1 at dim \"+r+\" and dim \"+o);r=o}else if(t[o]<0)throw Error(\"Shapes can not be < 0. Found \"+t[o]+\" at dim \"+o);if(-1===r){if(e>0&&e!==n)throw Error(\"Size(\"+e+\") must match the product of shape \"+t);return t}if(0===n)throw Error(\"Cannot infer the missing size in [\"+t+\"] when there are 0 elements\");if(e%n!=0)throw Error(\"The implicit shape can't be a fractional number. Got \"+e+\" / \"+n);var a=t.slice();return a[r]=e/n,a}function O(t,e){var n=e.length;return C((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return\"All values in axis param must be in range [-\"+n+\", \"+n+\") but got axis \"+t})),C(t.every((function(t){return A(t)})),(function(){return\"All values in axis param must be integers but got axis \"+t})),t.map((function(t){return t<0?n+t:t}))}function M(t,e){for(var n=[],r=[],o=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||o?null:O(e,t).sort(),i=0,s=0;s<t.length;++s){if(null!=a){if(a[i]===s&&1!==t[s])throw new Error(\"Can't squeeze axis \"+s+\" since its dim '\"+t[s]+\"' is not 1\");(null==a[i]||a[i]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[i]<=s&&i++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function B(t,e){var n=null;if(null==t||\"float32\"===t)n=new Float32Array(e);else if(\"int32\"===t)n=new Int32Array(e);else{if(\"bool\"!==t)throw new Error(\"Unknown data type \"+t);n=new Uint8Array(e)}return n}function P(t,e){var n=null;if(null==t||\"float32\"===t)n=new Float32Array(e);else if(\"int32\"===t)n=new Int32Array(e);else if(\"bool\"===t)n=new Uint8Array(e);else{if(\"string\"!==t)throw new Error(\"Unknown data type \"+t);n=new Array(e)}return n}function L(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error(\"A tensor of type \"+e+\" being uploaded contains \"+r+\".\")}}function W(t){return\"bool\"===t||\"complex64\"===t||\"float32\"===t||\"int32\"===t||\"string\"===t}function U(t,e){return\"complex64\"!==e&&((\"float32\"!==e||\"complex64\"===t)&&((\"int32\"!==e||\"float32\"===t||\"complex64\"===t)&&(\"bool\"!==e||\"bool\"!==t)))}function V(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function z(t){if(\"float32\"===t||\"int32\"===t)return 4;if(\"complex64\"===t)return 8;if(\"bool\"===t)return 1;throw new Error(\"Unknown dtype \"+t)}function G(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function H(t){return\"string\"==typeof t||t instanceof String}function q(t){return\"boolean\"==typeof t}function K(t){return\"number\"==typeof t}function j(t){return Array.isArray(t)?j(t[0]):t instanceof Float32Array?\"float32\":t instanceof Int32Array||t instanceof Uint8Array?\"int32\":K(t)?\"float32\":H(t)?\"string\":q(t)?\"bool\":\"float32\"}function X(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Y(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function $(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Q(t,e,n){if(\"string\"===e)throw new Error(\"Cannot convert a string[] to a TypedArray\");if(Array.isArray(t)&&(t=I(t)),n&&L(t,e),function(t,e){return t instanceof Float32Array&&\"float32\"===e||t instanceof Int32Array&&\"int32\"===e||t instanceof Uint8Array&&\"bool\"===e}(t,e))return t;if(null==e||\"float32\"===e||\"complex64\"===e)return new Float32Array(t);if(\"int32\"===e)return new Int32Array(t);if(\"bool\"===e){for(var r=new Uint8Array(t.length),o=0;o<r.length;++o)0!==Math.round(t[o])&&(r[o]=1);return r}throw new Error(\"Unknown data type \"+e)}function J(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error(\"[\"+t+\"] does not match the input size.\");return function t(e,n,r){var o=new Array;if(1===n.length)for(var a=n[0],i=0;i<a;i++)o[i]=r[e+i];else{a=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(i=0;i<a;i++)o[i]=t(e+i*u,s,r)}return o}(0,t,e)}function Z(t,e){for(var n=tt(t,e),r=0;r<n.length;r++)n[r]=1;return n}function tt(t,e){if(null==e||\"float32\"===e||\"complex64\"===e)return new Float32Array(t);if(\"int32\"===e)return new Int32Array(t);if(\"bool\"===e)return new Uint8Array(t);throw new Error(\"Unknown data type \"+e)}function et(){return i().platform.now()}function nt(t){t.forEach((function(e){C(Number.isInteger(e)&&e>=0,(function(){return\"Tensor must have a shape comprised of positive integers but got shape [\"+t+\"].\"}))}))}function rt(t,e){return void 0===e&&(e=\"utf-8\"),e=e||\"utf-8\",i().platform.encode(t,e)}function ot(t,e){return void 0===e&&(e=\"utf-8\"),e=e||\"utf-8\",i().platform.decode(t,e)}function at(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function it(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}var st=Object.freeze({shuffle:y,clamp:x,nearestLargerEven:b,sum:w,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var o=Number(t[r])-Number(e[r]);n+=o*o}return n},assert:C,assertShapesMatch:E,assertNonNull:R,flatten:I,sizeFromShape:k,isScalarShape:function(t){return 0===t.length},arraysEqual:S,isInt:A,tanh:D,sizeToSquarishShape:T,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return y(e),e},rightPad:N,repeatedTry:F,inferFromImplicitShape:_,parseAxisParam:O,squeezeShape:M,getTypedArrayFromDType:B,getArrayFromDType:P,checkConversionForErrors:L,isValidDtype:W,hasEncodingLoss:U,isTypedArray:V,bytesPerElement:z,bytesFromStringArray:G,isString:H,isBoolean:q,isNumber:K,inferDtype:j,isFunction:X,nearestDivisor:Y,computeStrides:$,toTypedArray:Q,toNestedArray:J,makeOnesTypedArray:Z,makeZerosTypedArray:tt,now:et,assertNonNegativeIntegerDimensions:nt,fetch:function(t,e){return i().platform.fetch(t,e)},encodeString:rt,decodeString:ot,locToIndex:at,indexToLoc:it}),ut=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new ct)}return t.prototype.profileKernel=function(t,e,n){var r,o=this,a=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if(\"float32\"!==e)return!1;for(var r=0;r<t.length;r++){var o=t[r];if(isNaN(o)||!isFinite(o))return console.warn(\"Found \"+o+\" in the result of '\"+n+\"'\"),!0}}(r,n.dtype,t),a.then((function(a){var i=\"\";null!=a.getExtraProfileInfo&&(i=a.getExtraProfileInfo()),o.logger.logKernelProfile(t,n,r,a.kernelMs,e,i)}))}))})),r},t}();var ct=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,o,a){var i=\"number\"==typeof r?N(r+\"ms\",9):r.error,s=N(t,25),u=e.rank,c=e.size,l=N(e.shape.toString(),14),h=\"\";for(var f in o){var d=o[f].shape||e.shape,p=d.length;h+=f+\": \"+p+\"D \"+(p>0?d:\"\")+\" \"}console.log(\"%c\"+s+\"\\t%c\"+i+\"\\t%c\"+u+\"D \"+l+\"\\t%c\"+c+\"\\t%c\"+h+\"\\t%c\"+a,\"font-weight:bold\",\"color:red\",\"color:blue\",\"color: orange\",\"color: green\",\"color: steelblue\")},t}();var lt=20,ht=3,ft=7;function dt(t,e,n,r){var o=$(e),a=function(t,e,n,r){var o=k(e),a=r[r.length-1],i=new Array(a).fill(0),s=e.length,u=\"complex64\"===n?mt(t):t;if(s>1)for(var c=0;c<o/a;c++)for(var l=c*a,h=0;h<a;h++)i[h]=Math.max(i[h],pt(u[l+h],0,n).length);return i}(t,e,n,o),i=e.length,s=function t(e,n,r,o,a,i){void 0===i&&(i=!0);var s=\"complex64\"===r?2:1,u=n[0],c=n.length;if(0===c){return\"complex64\"===r?[pt(mt(e)[0],0,r)]:\"bool\"===r?[vt(e[0])]:[e[0].toString()]}if(1===c){if(u>lt){var l=ht*s,h=Array.from(e.slice(0,l)),f=Array.from(e.slice((u-ht)*s,u*s));return\"complex64\"===r&&(h=mt(h),f=mt(f)),[\"[\"+h.map((function(t,e){return pt(t,a[e],r)})).join(\", \")+\", ..., \"+f.map((function(t,e){return pt(t,a[u-ht+e],r)})).join(\", \")+\"]\"]}return[\"[\"+(\"complex64\"===r?mt(e):Array.from(e)).map((function(t,e){return pt(t,a[e],r)})).join(\", \")+\"]\"]}var d=n.slice(1),p=o.slice(1),v=o[0]*s,m=[];if(u>lt){for(var g=0;g<ht;g++){var y=(x=g*v)+v;m.push.apply(m,t(e.slice(x,y),d,r,p,a,!1))}m.push(\"...\");for(g=u-ht;g<u;g++){y=(x=g*v)+v;m.push.apply(m,t(e.slice(x,y),d,r,p,a,g===u-1))}}else for(g=0;g<u;g++){var x;y=(x=g*v)+v;m.push.apply(m,t(e.slice(x,y),d,r,p,a,g===u-1))}var b=2===c?\",\":\"\";m[0]=\"[\"+m[0]+b;for(g=1;g<m.length-1;g++)m[g]=\" \"+m[g]+b;var w=\",\\n\";for(g=2;g<c;g++)w+=\"\\n\";return m[m.length-1]=\" \"+m[m.length-1]+\"]\"+(i?\"\":w),m}(t,e,n,o,a),u=[\"Tensor\"];return r&&(u.push(\"  dtype: \"+n),u.push(\"  rank: \"+i),u.push(\"  shape: [\"+e+\"]\"),u.push(\"  values:\")),u.push(s.map((function(t){return\"    \"+t})).join(\"\\n\")),u.join(\"\\n\")}function pt(t,e,n){return N(Array.isArray(t)?parseFloat(t[0].toFixed(ft))+\" + \"+parseFloat(t[1].toFixed(ft))+\"j\":H(t)?\"'\"+t+\"'\":\"bool\"===n?vt(t):parseFloat(t.toFixed(ft)).toString(),e)}function vt(t){return 0===t?\"false\":\"true\"}function mt(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var gt=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=k(t),null!=n){var o=n.length;C(o===this.size,(function(){return\"Length of values '\"+o+\"' does not match the size inferred by the shape '\"+r.size+\"'.\"}))}if(\"complex64\"===e)throw new Error(\"complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).\");this.values=n||P(e,this.size),this.strides=$(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),C(n.length===this.rank,(function(){return\"The number of provided coordinates (\"+n.length+\") must match the rank (\"+e.rank+\")\"}));var o=this.locToIndex(n);this.values[o]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,o=t;r<o.length;r++){var a=o[r];if(a<0||a>=this.shape[n]){var i=\"Requested out of range element at \"+t+\".   Buffer shape=\"+this.shape;throw new Error(i)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,\"rank\",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return yt().makeTensor(this.values,this.shape,this.dtype)},t}(),yt=null,xt=null,bt=null;var wt=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||\"float32\",this.size=k(t),this.strides=$(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():\"higher\"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),C(1===this.size,(function(){return\"The array must have only 1 element.\"})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,o){return this.throwIfDisposed(),this.reshape([t,e,n,r,o])},t.prototype.asType=function(t){return this.throwIfDisposed(),xt.cast(this,t)},Object.defineProperty(t.prototype,\"rank\",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,xt.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return xt.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,J(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return J(this.shape,this.dataSync())},t.prototype.data=function(){return n(this,void 0,void 0,(function(){var t,e;return r(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=yt().read(this.dataId),\"string\"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return ot(t)}))]}catch(t){throw new Error(\"Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().\")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=yt().readSync(this.dataId);if(\"string\"===this.dtype)try{return t.map((function(t){return ot(t)}))}catch(t){throw new Error(\"Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().\")}return t},t.prototype.bytes=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,yt().read(this.dataId)];case 1:return t=e.sent(),\"string\"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(yt().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,\"isDisposed\",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error(\"Tensor is disposed.\")},t.prototype.toFloat=function(){return this.asType(\"float32\")},t.prototype.toInt=function(){return this.asType(\"int32\")},t.prototype.toBool=function(){return this.asType(\"bool\")},t.prototype.print=function(t){return void 0===t&&(t=!1),xt.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),xt.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),xt.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),xt.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),xt.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),xt.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),xt.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),dt(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),xt.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),xt.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),xt.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),xt.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t=\"euclidean\"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),xt.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),xt.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),xt.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),xt.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),xt.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),xt.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),xt.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),xt.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,o){return void 0===n&&(n=.001),bt(\"tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon\"),this.batchNorm(t,e,o,r,n)},t.prototype.batchNorm=function(t,e,n,r,o){return void 0===o&&(o=.001),this.throwIfDisposed(),xt.batchNorm(this,t,e,n,r,o)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),xt.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),xt.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),xt.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),xt.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),xt.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),xt.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),xt.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),xt.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),xt.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),xt.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),xt.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),xt.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),xt.div(this,t)},t.prototype.divNoNan=function(t){return this.throwIfDisposed(),xt.divNoNan(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),xt.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),xt.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),xt.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),xt.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),xt.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),xt.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),xt.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),xt.modStrict(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),xt.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),xt.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),xt.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),xt.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),xt.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),xt.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),xt.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),xt.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),xt.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),xt.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),xt.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),xt.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),xt.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),xt.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),xt.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),xt.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),xt.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),xt.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),xt.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),xt.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),xt.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),xt.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),xt.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),xt.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),xt.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),xt.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),xt.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),xt.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),xt.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),xt.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),xt.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),xt.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),xt.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),xt.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),xt.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),xt.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),xt.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),xt.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),xt.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),xt.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),xt.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),xt.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),xt.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),xt.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),xt.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),xt.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),xt.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),xt.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),xt.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),xt.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),xt.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),xt.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),xt.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),xt.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),xt.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),xt.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),xt.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),xt.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),xt.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),xt.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),xt.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),xt.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),xt.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),xt.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),xt.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),xt.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,o,a){return void 0===r&&(r=\"NWC\"),void 0===o&&(o=1),this.throwIfDisposed(),xt.conv1d(this,t,e,n,r,o,a)},t.prototype.conv2d=function(t,e,n,r,o,a){return void 0===r&&(r=\"NHWC\"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),xt.conv2d(this,t,e,n,r,o,a)},t.prototype.conv2dTranspose=function(t,e,n,r,o){return this.throwIfDisposed(),xt.conv2dTranspose(this,t,e,n,r,o)},t.prototype.depthwiseConv2D=function(t,e,n,r,o,a){return void 0===r&&(r=\"NHWC\"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),xt.depthwiseConv2d(this,t,e,n,r,o,a)},t.prototype.separableConv2d=function(t,e,n,r,o,a){return void 0===o&&(o=[1,1]),void 0===a&&(a=\"NHWC\"),this.throwIfDisposed(),xt.separableConv2d(this,t,e,n,r,o,a)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),xt.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),xt.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),xt.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,o){return this.throwIfDisposed(),xt.pool(this,t,e,n,r,o)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),yt().makeVariable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),xt.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),xt.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),xt.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),xt.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,o,a,i,s){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===s&&(s=0),this.throwIfDisposed(),xt.stridedSlice(this,t,e,n,r,o,a,i,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),xt.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),xt.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),xt.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),xt.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),xt.spectral.irfft(this)},t}();Object.defineProperty(wt,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var Ct,Et,Rt,It,kt,St=function(t){function n(e,n,r,o){var a=t.call(this,e.shape,e.dtype,e.dataId,o)||this;return a.trainable=n,a.name=r,a}return e(n,t),n.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error(\"dtype of the new value (\"+t.dtype+\") and previous value (\"+this.dtype+\") must match\");if(!S(t.shape,this.shape))throw new Error(\"shape of the new value (\"+t.shape+\") and previous value (\"+this.shape+\") must match\");yt().disposeTensor(this),this.dataId=t.dataId,yt().incRef(this,null)},n.prototype.dispose=function(){yt().disposeVariable(this),this.isDisposedInternal=!0},n}(wt);Object.defineProperty(St,Symbol.hasInstance,{value:function(t){return t instanceof wt&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0=\"R0\",t.R1=\"R1\",t.R2=\"R2\",t.R3=\"R3\",t.R4=\"R4\",t.R5=\"R5\",t.R6=\"R6\"}(Ct||(Ct={})),function(t){t.float32=\"float32\",t.int32=\"int32\",t.bool=\"int32\",t.complex64=\"complex64\"}(Et||(Et={})),function(t){t.float32=\"float32\",t.int32=\"int32\",t.bool=\"bool\",t.complex64=\"complex64\"}(Rt||(Rt={})),function(t){t.float32=\"float32\",t.int32=\"float32\",t.bool=\"float32\",t.complex64=\"complex64\"}(It||(It={})),function(t){t.float32=\"complex64\",t.int32=\"complex64\",t.bool=\"complex64\",t.complex64=\"complex64\"}(kt||(kt={}));var At={float32:It,int32:Et,bool:Rt,complex64:kt};function Dt(t,e){if(\"string\"===t||\"string\"===e){if(\"string\"===t&&\"string\"===e)return\"string\";throw new Error(\"Can not upcast \"+t+\" with \"+e)}return At[t][e]}function Tt(t){return Dt(t,\"int32\")}function Nt(t,e){if(t.dtype===e.dtype)return[t,e];var n=Dt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Ft(t,e){C(t.dtype===e.dtype,(function(){return\"The dtypes of the first(\"+t.dtype+\") and second(\"+e.dtype+\") input must match\"}))}function _t(t){var e=[];return function t(e,n,r){if(null==e)return;if(e instanceof wt)return void n.push(e);if(o=e,!Array.isArray(o)&&\"object\"!=typeof o)return;var o;var a=e;for(var i in a){var s=a[i];r.has(s)||(r.add(s),t(s,n,r))}}(t,e,new Set),e}var Ot,Mt=Object.freeze({makeTypesMatch:Nt,assertTypesMatch:Ft,isTensorInList:function(t,e){return e.some((function(e){return e.id===t.id}))},getTensorsInContainer:_t}),Bt=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),Pt=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Bt}return t.prototype.ready=function(){return n(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error(\"Could not initialize any backends, all backend initializations failed.\")}}))}))},Object.defineProperty(t.prototype,\"backend\",{get:function(){if(null!=this.pendingBackendInit)throw new Error(\"Backend '\"+this.backendName+\"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods\");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error(\"The highest priority backend '\"+e+\"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods\");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+\" backend was already registered. Reusing existing backend factory.\"),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return n(this,void 0,void 0,(function(){var e,n,o;return r(this,(function(r){switch(r.label){case 0:if(null==this.registryFactory[t])throw new Error(\"Backend name '\"+t+\"' not found in registry\");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return o=r.sent(),[3,3];case 2:o=n,r.label=3;case 3:if(!o)return[2,!1];r.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new ut(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;f(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;f(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error(\"Cannot initialize backend \"+t+\", no registration found.\");try{var r=n.factory();if(Promise.resolve(r)===r){var o=++this.pendingBackendInitId,a=r.then((function(n){return!(o<e.pendingBackendInitId)&&(e.registry[t]=n,e.pendingBackendInit=null,!0)})).catch((function(n){return!(o<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn(\"Initialization of backend \"+t+\" failed\"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn(\"Initialization of backend \"+t+\" failed\"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+\" backend not found in registry\");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error(\"No backend found in registry.\");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),o=r.success,a=r.asyncInit;if(a||o)return{name:n,asyncInit:a}}throw new Error(\"Could not initialize any backends, all backend initializations failed.\")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,o=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,o,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,o=null;if(null==e){if(\"function\"!=typeof t)throw new Error(\"Please provide a function to tidy()\");e=t}else{if(\"string\"!=typeof t&&!(t instanceof String))throw new Error(\"When calling with two arguments, the first argument to tidy() must be a string\");if(\"function\"!=typeof e)throw new Error(\"When calling with two arguments, the 2nd argument to tidy() must be a function\");o=t}return this.scopedRun((function(){return r.startScope(o)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error(\"Cannot return a Promise inside of tidy.\"),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){return t.toFloat()}}}),[]),e},t.prototype.runKernel=function(t,e,n,r,o){return this.runKernelFunc(null,e,null,t,n,r,o)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool(\"IS_TEST\")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),o=0;n.forEach((function(t){o+=\"complex64\"===t.dtype?3:1}));var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-e-o-a;if(i>0)throw new Error(\"Backend '\"+this.backendName+\"' has an internal memory leak (\"+i+\" data ids) after running '\"+t+\"'\")},t.prototype.runKernelFunc=function(t,e,n,r,o,a,i){var s,u=this;void 0===a&&(a=[]),void 0===i&&(i=[]);var c=[],h=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:\"\");var f,d=function(t){h&&(c=t.map((function(t){return u.keep(u.clone(t))})))},p=this.state.numBytes,v=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var m,g=l(r,this.backendName);return f=null!=g?function(){var t=u.backend.numDataIds();m=g.kernelFunc({inputs:e,attrs:o,backend:u.backend});var n=Array.isArray(m)?m:[m];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n);var s=n.map((function(t){var e=t.dataId,n=t.shape,r=t.dtype;return u.makeTensorFromDataId(e,n,r)})),c=s.filter((function(t,e){return i[e]}));return d((a||[]).slice().concat(c)),s}:function(){var e=u.backend.numDataIds();m=u.tidy((function(){return t(u.backend,d)}));var n=Array.isArray(m)?m:[m];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n),n},this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool(\"DEBUG\")?u.profiler.profileKernel(r,e,(function(){return f()})):f()})),h&&this.addTapeNode(r,e,s,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-v,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(m)?s:s[0]},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error(\"Values passed to engine.makeTensor() are null\");n=n||\"float32\",r=r||this.backend;var o=t;\"string\"===n&&H(t[0])&&(o=t.map((function(t){return rt(t)})));var a=r.write(o,e,n),i=new wt(e,n,a,this.nextTensorId());if(this.incRef(i,r),\"string\"===n){var s=this.state.tensorInfo.get(a),u=G(o);this.state.numBytes+=u-s.bytes,s.bytes=u}return i},t.prototype.makeTensorFromDataId=function(t,e,n,r){var o=new wt(e,n=n||\"float32\",t,this.nextTensorId());return this.incRef(o,r),o},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var o=new St(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error(\"Variable with name \"+o.name+\" was already registered\");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},t.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,\"string\"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;\"complex64\"!==t.dtype&&\"string\"!==t.dtype&&(r=t.size*z(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof St||this.track(t)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,\"string\"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(\"complex64\"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push(\"Memory usage by string tensors is approximate (2 bytes per character)\")),t},t.prototype.profile=function(t){return n(this,void 0,void 0,(function(){var e,n;return r(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,o){var a=this,i={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:o},s=h(t);null!=s&&(r=s.gradFunc),null!=r&&(i.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],o=tt(r.size,r.dtype);return a.makeTensor(o,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],o)}),this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:\"unnamed scope\",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=_t(t),r=new Set(n.map((function(t){return t.id}))),o=0;o<this.state.activeScope.track.length;o++){var a=this.state.activeScope.track[o];a.kept||r.has(a.id)||a.dispose()}var i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==i.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var o=this;if(void 0===r&&(r=!1),C(e.length>0,(function(){return\"gradients() received an empty list of xs.\"})),null!=n&&\"float32\"!==n.dtype)throw new Error(\"dy must have 'float32' dtype, but has '\"+n.dtype+\"'\");var a=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy(\"forward\",t)}));C(a instanceof wt,(function(){return\"The result y returned by f() must be a tensor.\"}));var i=function(t,e,n){for(var r={},o={},a=0;a<e.length;a++)r[e[a].id]=!0;for(a=0;a<t.length;a++){var i=(p=t[a]).inputs;for(var s in i){for(var u=i[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){p.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,o[p.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var f={};for(a=t.length-1;a>=0;a--)for(i=(p=t[a]).inputs,l=0;l<p.outputs.length;l++)if(h[p.outputs[l].id]){for(var s in i)h[i[s].id]=!0,f[p.id]=!0;break}var d=[];for(a=0;a<t.length;a++){var p;if(o[(p=t[a]).id]&&f[p.id]){var v={};for(var s in p.inputs){var m=p.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},p);g.inputs=v,g.outputs=p.outputs,d.push(g)}}return d}(this.state.activeTape,e,a);if(!r&&0===i.length&&e.length>0)throw new Error(\"Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.\");return this.tidy(\"backward\",(function(){var t,r,s={};s[a.id]=null==n?(t=a.shape,r=Z(k(t),\"float32\"),Lt.makeTensor(r,t,\"float32\")):n,function(t,e,n){for(var r=function(r){var o=e[r],a=[];if(o.outputs.forEach((function(e){var n=t[e.id];null!=n?a.push(n):a.push(null)})),null==o.gradient)throw new Error(\"Cannot compute gradient: gradient function not found for \"+o.kernelName+\".\");var i=o.gradient(a),s=function(e){if(!(e in i))throw new Error(\"Cannot backprop through input \"+e+\". Available gradients found: \"+Object.keys(i)+\".\");var r=n((function(){return i[e]()}));if(\"float32\"!==r.dtype)throw new Error(\"Error in gradient for op \"+o.kernelName+\". The gradient of input \"+e+\" must have 'float32' dtype, but has '\"+r.dtype+\"'\");var a=o.inputs[e];if(!S(r.shape,a.shape))throw new Error(\"Error in gradient for op \"+o.kernelName+\". The gradient of input '\"+e+\"' has shape '\"+r.shape+\"', which does not match the shape of the input '\"+a.shape+\"'\");if(null==t[a.id])t[a.id]=r;else{var s=t[a.id];t[a.id]=s.add(r),s.dispose()}};for(var u in o.inputs)s(u)},o=e.length-1;o>=0;o--)r(o)}(s,i,(function(t){return o.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===o.state.gradientDepth&&(o.state.activeTape.forEach((function(t){for(var e=0,n=t.saved;e<n.length;e++){n[e].dispose()}})),o.state.activeTape=null),{value:a,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return C(X(t),(function(){return\"The f passed in customGrad(f) must be a function.\"})),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];C(r.every((function(t){return t instanceof wt})),(function(){return\"The args passed in customGrad(f)(x1, x2,...) must all be tensors\"}));var a={};return r.forEach((function(t,e){a[e]=t})),e.runKernelFunc((function(e,o){return C((n=t.apply(void 0,r.concat([o]))).value instanceof wt,(function(){return\"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor\"})),C(X(n.gradFunc),(function(){return\"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.\"})),n.value}),a,(function(t,e){var o=n.gradFunc(t,e),a=Array.isArray(o)?o:[o];C(a.length===r.length,(function(){return\"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).\"})),C(a.every((function(t){return t instanceof wt})),(function(){return\"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.\"}));var i={};return a.forEach((function(t,e){i[e]=function(){return t}})),i}))}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.time=function(t){return n(this,void 0,void 0,(function(){var e,n;return r(this,(function(r){switch(r.label){case 0:return e=et(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=et()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,\"registeredVariables\",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Bt,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}();var Lt=function(){var t=function(){if(null==Ot){var t=void 0;if(\"undefined\"!=typeof window)t=window;else if(\"undefined\"!=typeof global)t=global;else if(\"undefined\"!=typeof process)t=process;else{if(\"undefined\"==typeof self)throw new Error(\"Could not find a global object\");t=self}Ot=t}return Ot}();if(null==t._tfengine){var e=new o(t);t._tfengine=new Pt(e)}return function(t){s=t}(t._tfengine.ENV),yt=function(){return t._tfengine},t._tfengine}();function Wt(){return\"undefined\"!=typeof window&&null!=window.document||\"undefined\"!=typeof WorkerGlobalScope}var Ut=i();Ut.registerFlag(\"DEBUG\",(function(){return!1}),(function(t){t&&console.warn(\"Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.\")})),Ut.registerFlag(\"IS_BROWSER\",(function(){return Wt()})),Ut.registerFlag(\"IS_NODE\",(function(){return\"undefined\"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Ut.registerFlag(\"IS_CHROME\",(function(){return\"undefined\"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Ut.registerFlag(\"PROD\",(function(){return!1})),Ut.registerFlag(\"TENSORLIKE_CHECK_SHAPE_CONSISTENCY\",(function(){return Ut.getBool(\"DEBUG\")})),Ut.registerFlag(\"DEPRECATION_WARNINGS_ENABLED\",(function(){return!0})),Ut.registerFlag(\"IS_TEST\",(function(){return!1}));var Vt,zt,Gt,Ht={},qt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Kt(t,e){Ht[t]=e}function jt(t){t in Ht||(Ht[t]=function(t){if(1!==t&&2!==t)throw new Error(\"Cannot get WebGL rendering context, WebGL is disabled.\");var e=function(t){if(\"undefined\"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if(\"undefined\"!=typeof document)return document.createElement(\"canvas\");throw new Error(\"Cannot create a canvas in this context\")}(t);if(e.addEventListener(\"webglcontextlost\",(function(e){e.preventDefault(),delete Ht[t]}),!1),1===t)return e.getContext(\"webgl\",qt)||e.getContext(\"experimental-webgl\",qt);return e.getContext(\"webgl2\",qt)}(t));var e=Ht[t];return e.isContextLost()?(delete Ht[t],jt(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Ht[t])}function Xt(t,e){return[e,t]}function Yt(t){var e=k(t);return T(Math.ceil(e/4))}function $t(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Qt(t,e){var n,r,o,a,s,u,c,l,h,f=t;return 2===i().getNumber(\"WEBGL_VERSION\")?(n=f.R32F,r=f.R16F,o=f.RGBA16F,a=f.RGBA32F,s=f.RED,u=4,c=1,l=f.HALF_FLOAT,h=f.FLOAT):(n=t.RGBA,r=t.RGBA,o=t.RGBA,a=f.RGBA,s=t.RGBA,u=4,c=4,l=null!=e?e.HALF_FLOAT_OES:null,h=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:s,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:h}}function Jt(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error(\"WebGL Error: \"+ne(t,e))}(t),r}!function(t){t[t.DENSE=0]=\"DENSE\",t[t.SHARED_BATCH=1]=\"SHARED_BATCH\"}(Vt||(Vt={})),function(t){t[t.RENDER=0]=\"RENDER\",t[t.UPLOAD=1]=\"UPLOAD\",t[t.PIXELS=2]=\"PIXELS\",t[t.DOWNLOAD=3]=\"DOWNLOAD\"}(zt||(zt={})),function(t){t[t.UNPACKED_FLOAT16=0]=\"UNPACKED_FLOAT16\",t[t.UNPACKED_FLOAT32=1]=\"UNPACKED_FLOAT32\",t[t.PACKED_4X1_UNSIGNED_BYTE=2]=\"PACKED_4X1_UNSIGNED_BYTE\",t[t.PACKED_2X2_FLOAT32=3]=\"PACKED_2X2_FLOAT32\",t[t.PACKED_2X2_FLOAT16=4]=\"PACKED_2X2_FLOAT16\"}(Gt||(Gt={}));var Zt=5.96e-8,te=65504;function ee(t){return!!(i().getBool(\"WEBGL_RENDER_FLOAT32_ENABLED\")||0===t||Zt<Math.abs(t)&&Math.abs(t)<te)}function ne(t,e){switch(e){case t.NO_ERROR:return\"NO_ERROR\";case t.INVALID_ENUM:return\"INVALID_ENUM\";case t.INVALID_VALUE:return\"INVALID_VALUE\";case t.INVALID_OPERATION:return\"INVALID_OPERATION\";case t.INVALID_FRAMEBUFFER_OPERATION:return\"INVALID_FRAMEBUFFER_OPERATION\";case t.OUT_OF_MEMORY:return\"OUT_OF_MEMORY\";case t.CONTEXT_LOST_WEBGL:return\"CONTEXT_LOST_WEBGL\";default:return\"Unknown error code \"+e}}function re(t,e,n){return ke(t,e,(function(){return t.getExtension(n)}),'Extension \"'+n+'\" not supported on this browser.')}function oe(t,e,n){var r=ke(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),\"Unable to create vertex WebGLShader.\");if(Jt(t,e,(function(){return t.shaderSource(r,n)})),Jt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error(\"Failed to compile vertex shader.\");return r}function ae(t,e,n){var r=ke(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),\"Unable to create fragment WebGLShader.\");if(Jt(t,e,(function(){return t.shaderSource(r,n)})),Jt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=ue.exec(e);if(null==n)return console.log(\"Couldn't parse line number in error: \"+e),void console.log(t);for(var r=+n[1],o=t.split(\"\\n\"),a=o.length.toString().length+2,i=o.map((function(t,e){return N((e+1).toString(),a)+t})),s=0,u=0;u<i.length;u++)s=Math.max(i[u].length,s);var c=i.slice(0,r-1),l=i.slice(r-1,r),h=i.slice(r);console.log(c.join(\"\\n\")),console.log(e.split(\"\\n\")[0]),console.log(\"%c \"+N(l[0],s),\"border:1px solid red; background-color:#e3d2d2; color:#a61717\"),console.log(h.join(\"\\n\"))}(n,t.getShaderInfoLog(r)),new Error(\"Failed to compile fragment shader.\");return r}var ie,se,ue=/ERROR: [0-9]+:([0-9]+):/g;function ce(t,e){return ke(t,e,(function(){return t.createProgram()}),\"Unable to create WebGLProgram.\")}function le(t,e,n){if(Jt(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error(\"Failed to link vertex and fragment shaders.\")}function he(t,e,n){if(Jt(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error(\"Shader program validation failed.\")}function fe(t,e,n){var r=ke(t,e,(function(){return t.createBuffer()}),\"Unable to create WebGLBuffer\");return Jt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),Jt(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function de(t,e,n){var r=ke(t,e,(function(){return t.createBuffer()}),\"Unable to create WebGLBuffer\");return Jt(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),Jt(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function pe(t,e){return ke(t,e,(function(){return t.createTexture()}),\"Unable to create WebGLTexture.\")}function ve(t,e){var n=i().getNumber(\"WEBGL_MAX_TEXTURE_SIZE\");if(t<=0||e<=0){var r=\"[\"+t+\"x\"+e+\"]\";throw new Error(\"Requested texture size \"+r+\" is invalid.\")}if(t>n||e>n){r=\"[\"+t+\"x\"+e+\"]\";throw new Error(\"Requested texture size \"+r+\" greater than WebGL maximum on this browser / GPU \"+(\"[\"+n+\"x\"+n+\"]\")+\".\")}}function me(t,e){return ke(t,e,(function(){return t.createFramebuffer()}),\"Unable to create WebGLFramebuffer.\")}function ge(t,e,n,r,o,a,i,s){var u=t.getAttribLocation(n,r);return-1!==u&&(Jt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,o)})),Jt(t,e,(function(){return t.vertexAttribPointer(u,a,t.FLOAT,!1,i,s)})),Jt(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function ye(t,e,n,r){Se(t,r),Jt(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function xe(t,e,n,r){return ke(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform \"'+r+'\" not present in program.')}function be(t,e,n){return t.getUniformLocation(e,n)}function we(t,e,n,r,o,a){Jt(t,e,(function(){return ye(t,e,r,a)})),Jt(t,e,(function(){return t.uniform1i(o,a)}))}function Ce(t,e,n,r){Jt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Jt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function Ee(t,e,n){Jt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Jt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function Re(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error(\"Error binding framebuffer: \"+Ie(t,e))}function Ie(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return\"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return\"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return\"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\";case t.FRAMEBUFFER_UNSUPPORTED:return\"FRAMEBUFFER_UNSUPPORTED\";default:return\"unknown error \"+e}}function ke(t,e,n,r){var o=Jt(t,e,(function(){return n()}));if(null==o)throw new Error(r);return o}function Se(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error(\"textureUnit must be in \"+(\"[gl.TEXTURE0, gl.TEXTURE\"+n+\"]\")+\".\")}function Ae(t,e){return void 0===e&&(e=2),k(t.slice(0,t.length-e))}function De(t){if(0===t.length)throw Error(\"Cannot get rows and columns of an empty shape array.\");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Te(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[Ae(t)].concat(De(t))),e}function Ne(t,e){var n;void 0===e&&(e=!1);var r=i().getNumber(\"WEBGL_MAX_TEXTURE_SIZE\");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?b(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var o=M(t);t=o.newShape}var a=k(t);if(t.length<=1&&a<=r)return[1,a];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var s=Ae(t),u=2,c=2;return t.length&&(u=(n=De(t))[0],c=n[1]),T(a=s*(u/2)*(c/2)).map((function(t){return 2*t}))}return T(a)}function Fe(t){return t%2==0}function _e(t,e){if(S(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Fe(n)&&Fe(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Fe(t[0])&&Fe(e[0])}function Oe(t){if(null==ie){var e=jt(t);ie=e.getParameter(e.MAX_TEXTURE_SIZE)}return ie}function Me(t){if(null==se){var e=jt(t);se=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,se)}function Be(t){if(0===t)return 0;var e=jt(t);return Pe(e,\"EXT_disjoint_timer_query_webgl2\")&&2===t?2:Pe(e,\"EXT_disjoint_timer_query\")?1:0}function Pe(t,e){return null!=t.getExtension(e)}function Le(t){try{if(null!=jt(t))return!0}catch(t){return!1}return!1}function We(t){if(0===t)return!1;var e=jt(t);if(1===t){if(!Pe(e,\"OES_texture_float\"))return!1}else if(!Pe(e,\"EXT_color_buffer_float\"))return!1;return Ve(e)}function Ue(t){if(0===t)return!1;var e=jt(t);if(1!==t){if(Pe(e,\"EXT_color_buffer_float\"))return Ve(e);if(Pe(e,\"EXT_color_buffer_half_float\")){var n=e.getExtension(\"EXT_color_buffer_half_float\");return function(t,e){var n=Qt(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}(e,n)}return!1}return!!Pe(e,\"OES_texture_float\")&&(!!Pe(e,\"WEBGL_color_buffer_float\")&&Ve(e))}function Ve(t){var e=Qt(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),o}function ze(t){return 2===t&&null!=jt(t).fenceSync}var Ge=Object.freeze({callAndCheck:Jt,canBeRepresented:ee,getWebGLErrorMessage:ne,getExtensionOrThrow:re,createVertexShader:oe,createFragmentShader:ae,createProgram:ce,linkProgram:le,validateProgram:he,createStaticVertexBuffer:fe,createStaticIndexBuffer:de,getNumChannels:function(){return 2===i().getNumber(\"WEBGL_VERSION\")?1:4},createTexture:pe,validateTextureSize:ve,createFramebuffer:me,bindVertexBufferToProgramAttribute:ge,bindTextureUnit:ye,unbindTextureUnit:function(t,e,n){Se(t,n),Jt(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:xe,getProgramUniformLocation:be,bindTextureToProgramUniformSampler:we,bindCanvasToFramebuffer:function(t,e){Jt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Jt(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),Jt(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:Ce,unbindColorTextureFromFramebuffer:Ee,validateFramebuffer:Re,getFramebufferErrorMessage:Ie,getBatchDim:Ae,getRowsCols:De,getShapeAs3D:Te,getTextureShapeFromLogicalShape:Ne,isReshapeFree:_e,getWebGLMaxTextureSize:Oe,resetMaxTextureSize:function(){ie=null},resetMaxTexturesInShader:function(){se=null},getMaxTexturesInShader:Me,getWebGLDisjointQueryTimerVersion:Be,hasExtension:Pe,isWebGLVersionEnabled:Le,isCapableOfRenderingToFloatTexture:We,isDownloadFloatTextureEnabled:Ue,isWebGLFenceEnabled:ze}),He=i();function qe(){i().set(\"PROD\",!0)}function Ke(){i().set(\"DEBUG\",!0)}function je(){i().set(\"DEPRECATION_WARNINGS_ENABLED\",!1),console.warn(\"TensorFlow.js deprecation warnings have been disabled.\")}function Xe(t){i().getBool(\"DEPRECATION_WARNINGS_ENABLED\")&&console.warn(t+\" You can disable deprecation warnings with tf.disableDeprecationWarnings().\")}function Ye(){Lt.disposeVariables()}function $e(){return Lt}function Qe(){return Lt.memory()}function Je(t){return Lt.profile(t)}function Ze(t,e){return Lt.tidy(t,e)}function tn(t){_t(t).forEach((function(t){return t.dispose()}))}function en(t){return Lt.keep(t)}function nn(t){return Lt.time(t)}function rn(t){return Lt.setBackend(t)}function on(){return Lt.ready()}function an(){return Lt.backendName}function sn(t){Lt.removeBackend(t)}function un(t){return Lt.findBackend(t)}function cn(t){return Lt.findBackendFactory(t)}function ln(t,e,n){return void 0===n&&(n=1),Lt.registerBackend(t,e,n)}function hn(){return Lt.backend}function fn(t,e){i().setPlatform(t,e)}function dn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i().getBool(\"IS_TEST\")||console.warn.apply(console,t)}function pn(t,e){var n=t;if(V(t))return\"string\"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||V(n)&&\"string\"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&i().getBool(\"TENSORLIKE_CHECK_SHAPE_CONSISTENCY\")&&function t(e,n,r){if(r=r||[],!Array.isArray(e)&&!V(e))return void C(0===n.length,(function(){return\"Element arr[\"+r.join(\"][\")+\"] is a primitive, but should be an array/TypedArray of \"+n[0]+\" elements\"}));C(n.length>0,(function(){return\"Element arr[\"+r.join(\"][\")+\"] should be a primitive, but is an array of \"+e.length+\" elements\"})),C(e.length===n[0],(function(){return\"Element arr[\"+r.join(\"][\")+\"] should have \"+n[0]+\" elements, but has \"+e.length+\" elements\"}));for(var o=n.slice(1),a=0;a<e.length;++a)t(e[a],o,r.concat(a))}(t,r,[]),r}function vn(t,e,n,r){if(null!=t&&(\"numeric\"!==t&&t!==e||\"numeric\"===t&&\"string\"===e))throw new Error(\"Argument '\"+n+\"' passed to '\"+r+\"' must be \"+t+\" tensor, but got \"+e+\" tensor\")}function mn(t,e,n,r){if(void 0===r&&(r=\"numeric\"),t instanceof wt)return vn(r,t.dtype,e,n),t;var o=j(t);if(\"string\"!==o&&[\"bool\",\"int32\",\"float32\"].indexOf(r)>=0&&(o=r),vn(r,o,e,n),null==t||!V(t)&&!Array.isArray(t)&&\"number\"!=typeof t&&\"boolean\"!=typeof t&&\"string\"!=typeof t){var a=null==t?\"null\":t.constructor.name;throw new Error(\"Argument '\"+e+\"' passed to '\"+n+\"' must be a Tensor or TensorLike, but got '\"+a+\"'\")}var s=pn(t,o);V(t)||Array.isArray(t)||(t=[t]);var u=\"string\"!==o?Q(t,o,i().getBool(\"DEBUG\")):I(t,[],!0);return Lt.makeTensor(u,s,o)}function gn(t,e,n,r){if(void 0===r&&(r=\"numeric\"),!Array.isArray(t))throw new Error(\"Argument \"+e+\" passed to \"+n+\" must be a `Tensor[]` or `TensorLike[]`\");return t.map((function(t,r){return mn(t,e+\"[\"+r+\"]\",n)}),r)}function yn(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function xn(t,e,n){for(var r=t.length+e.length,o=[],a=0,i=0,s=0;s<r;s++)-1===n.indexOf(s)?o.push(t[a++]):o.push(e[i++]);return o}function bn(t,e){for(var n=[],r=t.length,o=0;o<r;o++)-1===e.indexOf(o)&&n.push(t[o]);return[n,e.map((function(e){return t[e]}))]}function wn(t,e){return xn(t,e.map((function(t){return 1})),e)}function Cn(t,e,n){C(yn(e,n),(function(){return t+\" supports only inner-most axes for now. Got axes \"+e+\" and rank-\"+n+\" input.\"}))}function En(t,e){if(yn(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function Rn(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function In(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function kn(t,e){var n=t[0].length;t.forEach((function(t,e){C(t.length===n,(function(){return\"Error in concat\"+n+\"D: rank of tensors[\"+e+\"] must be the same as the rank of the rest (\"+n+\")\"}))})),C(e>=0&&e<n,(function(){return\"Error in concat\"+n+\"D: axis must be between 0 and \"+(n-1)+\".\"}));var r=t[0];t.forEach((function(t,o){for(var a=0;a<n;a++)C(a===e||t[a]===r[a],(function(){return\"Error in concat\"+n+\"D: Shape of tensors[\"+o+\"] (\"+t+\") does not match the shape of the rest (\"+r+\") along the non-concatenated axis \"+o+\".\"}))}))}function Sn(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function An(t){var e=Object.keys(t);if(1!==e.length)throw new Error(\"Please provide an object with a single key (operation name) mapping to a function. Got an object with \"+e.length+\" keys.\");var n=e[0],r=t[n];n.endsWith(\"_\")&&(n=n.substring(0,n.length-1));var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Lt.startScope(n);try{var o=r.apply(void 0,t);return o instanceof Promise&&console.error(\"Cannot return a Promise inside of tidy.\"),Lt.endScope(o),o}catch(t){throw Lt.endScope(null),t}};return Object.defineProperty(o,\"name\",{value:n,configurable:!0}),o}He.registerFlag(\"HAS_WEBGL\",(function(){return He.getNumber(\"WEBGL_VERSION\")>0})),He.registerFlag(\"WEBGL_VERSION\",(function(){return Le(2)?2:Le(1)?1:0})),He.registerFlag(\"WEBGL_BUFFER_SUPPORTED\",(function(){return 2===He.get(\"WEBGL_VERSION\")})),He.registerFlag(\"WEBGL_CPU_FORWARD\",(function(){return!0})),He.registerFlag(\"WEBGL_FORCE_F16_TEXTURES\",(function(){return!1})),He.registerFlag(\"WEBGL_PACK\",(function(){return He.getBool(\"HAS_WEBGL\")})),He.registerFlag(\"WEBGL_PACK_NORMALIZATION\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_PACK_CLIP\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_PACK_DEPTHWISECONV\",(function(){return!1})),He.registerFlag(\"WEBGL_PACK_BINARY_OPERATIONS\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_PACK_UNARY_OPERATIONS\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_PACK_ARRAY_OPERATIONS\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_PACK_IMAGE_OPERATIONS\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_PACK_REDUCE\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_LAZILY_UNPACK\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_CONV_IM2COL\",(function(){return He.getBool(\"WEBGL_PACK\")})),He.registerFlag(\"WEBGL_MAX_TEXTURE_SIZE\",(function(){return Oe(He.getNumber(\"WEBGL_VERSION\"))})),He.registerFlag(\"WEBGL_MAX_TEXTURES_IN_SHADER\",(function(){return Me(He.getNumber(\"WEBGL_VERSION\"))})),He.registerFlag(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\",(function(){var t=He.getNumber(\"WEBGL_VERSION\");return 0===t?0:Be(t)})),He.registerFlag(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\",(function(){return He.getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(t.substr(0,4))));var t})),He.registerFlag(\"WEBGL_RENDER_FLOAT32_CAPABLE\",(function(){return We(He.getNumber(\"WEBGL_VERSION\"))})),He.registerFlag(\"WEBGL_RENDER_FLOAT32_ENABLED\",(function(){return!He.getBool(\"WEBGL_FORCE_F16_TEXTURES\")&&He.getBool(\"WEBGL_RENDER_FLOAT32_CAPABLE\")})),He.registerFlag(\"WEBGL_DOWNLOAD_FLOAT_ENABLED\",(function(){return Ue(He.getNumber(\"WEBGL_VERSION\"))})),He.registerFlag(\"WEBGL_FENCE_API_ENABLED\",(function(){return ze(He.getNumber(\"WEBGL_VERSION\"))})),He.registerFlag(\"WEBGL_SIZE_UPLOAD_UNIFORM\",(function(){return He.getBool(\"WEBGL_RENDER_FLOAT32_ENABLED\")?4:0})),bt=Xe;var Dn=An({complex_:function(t,e){var n=mn(t,\"real\",\"complex\"),r=mn(e,\"imag\",\"complex\");return E(n.shape,r.shape,\"real and imag shapes, \"+n.shape+\" and \"+r.shape+\", must match in call to tf.complex().\"),Lt.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),Tn=An({real_:function(t){var e=mn(t,\"input\",\"real\");return Lt.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),Nn=An({imag_:function(t){var e=mn(t,\"input\",\"imag\");return Lt.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function Fn(t,e,n){return _n(t,e,pn(t,n),n)}function _n(t,e,n,r){if(null==r&&(r=j(t)),\"complex64\"===r)throw new Error(\"Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).\");if(!V(t)&&!Array.isArray(t)&&\"number\"!=typeof t&&\"boolean\"!=typeof t&&\"string\"!=typeof t)throw new Error(\"values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray\");if(null!=e){nt(e);var o=k(e),a=k(n);C(o===a,(function(){return\"Based on the provided shape, [\"+e+\"], the tensor should have \"+o+\" values but has \"+a}));for(var s=0;s<n.length;++s){var u=n[s],c=s!==n.length-1||u!==k(e.slice(s));C(n[s]===e[s]||!c,(function(){return\"Error creating a new Tensor. Inferred shape (\"+n+\") does not match the provided shape (\"+e+\"). \"}))}}return V(t)||Array.isArray(t)||(t=[t]),e=e||n,t=\"string\"!==r?Q(t,r,i().getBool(\"DEBUG\")):I(t,[],!0),Lt.makeTensor(t,e,r)}function On(t,e){if((V(t)&&\"string\"!==e||Array.isArray(t))&&\"complex64\"!==e)throw new Error(\"Error creating a new Scalar: value must be a primitive (number|boolean|string)\");if(\"string\"===e&&V(t)&&!(t instanceof Uint8Array))throw new Error(\"When making a scalar from encoded string, the value must be `Uint8Array`.\");return _n(t,[],[],e)}function Mn(t,e){R(t);var n=pn(t,e);if(1!==n.length)throw new Error(\"tensor1d() requires values to be a flat/TypedArray\");return _n(t,null,n,e)}function Bn(t,e,n){if(R(t),null!=e&&2!==e.length)throw new Error(\"tensor2d() requires shape to have two numbers\");var r=pn(t,n);if(2!==r.length&&1!==r.length)throw new Error(\"tensor2d() requires values to be number[][] or flat/TypedArray\");if(1===r.length&&null==e)throw new Error(\"tensor2d() requires shape to be provided when `values` are a flat/TypedArray\");return _n(t,e,r,n)}function Pn(t,e,n){if(R(t),null!=e&&3!==e.length)throw new Error(\"tensor3d() requires shape to have three numbers\");var r=pn(t,n);if(3!==r.length&&1!==r.length)throw new Error(\"tensor3d() requires values to be number[][][] or flat/TypedArray\");if(1===r.length&&null==e)throw new Error(\"tensor3d() requires shape to be provided when `values` are a flat array\");return _n(t,e,r,n)}function Ln(t,e,n){if(R(t),null!=e&&4!==e.length)throw new Error(\"tensor4d() requires shape to have four numbers\");var r=pn(t,n);if(4!==r.length&&1!==r.length)throw new Error(\"tensor4d() requires values to be number[][][][] or flat/TypedArray\");if(1===r.length&&null==e)throw new Error(\"tensor4d() requires shape to be provided when `values` are a flat array\");return _n(t,e,r,n)}function Wn(t,e,n){if(R(t),null!=e&&5!==e.length)throw new Error(\"tensor5d() requires shape to have five numbers\");var r=pn(t,n);if(5!==r.length&&1!==r.length)throw new Error(\"tensor5d() requires values to be number[][][][][] or flat/TypedArray\");if(1===r.length&&null==e)throw new Error(\"tensor5d() requires shape to be provided when `values` are a flat array\");return _n(t,e,r,n)}function Un(t,e,n){if(R(t),null!=e&&6!==e.length)throw new Error(\"tensor6d() requires shape to have six numbers\");var r=pn(t,n);if(6!==r.length&&1!==r.length)throw new Error(\"tensor6d() requires values to be number[][][][][][] or flat/TypedArray\");if(1===r.length&&null==e)throw new Error(\"tensor6d() requires shape to be provided when `values` are a flat array\");return _n(t,e=e||r,r,n)}function Vn(t,e,n,r){return void 0===e&&(e=!0),Lt.makeVariable(t,e,n,r)}function zn(t,e){if(void 0===e&&(e=\"float32\"),\"complex64\"===e){var n=zn(t,\"float32\"),r=Gn(t,\"float32\");return Dn(n,r)}var o=Z(k(t),e);return Lt.makeTensor(o,t,e)}function Gn(t,e){if(void 0===e&&(e=\"float32\"),\"complex64\"===e){var n=Gn(t,\"float32\"),r=Gn(t,\"float32\");return Dn(n,r)}var o=tt(k(t),e);return Lt.makeTensor(o,t,e)}function Hn(t,e,n){return Lt.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function qn(t,e,n){if(n<=0)throw new Error(\"The number of values should be positive.\");return Lt.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function Kn(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=\"float32\"),0===n)throw new Error(\"Cannot have a step of zero\");if(t===e||t<e&&n<0||e<t&&n>1)return Gn([0],r);var o=tt(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),o[0]=t;for(var a=1;a<o.length;a++)o[a]=o[a-1]+n;return Mn(o,r)}var jn=An({onesLike_:function(t){var e=mn(t,\"x\",\"onesLike\");if(\"complex64\"===e.dtype){var n=jn(Tn(e)),r=Xn(Nn(e));return Dn(n,r)}return Lt.runKernelFunc((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Xn(t)}}}))}}),Xn=An({zerosLike_:function(t){var e=mn(t,\"x\",\"zerosLike\");return Lt.runKernelFunc((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Xn(t)}}}))}});var Yn=An({concat_:function(t,e){void 0===e&&(e=0),C(t.length>=1,(function(){return\"Pass at least one tensor to concat\"}));var n=gn(t,\"tensors\",\"concat\");\"complex64\"===n[0].dtype&&n.forEach((function(t){if(\"complex64\"!==t.dtype)throw new Error(\"Cannot concatenate complex64 tensors with a tensor\\n          with dtype \"+t.dtype+\". \")})),e=O(e,n[0].shape)[0];var r=Sn(n.map((function(t){return t.shape})),e);if(0===k(r))return Fn([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var o=n.map((function(t){return t.shape}));kn(o,e);var a=n,i={axis:e};return Lt.runKernelFunc((function(t){return t.concat(n,e)}),a,(function(t){var n=o.map((function(t){return t[e]}));return tr(t,n,e).map((function(t){return function(){return t}}))}),\"Concat\",i)}}),$n=An({concat1d_:function(t){return Yn(t,0)}}),Qn=An({concat2d_:function(t,e){return Yn(t,e)}}),Jn=An({concat3d_:function(t,e){return Yn(t,e)}}),Zn=An({concat4d_:function(t,e){return Yn(t,e)}}),tr=An({split_:function(t,e,n){void 0===n&&(n=0);var r,o=mn(t,\"x\",\"split\");return n=O(n,o.shape)[0],\"number\"==typeof e?(C(o.shape[n]%e==0,(function(){return\"Number of splits must evenly divide the axis.\"})),r=new Array(e).fill(o.shape[n]/e)):(C(o.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return\"The sum of sizes must match the size of the axis dimension.\"})),r=e),Lt.runKernelFunc((function(t){return t.split(o,r,n)}),{$x:o},(function(t){return{$x:function(){return Yn(t,n)}}}))}});\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self&&self;function er(t,e){return t(e={exports:{}},e.exports),e.exports}var nr=er((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(\" \"),n.s1=r(\" \"),n.s2=r(\" \"),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var n=new r(t),a=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,a&&(\"object\"==typeof a&&o(a,n),i.state=function(){return o(n,{})}),i}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.alea=a}(0,t,!1)})),rr=er((function(t){!function(t,e,n){function r(t){var e=this,n=\"\";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var n=new r(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(\"object\"==typeof a&&o(a,n),i.state=function(){return o(n,{})}),i}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xor128=a}(0,t,!1)})),or=er((function(t){!function(t,e,n){function r(t){var e=this,n=\"\";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(\"object\"==typeof a&&o(a,n),i.state=function(){return o(n,{})}),i}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xorwow=a}(0,t,!1)})),ar=er((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,o=e.i;return t=r[o],n=(t^=t>>>7)^t<<24,n^=(t=r[o+1&7])^t>>>10,n^=(t=r[o+3&7])^t>>>3,n^=(t=r[o+4&7])^t<<7,t=r[o+7&7],n^=(t^=t<<13)^t<<9,r[o]=n,e.i=o+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=\"\"+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(a.x&&o(a,n),i.state=function(){return o(n,{})}),i}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xorshift7=a}(0,t,!1)})),ir=er((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,o=e.X,a=e.i;return e.w=r=r+1640531527|0,n=o[a+34&127],t=o[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=o[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,o,a,i,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+=\"\\0\",r=0,u=Math.max(u,e.length)),o=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,o=0==(n=s[127&a]^=r+i)?o+1:0);for(o>=128&&(s[127&(e&&e.length||0)]=-1),o=127,a=512;a>0;--a)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;t.w=i,t.X=s,t.i=o}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(a.X&&o(a,n),i.state=function(){return o(n,{})}),i}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xor4096=a}(0,t,!1)})),sr=er((function(t){!function(t,e,n){function r(t){var e=this,n=\"\";e.next=function(){var t=e.b,n=e.c,r=e.d,o=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(\"object\"==typeof a&&o(a,n),i.state=function(){return o(n,{})}),i}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.tychei=a}(0,t,!1)})),ur=er((function(t){!function(e,n){var r,o=this,a=256,i=6,s=\"random\",u=n.pow(a,i),c=n.pow(2,52),l=2*c,h=a-1;function f(t,h,f){var g=[],y=v(function t(e,n){var r,o=[],a=typeof e;if(n&&\"object\"==a)for(r in e)try{o.push(t(e[r],n-1))}catch(t){}return o.length?o:\"string\"==a?e:e+\"\\0\"}((h=1==h?{entropy:!0}:h||{}).entropy?[t,m(e)]:null==t?function(){try{var t;return r&&(t=r.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=o.navigator,i=n&&n.plugins;return[+new Date,o,i,o.screen,m(e)]}}():t,3),g),x=new d(g),b=function(){for(var t=x.g(i),e=u,n=0;t<c;)t=(t+n)*a,e*=a,n=x.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|x.g(4)},b.quick=function(){return x.g(4)/4294967296},b.double=b,v(m(x.S),e),(h.pass||f||function(t,e,r,o){return o&&(o.S&&p(o,x),t.state=function(){return p(x,{})}),r?(n[s]=t,e):t})(b,y,\"global\"in h?h.global:this==n,h.state)}function d(t){var e,n=t.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);o<a;)s[o]=o++;for(o=0;o<a;o++)s[o]=s[i=h&i+t[o%n]+(e=s[o])],s[i]=e;(r.g=function(t){for(var e,n=0,o=r.i,i=r.j,s=r.S;t--;)e=s[o=h&o+1],n=n*a+s[h&(s[o]=s[i=h&i+e])+(s[i]=e)];return r.i=o,r.j=i,n})(a)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){for(var n,r=t+\"\",o=0;o<r.length;)e[h&o]=h&(n^=19*e[h&o])+r.charCodeAt(o++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(n[\"seed\"+s]=f,v(n.random(),e),t.exports){t.exports=f;try{r=require(\"crypto\")}catch(t){}}}([],Math)}));ur.alea=nr,ur.xor128=rr,ur.xorwow=or,ur.xorshift7=ar,ur.xor4096=ir,ur.tychei=sr;var cr=ur.alea,lr=function(){function t(t,e,n,r,o){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=o||Math.random();this.random=cr(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var o=void 0,a=void 0,i=void 0;do{i=(o=2*this.random()-1)*o+(a=2*this.random()-1)*a}while(i>=1||0===i);var s=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*o*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||\"float32\"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),hr=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var o=r||Math.random();this.randu=cr(o.toString()),this.randn=new lr(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,o,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-a+Math.log(a)),(o=this.randu())<e||Math.log(o)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(t){return\"float32\"===this.dtype?t:Math.round(t)},t}(),fr=function(){function t(t,e,n,r){var o=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==o.dtype||\"float32\"===o.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),\"number\"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(\"The difference between \"+t+\" - \"+e+\" <= 1 and dtype is not float\");this.random=cr(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function dr(t,e,n){return void 0===e&&(e=\"float32\"),e=e||\"float32\",nt(t),new gt(t,e,n)}function pr(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}var vr=An({batchToSpaceND_:function(t,e,n){var r=mn(t,\"x\",\"batchToSpaceND\"),o=e.reduce((function(t,e){return t*e}));return C(r.rank>=1+e.length,(function(){return\"input rank is \"+r.rank+\" but should be > than blockShape.length \"+e.length})),C(n.length===e.length,(function(){return\"crops.length is \"+n.length+\" but should be equal to blockShape.length  \"+e.length})),C(r.shape[0]%o==0,(function(){return\"input tensor batch is \"+r.shape[0]+\" but is not divisible by the product of the elements of blockShape \"+e.join(\" * \")+\" === \"+o})),Lt.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),mr=An({broadcastTo_:function(t,e){var n=mn(t,\"broadcastTo\",\"x\"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!=0})))throw new Error(\"broadcastTo(): Invalid broadcast shape [\"+e+\"].\");if(e.length<n.rank)throw new Error(\"broadcastTo(): shape.length=\"+e.length+\" < input.rank=\"+n.rank+\".\");if(e.length>n.rank){for(var o=n.shape.slice();o.length<e.length;)o.unshift(1);n=n.reshape(o)}for(var a=Array.from(e),i=e.length-1;i>=0;i--)if(n.shape[i]===e[i])a[i]=1;else if(1!==n.shape[i])throw new Error(\"broadcastTo(): [\"+r+\"] cannot be broadcast to [\"+e+\"].\");var s=a.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0}));return 0===s.length?n.clone():Lt.runKernelFunc((function(t){return t.tile(n,a)}),{input:n},(function(t){return{input:function(){return t.sum(s,!0)}}}))}}),gr=An({cast_:function(t,e){var n=mn(t,\"x\",\"cast\");if(!W(e))throw new Error(\"Failed to cast to unknown dtype \"+e);if(\"string\"===e&&\"string\"!==n.dtype||\"string\"!==e&&\"string\"===n.dtype)throw new Error(\"Only strings can be casted to strings\");var r={dtype:e};return Lt.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),\"Cast\",r)}}),yr=An({clone_:function(t){var e=mn(t,\"x\",\"clone\",null);return Lt.runKernelFunc((function(){return Lt.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),xr=An({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=mn(t,\"x\",\"cumsum\"),a=En([e|=0],o.rank),i=o;null!=a&&(i=o.transpose(a));var s=In(1,o.rank)[0],u=Lt.runKernelFunc((function(t){return t.cumsum(i,s,n,r)}),{permutedX:i},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=a&&(u=u.transpose(a)),u}}),br=An({depthToSpace_:function(t,e,n){void 0===n&&(n=\"NHWC\");var r=mn(t,\"x\",\"depthToSpace\"),o=\"NHWC\"===n?r.shape[1]:r.shape[2],a=\"NHWC\"===n?r.shape[2]:r.shape[3],i=\"NHWC\"===n?r.shape[3]:r.shape[1];return C(o*e>=0,(function(){return\"Negative dimension size caused by overflow when multiplying\\n      \"+o+\" and \"+e+\"  for depthToSpace with input shape\\n      \"+r.shape})),C(a*e>=0,(function(){return\"Negative dimension size caused by overflow when multiplying\\n      \"+a+\" and \"+e+\" for depthToSpace with input shape\\n          \"+r.shape})),C(i%(e*e)==0,(function(){return\"Dimension size must be evenly divisible by \"+e*e+\" but is \"+i+\" for depthToSpace with input shape \"+r.shape})),Lt.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),wr=An({expandDims_:function(t,e){void 0===e&&(e=0);var n=mn(t,\"x\",\"expandDims\",null);C(e<=n.rank,(function(){return\"Axis must be <= rank of the tensor\"}));var r=n.shape.slice();return e<0&&(C(-(n.rank+1)<=e,(function(){return\"Axis must be in the interval [\"+-(n.rank+1)+\", \"+n.rank+\"]\"})),e=n.rank+e+1),r.splice(e,0,1),Or(n,r)}}),Cr=An({eye_:function(t,e,n,r){void 0===r&&(r=\"float32\"),null==e&&(e=t);for(var o=dr([t,e],r),a=t<=e?t:e,i=0;i<a;++i)o.set(1,i,i);var s=o.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return Lr(wr(s,0),[n[0],1,1]);if(2===n.length)return Lr(wr(wr(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Lr(wr(wr(wr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(\"eye() currently supports only 1D and 2D batchShapes, but received \"+n.length+\"D.\")}}),Er=An({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var o=mn(t,\"logits\",\"multinomial\"),a=o.size,i=o.rank;if(a<2)throw new Error(\"Error in multinomial: you need at least 2 outcomes, but got \"+a+\".\");if(i>2)throw new Error(\"Rank of probabilities must be 1 or 2, but is \"+i);n=n||Math.random();var s=1===i?o.as2D(1,-1):o,u=Lt.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===i?u.as1D():u}}),Rr=An({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error(\"Error in oneHot: depth must be >=2, but it is \"+e);var o=mn(t,\"indices\",\"oneHot\",\"int32\"),a=o.shape.concat([e]);return o=o.flatten(),Lt.runKernelFunc((function(t){return t.oneHot(o,e,n,r)}),{$indices:o},(function(t){return{$indices:function(){return Gn(o.shape,\"float32\")}}})).reshape(a)}}),Ir=An({pad_:function(t,e,n){void 0===n&&(n=0);var r=mn(t,\"x\",\"pad\");if(0===r.rank)throw new Error(\"pad(scalar) is not defined. Pass non-scalar to pad\");var o={paddings:e,constantValue:n};return Lt.runKernelFunc((function(t){return t.pad(r,e,n)}),{x:r},(function(t){var n=e.map((function(t){return t[0]}));return{x:function(){return t.slice(n,r.shape)}}}),\"PadV2\",o)}}),kr=An({pad1d_:function(t,e,n){return void 0===n&&(n=0),C(2===e.length,(function(){return\"Invalid number of paddings. Must be length of 2.\"})),Ir(t,[e],n)}}),Sr=An({pad2d_:function(t,e,n){return void 0===n&&(n=0),C(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return\"Invalid number of paddings. Must be length of 2 each.\"})),Ir(t,e,n)}}),Ar=An({pad3d_:function(t,e,n){return void 0===n&&(n=0),C(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return\"Invalid number of paddings. Must be length of 2 each.\"})),Ir(t,e,n)}}),Dr=An({pad4d_:function(t,e,n){return void 0===n&&(n=0),C(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return\"Invalid number of paddings. Must be length of 2 each.\"})),Ir(t,e,n)}}),Tr=An({rand_:function(t,e,n){var r=k(t),o=null;if(null==n||\"float32\"===n)o=new Float32Array(r);else if(\"int32\"===n)o=new Int32Array(r);else{if(\"bool\"!==n)throw new Error(\"Unknown data type \"+n);o=new Uint8Array(r)}for(var a=0;a<r;a++)o[a]=e();return Lt.makeTensor(o,t,n)}}),Nr=An({randomNormal_:function(t,e,n,r,o){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&\"bool\"===r)throw new Error(\"Unsupported data type \"+r);for(var a=new lr(e,n,r,!1,o),i=dr(t,r),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Fr=An({randomGamma_:function(t,e,n,r,o){if(void 0===n&&(n=1),void 0===r&&(r=\"float32\"),null==n&&(n=1),null==r&&(r=\"float32\"),\"float32\"!==r&&\"int32\"!==r)throw new Error(\"Unsupported data type \"+r);for(var a=new hr(e,n,r,o),i=dr(t,r),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),_r=An({randomUniform_:function(t,e,n,r,o){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=\"float32\");for(var a=dr(t,r),i=new fr(e,n,null,o),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Or=An({reshape_:function(t,e){var n=mn(t,\"x\",\"reshape\",null);e=_(e,n.size),C(n.size===k(e),(function(){return\"new shape and old shape must have the same number of elements.\"}));var r={shape:e};return Lt.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),\"Reshape\",r)}}),Mr=An({spaceToBatchND_:function(t,e,n){var r=mn(t,\"x\",\"spaceToBatchND\");return C(r.rank>=1+e.length,(function(){return\"input rank \"+r.rank+\" should be > than [blockShape] \"+e.length})),C(n.length===e.length,(function(){return\"paddings.shape[0] \"+n.length+\" must be equal to [blockShape] \"+e.length})),C(r.shape.reduce((function(t,r,o){return o>0&&o<=e.length?t&&(r+n[o-1][0]+n[o-1][1])%e[o-1]==0:t}),!0),(function(){return\"input spatial dimensions \"+r.shape.slice(1)+\" with paddings \"+n.toString()+\" must be divisible by blockShapes \"+e.toString()})),Lt.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),Br=An({squeeze_:function(t,e){var n=mn(t,\"x\",\"squeeze\");return Or(n,M(n.shape,e).newShape)}}),Pr=An({stack_:function(t,e){void 0===e&&(e=0);var n=gn(t,\"tensors\",\"stack\");if(C(n.length>=1,(function(){return\"Pass at least one tensor to tf.stack\"})),1===n.length)return n[0].expandDims(e);var r=n[0].rank,o=n[0].shape,a=n[0].dtype;C(e<=r,(function(){return\"Axis must be <= rank of the tensor\"})),n.forEach((function(t){E(o,t.shape,\"All tensors passed to stack must have matching shapes\")})),n.forEach((function(t){C(a===t.dtype,(function(){return\"All tensors passed to stack must have matching dtypes\"}))}));var i=n.map((function(t){return t.expandDims(e)}));return Yn(i,e)}}),Lr=An({tile_:function(t,e){var n=mn(t,\"x\",\"tile\",null);C(n.rank===e.length,(function(){return\"Error in transpose: rank of input \"+n.rank+\" must match length of reps \"+e+\".\"}));var r=[n],o={reps:e};return Lt.runKernelFunc((function(t,r){var o=t.tile(n,e);return r([n]),o}),{x:n},(function(t,n){var r=n[0];return{x:function(){var n=Xn(r);if(1===r.rank)for(var o=0;o<e[0];++o)n=n.add(t.slice([o*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(o=0;o<e[0];++o)for(var a=0;a<e[1];++a)n=n.add(t.slice([o*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(o=0;o<e[0];++o)for(a=0;a<e[1];++a)for(var i=0;i<e[2];++i)n=n.add(t.slice([o*r.shape[0],a*r.shape[1],i*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(\"Gradient for tile operation is not implemented for rank-\"+r.rank+\" tensors yet.\");for(o=0;o<e[0];++o)for(a=0;a<e[1];++a)for(i=0;i<e[2];++i)for(var s=0;s<e[3];++s)n=n.add(t.slice([o*r.shape[0],a*r.shape[1],i*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}),\"Tile\",o,r)}}),Wr=An({truncatedNormal_:function(t,e,n,r,o){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&\"bool\"===r)throw new Error(\"Unsupported data type \"+r);for(var a=new lr(e,n,r,!0,o),i=dr(t,r),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Ur=An({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=mn(t,\"x\",\"unstack\");C(e>=-n.shape.length&&e<n.shape.length,(function(){return\"Axis = \"+e+\" is not in [-\"+n.shape.length+\", \"+n.shape.length+\")\"})),e<0&&(e+=n.shape.length);var r={axis:e};return Lt.runKernelFunc((function(t){return t.unstack(n,e)}),{x:n},(function(t){return{x:function(){return Pr(t,e)}}}),\"Unpack\",r)}}),Vr=function(t,e){return n(this,void 0,void 0,(function(){var n,o,a,i,s,u,c,l,h,f;return r(this,(function(r){switch(r.label){case 0:return n=mn(t,\"x\",\"setdiff1d\"),o=mn(e,\"y\",\"setdiff1d\"),C(n.dtype===o.dtype,(function(){return\"x and y should have the same dtype, but got x (\"+n.dtype+\") and y (\"+o.dtype+\").\"})),C(1===n.rank,(function(){return\"x should be 1D tensor, but got x (\"+n.shape+\").\"})),C(1===o.rank,(function(){return\"y should be 1D tensor, but got y (\"+o.shape+\").\"})),[4,n.data()];case 1:return a=r.sent(),[4,o.data()];case 2:for(i=r.sent(),s=new Set(i),u=0,h=0;h<a.length;h++)s.has(a[h])||u++;for(c=new gt([u],n.dtype),l=new gt([u],\"int32\"),h=0,f=0;h<a.length;h++)s.has(a[h])||(c.values[f]=a[h],l.values[f]=h,f++);return[2,[c.toTensor(),l.toTensor()]]}}))}))};function zr(t,e,n,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(e.slice(0))).push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);for(var a=e.length,i=0;i<a;++i)o=o.concat([t[i+1]/e[i],e[i]]);o=o.concat(t.slice(a+1))}return o}function Gr(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{var a=[],i=[];for(o=1;o<t;++o)o>=2*e+1||o%2==1?i.push(o):a.push(o);r.push.apply(r,a),r.push(0),r.push.apply(r,i)}return r}function Hr(t,e,n,r){void 0===r&&(r=!0);var o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(var a=1;a<t.length;++a)a<=e.length?r?o.push(e[a-1]*t[a]):o.push(t[a]/e[a-1]):o.push(t[a]);return o}function qr(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Kr(t,e,n){for(var r=t.slice(0,1),o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}function jr(t,e){if(t.rank<1)throw new Error(\"tf.gatherND() expects the input to be rank 1 or higher, but the rank was \"+t.rank+\".\");if(e.rank<1)throw new Error(\"tf.gatherND() expects the indices to be rank 1 or higher, but the rank was \"+e.rank+\".\");if(\"int32\"!==e.dtype)throw new Error(\"tf.gatherND() expects the indices to be int32 type, but the dtype was \"+e.dtype+\".\");if(e.shape[e.rank-1]>t.rank)throw new Error(\"index innermost dimension length must be <= tensor rank; saw: \"+e.shape[e.rank-1]+\" vs. \"+t.rank);if(0===t.size)throw new Error(\"Requested more than 0 entries, but input is empty. Input shape: \"+t.shape+\".\");for(var n=e.shape,r=n[n.length-1],o=1,a=0;a<n.length-1;++a)o*=n[a];var i=t.shape,s=n.slice();s.pop();var u=1;for(a=r;a<t.rank;++a)u*=i[a],s.push(i[a]);var c=$(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,o,u,c]}var Xr=Object.freeze({prepareAndValidate:jr}),Yr=30;function $r(t){return t<=Yr?t:Y(t,Math.floor(Math.sqrt(t)))}function Qr(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,a=\"Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: \"+n.shape+\", indices.shape: \"+e.shape+\", shape: \"+t+\", sliceDim: \"+r+\", and batchDim: \"+o+\".\";if(n.rank<o)throw new Error(a+\" update.rank < \"+o+\". \");if(t.length<r+(n.rank-o))throw new Error(a+\" Output shape length < \"+(r+(n.rank-o)));if(n.rank!==o+t.length-r)throw new Error(a+\" update.rank != \"+(o+t.length-r));for(var i=0;i<o;++i)if(n.shape[i]!==e.shape[i])throw new Error(a+\" updates.shape[\"+i+\"] (\"+n.shape[i]+\") != indices.shape[\"+i+\"] (\"+e.shape[i]+\").\");for(i=0;i<n.rank-o;++i)if(n.shape[i+o]!==t[i+r])throw new Error(a+\" updates.shape[\"+(i+o)+\"] (\"+n.shape[i+o]+\") != shape[\"+(i+o)+\"] (\"+t[i+o]+\")\")}function Jr(t,e,n){if(e.rank<1)throw new Error(\"tf.scatterND() expects the indices to be rank 1 or higher, but the rank was \"+e.rank+\".\");if(t.rank<1)throw new Error(\"tf.scatterND() expects the updates to be rank 1 or higher, but the rank was \"+t.rank+\".\");if(\"int32\"!==e.dtype)throw new Error(\"The dtype of 'indices' should be int32, but got dtype: \"+e.dtype);if(n.length<1)throw new Error(\"Output rank must be greater or equal to 1, but got shape: \"+n);if(0===n.length){if(0===e.size)throw new Error(\"Indices specified for empty output. indices shape: \"+e.shape);if(0===t.size)throw new Error(\"Updates specified for empty output. updates shape: \"+t.shape)}Qr(n,e,t)}function Zr(t,e,n){for(var r=e.shape.length,o=r>1?e.shape[r-1]:1,a=n.length,i=1,s=o;s<a;++s)i*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:k(e.shape)/u,sliceSize:i,strides:$(n.slice(0,o)).concat([1]),outputSize:k(n)}}var to=Object.freeze({validateUpdateShape:Qr,validateInput:Jr,calculateShapes:Zr});function eo(t,e,n){C(t.rank===e.length,(function(){return\"Error in slice\"+t.rank+\"D: Length of begin \"+e+\" must match the rank of the array (\"+t.rank+\").\"})),C(t.rank===n.length,(function(){return\"Error in slice\"+t.rank+\"D: Length of size \"+n+\" must match the rank of the array (\"+t.rank+\").\"}));for(var r=function(r){C(e[r]+n[r]<=t.shape[r],(function(){return\"Error in slice\"+t.rank+\"D: begin[\"+r+\"] + size[\"+r+\"] (\"+(e[r]+n[r])+\") would overflow input.shape[\"+r+\"] (\"+t.shape[r]+\")\"}))},o=0;o<t.rank;++o)r(o)}function no(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function ro(t,e,n){for(var r=[],o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function oo(t,e,n,r,o){var a=e[o],i=n[o]||1;(t&1<<o||null==a)&&(a=i>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return a<0&&(a+=s),a=x(0,a,s-1)}function ao(t,e,n,r,o){var a=e[o],i=n[o]||1;(t&1<<o||null==a)&&(a=i>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return a<0&&(a+=s),a=i>0?x(0,a,s):x(-1,a,s-1)}function io(t,e,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function so(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}var uo=Object.freeze({assertParamsValid:eo,maskToAxes:no,computeOutShape:ro,startForAxis:oo,stopForAxis:ao,isSliceContinous:io,computeFlatOffset:so});function co(t){return C(X(t),(function(){return\"The f passed in grad(f) must be a function\"})),function(e,n){var r=mn(e,\"x\",\"tf.grad\",null),o=null!=n?mn(n,\"dy\",\"tf.grad\"):null;return Lt.tidy((function(){var e=Lt.gradients((function(){return t(r)}),[r],o),n=e.value,a=e.grads;return null!=o&&E(n.shape,o.shape,\"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)\"),mo(a),a[0]}))}}function lo(t){return C(X(t),(function(){return\"The f passed in grads(f) must be a function\"})),function(e,n){C(Array.isArray(e),(function(){return\"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s\"}));var r=gn(e,\"args\",\"tf.grads\",null),o=null!=n?mn(n,\"dy\",\"tf.grads\"):null;return Lt.tidy((function(){var e=Lt.gradients((function(){return t.apply(void 0,r)}),r,o),n=e.value,a=e.grads;return null!=o&&E(n.shape,o.shape,\"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])\"),mo(a),a}))}}function ho(t){return C(X(t),(function(){return\"The f passed in valueAndGrad(f) must be a function\"})),function(e,n){C(e instanceof wt,(function(){return\"The x passed in valueAndGrad(f)(x) must be a tensor\"})),C(null==n||n instanceof wt,(function(){return\"The dy passed in valueAndGrad(f)(x, dy) must be a tensor\"}));var r=Lt.gradients((function(){return t(e)}),[e],n),o=r.grads,a=r.value;return mo(o),{grad:o[0],value:a}}}function fo(t){return C(X(t),(function(){return\"The f passed in valueAndGrads(f) must be a function\"})),function(e,n){C(Array.isArray(e)&&e.every((function(t){return t instanceof wt})),(function(){return\"The args passed in valueAndGrads(f)(args) must be array of tensors\"})),C(null==n||n instanceof wt,(function(){return\"The dy passed in valueAndGrads(f)(args, dy) must be a tensor\"}));var r=Lt.gradients((function(){return t.apply(void 0,e)}),e,n);return null!=n&&E(r.value.shape,n.shape,\"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])\"),mo(r.grads),r}}function po(t,e){C(X(t),(function(){return\"The f passed in variableGrads(f) must be a function\"})),C(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof St})),(function(){return\"The varList passed in variableGrads(f, varList) must be an array of variables\"}));var n=null!=e;if(!n)for(var r in e=[],Lt.registeredVariables)e.push(Lt.registeredVariables[r]);var o=n?e.filter((function(t){return!t.trainable})):null,a=e.length;C((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return\"variableGrads() expects at least one of the input variables to be trainable, but none of the \"+a+\" variables is trainable.\"}));var i=Lt.gradients(t,e,null,!0),s=i.value,u=i.grads;C(u.some((function(t){return null!=t})),(function(){return\"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().\"})),C(0===s.rank,(function(){return\"The f passed in variableGrads(f) must return a scalar, but it returned a rank-\"+s.rank+\" tensor\"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=o&&o.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}function vo(t){return Lt.customGrad(t)}function mo(t){if(t.filter((function(t){return null==t})).length>0)throw new Error(\"Cannot compute gradient of y=f(x) with respect to x. Make sure that\\n    the f you passed encloses all operations that lead from x to y.\")}var go=An({softmax_:function(t,e){void 0===e&&(e=-1);var n=mn(t,\"logits\",\"softmax\",\"float32\");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(\"Softmax along a non-last dimension is not yet supported. Logits was rank \"+n.rank+\" and dim was \"+e);return Lt.runKernelFunc((function(t,r){var o=t.softmax(n,e);return r([o]),o}),{logits:n},(function(t,n){var r=n[0],o=t.mul(r);return{logits:function(){return o.sub(o.sum([e],!0).mul(r))}}}),\"Softmax\",{dim:e},[],[!0])}}),yo=An({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=mn(t,\"logits\",\"logSoftmax\");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(\"Log Softmax along a non-last dimension is not yet supported. Logits was rank \"+n.rank+\" and axis was \"+e);return vo((function(t,n){var r=t.max(e,!0),o=t.sub(r),a=o.toFloat().sub(o.exp().sum(e,!0).log());n([a]);return{value:a,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),xo=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),bo=function(){function t(){}return t.prototype.time=function(t){return wo(\"time\")},t.prototype.read=function(t){return wo(\"read\")},t.prototype.readSync=function(t){return wo(\"readSync\")},t.prototype.numDataIds=function(){return wo(\"numDataIds\")},t.prototype.disposeData=function(t){return wo(\"disposeData\")},t.prototype.write=function(t,e,n){return wo(\"write\")},t.prototype.move=function(t,e,n,r){return wo(\"move\")},t.prototype.memory=function(){return wo(\"memory\")},t.prototype.floatPrecision=function(){return wo(\"floatPrecision\")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){return wo(\"batchMatMul\")},t.prototype.fusedBatchMatMul=function(t){t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights;return wo(\"fusedBatchMatMul\")},t.prototype.slice=function(t,e,n){return wo(\"slice\")},t.prototype.stridedSlice=function(t,e,n,r){return wo(\"stridedSlice\")},t.prototype.unstack=function(t,e){return wo(\"unstack\")},t.prototype.reverse=function(t,e){return wo(\"reverse\")},t.prototype.concat=function(t,e){return wo(\"concat\")},t.prototype.neg=function(t){return wo(\"neg\")},t.prototype.add=function(t,e){return wo(\"add\")},t.prototype.addN=function(t){return wo(\"addN\")},t.prototype.subtract=function(t,e){return wo(\"subtract\")},t.prototype.multiply=function(t,e){return wo(\"multiply\")},t.prototype.realDivide=function(t,e){return wo(\"realDivide\")},t.prototype.floorDiv=function(t,e){return wo(\"floorDiv\")},t.prototype.sum=function(t,e){return wo(\"sum\")},t.prototype.prod=function(t,e){return wo(\"prod\")},t.prototype.unsortedSegmentSum=function(t,e,n){return wo(\"unsortedSegmentSum\")},t.prototype.argMin=function(t,e){return wo(\"argMin\")},t.prototype.argMax=function(t,e){return wo(\"argMax\")},t.prototype.equal=function(t,e){return wo(\"equal\")},t.prototype.notEqual=function(t,e){return wo(\"notEqual\")},t.prototype.less=function(t,e){return wo(\"less\")},t.prototype.lessEqual=function(t,e){return wo(\"lessEqual\")},t.prototype.greater=function(t,e){return wo(\"greater\")},t.prototype.greaterEqual=function(t,e){return wo(\"greaterEqual\")},t.prototype.logicalNot=function(t){return wo(\"logicalNot\")},t.prototype.logicalAnd=function(t,e){return wo(\"logicalAnd\")},t.prototype.logicalOr=function(t,e){return wo(\"logicalOr\")},t.prototype.where=function(t){return wo(\"where\")},t.prototype.select=function(t,e,n){return wo(\"select\")},t.prototype.topk=function(t,e,n){return wo(\"topk\")},t.prototype.min=function(t,e){return wo(\"min\")},t.prototype.minimum=function(t,e){return wo(\"minimum\")},t.prototype.mod=function(t,e){return wo(\"mod\")},t.prototype.max=function(t,e){return wo(\"max\")},t.prototype.maximum=function(t,e){return wo(\"maximum\")},t.prototype.all=function(t,e){return wo(\"all\")},t.prototype.any=function(t,e){return wo(\"any\")},t.prototype.squaredDifference=function(t,e){return wo(\"squaredDifference\")},t.prototype.ceil=function(t){return wo(\"ceil\")},t.prototype.floor=function(t){return wo(\"floor\")},t.prototype.round=function(t){return wo(\"round\")},t.prototype.sign=function(t){return wo(\"sign\")},t.prototype.isNaN=function(t){return wo(\"isNaN\")},t.prototype.isInf=function(t){return wo(\"isInf\")},t.prototype.isFinite=function(t){return wo(\"isFinite\")},t.prototype.pow=function(t,e){return wo(\"pow\")},t.prototype.exp=function(t){return wo(\"exp\")},t.prototype.expm1=function(t){return wo(\"expm1\")},t.prototype.softmax=function(t,e){return wo(\"softmax\")},t.prototype.log=function(t){return wo(\"log\")},t.prototype.log1p=function(t){return wo(\"log1p\")},t.prototype.sqrt=function(t){return wo(\"sqrt\")},t.prototype.rsqrt=function(t){return wo(\"rsqrt\")},t.prototype.square=function(t){return wo(\"square\")},t.prototype.reciprocal=function(t){return wo(\"reciprocal\")},t.prototype.relu=function(t){return wo(\"relu\")},t.prototype.relu6=function(t){return wo(\"relu6\")},t.prototype.prelu=function(t,e){return wo(\"prelu\")},t.prototype.elu=function(t){return wo(\"elu\")},t.prototype.eluDer=function(t,e){return wo(\"eluDer\")},t.prototype.selu=function(t){return wo(\"selu\")},t.prototype.int=function(t){return wo(\"int\")},t.prototype.clip=function(t,e,n){return wo(\"clip\")},t.prototype.abs=function(t){return wo(\"abs\")},t.prototype.complexAbs=function(t){return wo(\"complexAbs\")},t.prototype.sigmoid=function(t){return wo(\"sigmoid\")},t.prototype.softplus=function(t){return wo(\"softplus\")},t.prototype.sin=function(t){return wo(\"sin\")},t.prototype.cos=function(t){return wo(\"cos\")},t.prototype.tan=function(t){return wo(\"tan\")},t.prototype.asin=function(t){return wo(\"asin\")},t.prototype.acos=function(t){return wo(\"acos\")},t.prototype.atan=function(t){return wo(\"atan\")},t.prototype.atan2=function(t,e){return wo(\"atan2\")},t.prototype.sinh=function(t){return wo(\"sinh\")},t.prototype.cosh=function(t){return wo(\"cosh\")},t.prototype.tanh=function(t){return wo(\"tanh\")},t.prototype.asinh=function(t){return wo(\"asinh\")},t.prototype.acosh=function(t){return wo(\"acosh\")},t.prototype.atanh=function(t){return wo(\"atanh\")},t.prototype.erf=function(t){return wo(\"erf\")},t.prototype.step=function(t,e){return wo(\"step\")},t.prototype.fusedConv2d=function(t){t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights;return wo(\"fusedConv2d\")},t.prototype.conv2d=function(t,e,n){return wo(\"conv2d\")},t.prototype.conv2dDerInput=function(t,e,n){return wo(\"conv2dDerInput\")},t.prototype.conv2dDerFilter=function(t,e,n){return wo(\"conv2dDerFilter\")},t.prototype.fusedDepthwiseConv2D=function(t){t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights;return wo(\"fusedDepthwiseConv2D\")},t.prototype.depthwiseConv2D=function(t,e,n){return wo(\"depthwiseConv2D\")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){return wo(\"depthwiseConv2DDerInput\")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){return wo(\"depthwiseConv2DDerFilter\")},t.prototype.conv3d=function(t,e,n){return wo(\"conv3d\")},t.prototype.conv3dDerInput=function(t,e,n){return wo(\"conv3dDerInput\")},t.prototype.conv3dDerFilter=function(t,e,n){return wo(\"conv3dDerFilter\")},t.prototype.maxPool=function(t,e){return wo(\"maxPool\")},t.prototype.maxPoolBackprop=function(t,e,n,r){return wo(\"maxPoolBackprop\")},t.prototype.avgPool=function(t,e){return wo(\"avgPool\")},t.prototype.avgPoolBackprop=function(t,e,n){return wo(\"avgPoolBackprop\")},t.prototype.avgPool3d=function(t,e){return wo(\"avgPool3d\")},t.prototype.avgPool3dBackprop=function(t,e,n){return wo(\"avgPool3dBackprop\")},t.prototype.maxPool3d=function(t,e){return wo(\"maxPool3d\")},t.prototype.maxPool3dBackprop=function(t,e,n,r){return wo(\"maxPool3dBackprop\")},t.prototype.reshape=function(t,e){return wo(\"reshape\")},t.prototype.cast=function(t,e){return wo(\"cast\")},t.prototype.tile=function(t,e){return wo(\"tile\")},t.prototype.pad=function(t,e,n){return wo(\"pad\")},t.prototype.transpose=function(t,e){return wo(\"transpose\")},t.prototype.gather=function(t,e,n){return wo(\"gather\")},t.prototype.gatherND=function(t,e){return wo(\"gatherND\")},t.prototype.scatterND=function(t,e,n){return wo(\"scatterND\")},t.prototype.batchToSpaceND=function(t,e,n){return wo(\"batchToSpaceND\")},t.prototype.spaceToBatchND=function(t,e,n){return wo(\"spaceToBatchND\")},t.prototype.resizeBilinear=function(t,e,n,r){return wo(\"resizeBilinear\")},t.prototype.resizeBilinearBackprop=function(t,e,n){return wo(\"resizeBilinearBackprop\")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){return wo(\"resizeNearestNeighbor\")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){return wo(\"resizeNearestNeighborBackprop\")},t.prototype.batchNormalization=function(t,e,n,r,o,a){return wo(\"batchNormalization\")},t.prototype.localResponseNormalization4D=function(t,e,n,r,o){return wo(\"localResponseNormalization4D\")},t.prototype.LRNGrad=function(t,e,n,r,o,a,i){return wo(\"LRNGrad\")},t.prototype.multinomial=function(t,e,n,r){return wo(\"multinomial\")},t.prototype.oneHot=function(t,e,n,r){return wo(\"oneHot\")},t.prototype.cumsum=function(t,e,n,r){return wo(\"cumsum\")},t.prototype.nonMaxSuppression=function(t,e,n,r,o){return wo(\"nonMaxSuppression\")},t.prototype.fft=function(t){return wo(\"fft\")},t.prototype.ifft=function(t){return wo(\"ifft\")},t.prototype.complex=function(t,e){return wo(\"complex\")},t.prototype.real=function(t){return wo(\"real\")},t.prototype.imag=function(t){return wo(\"imag\")},t.prototype.cropAndResize=function(t,e,n,r,o,a){return wo(\"cropAndResize\")},t.prototype.depthToSpace=function(t,e,n){return wo(\"depthToSpace\")},t.prototype.split=function(t,e,n){return wo(\"split\")},t.prototype.sparseToDense=function(t,e,n,r){return wo(\"sparseToDense\")},t.prototype.diag=function(t){return wo(\"diag\")},t.prototype.fill=function(t,e,n){return wo(\"fill\")},t.prototype.onesLike=function(t){return wo(\"onesLike\")},t.prototype.zerosLike=function(t){return wo(\"zerosLike\")},t.prototype.linspace=function(t,e,n){return wo(\"linspace\")},t.prototype.dispose=function(){return wo(\"dispose\")},t}();function wo(t){throw new Error(\"'\"+t+\"' not yet implemented or not found in the registry. Did you forget to import the kernel?\")}function Co(t,e){for(var n=t.length,r=[],o=0;o<n;o++){var a=n-1-o,i=t[a]||1;(e[e.length-1-o]||1)>1&&1===i&&r.unshift(a)}return r}function Eo(t,e){for(var n=[],r=0;r<e.length;r++){var o=t[t.length-r-1],a=e.length-r-1,i=e[a];(null==o||1===o&&i>1)&&n.unshift(a)}return n}function Ro(t,e){for(var n=[],r=Math.max(t.length,e.length),o=0;o<r;o++){var a=t[t.length-o-1];null==a&&(a=1);var i=e[e.length-o-1];if(null==i&&(i=1),1===a)n.unshift(i);else if(1===i)n.unshift(a);else{if(a!==i)throw Error(\"Operands could not be broadcast together with shapes \"+t+\" and \"+e+\".\");n.unshift(a)}}return n}function Io(t,e,n,r,o,a,i){void 0===i&&(i=\"channelsLast\");var s,u=To(e),c=u[0],l=u[1];if(\"channelsLast\"===i)s=[c,l,t[3],t[3]];else{if(\"channelsFirst\"!==i)throw new Error(\"Unknown dataFormat \"+i);s=[c,l,t[1],t[1]]}return So(t,s,n,r,o,a,!1,i)}function ko(t,e,n,r,o,a,i){void 0===i&&(i=\"NDHWC\");var s,u,c=No(e),l=c[0],h=c[1],f=c[2];if(\"NDHWC\"===i)u=\"channelsLast\",s=[l,h,f,t[4],t[4]];else{if(\"NCDHW\"!==i)throw new Error(\"Unknown dataFormat \"+i);u=\"channelsFirst\",s=[l,h,f,t[1],t[1]]}return Ao(t,s,n,r,o,!1,u,a)}function So(t,e,n,r,o,a,i,s){void 0===i&&(i=!1),void 0===s&&(s=\"channelsLast\");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3];if(\"channelsLast\"===s)c=t[0],l=t[1],h=t[2],f=t[3];else{if(\"channelsFirst\"!==s)throw new Error(\"Unknown dataFormat \"+s);c=t[0],f=t[1],l=t[2],h=t[3]}var d,p=e[0],v=e[1],m=e[3],g=To(n),y=g[0],x=g[1],b=To(r),w=b[0],E=b[1],R=Fo(p,w),I=Fo(v,E),k=function(t,e,n,r,o,a,i,s){var u,c,l;if(\"number\"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?\"VALID\":\"NUMBER\"};var h=function(t,e,n,r,o){null==r&&(r=Do(t,e,n));var a=t[0],i=t[1],s=_o((a-e+2*r)/n+1,o);C(A(s),(function(){return\"The output # of rows (\"+s+\") must be an integer. Change the stride and/or zero pad parameters\"}));var u=_o((i-e+2*r)/n+1,o);return C(A(u),(function(){return\"The output # of columns (\"+u+\") must be an integer. Change the stride and/or zero pad parameters\"})),[s,u]}([e,n],a,r,t,s);c=h[0],l=h[1]}else if(\"same\"===t){c=Math.ceil(e/r),l=Math.ceil(n/o);var f=Math.max(0,(c-1)*r+a-e),d=Math.max(0,(l-1)*o+i-n),p=Math.floor(f/2),v=f-p,m=Math.floor(d/2);u={top:p,bottom:v,left:m,right:d-m,type:\"SAME\"}}else{if(\"valid\"!==t)throw Error(\"Unknown padding parameter: \"+t);u={top:0,bottom:0,left:0,right:0,type:\"VALID\"},c=Math.ceil((e-a+1)/r),l=Math.ceil((n-i+1)/o)}return{padInfo:u,outHeight:c,outWidth:l}}(o,l,h,y,x,R,I,a),S=k.padInfo,D=k.outHeight,T=k.outWidth,N=i?m*f:m;return\"channelsFirst\"===s?d=[c,N,D,T]:\"channelsLast\"===s&&(d=[c,D,T,N]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:h,inChannels:f,outHeight:D,outWidth:T,outChannels:N,padInfo:S,strideHeight:y,strideWidth:x,filterHeight:p,filterWidth:v,effectiveFilterHeight:R,effectiveFilterWidth:I,dilationHeight:w,dilationWidth:E,inShape:t,outShape:d,filterShape:e}}function Ao(t,e,n,r,o,a,i,s){void 0===a&&(a=!1),void 0===i&&(i=\"channelsLast\");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3],d=u[4];if(\"channelsLast\"===i)c=t[0],l=t[1],h=t[2],f=t[3],d=t[4];else{if(\"channelsFirst\"!==i)throw new Error(\"Unknown dataFormat \"+i);c=t[0],d=t[1],l=t[2],h=t[3],f=t[4]}var p,v=e[0],m=e[1],g=e[2],y=e[4],x=No(n),b=x[0],w=x[1],E=x[2],R=No(r),I=R[0],k=R[1],S=R[2],D=Fo(v,I),T=Fo(m,k),N=Fo(g,S),F=function(t,e,n,r,o,a,i,s,u,c,l){var h,f,d,p;if(\"number\"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?\"VALID\":\"NUMBER\"};var v=function(t,e,n,r,o,a){null==o&&(o=Do(t,e,r));var i=t[0],s=t[1],u=t[2],c=_o((i-e+2*o)/r+1,a);C(A(c),(function(){return\"The output # of depths (\"+c+\") must be an integer. Change the stride and/or zero pad parameters\"}));var l=_o((s-e+2*o)/r+1,a);C(A(l),(function(){return\"The output # of rows (\"+l+\") must be an integer. Change the stride and/or zero pad parameters\"}));var h=_o((u-e+2*o)/r+1,a);return C(A(h),(function(){return\"The output # of columns (\"+h+\") must be an integer. Change the stride and/or zero pad parameters\"})),[c,l,h,n]}([e,n,r,1],s,1,o,t,l);f=v[0],d=v[1],p=v[2]}else if(\"same\"===t){f=Math.ceil(e/o),d=Math.ceil(n/a),p=Math.ceil(r/i);var m=(f-1)*o+s-e,g=(d-1)*a+u-n,y=(p-1)*i+c-r,x=Math.floor(m/2),b=m-x,w=Math.floor(g/2),E=g-w,R=Math.floor(y/2);h={top:w,bottom:E,left:R,right:y-R,front:x,back:b,type:\"SAME\"}}else{if(\"valid\"!==t)throw Error(\"Unknown padding parameter: \"+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:\"VALID\"},f=Math.ceil((e-s+1)/o),d=Math.ceil((n-u+1)/a),p=Math.ceil((r-c+1)/i)}return{padInfo:h,outDepth:f,outHeight:d,outWidth:p}}(o,l,h,f,b,w,E,D,T,N,s),_=F.padInfo,O=F.outDepth,M=F.outHeight,B=F.outWidth,P=a?y*d:y;return\"channelsFirst\"===i?p=[c,P,O,M,B]:\"channelsLast\"===i&&(p=[c,O,M,B,P]),{batchSize:c,dataFormat:i,inDepth:l,inHeight:h,inWidth:f,inChannels:d,outDepth:O,outHeight:M,outWidth:B,outChannels:P,padInfo:_,strideDepth:b,strideHeight:w,strideWidth:E,filterDepth:v,filterHeight:m,filterWidth:g,effectiveFilterDepth:D,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationDepth:I,dilationHeight:k,dilationWidth:S,inShape:t,outShape:p,filterShape:e}}function Do(t,e,n,r){void 0===r&&(r=1);var o=Fo(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function To(t){return\"number\"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function No(t){return\"number\"==typeof t?[t,t,t]:t}function Fo(t,e){return e<=1?t:t+(t-1)*(e-1)}function _o(t,e){if(!e)return t;switch(e){case\"round\":return Math.round(t);case\"ceil\":return Math.ceil(t);case\"floor\":return Math.floor(t);default:throw new Error(\"Unknown roundingMode \"+e)}}function Oo(t){var e=To(t),n=e[0],r=e[1],o=e[2];return 1===n&&1===r&&1===o}function Mo(t,e){return Oo(t)||Oo(e)}function Bo(t){if(\"NHWC\"===t)return\"channelsLast\";if(\"NCHW\"===t)return\"channelsFirst\";throw new Error(\"Unknown dataFormat \"+t)}function Po(t,e,n){if(\"complex64\"===e){if(\"complex64\"===t.dtype)return t.clone();var r=Gn(t.shape),o=t.toFloat(),a=n.complex(o,r);return r.dispose(),o.dispose(),a}if(!U(t.dtype,e))return Lt.makeTensorFromDataId(t.dataId,t.shape,e);if(\"complex64\"===t.dtype){var i=n.real(t);a=i.cast(e);return i.dispose(),a}if(\"int32\"===e)return n.int(t);if(\"bool\"===e){var s=On(0,t.dtype);a=n.notEqual(t,s);return s.dispose(),a}throw new Error(\"Error in Cast: failed to cast \"+t.dtype+\" to \"+e)}function Lo(t,e){return Lt.makeTensorFromDataId(t.dataId,e,t.dtype)}function Wo(t,e,n){var r=(e-t)/(n-1),o=tt(n,\"float32\");o[0]=t;for(var a=1;a<o.length;a++)o[a]=o[a-1]+r;return Mn(o,\"float32\")}var Uo=Object.freeze({castTensor:Po,reshapeTensor:Lo,linspaceImpl:Wo,upcastType:Dt,axesAreInnerMostDims:yn,combineLocations:xn,computeOutAndReduceShapes:bn,expandShapeToKeepDim:wn,assertAxesAreInnerMostDims:Cn,getAxesPermutation:En,getUndoAxesPermutation:Rn,getInnerMostAxes:In,getBroadcastDims:Co,getReductionAxes:Eo,assertAndGetBroadcastShape:Ro,assertParamsConsistent:kn,computeOutShape:Sn,computePool2DInfo:Io,computePool3DInfo:ko,computeConv2DInfo:So,computeConv3DInfo:Ao,computeDefaultPad:Do,tupleValuesAreOne:Oo,eitherStridesOrDilationsAreOne:Mo,convertConv2DDataFormat:Bo,PARALLELIZE_THRESHOLD:Yr,computeOptimalWindowSize:$r});function Vo(t,e){if(t.length!==e.length)throw new Error(\"Cannot merge real and imag arrays of different lengths. real:\"+t.length+\", imag: \"+e.length+\".\");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function zo(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Go(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Ho(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function qo(t,e,n){var r=function(t,e,n){return function(t,e,n){var r=0,o=t.length,a=0,i=!1;for(;r<o;){var s=n(e,t[a=r+(o-r>>>1)]);s>0?r=a+1:(o=a,i=!s)}return i?r:-r-1}(t,e,n||Ko)}(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function Ko(t,e){return t>e?1:t<e?-1:0}function jo(t,e,n,r,o){return Yo(t,e,n,r,o,0).selectedIndices}function Xo(t,e,n,r,o,a){var i=Yo(t,e,n,r,o,a,!0);return i.numValidOutputs.dispose(),{selectedIndices:i.selectedIndices,selectedScores:i.selectedScores}}function Yo(t,e,n,r,o,a,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1);for(var u=Array.from(e).map((function(t,e){return{score:t,boxIndex:e,suppressBeginIndex:0}})).filter((function(t){return t.score>o})).sort(Jo),c=a>0?-.5/a:0,l=[],h=[];l.length<n&&u.length>0;){var f=u.pop(),d=f.score,p=f.boxIndex,v=f.suppressBeginIndex;if(d<o)break;for(var m=!1,g=l.length-1;g>=v;--g){var y=$o(t,p,l[g]);if(y>=r){m=!0;break}if(f.score=f.score*Qo(r,c,y),f.score<=o)break}f.suppressBeginIndex=l.length,m||(f.score===d?(l.push(p),h.push(f.score)):f.score>o&&qo(u,f,Jo))}var x=l.length;return s&&(l.fill(0,x),h.fill(0,x)),{selectedIndices:Mn(l,\"int32\"),selectedScores:Mn(h,\"float32\"),numValidOutputs:On(x,\"int32\")}}function $o(t,e,n){var r=t.subarray(4*e,4*e+4),o=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),h=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),d=(s-a)*(u-i),p=(h-c)*(f-l);if(d<=0||p<=0)return 0;var v=Math.max(a,c),m=Math.max(i,l),g=Math.min(s,h),y=Math.min(u,f),x=Math.max(g-v,0)*Math.max(y-m,0);return x/(d+p-x)}function Qo(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Jo(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function Zo(t,e,n){var r=new Array(t.rank).fill(0),o=t.shape.slice();return e.map((function(e){o[n]=e;var a=t.slice(r,o);return r[n]+=e,a}))}function ta(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var o=dr(n,t.dtype);for(r=0;r<o.values.length;++r){for(var a=o.indexToLoc(r),i=new Array(t.rank),s=0;s<i.length;s++)i[s]=a[s]%t.shape[s];var u=t.locToIndex(i);o.values[r]=t.values[u]}return o.toTensor()}function ea(t,e,n,r,o){for(var a=e[e.length-1],i=[t.length/a,a],s=i[0],u=i[1],c=B(n,s*r),l=B(\"int32\",s*r),h=0;h<s;h++){for(var f=h*u,d=t.subarray(f,f+u),p=[],v=0;v<d.length;v++)p.push({value:d[v],index:v});p.sort((function(t,e){return e.value-t.value}));var m=h*r,g=c.subarray(m,m+r),y=l.subarray(m,m+r);for(v=0;v<r;v++)g[v]=p[v].value,y[v]=p[v].index}var x=e.slice();return x[x.length-1]=r,[Fn(c,x,n),Fn(l,x,\"int32\")]}function na(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var o=dr(t,\"int32\"),a=dr([n.length,t.length],\"int32\");for(r=0;r<n.length;r++){var i=o.indexToLoc(n[r]),s=r*t.length;a.values.set(i,s)}return a.toTensor()}var ra=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return\"T\"+e}));var n=[];this.variableNames.forEach((function(t){n.push(\"float v\"+t+\" = get\"+t+\"AtOutCoords();\")}));var r=this.variableNames.map((function(t){return\"v\"+t})).join(\" + \");this.userCode=\"\\n      void main() {\\n        \"+n.join(\"\\n        \")+\"\\n\\n        float result = \"+r+\";\\n        setOutput(result);\\n      }\\n    \"},oa=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return\"T\"+e}));var n=[];this.variableNames.forEach((function(t){n.push(\"vec4 v\"+t+\" = get\"+t+\"AtOutCoords();\")}));var r=this.variableNames.map((function(t){return\"v\"+t})).join(\" + \");this.userCode=\"\\n      void main() {\\n        \"+n.join(\"\\n        \")+\"\\n\\n        vec4 result = \"+r+\";\\n        setOutput(result);\\n      }\\n    \"},aa=function(t,e,n){this.variableNames=[\"A\"];var r=t.windowSize,o=t.batchSize,a=t.inSize,i=Math.ceil(a/r);n||this.variableNames.push(\"bestIndicesA\"),this.outputShape=[o,i];var s=\"max\"===e?\">\":\"<\",u=n?\"inOffset + i;\":\"round(getBestIndicesA(batch, inOffset + i));\";this.userCode=\"\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int outIdx = coords[1];\\n        int inOffset = outIdx * \"+r+\";\\n\\n        int bestIndex = inOffset;\\n        float bestValue = getA(batch, bestIndex);\\n\\n        for (int i = 0; i < \"+r+\"; i++) {\\n          int inIdx = \"+u+\";\\n          float candidate = getA(batch, inIdx);\\n          if (candidate \"+s+\" bestValue) {\\n            bestValue = candidate;\\n            bestIndex = inIdx;\\n          }\\n        }\\n        setOutput(float(bestIndex));\\n      }\\n    \"};function ia(t,e){return[\"x\",\"y\",\"z\",\"w\",\"u\",\"v\"].slice(0,e).map((function(e){return t+\".\"+e}))}function sa(t,e){return 1===e?[t]:ia(t,e)}function ua(){var t,e,n,r,o,a,s,u,c,l;return 2===i().getNumber(\"WEBGL_VERSION\")?(t=\"#version 300 es\",e=\"in\",n=\"out\",r=\"in\",o=\"texture\",a=\"outputColor\",s=\"out vec4 outputColor;\",u=\"\\n      bool isnan_custom(float val) {\\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\\n      }\\n\\n      bvec4 isnan_custom(vec4 val) {\\n        return bvec4(isnan_custom(val.x),\\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\\n      }\\n\\n      #define isnan(value) isnan_custom(value)\\n    \",c=\"\",l=\"\\n      #define round(value) newRound(value)\\n      int newRound(float value) {\\n        return int(floor(value + 0.5));\\n      }\\n\\n      ivec4 newRound(vec4 value) {\\n        return ivec4(floor(value + vec4(0.5)));\\n      }\\n    \"):(t=\"\",e=\"attribute\",n=\"varying\",r=\"varying\",o=\"texture2D\",a=\"gl_FragColor\",s=\"\",u=\"\\n      #define isnan(value) isnan_custom(value)\\n      bool isnan_custom(float val) {\\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\\n      }\\n      bvec4 isnan_custom(vec4 val) {\\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\\n      }\\n    \",c=\"\\n      uniform float INFINITY;\\n\\n      bool isinf(float val) {\\n        return abs(val) == INFINITY;\\n      }\\n      bvec4 isinf(vec4 val) {\\n        return equal(abs(val), vec4(INFINITY));\\n      }\\n    \",l=\"\\n      int round(float value) {\\n        return int(floor(value + 0.5));\\n      }\\n\\n      ivec4 round(vec4 value) {\\n        return ivec4(floor(value + vec4(0.5)));\\n      }\\n    \"),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:a,defineOutput:s,defineSpecialNaN:u,defineSpecialInf:c,defineRound:l}}function ca(t,e,n){void 0===n&&(n=\"index\");var r=$(e);return r.map((function(e,o){return\"int \"+t[o]+\" = \"+n+\" / \"+e+\"; \"+(o===r.length-1?\"int \"+t[o+1]+\" = \"+n+\" - \"+t[o]+\" * \"+e:\"index -= \"+t[o]+\" * \"+e)+\";\"})).join(\"\")}function la(t){var e=$(t).map((function(t){return t.toString()}));return\"\\n  int getFlatIndex(ivec3 coords) {\\n    return coords.x * \"+e[0]+\" + coords.y * \"+e[1]+\" + coords.z;\\n  }\\n\"}var ha=\"\\n  const float FLOAT_MAX = 1.70141184e38;\\n  const float FLOAT_MIN = 1.17549435e-38;\\n\\n  lowp vec4 encode_float(highp float v) {\\n    if (isnan(v)) {\\n      return vec4(255, 255, 255, 255);\\n    }\\n\\n    highp float av = abs(v);\\n\\n    if(av < FLOAT_MIN) {\\n      return vec4(0.0, 0.0, 0.0, 0.0);\\n    } else if(v > FLOAT_MAX) {\\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\\n    } else if(v < -FLOAT_MAX) {\\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\\n    }\\n\\n    highp vec4 c = vec4(0,0,0,0);\\n\\n    highp float e = floor(log2(av));\\n    highp float m = exp2(fract(log2(av))) - 1.0;\\n\\n    c[2] = floor(128.0 * m);\\n    m -= c[2] / 128.0;\\n    c[1] = floor(32768.0 * m);\\n    m -= c[1] / 32768.0;\\n    c[0] = floor(8388608.0 * m);\\n\\n    highp float ebias = e + 127.0;\\n    c[3] = floor(ebias / 2.0);\\n    ebias -= c[3] * 2.0;\\n    c[2] += floor(ebias) * 128.0;\\n\\n    c[3] += 128.0 * step(0.0, -v);\\n\\n    return c / 255.0;\\n  }\\n\";function fa(t,e,n,r){var o=[];t.forEach((function(t){var e=k(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?o.push(\"uniform float \"+t.name+(e>1?\"[\"+e+\"]\":\"\")+\";\"):(o.push(\"uniform sampler2D \"+t.name+\";\"),o.push(\"uniform int offset\"+t.name+\";\"))}));var a,i,s=o.join(\"\\n\"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r=\"\";r+=n?pa(t):da(t);var o=t.shapeInfo.logicalShape,a=e.logicalShape;o.length<=a.length&&(r+=n?function(t,e){var n,r=t.name,o=r.charAt(0).toUpperCase()+r.slice(1),a=\"get\"+o+\"AtOutCoords\",i=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,u=Co(t.shapeInfo.logicalShape,e.logicalShape),c=wa(s),l=s-i,h=[\"x\",\"y\",\"z\",\"w\",\"u\",\"v\"];n=0===i?\"\":s<2&&u.length>=1?\"coords = 0;\":u.map((function(t){return\"coords.\"+h[t+l]+\" = 0;\"})).join(\"\\n\");var f=\"\";f=s<2&&i>0?\"coords\":t.shapeInfo.logicalShape.map((function(t,e){return\"coords.\"+h[e+l]})).join(\", \");var d=\"return outputValue;\",p=1===k(t.shapeInfo.logicalShape),v=1===k(e.logicalShape);if(1!==i||p||v){if(p&&!v)d=1===s?\"\\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\\n      \":\"\\n        return vec4(outputValue.x);\\n      \";else if(u.length){var m=i-2,g=i-1;u.indexOf(m)>-1&&u.indexOf(g)>-1?d=\"return vec4(outputValue.x);\":u.indexOf(m)>-1?d=\"return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);\":u.indexOf(g)>-1&&(d=\"return vec4(outputValue.xx, outputValue.zz);\")}}else d=\"\\n      return vec4(outputValue.xy, outputValue.xy);\\n    \";return\"\\n    vec4 \"+a+\"() {\\n      \"+c+\" coords = getOutputCoords();\\n      \"+n+\"\\n      vec4 outputValue = get\"+o+\"(\"+f+\");\\n      \"+d+\"\\n    }\\n  \"}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),o=\"get\"+r+\"AtOutCoords\",a=e.texShape,i=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===u&&null==t.shapeInfo.flatOffset&&S(i,a))return\"\\n      float \"+o+\"() {\\n        return sampleTexture(\"+n+\", resultUV);\\n      }\\n    \";var c,l=wa(u),h=Co(t.shapeInfo.logicalShape,e.logicalShape),f=u-s,d=[\"x\",\"y\",\"z\",\"w\",\"u\",\"v\"];c=0===s?\"\":u<2&&h.length>=1?\"coords = 0;\":h.map((function(t){return\"coords.\"+d[t+f]+\" = 0;\"})).join(\"\\n\");var p=\"\";p=u<2&&s>0?\"coords\":t.shapeInfo.logicalShape.map((function(t,e){return\"coords.\"+d[e+f]})).join(\", \");return\"\\n    float \"+o+\"() {\\n      \"+l+\" coords = getOutputCoords();\\n      \"+c+\"\\n      return get\"+r+\"(\"+p+\");\\n    }\\n  \"}(t,e));return r}(t,e,r)})).join(\"\\n\"),c=e.texShape,l=ua(),h=function(t){return\"\\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\\n      return \"+t.texture2D+\"(textureSampler, uv).r;\\n    }\\n  \"}(l),f=function(t){return t.version+\"\\n    precision highp float;\\n    precision highp int;\\n    precision highp sampler2D;\\n    \"+t.varyingFs+\" vec2 resultUV;\\n    \"+t.defineOutput+\"\\n    const vec2 halfCR = vec2(0.5, 0.5);\\n\\n    struct ivec5\\n    {\\n      int x;\\n      int y;\\n      int z;\\n      int w;\\n      int u;\\n    };\\n\\n    struct ivec6\\n    {\\n      int x;\\n      int y;\\n      int z;\\n      int w;\\n      int u;\\n      int v;\\n    };\\n\\n    uniform float NAN;\\n    \"+t.defineSpecialNaN+\"\\n    \"+t.defineSpecialInf+\"\\n    \"+t.defineRound+\"\\n\\n    int imod(int x, int y) {\\n      return x - y * (x / y);\\n    }\\n\\n    int idiv(int a, int b, float sign) {\\n      int res = a / b;\\n      int mod = imod(a, b);\\n      if (sign < 0. && mod != 0) {\\n        res -= 1;\\n      }\\n      return res;\\n    }\\n\\n    //Based on the work of Dave Hoskins\\n    //https://www.shadertoy.com/view/4djSRW\\n    #define HASHSCALE1 443.8975\\n    float random(float seed){\\n      vec2 p = resultUV * seed;\\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\\n      p3 += dot(p3, p3.yzx + 19.19);\\n      return fract((p3.x + p3.y) * p3.z);\\n    }\\n\\n    \"+va+\"\\n    \"+ma+\"\\n    \"+ga+\"\\n  \"}(l);return e.isPacked?(a=function(t,e){switch(t.length){case 0:return\"\\n    int getOutputCoords() {\\n      return 0;\\n    }\\n  \";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===n[0])return\"\\n      int getOutputCoords() {\\n        return 2 * int(resultUV.x * \"+n[1]+\".0);\\n      }\\n    \";if(1===n[1])return\"\\n      int getOutputCoords() {\\n        return 2 * int(resultUV.y * \"+n[0]+\".0);\\n      }\\n    \";return\"\\n    int getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+n[0]+\", \"+n[1]+\"));\\n      return 2 * (resTexRC.x * \"+n[1]+\" + resTexRC.y);\\n    }\\n  \"}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(S(t,e))return\"\\n      ivec2 getOutputCoords() {\\n        return 2 * ivec2(resultUV.yx * vec2(\"+n[0]+\", \"+n[1]+\"));\\n      }\\n    \";var r=Math.ceil(t[1]/2);return\"\\n    ivec2 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+n[0]+\", \"+n[1]+\"));\\n\\n      int index = resTexRC.x * \"+n[1]+\" + resTexRC.y;\\n      int r = 2 * (index / \"+r+\");\\n      int c = imod(index, \"+r+\") * 2;\\n\\n      return ivec2(r, c);\\n    }\\n  \"}(t,e);case 3:return n=t,r=e,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=Math.ceil(n[2]/2),i=a*Math.ceil(n[1]/2),\"\\n    ivec3 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+o[0]+\", \"+o[1]+\"));\\n      int index = resTexRC.x * \"+o[1]+\" + resTexRC.y;\\n\\n      int b = index / \"+i+\";\\n      index -= b * \"+i+\";\\n\\n      int r = 2 * (index / \"+a+\");\\n      int c = imod(index, \"+a+\") * 2;\\n\\n      return ivec3(b, r, c);\\n    }\\n  \";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),o=r*Math.ceil(t[t.length-2]/2),a=o,i=\"\",s=\"b, r, c\",u=2;u<t.length-1;u++)a*=t[t.length-u-1],i=\"\\n      int b\"+u+\" = index / \"+a+\";\\n      index -= b\"+u+\" * \"+a+\";\\n    \"+i,s=\"b\"+u+\", \"+s;return\"\\n    ivec\"+t.length+\" getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+n[0]+\", \"+n[1]+\"));\\n      int index = resTexRC.x * \"+n[1]+\" + resTexRC.y;\\n\\n      \"+i+\"\\n\\n      int b = index / \"+o+\";\\n      index -= b * \"+o+\";\\n\\n      int r = 2 * (index / \"+r+\");\\n      int c = imod(index, \"+r+\") * 2;\\n\\n      return ivec\"+t.length+\"(\"+s+\");\\n    }\\n  \"}(t,e)}var n,r,o,a,i}(e.logicalShape,c),i=function(t){return\"\\n    void setOutput(vec4 val) {\\n      \"+t.output+\" = val;\\n    }\\n  \"}(l)):(a=function(t,e){switch(t.length){case 0:return\"\\n    int getOutputCoords() {\\n      return 0;\\n    }\\n  \";case 1:return function(t,e){if(1===e[0])return\"\\n      int getOutputCoords() {\\n        return int(resultUV.x * \"+e[1]+\".0);\\n      }\\n    \";if(1===e[1])return\"\\n      int getOutputCoords() {\\n        return int(resultUV.y * \"+e[0]+\".0);\\n      }\\n    \";return\"\\n    int getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+e[0]+\", \"+e[1]+\"));\\n      return resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n    }\\n  \"}(0,e);case 2:return function(t,e){if(S(t,e))return\"\\n      ivec2 getOutputCoords() {\\n        return ivec2(resultUV.yx * vec2(\"+e[0]+\", \"+e[1]+\"));\\n      }\\n    \";if(1===t[1])return\"\\n      ivec2 getOutputCoords() {\\n        ivec2 resTexRC = ivec2(resultUV.yx *\\n                               vec2(\"+e[0]+\", \"+e[1]+\"));\\n        int index = resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n        return ivec2(index, 0);\\n      }\\n    \";if(1===t[0])return\"\\n      ivec2 getOutputCoords() {\\n        ivec2 resTexRC = ivec2(resultUV.yx *\\n                               vec2(\"+e[0]+\", \"+e[1]+\"));\\n        int index = resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n        return ivec2(0, index);\\n      }\\n    \";return\"\\n    ivec2 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+e[0]+\", \"+e[1]+\"));\\n      int index = resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n      int r = index / \"+t[1]+\";\\n      int c = index - r * \"+t[1]+\";\\n      return ivec2(r, c);\\n    }\\n  \"}(t,e);case 3:return n=e,r=ca([\"r\",\"c\",\"d\"],t),\"\\n    ivec3 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+n[0]+\", \"+n[1]+\"));\\n      int index = resTexRC.x * \"+n[1]+\" + resTexRC.y;\\n      \"+r+\"\\n      return ivec3(r, c, d);\\n    }\\n  \";case 4:return function(t,e){var n=ca([\"r\",\"c\",\"d\",\"d2\"],t);return\"\\n    ivec4 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n        vec2(\"+e[0]+\", \"+e[1]+\"));\\n      int index = resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n      \"+n+\"\\n      return ivec4(r, c, d, d2);\\n    }\\n  \"}(t,e);case 5:return function(t,e){var n=ca([\"r\",\"c\",\"d\",\"d2\",\"d3\"],t);return\"\\n    ivec5 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(\"+e[0]+\",\\n                             \"+e[1]+\"));\\n\\n      int index = resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n\\n      \"+n+\"\\n\\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\\n      return outShape;\\n    }\\n  \"}(t,e);case 6:return function(t,e){var n=ca([\"r\",\"c\",\"d\",\"d2\",\"d3\",\"d4\"],t);return\"\\n    ivec6 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n        vec2(\"+e[0]+\", \"+e[1]+\"));\\n      int index = resTexRC.x * \"+e[1]+\" + resTexRC.y;\\n\\n      \"+n+\"\\n\\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\\n      return result;\\n    }\\n  \"}(t,e);default:throw new Error(t.length+\"-D output sampling is not yet supported\")}var n,r}(e.logicalShape,c),i=function(t){return\"\\n    void setOutput(float val) {\\n      \"+t.output+\" = vec4(val, 0, 0, 0);\\n    }\\n  \"}(l)),r&&(f+=ya),[f,h,i,s,a,u,n].join(\"\\n\")}function da(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var e=t.name,n=\"get\"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return\"float \"+n+\"() {return \"+e+\";}\";var r=t.shapeInfo.texShape,o=r[0],a=r[1];if(1===o&&1===a)return\"\\n      float \"+n+\"() {\\n        return sampleTexture(\"+e+\", halfCR);\\n      }\\n    \";var i=t.shapeInfo.texShape,s=i[0],u=i[1],c=xa(e);return\"\\n    float \"+n+\"() {\\n      vec2 uv = uvFromFlat(\"+s+\", \"+u+\", \"+c+\");\\n      return sampleTexture(\"+e+\", uv);\\n    }\\n  \"}(t);case 1:return function(t){var e=t.name,n=\"get\"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return\"\\n      float \"+n+\"(int index) {\\n        \"+ba(t)+\"\\n      }\\n    \";var r=t.shapeInfo.texShape,o=r[0],a=r[1];if(1===a&&1===o)return\"\\n      float \"+n+\"(int index) {\\n        return sampleTexture(\"+e+\", halfCR);\\n      }\\n    \";var i=xa(e);if(1===a)return\"\\n      float \"+n+\"(int index) {\\n        vec2 uv = vec2(0.5, (float(index + \"+i+\") + 0.5) / \"+o+\".0);\\n        return sampleTexture(\"+e+\", uv);\\n      }\\n    \";if(1===o)return\"\\n      float \"+n+\"(int index) {\\n        vec2 uv = vec2((float(index + \"+i+\") + 0.5) / \"+a+\".0, 0.5);\\n        return sampleTexture(\"+e+\", uv);\\n      }\\n    \";return\"\\n    float \"+n+\"(int index) {\\n      vec2 uv = uvFromFlat(\"+o+\", \"+a+\", index + \"+i+\");\\n      return sampleTexture(\"+e+\", uv);\\n    }\\n  \"}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=t.shapeInfo.texShape;if(null!=o&&S(e,o)){var a=o[0],i=o[1];return\"\\n    float \"+r+\"(int row, int col) {\\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(\"+i+\".0, \"+a+\".0);\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \"}var s=M(e),u=s.newShape,c=s.keptDims,l=u;if(l.length<e.length){var h=Ca(t,l);return\"\\n      \"+da(h)+\"\\n      float \"+r+\"(int row, int col) {\\n        return \"+r+\"(\"+Ea([\"row\",\"col\"],c)+\");\\n      }\\n    \"}if(t.shapeInfo.isUniform)return\"\\n      float \"+r+\"(int row, int col) {\\n        int index = round(dot(vec2(row, col), vec2(\"+e[1]+\", 1)));\\n        \"+ba(t)+\"\\n      }\\n    \";var f=o[0],d=o[1],p=xa(n);if(1===d)return\"\\n    float \"+r+\"(int row, int col) {\\n      float index = dot(vec3(row, col, \"+p+\"), vec3(\"+e[1]+\", 1, 1));\\n      vec2 uv = vec2(0.5, (index + 0.5) / \"+f+\".0);\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \";if(1===f)return\"\\n    float \"+r+\"(int row, int col) {\\n      float index = dot(vec3(row, col, \"+p+\"), vec3(\"+e[1]+\", 1, 1));\\n      vec2 uv = vec2((index + 0.5) / \"+d+\".0, 0.5);\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \";return\"\\n  float \"+r+\"(int row, int col) {\\n    // Explicitly use integer operations as dot() only works on floats.\\n    int index = row * \"+e[1]+\" + col + \"+p+\";\\n    vec2 uv = uvFromFlat(\"+f+\", \"+d+\", index);\\n    return sampleTexture(\"+n+\", uv);\\n  }\\n\"}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=e[1]*e[2],a=e[2],i=M(e),s=i.newShape,u=i.keptDims,c=s;if(c.length<e.length){var l=Ca(t,c);return\"\\n        \"+da(l)+\"\\n        float \"+r+\"(int row, int col, int depth) {\\n          return \"+r+\"(\"+Ea([\"row\",\"col\",\"depth\"],u)+\");\\n        }\\n      \"}if(t.shapeInfo.isUniform)return\"\\n      float \"+r+\"(int row, int col, int depth) {\\n        int index = round(dot(vec3(row, col, depth),\\n                          vec3(\"+o+\", \"+a+\", 1)));\\n        \"+ba(t)+\"\\n      }\\n    \";var h=t.shapeInfo.texShape,f=h[0],d=h[1],p=t.shapeInfo.flatOffset;if(d===o&&null==p)return\"\\n        float \"+r+\"(int row, int col, int depth) {\\n          float texR = float(row);\\n          float texC = dot(vec2(col, depth), vec2(\"+a+\", 1));\\n          vec2 uv = (vec2(texC, texR) + halfCR) /\\n                     vec2(\"+d+\".0, \"+f+\".0);\\n          return sampleTexture(\"+n+\", uv);\\n        }\\n      \";if(d===a&&null==p)return\"\\n    float \"+r+\"(int row, int col, int depth) {\\n      float texR = dot(vec2(row, col), vec2(\"+e[1]+\", 1));\\n      float texC = float(depth);\\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(\"+d+\".0, \"+f+\".0);\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \";var v=xa(n);return\"\\n      float \"+r+\"(int row, int col, int depth) {\\n        // Explicitly use integer operations as dot() only works on floats.\\n        int index = row * \"+o+\" + col * \"+a+\" + depth + \"+v+\";\\n        vec2 uv = uvFromFlat(\"+f+\", \"+d+\", index);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n  \"}(t);case 4:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=e[3],a=e[2]*o,i=e[1]*a,s=M(e),u=s.newShape,c=s.keptDims;if(u.length<e.length){var l=Ca(t,u);return\"\\n      \"+da(l)+\"\\n      float \"+r+\"(int row, int col, int depth, int depth2) {\\n        return \"+r+\"(\"+Ea([\"row\",\"col\",\"depth\",\"depth2\"],c)+\");\\n      }\\n    \"}if(t.shapeInfo.isUniform)return\"\\n      float \"+r+\"(int row, int col, int depth, int depth2) {\\n        int index = round(dot(vec4(row, col, depth, depth2),\\n                          vec4(\"+i+\", \"+a+\", \"+o+\", 1)));\\n        \"+ba(t)+\"\\n      }\\n    \";var h=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,d=f[0],p=f[1];if(p===i&&null==h)return\"\\n      float \"+r+\"(int row, int col, int depth, int depth2) {\\n        float texR = float(row);\\n        float texC =\\n            dot(vec3(col, depth, depth2),\\n                vec3(\"+a+\", \"+o+\", 1));\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                   vec2(\"+p+\".0, \"+d+\".0);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n    \";if(p===o&&null==h)return\"\\n      float \"+r+\"(int row, int col, int depth, int depth2) {\\n        float texR = dot(vec3(row, col, depth),\\n                         vec3(\"+e[1]*e[2]+\", \"+e[2]+\", 1));\\n        float texC = float(depth2);\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                  vec2(\"+p+\".0, \"+d+\".0);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n    \";var v=xa(n);return\"\\n    float \"+r+\"(int row, int col, int depth, int depth2) {\\n      // Explicitly use integer operations as dot() only works on floats.\\n      int index = row * \"+i+\" + col * \"+a+\" +\\n          depth * \"+o+\" + depth2;\\n      vec2 uv = uvFromFlat(\"+d+\", \"+p+\", index + \"+v+\");\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \"}(t);case 5:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=e[4],a=e[3]*o,i=e[2]*a,s=e[1]*i,u=M(e),c=u.newShape,l=u.keptDims;if(c.length<e.length){var h=Ca(t,c);return\"\\n      \"+da(h)+\"\\n      float \"+r+\"(int row, int col, int depth, int depth2, int depth3) {\\n        return \"+r+\"(\"+Ea([\"row\",\"col\",\"depth\",\"depth2\",\"depth3\"],l)+\");\\n      }\\n    \"}if(t.shapeInfo.isUniform)return\"\\n      float \"+r+\"(int row, int col, int depth, int depth2, int depth3) {\\n        float index = dot(\\n          vec4(row, col, depth, depth2),\\n          vec4(\"+s+\", \"+i+\", \"+a+\", \"+o+\")) +\\n          depth3;\\n        \"+ba(t)+\"\\n      }\\n    \";var f=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],v=d[1];if(v===s&&null==f)return\"\\n      float \"+r+\"(int row, int col, int depth, int depth2, int depth3) {\\n        int texR = row;\\n        float texC = dot(vec4(col, depth, depth2, depth3),\\n                         vec4(\"+i+\", \"+a+\", \"+o+\", 1));\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                   vec2(\"+v+\".0, \"+p+\".0);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n    \";if(v===o&&null==f)return\"\\n      float \"+r+\"(int row, int col, int depth, int depth2, int depth3) {\\n        float texR = dot(\\n          vec4(row, col, depth, depth2),\\n          vec4(\"+e[1]*e[2]*e[3]+\",\\n               \"+e[2]*e[3]+\", \"+e[3]+\", 1));\\n        int texC = depth3;\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                  vec2(\"+v+\".0, \"+p+\".0);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n    \";var m=xa(n);return\"\\n    float \"+r+\"(int row, int col, int depth, int depth2, int depth3) {\\n      // Explicitly use integer operations as dot() only works on floats.\\n      int index = row * \"+s+\" + col * \"+i+\" + depth * \"+a+\" +\\n          depth2 * \"+o+\" + depth3 + \"+m+\";\\n      vec2 uv = uvFromFlat(\"+p+\", \"+v+\", index);\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \"}(t);case 6:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=M(e),a=o.newShape,i=o.keptDims;if(a.length<e.length){var s=Ca(t,a);return\"\\n      \"+da(s)+\"\\n      float \"+r+\"(int row, int col, int depth,\\n                    int depth2, int depth3, int depth4) {\\n        return \"+r+\"(\"+Ea([\"row\",\"col\",\"depth\",\"depth2\",\"depth3\",\"depth4\"],i)+\");\\n      }\\n    \"}var u=e[5],c=e[4]*u,l=e[3]*c,h=e[2]*l,f=e[1]*h;if(t.shapeInfo.isUniform)return\"\\n      float \"+r+\"(int row, int col, int depth,\\n                  int depth2, int depth3, int depth4) {\\n        int index = round(dot(\\n          vec4(row, col, depth, depth2),\\n          vec4(\"+f+\", \"+h+\", \"+l+\", \"+c+\")) +\\n          dot(\\n            vec2(depth3, depth4),\\n            vec2(\"+u+\", 1)));\\n        \"+ba(t)+\"\\n      }\\n    \";var d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,v=p[0],m=p[1];if(m===f&&null==d)return\"\\n      float \"+r+\"(int row, int col, int depth,\\n                    int depth2, int depth3, int depth4) {\\n        int texR = row;\\n        float texC = dot(vec4(col, depth, depth2, depth3),\\n          vec4(\"+h+\", \"+l+\", \"+c+\", \"+u+\")) +\\n               float(depth4);\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                   vec2(\"+m+\".0, \"+v+\".0);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n    \";if(m===u&&null==d)return\"\\n      float \"+r+\"(int row, int col, int depth,\\n                    int depth2, int depth3, int depth4) {\\n        float texR = dot(vec4(row, col, depth, depth2),\\n          vec4(\"+e[1]*e[2]*e[3]*e[4]+\",\\n               \"+e[2]*e[3]*e[4]+\",\\n               \"+e[3]*e[4]+\",\\n               \"+e[4]+\")) + float(depth3);\\n        int texC = depth4;\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                  vec2(\"+m+\".0, \"+v+\".0);\\n        return sampleTexture(\"+n+\", uv);\\n      }\\n    \";var g=xa(n);return\"\\n    float \"+r+\"(int row, int col, int depth,\\n                  int depth2, int depth3, int depth4) {\\n      // Explicitly use integer operations as dot() only works on floats.\\n      int index = row * \"+f+\" + col * \"+h+\" + depth * \"+l+\" +\\n          depth2 * \"+c+\" + depth3 * \"+u+\" + depth4 + \"+g+\";\\n      vec2 uv = uvFromFlat(\"+v+\", \"+m+\", index);\\n      return sampleTexture(\"+n+\", uv);\\n    }\\n  \"}(t);default:throw new Error(e.length+\"-D input sampling is not yet supported\")}}function pa(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n=\"get\"+e.charAt(0).toUpperCase()+e.slice(1),r=ua(),\"\\n    vec4 \"+n+\"() {\\n      return \"+r.texture2D+\"(\"+e+\", halfCR);\\n    }\\n  \";case 1:return function(t){var e=t.name,n=\"get\"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=ua();return\"\\n    vec4 \"+n+\"(int index) {\\n      vec2 uv = packedUVfrom1D(\\n        \"+o[0]+\", \"+o[1]+\", index);\\n      return \"+a.texture2D+\"(\"+e+\", uv);\\n    }\\n  \"}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=t.shapeInfo.texShape,a=o[0],i=o[1],s=ua();if(null!=o&&S(e,o))return\"\\n      vec4 \"+r+\"(int row, int col) {\\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(\"+i+\".0, \"+a+\".0);\\n\\n        return \"+s.texture2D+\"(\"+n+\", uv);\\n      }\\n    \";var u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(e[1]/2);return\"\\n    vec4 \"+r+\"(int row, int col) {\\n      vec2 uv = packedUVfrom2D(\"+c+\", \"+u[0]+\", \"+u[1]+\", row, col);\\n      return \"+s.texture2D+\"(\"+n+\", uv);\\n    }\\n  \"}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r=\"get\"+n.charAt(0).toUpperCase()+n.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===e[0]){var i=e.slice(1),s=Ca(t,i);return\"\\n        \"+pa(s)+\"\\n        vec4 \"+r+\"(int b, int row, int col) {\\n          return \"+r+\"(\"+Ea([\"b\",\"row\",\"col\"],[1,2])+\");\\n        }\\n      \"}var u=a[0],c=a[1],l=Math.ceil(e[2]/2),h=l*Math.ceil(e[1]/2),f=ua();return\"\\n    vec4 \"+r+\"(int b, int row, int col) {\\n      vec2 uv = packedUVfrom3D(\\n        \"+u+\", \"+c+\", \"+h+\", \"+l+\", b, row, col);\\n      return \"+f.texture2D+\"(\"+n+\", uv);\\n    }\\n  \"}(t);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,o=\"get\"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],s=i[0],u=i[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h=\"int b, int row, int col\",f=\"b * \"+l+\" + (row / 2) * \"+c+\" + (col / 2)\",d=2;d<n-1;d++)h=\"int b\"+d+\", \"+h,l*=e[n-d-1],f=\"b\"+d+\" * \"+l+\" + \"+f;var p=ua();return\"\\n    vec4 \"+o+\"(\"+h+\") {\\n      int index = \"+f+\";\\n      int texR = index / \"+u+\";\\n      int texC = index - texR * \"+u+\";\\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(\"+u+\", \"+s+\");\\n      return \"+p.texture2D+\"(\"+r+\", uv);\\n    }\\n  \"}(t)}}var va=\"\\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\\n  int texR = index / texNumC;\\n  int texC = index - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\\n  int texelIndex = index / 2;\\n  int texR = texelIndex / texNumC;\\n  int texC = texelIndex - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\",ma=\"\\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\\n  int texNumC, int row, int col) {\\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\\n  int texR = texelIndex / texNumC;\\n  int texC = texelIndex - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\",ga=\"\\nvec2 packedUVfrom3D(int texNumR, int texNumC,\\n    int texelsInBatch, int texelsInLogicalRow, int b,\\n    int row, int col) {\\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\\n  int texR = index / texNumC;\\n  int texC = index - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\",ya=\"\\n  float getChannel(vec4 frag, vec2 innerDims) {\\n    vec2 modCoord = mod(innerDims, 2.);\\n    return modCoord.x == 0. ?\\n      (modCoord.y == 0. ? frag.r : frag.g) :\\n      (modCoord.y == 0. ? frag.b : frag.a);\\n  }\\n  float getChannel(vec4 frag, int dim) {\\n    float modCoord = mod(float(dim), 2.);\\n    return modCoord == 0. ? frag.r : frag.g;\\n  }\\n\";function xa(t){return\"offset\"+t}function ba(t){var e=t.name,n=k(t.shapeInfo.logicalShape);return n<2?\"return \"+e+\";\":\"\\n    for (int i = 0; i < \"+n+\"; i++) {\\n      if (i == index) {\\n        return \"+e+\"[i];\\n      }\\n    }\\n  \"}function wa(t){if(t<=1)return\"int\";if(2===t)return\"ivec2\";if(3===t)return\"ivec3\";if(4===t)return\"ivec4\";if(5===t)return\"ivec5\";if(6===t)return\"ivec6\";throw Error(\"GPU for rank \"+t+\" is not yet supported\")}function Ca(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Ea(t,e){return e.map((function(e){return t[e]})).join(\", \")}var Ra=function(t,e,n,r){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,C(t.length>2,(function(){return\"Packed arg\"+(n.charAt(0).toUpperCase()+n.slice(1))+\" supports only inputs with rank above 2.\"}));var o=t[t.length-1],a=Math.ceil(o/e);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push(\"bestIndicesA\");var i,s,u=this.outputShape,c=u.length,l=wa(c),h=sa(\"coords\",c);if(1===a){var f=wa(s=c+1);i=\"\\n        \"+f+\" sourceLocR = \"+f+\"(\"+h.join()+\", 0);\\n        ++\"+h[c-1]+\";\\n        \"+f+\" sourceLocG = \"+f+\"(\"+h.join()+\", 0);\\n        ++\"+h[c-2]+\";\\n        \"+f+\" sourceLocA = \"+f+\"(\"+h.join()+\", 0);\\n        --\"+h[c-1]+\";\\n        \"+f+\" sourceLocB = \"+f+\"(\"+h.join()+\", 0);\\n        --\"+h[c-2]+\";\"}else s=c,i=\"\\n        \"+l+\" sourceLocR = coords;\\n        ++\"+h[c-1]+\";\\n        \"+l+\" sourceLocG = coords;\\n        ++\"+h[c-2]+\";\\n        \"+l+\" sourceLocA = coords;\\n        --\"+h[c-1]+\";\\n        \"+l+\" sourceLocB = coords;\\n        --\"+h[c-2]+\";\";var d=[\"x\",\"y\",\"z\",\"w\",\"u\",\"v\"].slice(0,s),p=\".\"+d[s-1],v=d.map((function(t){return\"int \"+t})),m=sa(\"sourceLocR\",s-1).concat(\"inIdx.r\"),g=sa(\"sourceLocG\",s-1).concat(\"inIdx.g\"),y=sa(\"sourceLocB\",s-1).concat(\"inIdx.b\"),x=sa(\"sourceLocA\",s-1).concat(\"inIdx.a\"),b=\"max\"===n?\"greaterThan\":\"lessThan\",w=r?\"\":\"\\n          inIdx = round(vec4(getBestIndicesAChannel(\"+m.join()+\"),\\n                             getBestIndicesAChannel(\"+g.join()+\"),\\n                             getBestIndicesAChannel(\"+y.join()+\"),\\n                             getBestIndicesAChannel(\"+x.join()+\")));\",E=\"vec4(\\n            getAChannel(\"+m.join()+\"),\\n            hasNextCol ? getAChannel(\"+g.join()+\") : 0.,\\n            hasNextRow ? getAChannel(\"+y.join()+\") : 0.,\\n            hasNextRow && hasNextCol ? getAChannel(\"+x.join()+\") : 0.)\",R=r?\"\":\"\\n      float getBestIndicesAChannel(\"+v.join()+\") {\\n        return getChannel(getBestIndicesA(\"+d.join()+\"),\\n                                          vec2(\"+d.slice(-2).join()+\"));\\n      }\";this.userCode=\"\\n      float getAChannel(\"+v.join()+\") {\\n        return getChannel(getA(\"+d.join()+\"),\\n                               vec2(\"+d.slice(-2).join()+\"));\\n      }\\n      \"+R+\"\\n      void main() {\\n        \"+l+\" coords = getOutputCoords();\\n        bool hasNextCol = \"+h[c-1]+\" < \"+(u[c-1]-1)+\";\\n        bool hasNextRow = \"+h[c-2]+\" < \"+(u[c-2]-1)+\";\\n        \"+i+\"\\n        ivec4 srcIdx = ivec4(sourceLocR\"+p+\", sourceLocG\"+p+\",\\n          sourceLocB\"+p+\", sourceLocA\"+p+\") * \"+e+\";\\n        ivec4 inIdx = srcIdx;\\n        vec4 bestIndex = vec4(inIdx);\\n        vec4 bestValue = \"+E+\";\\n\\n        for (int i = 0; i < \"+e+\"; i++) {\\n          inIdx = srcIdx;\\n          \"+w+\"\\n          vec4 candidate = \"+E+\";\\n          bvec4 nan = isnan(candidate);\\n          bvec4 replace = bvec4(\\n            vec4(\"+b+\"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\\n\\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\\n                           replace.y  ? candidate.y : bestValue.y,\\n                           replace.z  ? candidate.z : bestValue.z,\\n                           replace.w  ? candidate.w : bestValue.w);\\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\\n          srcIdx++;\\n        }\\n        setOutput(bestIndex);\\n      }\\n    \"},Ia=function(t){this.variableNames=[\"dy\"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,i=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,h=1/(e*n);this.userCode=\"\\n      const ivec2 pads = ivec2(\"+c+\", \"+l+\");\\n      const float avgMultiplier = float(\"+h+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n\\n        ivec2 dyRCCorner = coords.yz - pads;\\n        int dyRCorner = dyRCCorner.x;\\n        int dyCCorner = dyRCCorner.y;\\n\\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+s+\";\\n            wR += \"+a+\") {\\n          float dyR = float(dyRCorner + wR) / \"+r+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          for (int wC = 0; wC < \"+u+\";\\n            wC+= \"+i+\") {\\n            float dyC = float(dyCCorner + wC) / \"+o+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            float dyValue = getDy(b, idyR, idyC, d);\\n\\n            dotProd += dyValue * avgMultiplier;\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},ka=function(t){this.variableNames=[\"dy\"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=l-1-t.padInfo.front,p=h-1-t.padInfo.top,v=f-1-t.padInfo.left,m=1/(e*n*r);this.userCode=\"\\n      const ivec3 pads = ivec3(\"+d+\", \"+p+\", \"+v+\");\\n      const float avgMultiplier = float(\"+m+\");\\n\\n      void main() {\\n        ivec5 coords = getOutputCoords();\\n        int batch = coords.x;\\n        int ch = coords.u;\\n\\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\\n        int dyDCorner = dyCorner.x;\\n        int dyRCorner = dyCorner.y;\\n        int dyCCorner = dyCorner.z;\\n\\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\\n        // dx(xD, xR, xC, ch).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n\\n        for (int wD = 0; wD < \"+l+\";\\n            wD += \"+s+\") {\\n          float dyD = float(dyDCorner + wD) / \"+o+\".0;\\n\\n          if (dyD < 0.0 || dyD >= \"+t.outDepth+\".0 || fract(dyD) > 0.0) {\\n            continue;\\n          }\\n          int idyD = int(dyD);\\n\\n          for (int wR = 0; wR < \"+h+\";\\n              wR += \"+u+\") {\\n            float dyR = float(dyRCorner + wR) / \"+a+\".0;\\n\\n            if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 ||\\n                fract(dyR) > 0.0) {\\n              continue;\\n            }\\n            int idyR = int(dyR);\\n\\n            for (int wC = 0; wC < \"+f+\";\\n                wC += \"+c+\") {\\n              float dyC = float(dyCCorner + wC) / \"+i+\".0;\\n\\n              if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                  fract(dyC) > 0.0) {\\n                continue;\\n              }\\n              int idyC = int(dyC);\\n\\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\\n\\n              dotProd += dyValue * avgMultiplier;\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Sa=function(t,e,n,r,o,a){this.outputShape=[],this.variableNames=[\"x\",\"mean\",\"variance\"],Ro(t,e),Ro(t,n);var i=\"0.0\";null!=r&&(Ro(t,r),this.variableNames.push(\"offset\"),i=\"getOffsetAtOutCoords()\");var s=\"1.0\";null!=o&&(Ro(t,o),this.variableNames.push(\"scale\"),s=\"getScaleAtOutCoords()\"),this.outputShape=t,this.userCode=\"\\n      void main() {\\n        float x = getXAtOutCoords();\\n        float mean = getMeanAtOutCoords();\\n        float variance = getVarianceAtOutCoords();\\n        float offset = \"+i+\";\\n        float scale = \"+s+\";\\n        float inv = scale * inversesqrt(variance + float(\"+a+\"));\\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\\n      }\\n    \"},Aa=function(t,e,n,r,o,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=[\"x\",\"mean\",\"variance\"],Ro(t,e),Ro(t,n);var i=\"vec4(0.0)\";null!=r&&(Ro(t,r),this.variableNames.push(\"offset\"),i=\"getOffsetAtOutCoords()\");var s=\"vec4(1.0)\";null!=o&&(Ro(t,o),this.variableNames.push(\"scale\"),s=\"getScaleAtOutCoords()\"),this.outputShape=t,this.userCode=\"\\n      void main() {\\n        vec4 offset = \"+i+\";\\n        vec4 scale = \"+s+\";\\n\\n        vec4 x = getXAtOutCoords();\\n        vec4 mean = getMeanAtOutCoords();\\n        vec4 variance = getVarianceAtOutCoords();\\n\\n        vec4 inv = scale * inversesqrt(variance + vec4(\"+a+\"));\\n\\n        setOutput((x - mean) * inv + offset);\\n      }\\n    \"},Da=\"return areal * breal - aimag * bimag;\",Ta=\"return areal * bimag + aimag * breal;\",Na=function(t,e,n){this.variableNames=[\"AReal\",\"AImag\",\"BReal\",\"BImag\"],this.outputShape=Ro(e,n),this.userCode=\"\\n      float binaryOpComplex(\\n          float areal, float aimag, float breal, float bimag) {\\n        \"+t+\"\\n      }\\n\\n      void main() {\\n        float areal = getARealAtOutCoords();\\n        float aimag = getAImagAtOutCoords();\\n        float breal = getBRealAtOutCoords();\\n        float bimag = getBImagAtOutCoords();\\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\\n      }\\n    \"},Fa=\"return a + b;\",_a=\"return a - b;\",Oa=\"return a * b;\",Ma=\"return (a < 0.) ? b * a : a;\",Ba=function(t,e,n){this.variableNames=[\"A\",\"B\"],this.outputShape=Ro(e,n),this.userCode=\"\\n      float binaryOperation(float a, float b) {\\n        \"+t+\"\\n      }\\n\\n      void main() {\\n        float a = getAAtOutCoords();\\n        float b = getBAtOutCoords();\\n        setOutput(binaryOperation(a, b));\\n      }\\n    \"},Pa=\"\\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\\n\",La=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=[\"A\",\"B\"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ro(e,n);var o=this.outputShape.length,a=\"\";if(r)if(0===o||1===k(this.outputShape))a=\"\\n          result.y = 0.;\\n          result.z = 0.;\\n          result.w = 0.;\\n        \";else if(a=\"\\n          \"+wa(o)+\" coords = getOutputCoords();\\n        \",1===o)a+=\"\\n            result.y = (coords + 1) >= \"+this.outputShape[0]+\" ? 0. : result.y;\\n            result.z = 0.;\\n            result.w = 0.;\\n          \";else{var i=sa(\"coords\",o);a+=\"\\n            bool nextRowOutOfBounds =\\n              (\"+i[o-2]+\" + 1) >= \"+this.outputShape[o-2]+\";\\n            bool nextColOutOfBounds =\\n              (\"+i[o-1]+\" + 1) >= \"+this.outputShape[o-1]+\";\\n            result.y = nextColOutOfBounds ? 0. : result.y;\\n            result.z = nextRowOutOfBounds ? 0. : result.z;\\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\\n          \"}this.userCode=\"\\n      vec4 binaryOperation(vec4 a, vec4 b) {\\n        \"+t+\"\\n      }\\n\\n      void main() {\\n        vec4 a = getAAtOutCoords();\\n        vec4 b = getBAtOutCoords();\\n\\n        vec4 result = binaryOperation(a, b);\\n        \"+a+\"\\n\\n        setOutput(result);\\n      }\\n    \"},Wa=function(){function t(t){this.variableNames=[\"A\"],this.outputShape=t,this.userCode=\"\\n      uniform float minVal;\\n      uniform float maxVal;\\n\\n      void main() {\\n        float value = getAAtOutCoords();\\n        if (isnan(value)) {\\n          setOutput(value);\\n          return;\\n        }\\n\\n        setOutput(clamp(value, minVal, maxVal));\\n      }\\n    \"}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,\"minVal\"),n.maxLoc=r.getUniformLocationNoThrow(o,\"maxVal\")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Ua=function(){function t(t){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=\"\\n      uniform float minVal;\\n      uniform float maxVal;\\n\\n      void main() {\\n        vec4 value = getAAtOutCoords();\\n\\n        if (any(isnan(value))) {\\n          setOutput(value);\\n          return;\\n        }\\n\\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\\n      }\\n    \"}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,\"minVal\"),n.maxLoc=r.getUniformLocationNoThrow(o,\"maxVal\")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Va=function(t){this.variableNames=[\"real\",\"imag\"],this.outputShape=t,this.userCode=\"\\n      void main() {\\n        float re = abs(getRealAtOutCoords());\\n        float im = abs(getImagAtOutCoords());\\n        float mx = max(re, im);\\n\\n        // sadly the length function in glsl is not underflow-safe\\n        // (at least not on Intel GPUs). So the safe solution is\\n        // to ensure underflow-safety in all cases.\\n        setOutput(\\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\\n        );\\n      }\\n    \"},za=function(t){this.outputShape=[],this.outputShape=Sn(t,1),this.variableNames=t.map((function(t,e){return\"T\"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=[\"if (yC < \"+e[0]+\") setOutput(getT0(yR, yC));\"];for(n=1;n<e.length;n++){var o=e[n-1];r.push(\"else if (yC < \"+e[n]+\") setOutput(getT\"+n+\"(yR, yC-\"+o+\"));\")}var a=e.length,i=e[e.length-1];r.push(\"else setOutput(getT\"+a+\"(yR, yC-\"+i+\"));\"),this.userCode=\"\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int yR = coords.x;\\n        int yC = coords.y;\\n\\n        \"+r.join(\"\\n        \")+\"\\n      }\\n    \"},Ga=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Sn(t,e);var n=this.outputShape,r=n.length,o=wa(r),a=sa(\"coords\",r),i=[\"x\",\"y\",\"z\",\"w\",\"u\",\"v\"].slice(0,r);this.variableNames=t.map((function(t,e){return\"T\"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=i[e],l=i.slice(-2),h=i.join(),f=\"if (\"+c+\" < \"+s[0]+\") {\\n        return getChannel(\\n            getT0(\"+h+\"), vec2(\"+l.join()+\"));\\n        }\";for(u=1;u<s.length;u++){var d=s[u-1];f+=\"\\n        if (\"+c+\" < \"+s[u]+\"  && \"+c+\" >= \"+s[u-1]+\") {\\n          return getChannel(\\n            getT\"+u+\"(\"+Ha(i,c,d)+\"),\\n            vec2(\"+Ha(l,c,d)+\"));\\n        }\"}var p=s.length,v=s[s.length-1];f+=\"\\n        return getChannel(\\n          getT\"+p+\"(\"+Ha(i,c,v)+\"),\\n          vec2(\"+Ha(l,c,v)+\"));\",this.userCode=\"\\n      float getValue(\"+i.map((function(t){return\"int \"+t}))+\") {\\n        \"+f+\"\\n      }\\n\\n      void main() {\\n        \"+o+\" coords = getOutputCoords();\\n        vec4 result = vec4(getValue(\"+a+\"), 0., 0., 0.);\\n\\n        \"+a[r-1]+\" = \"+a[r-1]+\" + 1;\\n        if (\"+a[r-1]+\" < \"+n[r-1]+\") {\\n          result.g = getValue(\"+a+\");\\n        }\\n\\n        \"+a[r-2]+\" = \"+a[r-2]+\" + 1;\\n        if (\"+a[r-2]+\" < \"+n[r-2]+\") {\\n          result.a = getValue(\"+a+\");\\n        }\\n\\n        \"+a[r-1]+\" = \"+a[r-1]+\" - 1;\\n        if (\"+a[r-2]+\" < \"+n[r-2]+\" &&\\n            \"+a[r-1]+\" < \"+n[r-1]+\") {\\n          result.b = getValue(\"+a+\");\\n        }\\n        setOutput(result);\\n      }\\n    \"};function Ha(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+\" - \"+n:t})).join()}var qa=function(t){this.variableNames=[\"x\",\"dy\"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,a=\"channelsLast\"===t.dataFormat;this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int wR = coords.x;\\n        int wC = coords.y;\\n        int d1 = coords.z;\\n        int d2 = coords.w;\\n\\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n\\n        for (int b = 0; b < \"+t.batchSize+\"; b++) {\\n          for (int yR = 0; yR < \"+t.outHeight+\"; yR++) {\\n            int xR = wR + yR * \"+e+\" - \"+r+\";\\n\\n            if (xR < 0 || xR >= \"+t.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int yC = 0; yC < \"+t.outWidth+\"; yC++) {\\n              int xC = wC + yC * \"+n+\" - \"+o+\";\\n\\n              if (xC < 0 || xC >= \"+t.inWidth+\") {\\n                continue;\\n              }\\n\\n              if (\"+a+\") {\\n                float dyValue = getDy(b, yR, yC, d2);\\n                float xValue = getX(b, xR, xC, d1);\\n                dotProd += (xValue * dyValue);\\n              } else {\\n                float dyValue = getDy(b, d2, yR, yC);\\n                float xValue = getX(b, d1, xR, xC);\\n                dotProd += (xValue * dyValue);\\n              }\\n\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Ka=function(t){this.variableNames=[\"dy\",\"W\"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,a=\"channelsLast\"===t.dataFormat,i=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=a?1:2,c=a?2:3,l=a?3:1;this.userCode=\"\\n      const ivec2 pads = ivec2(\"+i+\", \"+s+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d1 = coords[\"+l+\"];\\n\\n        ivec2 dyCorner = ivec2(coords[\"+u+\"], coords[\"+c+\"]) - pads;\\n        int dyRCorner = dyCorner.x;\\n        int dyCCorner = dyCorner.y;\\n\\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+e+\"; wR++) {\\n          float dyR = float(dyRCorner + wR) / \"+r+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          int wRPerm = \"+e+\" - 1 - wR;\\n\\n          for (int wC = 0; wC < \"+n+\"; wC++) {\\n            float dyC = float(dyCCorner + wC) / \"+o+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            int wCPerm = \"+n+\" - 1 - wC;\\n\\n            for (int d2 = 0; d2 < \"+t.outChannels+\"; d2++) {\\n\\n              if (\"+a+\") {\\n                float xValue = getDy(batch, idyR, idyC, d2);\\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\\n                dotProd += xValue * wValue;\\n              } else {\\n                float xValue = getDy(batch, d2, idyR, idyC);\\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\\n                dotProd += xValue * wValue;\\n              }\\n\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},ja=function(t){this.variableNames=[\"x\",\"dy\"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,a=t.padInfo.top,i=t.padInfo.left;this.userCode=\"\\n      void main() {\\n        ivec5 coords = getOutputCoords();\\n        int wF = coords.x;\\n        int wR = coords.y;\\n        int wC = coords.z;\\n        int d1 = coords.w;\\n        int d2 = coords.u;\\n\\n        float dotProd = 0.0;\\n\\n        for (int b = 0; b < \"+t.batchSize+\"; b++) {\\n          for (int yF = 0; yF < \"+t.outDepth+\"; yF++) {\\n            int xF = wF + yF * \"+e+\" - \"+o+\";\\n\\n            if (xF < 0 || xF >= \"+t.inDepth+\") {\\n              continue;\\n            }\\n\\n            for (int yR = 0; yR < \"+t.outHeight+\"; yR++) {\\n              int xR = wR + yR * \"+n+\" - \"+a+\";\\n\\n              if (xR < 0 || xR >= \"+t.inHeight+\") {\\n                continue;\\n              }\\n\\n              for (int yC = 0; yC < \"+t.outWidth+\"; yC++) {\\n                int xC = wC + yC * \"+r+\" - \"+i+\";\\n\\n                if (xC < 0 || xC >= \"+t.inWidth+\") {\\n                  continue;\\n                }\\n\\n                float dyValue = getDy(b, yF, yR, yC, d2);\\n                float xValue = getX(b, xF, xR, xC, d1);\\n                dotProd += (xValue * dyValue);\\n              }\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Xa=function(t){this.variableNames=[\"dy\",\"W\"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode=\"\\n      const ivec3 pads = ivec3(\"+s+\", \"+u+\", \"+c+\");\\n\\n      void main() {\\n        ivec5 coords = getOutputCoords();\\n        int batch = coords.x;\\n        int d1 = coords.u;\\n\\n\\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\\n        int dyFCorner = dyCorner.x;\\n        int dyRCorner = dyCorner.y;\\n        int dyCCorner = dyCorner.z;\\n\\n        float dotProd = 0.0;\\n        for (int wF = 0; wF < \"+e+\"; wF++) {\\n          float dyF = float(dyFCorner + wF) / \"+o+\".0;\\n\\n          if (dyF < 0.0 || dyF >= \"+t.outDepth+\".0 || fract(dyF) > 0.0) {\\n            continue;\\n          }\\n          int idyF = int(dyF);\\n\\n          int wFPerm = \"+e+\" - 1 - wF;\\n\\n          for (int wR = 0; wR < \"+n+\"; wR++) {\\n            float dyR = float(dyRCorner + wR) / \"+a+\".0;\\n\\n            if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 ||\\n              fract(dyR) > 0.0) {\\n              continue;\\n            }\\n            int idyR = int(dyR);\\n\\n            int wRPerm = \"+n+\" - 1 - wR;\\n\\n            for (int wC = 0; wC < \"+r+\"; wC++) {\\n              float dyC = float(dyCCorner + wC) / \"+i+\".0;\\n\\n              if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                  fract(dyC) > 0.0) {\\n                continue;\\n              }\\n              int idyC = int(dyC);\\n\\n              int wCPerm = \"+r+\" - 1 - wC;\\n\\n              for (int d2 = 0; d2 < \"+t.outChannels+\"; d2++) {\\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\\n                dotProd += xValue * wValue;\\n              }\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Ya=function(t){this.variableNames=[\"x\",\"dy\"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int wR = coords.x;\\n        int wC = coords.y;\\n        int d1 = coords.z;\\n        int dm = coords.w;\\n        int d2 = d1 * \"+a+\" + dm;\\n\\n        float dotProd = 0.0;\\n\\n        // TO DO: Vec4 over the batch size\\n        for (int b = 0; b < \"+t.batchSize+\"; b++) {\\n          for (int yR = 0; yR < \"+t.outHeight+\"; yR++) {\\n            int xR = wR + yR * \"+e+\" - \"+r+\";\\n\\n            if (xR < 0 || xR >= \"+t.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int yC = 0; yC < \"+t.outWidth+\"; yC++) {\\n              int xC = wC + yC * \"+n+\" - \"+o+\";\\n\\n              if (xC < 0 || xC >= \"+t.inWidth+\") {\\n                continue;\\n              }\\n\\n              float dyValue = getDy(b, yR, yC, d2);\\n              float xValue = getX(b, xR, xC, d1);\\n              dotProd += (xValue * dyValue);\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},$a=function(t){this.variableNames=[\"dy\",\"W\"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.top,i=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=\"\\n      const ivec2 pads = ivec2(\"+a+\", \"+i+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d1 = coords[3];\\n        ivec2 dyCorner = coords.yz - pads;\\n        int dyRCorner = dyCorner.x;\\n        int dyCCorner = dyCorner.y;\\n\\n        float dotProd = 0.0;\\n\\n        for (int wR = 0; wR < \"+e+\"; wR++) {\\n          float dyR = float(dyRCorner + wR) / \"+r+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          int wRPerm = \"+e+\" - 1 - wR;\\n\\n          for (int wC = 0; wC < \"+n+\"; wC++) {\\n            float dyC = float(dyCCorner + wC) / \"+o+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            int wCPerm = \"+n+\" - 1 - wC;\\n\\n            // TO DO: Vec4 over the channelMul\\n            for (int dm = 0; dm < \"+s+\"; dm++) {\\n              int d2 = d1 * \"+s+\" + dm;\\n              float xValue = getDy(batch, idyR, idyC, d2);\\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\\n              dotProd += xValue * wValue;\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Qa=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=[\"x\",\"W\"],this.outputShape=t.outShape;var o=t.padInfo.top,a=t.padInfo.left,i=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),d=t.inChannels%4,p=\"channelsLast\"===t.dataFormat,v=p?1:2,m=p?2:3,g=p?3:1,y=\"\",x=\"\";n&&(y=r?\"float activation(float a) {\\n          float b = getPreluActivationWeightsAtOutCoords();\\n          \"+n+\"\\n        }\":\"\\n          float activation(float x) {\\n            \"+n+\"\\n          }\\n        \",x=\"result = activation(result);\");var b=e?\"result += getBiasAtOutCoords();\":\"\";e&&this.variableNames.push(\"bias\"),r&&this.variableNames.push(\"preluActivationWeights\"),this.userCode=\"\\n      \"+y+\"\\n\\n      const ivec2 strides = ivec2(\"+i+\", \"+s+\");\\n      const ivec2 pads = ivec2(\"+o+\", \"+a+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d2 = coords[\"+g+\"];\\n\\n        ivec2 xRCCorner =\\n            ivec2(coords[\"+v+\"], coords[\"+m+\"]) * strides - pads;\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+l+\"; wR++) {\\n          int xR = xRCorner + wR * \"+u+\";\\n\\n          if (xR < 0 || xR >= \"+t.inHeight+\") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \"+h+\"; wC++) {\\n            int xC = xCCorner + wC * \"+c+\";\\n\\n            if (xC < 0 || xC >= \"+t.inWidth+\") {\\n              continue;\\n            }\\n\\n            for (int d1 = 0; d1 < \"+f+\"; d1 += 4) {\\n              vec4 wValues = vec4(\\n                getW(wR, wC, d1, d2),\\n                getW(wR, wC, d1 + 1, d2),\\n                getW(wR, wC, d1 + 2, d2),\\n                getW(wR, wC, d1 + 3, d2)\\n              );\\n\\n              if (\"+p+\") {\\n                vec4 xValues = vec4(\\n                  getX(batch, xR, xC, d1),\\n                  getX(batch, xR, xC, d1 + 1),\\n                  getX(batch, xR, xC, d1 + 2),\\n                  getX(batch, xR, xC, d1 + 3)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              } else {\\n                vec4 xValues = vec4(\\n                  getX(batch, d1, xR, xC),\\n                  getX(batch, d1 + 1, xR, xC),\\n                  getX(batch, d1 + 2, xR, xC),\\n                  getX(batch, d1 + 3, xR, xC)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              }\\n            }\\n\\n            if (\"+(1===d)+\") {\\n\\n              if (\"+p+\") {\\n                dotProd +=\\n                    getX(batch, xR, xC, \"+f+\") *\\n                    getW(wR, wC, \"+f+\", d2);\\n              } else {\\n                dotProd +=\\n                    getX(batch, \"+f+\", xR, xC) *\\n                    getW(wR, wC, \"+f+\", d2);\\n              }\\n\\n            } else if (\"+(2===d)+\") {\\n              vec2 wValues = vec2(\\n                getW(wR, wC, \"+f+\", d2),\\n                getW(wR, wC, \"+f+\" + 1, d2)\\n              );\\n\\n              if (\"+p+\") {\\n                vec2 xValues = vec2(\\n                  getX(batch, xR, xC, \"+f+\"),\\n                  getX(batch, xR, xC, \"+f+\" + 1)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              } else {\\n                vec2 xValues = vec2(\\n                  getX(batch, \"+f+\", xR, xC),\\n                  getX(batch, \"+f+\" + 1, xR, xC)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              }\\n\\n            } else if (\"+(3===d)+\") {\\n              vec3 wValues = vec3(\\n                getW(wR, wC, \"+f+\", d2),\\n                getW(wR, wC, \"+f+\" + 1, d2),\\n                getW(wR, wC, \"+f+\" + 2, d2)\\n              );\\n\\n              if (\"+p+\") {\\n                vec3 xValues = vec3(\\n                  getX(batch, xR, xC, \"+f+\"),\\n                  getX(batch, xR, xC, \"+f+\" + 1),\\n                  getX(batch, xR, xC, \"+f+\" + 2)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              } else {\\n                vec3 xValues = vec3(\\n                  getX(batch, \"+f+\", xR, xC),\\n                  getX(batch, \"+f+\" + 1, xR, xC),\\n                  getX(batch, \"+f+\" + 2, xR, xC)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              }\\n\\n            }\\n          }\\n        }\\n\\n        float result = dotProd;\\n        \"+b+\"\\n        \"+x+\"\\n        setOutput(result);\\n      }\\n    \"},Ja=function(t){this.variableNames=[\"x\",\"W\"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode=\"\\n      const ivec3 strides = ivec3(\"+o+\", \"+a+\", \"+i+\");\\n      const ivec3 pads = ivec3(\"+e+\", \"+n+\", \"+r+\");\\n\\n      void main() {\\n        ivec5 coords = getOutputCoords();\\n        int batch = coords.x;\\n        int d2 = coords.u;\\n\\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\\n        int xFCorner = xFRCCorner.x;\\n        int xRCorner = xFRCCorner.y;\\n        int xCCorner = xFRCCorner.z;\\n\\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\\n        // values in that axis.\\n        float dotProd = 0.0;\\n        for (int wF = 0; wF < \"+l+\"; wF++) {\\n          int xF = xFCorner + wF * \"+s+\";\\n\\n          if (xF < 0 || xF >= \"+t.inDepth+\") {\\n            continue;\\n          }\\n\\n          for (int wR = 0; wR < \"+h+\"; wR++) {\\n            int xR = xRCorner + wR * \"+u+\";\\n\\n            if (xR < 0 || xR >= \"+t.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int wC = 0; wC < \"+f+\"; wC++) {\\n              int xC = xCCorner + wC * \"+c+\";\\n\\n              if (xC < 0 || xC >= \"+t.inWidth+\") {\\n                continue;\\n              }\\n\\n              for (int d1 = 0; d1 < \"+d+\"; d1 += 4) {\\n                vec4 xValues = vec4(\\n                  getX(batch, xF, xR, xC, d1),\\n                  getX(batch, xF, xR, xC, d1 + 1),\\n                  getX(batch, xF, xR, xC, d1 + 2),\\n                  getX(batch, xF, xR, xC, d1 + 3)\\n                );\\n                vec4 wValues = vec4(\\n                  getW(wF, wR, wC, d1, d2),\\n                  getW(wF, wR, wC, d1 + 1, d2),\\n                  getW(wF, wR, wC, d1 + 2, d2),\\n                  getW(wF, wR, wC, d1 + 3, d2)\\n                );\\n\\n                dotProd += dot(xValues, wValues);\\n              }\\n\\n              if (\"+(1===p)+\") {\\n                dotProd +=\\n                  getX(batch, xF, xR, xC, \"+d+\") *\\n                  getW(wF, wR, wC, \"+d+\", d2);\\n              } else if (\"+(2===p)+\") {\\n                vec2 xValues = vec2(\\n                  getX(batch, xF, xR, xC, \"+d+\"),\\n                  getX(batch, xF, xR, xC, \"+d+\" + 1)\\n                );\\n                vec2 wValues = vec2(\\n                  getW(wF, wR, wC, \"+d+\", d2),\\n                  getW(wF, wR, wC, \"+d+\" + 1, d2)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              } else if (\"+(3===p)+\") {\\n                vec3 xValues = vec3(\\n                  getX(batch, xF, xR, xC, \"+d+\"),\\n                  getX(batch, xF, xR, xC, \"+d+\" + 1),\\n                  getX(batch, xF, xR, xC, \"+d+\" + 2)\\n                );\\n                vec3 wValues = vec3(\\n                  getW(wF, wR, wC, \"+d+\", d2),\\n                  getW(wF, wR, wC, \"+d+\" + 1, d2),\\n                  getW(wF, wR, wC, \"+d+\" + 2, d2)\\n                );\\n                dotProd += dot(xValues, wValues);\\n              }\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Za=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=[\"x\",\"W\"],this.outputShape=t.outShape;var o=t.inHeight,a=t.inWidth,i=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,p=t.outChannels/t.inChannels,v=\"\",m=\"\";n&&(v=r?\"float activation(float a) {\\n          float b = getPreluActivationWeightsAtOutCoords();\\n          \"+n+\"\\n        }\":\"\\n          float activation(float x) {\\n            \"+n+\"\\n          }\\n        \",m=\"result = activation(result);\");var g=e?\"result += getBiasAtOutCoords();\":\"\";e&&this.variableNames.push(\"bias\"),r&&this.variableNames.push(\"preluActivationWeights\"),this.userCode=\"\\n      \"+v+\"\\n\\n      const ivec2 strides = ivec2(\"+u+\", \"+c+\");\\n      const ivec2 pads = ivec2(\"+i+\", \"+s+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords.x;\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int d2 = coords.w;\\n        int d1 = d2 / \"+p+\";\\n        int q = d2 - d1 * \"+p+\";\\n\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\\n        for (int wR = 0; wR < \"+f+\"; wR++) {\\n          int xR = xRCorner + wR * \"+l+\";\\n\\n          if (xR < 0 || xR >= \"+o+\") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \"+d+\"; wC++) {\\n            int xC = xCCorner + wC * \"+h+\";\\n\\n            if (xC < 0 || xC >= \"+a+\") {\\n              continue;\\n            }\\n\\n            float xVal = getX(batch, xR, xC, d1);\\n            float wVal = getW(wR, wC, d1, q);\\n            dotProd += xVal * wVal;\\n          }\\n        }\\n\\n        float result = dotProd;\\n        \"+g+\"\\n        \"+m+\"\\n        setOutput(result);\\n      }\\n    \"},ti=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=[\"x\",\"W\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,a=t.inWidth,i=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,p=d,v=\"int xR; int xC; int xCOffset;\",m=0;m<f;m++)for(var g=0;g<d;g++)v+=\"\\n          vec4 xTexelR\"+m+\"C\"+2*g+\" = vec4(0.);\\n          vec4 wR\"+m+\"C\"+g+\" = vec4(0.);\\n          vec4 xR\"+m+\"C\"+g+\" = vec4(0.);\";for(m=0;m<f;m++)for(var y=0;y<p;y++){if(v+=\"\\n          xR = xRCorner + \"+m*l+\";\\n          xC = xCCorner + \"+(g=2*y)*h+\";\\n        \",1===c){if(g<d&&(v+=s%2==1?\"\\n                xCOffset = xC + 1;\\n                if(xR >= 0 && xR < \"+o+\" && xCOffset >= 0 && xCOffset < \"+a+\") {\\n                  xTexelR\"+m+\"C\"+g+\" = getX(batch, xR, xCOffset, d1);\\n\\n                  // Need to manually clear unused channels in case\\n                  // we're reading from recycled texture.\\n                  if(xCOffset + 1 >= \"+a+\") {\\n                    xTexelR\"+m+\"C\"+g+\".zw = vec2(0.);\\n                  }\\n                } else {\\n                  xTexelR\"+m+\"C\"+g+\" = vec4(0.);\\n                }\\n\\n                xCOffset = xC + 1 - 2;\\n                if(xR >= 0 && xR < \"+o+\" && xCOffset >= 0 && xCOffset < \"+a+\") {\\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\\n\\n                  // Need to manually clear unused channels in case\\n                  // we're reading from recycled texture.\\n                  if(xCOffset + 1 >= \"+a+\") {\\n                    previous.zw = vec2(0.);\\n                  }\\n\\n                  xR\"+m+\"C\"+g+\" = vec4(previous.zw, xTexelR\"+m+\"C\"+g+\".xy);\\n                } else {\\n                  xR\"+m+\"C\"+g+\" = vec4(0, 0, xTexelR\"+m+\"C\"+g+\".xy);\\n                }\\n              \":\"\\n                if(xR >= 0 && xR < \"+o+\" && xC >= 0 && xC < \"+a+\") {\\n                  xTexelR\"+m+\"C\"+g+\" = getX(batch, xR, xC, d1);\\n                } else {\\n                  xTexelR\"+m+\"C\"+g+\" = vec4(0.);\\n                }\\n\\n                xR\"+m+\"C\"+g+\" = xTexelR\"+m+\"C\"+g+\";\\n              \",g+1<d)){var x=s%2==0?b(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(v+=\"\\n                  xCOffset = xC + \"+s%2+\" + \"+x+\";\\n\\n                  if(xR >= 0 && xR < \"+o+\" &&\\n                    xCOffset >= 0 && xCOffset < \"+a+\") {\\n                    xTexelR\"+m+\"C\"+(g+2)+\" = getX(batch, xR, xCOffset, d1);\\n                  }\\n                \",h>1&&(v+=\"\\n                    xCOffset -= 2;\\n                    if(xR >= 0 && xR < \"+o+\" &&\\n                      xCOffset >= 0 && xCOffset < \"+a+\") {\\n                      xTexelR\"+m+\"C\"+g+\" = getX(batch, xR, xCOffset, d1);\\n                    } else {\\n                      xTexelR\"+m+\"C\"+g+\" = vec4(0.);\\n                    }\\n                  \"),v+=\"\\n                  xR\"+m+\"C\"+(g+1)+\" = vec4(\\n                    xTexelR\"+m+\"C\"+g+\".zw, xTexelR\"+m+\"C\"+(g+2)+\".xy);\\n                \"):v+=\"\\n                  xCOffset = xC + \"+x+\";\\n\\n                  if(xR >= 0 && xR < \"+o+\" &&\\n                    xCOffset >= 0 && xCOffset < \"+a+\") {\\n                    xTexelR\"+m+\"C\"+(g+2)+\" = getX(batch, xR, xCOffset, d1);\\n                  }\\n\\n                  xR\"+m+\"C\"+(g+1)+\" = xTexelR\"+m+\"C\"+(g+2)+\";\\n                \"}}else g<d&&(v+=\"\\n              if(xR >= 0 && xR < \"+o+\") {\\n            \",s%2==1?(v+=\"\\n                xCOffset = xC + 1 - \"+c+\";\\n                if(xCOffset >= 0 && xCOffset < \"+a+\") {\\n                  xTexelR\"+m+\"C\"+g+\" = getX(batch, xR, xCOffset, d1);\\n                } else {\\n                  xTexelR\"+m+\"C\"+g+\" = vec4(0.);\\n                }\\n\\n                if(xC + 1 >= 0 && xC + 1 < \"+a+\") {\\n                  xTexelR\"+m+\"C\"+(g+2)+\" = getX(batch, xR, xC + 1, d1);\\n                } else {\\n                  xTexelR\"+m+\"C\"+(g+2)+\" = vec4(0.);\\n                }\\n\\n                xR\"+m+\"C\"+g+\" = vec4(\\n                  xTexelR\"+m+\"C\"+g+\".zw, xTexelR\"+m+\"C\"+(g+2)+\".zw);\\n              \",g+1<d&&(v+=\"\\n                  vec4 final = vec4(0.);\\n                  xCOffset = xC + 1 + \"+c+\";\\n                  if(xCOffset >= 0 && xCOffset < \"+a+\") {\\n                    final = getX(batch, xR, xCOffset, d1);\\n                  }\\n                  xR\"+m+\"C\"+(g+1)+\" = vec4(xTexelR\"+m+\"C\"+(g+2)+\".xy, final.xy);\\n                \")):(v+=\"\\n                if(xC >= 0 && xC < \"+a+\") {\\n                  xTexelR\"+m+\"C\"+g+\" = getX(batch, xR, xC, d1);\\n                } else {\\n                  xTexelR\"+m+\"C\"+g+\" = vec4(0.);\\n                }\\n\\n                xCOffset = xC + \"+c+\";\\n                if(xCOffset >= 0 && xCOffset < \"+a+\") {\\n                  xTexelR\"+m+\"C\"+(g+2)+\" = getX(batch, xR, xCOffset, d1);\\n                } else {\\n                  xTexelR\"+m+\"C\"+(g+2)+\" = vec4(0.);\\n                }\\n\\n                xR\"+m+\"C\"+g+\" = vec4(\\n                  xTexelR\"+m+\"C\"+g+\".xy, xTexelR\"+m+\"C\"+(g+2)+\".xy);\\n              \",g+1<d&&(v+=\"\\n                  xR\"+m+\"C\"+(g+1)+\" = vec4(\\n                    xTexelR\"+m+\"C\"+g+\".zw, xTexelR\"+m+\"C\"+(g+2)+\".zw);\\n                \")),v+=\"}\");g<d&&(v+=\"\\n            vec4 wTexelR\"+m+\"C\"+g+\" = getW(\"+m+\", \"+g+\", d1, q);\\n            wR\"+m+\"C\"+g+\" = vec4(wTexelR\"+m+\"C\"+g+\".xz, wTexelR\"+m+\"C\"+g+\".xz);\\n          \",g+1<d&&(v+=\"\\n              vec4 wTexelR\"+m+\"C\"+(g+1)+\" = getW(\"+m+\", \"+(g+1)+\", d1, q);\\n              wR\"+m+\"C\"+(g+1)+\" =\\n                vec4(wTexelR\"+m+\"C\"+(g+1)+\".xz, wTexelR\"+m+\"C\"+(g+1)+\".xz);\"))}for(m=0;m<f;m++)for(g=0;g<d;g++)v+=\"dotProd += xR\"+m+\"C\"+g+\" * wR\"+m+\"C\"+g+\";\";var w=\"\",C=\"\";n&&(w=r?\"vec4 activation(vec4 a) {\\n          vec4 b = getPreluActivationWeightsAtOutCoords();\\n          \"+n+\"\\n        }\":\"vec4 activation(vec4 x) {\\n          \"+n+\"\\n        }\",C=\"result = activation(result);\");var E=e?\"result += getBiasAtOutCoords();\":\"\";e&&this.variableNames.push(\"bias\"),r&&this.variableNames.push(\"preluActivationWeights\"),this.userCode=\"\\n      \"+w+\"\\n\\n      const ivec2 strides = ivec2(\"+u+\", \"+c+\");\\n      const ivec2 pads = ivec2(\"+i+\", \"+s+\");\\n\\n      void main() {\\n\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords.x;\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int d2 = coords.w;\\n        int d1 = d2;\\n        int q = 0;\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        vec4 dotProd = vec4(0.);\\n\\n        \"+v+\"\\n\\n        vec4 result = dotProd;\\n        \"+E+\"\\n        \"+C+\"\\n        setOutput(result);\\n      }\\n    \"},ei=function(t,e,n,r,o){this.variableNames=[\"Image\",\"Boxes\",\"BoxInd\"],this.outputShape=[];var a=t[0],i=t[1],s=t[2],u=t[3],c=e[0],l=n[0],h=n[1];this.outputShape=[c,l,h,u];var f=\"bilinear\"===r?1:0,d=[i-1+\".0\",s-1+\".0\"],p=d[0],v=d[1],m=l>1?[\"\"+(i-1)/(l-1),\"(y2-y1) * height_ratio\",\"y1*\"+p+\" + float(y)*(height_scale)\"]:[\"0.0\",\"0.0\",\"0.5 * (y1+y2) * \"+p],g=m[0],y=m[1],x=m[2],b=h>1?[\"\"+(s-1)/(h-1),\"(x2-x1) * width_ratio\",\"x1*\"+v+\" + float(x)*(width_scale)\"]:[\"0.0\",\"0.0\",\"0.5 * (x1+x2) * \"+v],w=b[0],C=b[1],E=b[2];this.userCode=\"\\n      const float height_ratio = float(\"+g+\");\\n      const float width_ratio = float(\"+w+\");\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int y = coords[1];\\n        int x = coords[2];\\n        int d = coords[3];\\n\\n        // get box vals\\n        float y1 = getBoxes(b,0);\\n        float x1 = getBoxes(b,1);\\n        float y2 = getBoxes(b,2);\\n        float x2 = getBoxes(b,3);\\n\\n        // get image in batch index\\n        int bInd = round(getBoxInd(b));\\n        if(bInd < 0 || bInd >= \"+a+\") {\\n          return;\\n        }\\n\\n        float height_scale = \"+y+\";\\n        float width_scale = \"+C+\";\\n\\n        float in_y = \"+x+\";\\n        if( in_y < 0.0 || in_y > \"+p+\" ) {\\n          setOutput(float(\"+o+\"));\\n          return;\\n        }\\n        float in_x = \"+E+\";\\n        if( in_x < 0.0 || in_x > \"+v+\" ) {\\n          setOutput(float(\"+o+\"));\\n          return;\\n        }\\n\\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\\n        if(\"+f+\" == 1) {\\n          // Compute the four integer indices.\\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\\n\\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\\n\\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\\n\\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\\n          float newValue = top + (bottom - top) * fracCR.y;\\n          setOutput(newValue);\\n        } else {\\n          // Compute the coordinators of nearest neighbor point.\\n          ivec2 sourceNearestCR = ivec2(floor(\\n            sourceFracIndexCR + vec2(0.5,0.5)));\\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\\n          setOutput(newValue);\\n        }\\n      }\\n    \"},ni=function(t,e,n){this.variableNames=[\"x\"],this.outputShape=t;var r=t.length,o=t[t.length-1],a=n?\"<\":\">\";this.userCode=\"\\n      int getIndex(int i) {\\n        \"+(n?\"return \"+o+\" -i - 1;\":\"return i;\")+\"\\n      }\\n\\n      void main() {\\n        \"+wa(r)+\" coords = getOutputCoords();\\n        int end = \"+ri(r,\"coords\")+\";\\n        float val = 0.0;\\n        for (int i = \"+o+\" - 1; i >= 0; i -= 1) {\\n          int idx = getIndex(i);\\n          if (idx \"+a+\" end) {\\n            continue;\\n          }\\n          if (idx == end && \"+e+\") {\\n            continue;\\n          }\\n          \"+ri(r,\"coords\")+\" = idx;\\n          val += getX(\"+function(t,e){if(1===t)return\"\"+e;if(2===t)return e+\".x, \"+e+\".y\";if(3===t)return e+\".x, \"+e+\".y, \"+e+\".z\";if(4===t)return e+\".x, \"+e+\".y, \"+e+\".z, \"+e+\".w\";throw Error(\"Cumulative sum for rank \"+t+\" is not yet supported\")}(r,\"coords\")+\");\\n        }\\n        setOutput(val);\\n      }\\n    \"};function ri(t,e){if(1===t)return\"\"+e;if(2===t)return e+\".y\";if(3===t)return e+\".z\";if(4===t)return e+\".w\";throw Error(\"Cumulative sum for rank \"+t+\" is not yet supported\")}var oi=function(t){this.variableNames=[\"A\"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Vt.DENSE;var e=Yt(t),n=ua();this.outputShape=t,this.userCode=\"\\n      ivec3 outCoordsFromFlatIndex(int index) {\\n        \"+ca([\"r\",\"c\",\"d\"],t)+\"\\n        return ivec3(r, c, d);\\n      }\\n\\n      void main() {\\n        ivec2 resTexRC = ivec2(resultUV.yx *\\n          vec2(\"+e[0]+\", \"+e[1]+\"));\\n        int index = 4 * (resTexRC.x * \"+e[1]+\" + resTexRC.y);\\n\\n        vec4 result = vec4(0.);\\n\\n        for (int i=0; i<4; i++) {\\n          int flatIndex = index + i;\\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\\n          result[i] = getA(rc.x, rc.y, rc.z);\\n        }\\n\\n        \"+n.output+\" = result;\\n      }\\n    \"},ai=function(t){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Vt.DENSE;var e=Yt(t),n=ua();this.outputShape=t,this.userCode=\"\\n      ivec3 outCoordsFromFlatIndex(int index) {\\n        \"+ca([\"r\",\"c\",\"d\"],t)+\"\\n        return ivec3(r, c, d);\\n      }\\n\\n      void main() {\\n        ivec2 resTexRC = ivec2(resultUV.yx *\\n          vec2(\"+e[0]+\", \"+e[1]+\"));\\n        int index = 4 * (resTexRC.x * \"+e[1]+\" + resTexRC.y);\\n\\n        vec4 result = vec4(0.);\\n\\n        for (int i=0; i<4; i++) {\\n          int flatIndex = index + i;\\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\\n        }\\n\\n        \"+n.output+\" = result;\\n      }\\n    \"},ii=function(){function t(t,e,n){this.variableNames=[\"x\"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=\"\\n    void main() {\\n      ivec4 coords = getOutputCoords();\\n      int b = coords[0];\\n      int h = \"+this.getHeightCoordString()+\";\\n      int w = \"+this.getWidthCoordString()+\";\\n      int d = \"+this.getDepthCoordString()+\";\\n\\n      int in_h = h / \"+e+\";\\n      int offset_h = imod(h, \"+e+\");\\n      int in_w = w / \"+e+\";\\n      int offset_w = imod(w, \"+e+\");\\n      int offset_d = (offset_h * \"+e+\" + offset_w) *\\n        \"+this.getOutputDepthSize()+\";\\n      int in_d = d + offset_d;\\n\\n      float result = \"+this.getInputSamplingString()+\";\\n      setOutput(result);\\n    }\\n  \"}return t.prototype.getHeightCoordString=function(){return\"NHWC\"===this.dataFormat?\"coords[1]\":\"coords[2]\"},t.prototype.getWidthCoordString=function(){return\"NHWC\"===this.dataFormat?\"coords[2]\":\"coords[3]\"},t.prototype.getDepthCoordString=function(){return\"NHWC\"===this.dataFormat?\"coords[3]\":\"coords[1]\"},t.prototype.getOutputDepthSize=function(){return\"NHWC\"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return\"NHWC\"===this.dataFormat?\"getX(b, in_h, in_w, in_d)\":\"getX(b, in_d, in_h, in_w)\"},t}(),si=function(t){this.variableNames=[\"X\"],this.outputShape=[t,t],this.userCode=\"\\n      void main() {\\n          ivec2 coords = getOutputCoords();\\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\\n          setOutput(val);\\n      }\\n    \"},ui=function(t){this.variableNames=[\"A\"],this.outTexUsage=zt.DOWNLOAD;var e=ua();this.outputShape=t,this.userCode=\"\\n      \"+ha+\"\\n\\n      void main() {\\n        float x = getAAtOutCoords();\\n        \"+e.output+\" = encode_float(x);\\n      }\\n    \"},ci=function(t){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zt.DOWNLOAD;var e=ua();this.outputShape=t,this.userCode=\"\\n      \"+ha+\"\\n\\n      void main() {\\n        ivec3 coords = getOutputCoords();\\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\\n        \"+e.output+\" = encode_float(x);\\n      }\\n    \"},li=function(t,e,n){void 0===n&&(n=!1),this.variableNames=[\"A\"];var r=ua(),o=e[0],a=e[1];this.outputShape=t;var i=\"result\";n&&(i=\"floor(result * 255. + 0.5)\"),this.userCode=\"\\n      \"+la(t)+\"\\n\\n      void main() {\\n        ivec3 coords = getOutputCoords();\\n\\n        int flatIndex = getFlatIndex(coords);\\n        int offset = imod(flatIndex, 4);\\n\\n        flatIndex = idiv(flatIndex, 4, 1.);\\n        \\n        int r = flatIndex / \"+a+\";\\n        int c = imod(flatIndex, \"+a+\");\\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(\"+a+\".0, \"+o+\".0);\\n        vec4 values = \"+r.texture2D+\"(A, uv);\\n\\n        float result;\\n\\n        if(offset == 0) {\\n          result = values[0];\\n        } else if(offset == 1) {\\n          result = values[1];\\n        } else if(offset == 2) {\\n          result = values[2];\\n        } else {\\n          result = values[3];\\n        }\\n\\n        \"+r.output+\" = vec4(\"+i+\", 0., 0., 0.);\\n      }\\n    \"},hi=function(t,e,n){void 0===n&&(n=!1),this.variableNames=[\"A\"],this.packedInputs=!1,this.packedOutput=!0;var r=ua(),o=e[0],a=e[1];this.outputShape=t;var i=\"\",s=\"result\";n&&(s=\"floor(result * 255. + 0.5)\");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;i+=\"\\n          localCoords = coords;\\n          if(localCoords[2] + \"+c+\" < \"+t[2]+\") {\\n            localCoords[2] += \"+c+\";\\n            if(localCoords[1] + \"+u+\" < \"+t[1]+\") {\\n              localCoords[1] += \"+u+\";\\n\\n              flatIndex = getFlatIndex(localCoords);\\n              offset = imod(flatIndex, 4);\\n\\n              flatIndex = idiv(flatIndex, 4, 1.);\\n\\n              r = flatIndex / \"+a+\";\\n              c = imod(flatIndex, \"+a+\");\\n              uv = (vec2(c, r) + halfCR) / vec2(\"+a+\".0, \"+o+\".0);\\n              values = \"+r.texture2D+\"(A, uv);\\n\\n              if(offset == 0) {\\n                result[\"+l+\"] = values[0];\\n              } else if(offset == 1) {\\n                result[\"+l+\"] = values[1];\\n              } else if(offset == 2) {\\n                result[\"+l+\"] = values[2];\\n              } else {\\n                result[\"+l+\"] = values[3];\\n              }\\n            }\\n          }\\n        \"}this.userCode=\"\\n      \"+la(t)+\"\\n\\n      void main() {\\n        ivec3 coords = getOutputCoords();\\n\\n        vec4 result = vec4(0.);\\n        int flatIndex, r, c, offset;\\n        ivec3 localCoords;\\n        vec2 uv;\\n        vec4 values;\\n\\n        \"+i+\"\\n\\n        \"+r.output+\" = \"+s+\";\\n      }\\n    \"},fi=\"return real * expR - imag * expI;\",di=\"return real * expI + imag * expR;\",pi=function(t,e,n){this.variableNames=[\"real\",\"imag\"];var r=e[1];this.outputShape=e;var o=n?\"2.0 * \"+Math.PI:\"-2.0 * \"+Math.PI,a=n?r+\".0\":\"1.0\";this.userCode=\"\\n      const float exponentMultiplier = \"+o+\";\\n\\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\\n        \"+t+\"\\n      }\\n\\n      float mulMatDFT(int batch, int index) {\\n        float indexRatio = float(index) / float(\"+r+\");\\n        float exponentMultiplierTimesIndexRatio =\\n            exponentMultiplier * indexRatio;\\n\\n        float result = 0.0;\\n\\n        for (int i = 0; i < \"+r+\"; i++) {\\n          // x = (-2|2 * PI / N) * index * i;\\n          float x = exponentMultiplierTimesIndexRatio * float(i);\\n          float expR = cos(x);\\n          float expI = sin(x);\\n          float real = getReal(batch, i);\\n          float imag = getImag(batch, i);\\n\\n          result +=\\n              unaryOpComplex(real, expR, imag, expI) / \"+a+\";\\n        }\\n\\n        return result;\\n      }\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        setOutput(mulMatDFT(coords[0], coords[1]));\\n      }\\n    \"},vi=function(){function t(t,e){this.outputShape=[],this.variableNames=[\"x\"],this.outputShape=t,this.userCode=\"\\n      uniform float value;\\n      void main() {\\n        // Input can be obtained from uniform value.\\n        setOutput(value);\\n      }\\n    \"}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,\"value\")),n.gl.uniform1f(e.valueLoc,t)}},t}(),mi=function(t,e,n){this.variableNames=[\"A\",\"indices\"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var o=wa(this.rank),a=function(t,e){var n=t.length;if(n>4)throw Error(\"Gather for rank \"+n+\" is not yet supported\");if(1===n)return\"int(getIndices(resRC))\";for(var r=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\"],o=[],a=0;a<t.length;a++)a===e?o.push(\"int(getIndices(\"+r[a]+\"))\"):o.push(\"\"+r[a]);return o.join()}(t,n);this.userCode=\"\\n      void main() {\\n        \"+o+\" resRC = getOutputCoords();\\n        setOutput(getA(\"+a+\"));\\n      }\\n    \"};var gi=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=[\"x\",\"indices\"],this.outputShape=n;var r=wa(e.length),o=wa(n.length),a=this.sliceDim>1?\"strides[j]\":\"strides\";this.userCode=\"\\n        \"+r+\" strides = \"+r+\"(\"+this.strides+\");\\n         void main() {\\n          \"+o+\" coords = getOutputCoords();\\n          int flattenIndex = 0;\\n          for (int j = 0; j < \"+this.sliceDim+\"; j++) {\\n            int index = round(getIndices(coords[0], j));\\n            flattenIndex += index * \"+a+\";\\n          }\\n          setOutput(getX(flattenIndex, coords[1]));\\n        }\\n      \"};function yi(t,e){var n=ua();return oe(t,e,n.version+\"\\n    precision highp float;\\n    \"+n.attribute+\" vec3 clipSpacePos;\\n    \"+n.attribute+\" vec2 uv;\\n    \"+n.varyingVs+\" vec2 resultUV;\\n\\n    void main() {\\n      gl_Position = vec4(clipSpacePos, 1);\\n      resultUV = uv;\\n    }\")}function xi(t,e){return fe(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function bi(t,e){return de(t,e,new Uint16Array([0,1,2,2,1,3]))}function wi(t,e,n,r,o,a,i){ve(n,r);var s=pe(t,e),u=t.TEXTURE_2D;return Jt(t,e,(function(){return t.bindTexture(u,s)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Jt(t,e,(function(){return t.texImage2D(u,0,o,n,r,0,a,i,null)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function Ci(t,e,n,r,o){var a=Xt(n,r);return wi(t,e,a[0],a[1],o.internalFormatFloat,o.textureFormatFloat,t.FLOAT)}function Ei(t,e,n,r,o){var a=Xt(n,r);return wi(t,e,a[0],a[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function Ri(t,e,n,r,o){var a=Xt(n,r);return wi(t,e,a[0],a[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function Ii(t,e,n,r,o){var a=$t(n,r);return wi(t,e,a[0],a[1],o.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function ki(t,e,n,r,o){var a=$t(n,r);return wi(t,e,a[0],a[1],o.internalFormatPackedHalfFloat,t.RGBA,o.textureTypeHalfFloat)}function Si(t,e,n,r){return Jt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),ge(t,e,n,\"clipSpacePos\",r,3,20,0)&&ge(t,e,n,\"uv\",r,2,20,12)}function Ai(t,e,n,r,o,a,i){var s,u,c;Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),a instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*o*4),u=t.FLOAT,c=i.internalFormatPackedFloat),s.set(a),Jt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,o,0,t.RGBA,u,s)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Di(t,e,n,r){Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Jt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):Jt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Ti(t,e,n,r,o){var a=t.createBuffer();Jt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,a)}));var i=16*n*r;return Jt(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)})),Jt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),Jt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),a}function Ni(t,e,n){var r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function Fi(t,e,n,r,o){var a=Xt(n,r),i=a[0],s=a[1],u=new Uint8Array(n*r*4);return Jt(t,e,(function(){return t.readPixels(0,0,i,s,o.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function _i(t,e,n,r,o,a,i,s){var u=t,c=new Float32Array(function(t,e){var n=$t(t,e);return n[0]*n[1]*4}(a,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function Oi(t,e,n,r){var o=new Float32Array(n*r*4);return Jt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,o)})),o}var Mi=Object.freeze({createVertexShader:yi,createVertexBuffer:xi,createIndexBuffer:bi,createFloat32MatrixTexture:Ci,createFloat16MatrixTexture:Ei,createUnsignedBytesMatrixTexture:Ri,createPackedMatrixTexture:Ii,createFloat16PackedMatrixTexture:ki,bindVertexProgramAttributeStreams:Si,uploadDenseMatrixToTexture:Ai,uploadPixelDataToTexture:Di,createBufferFromOutputTexture:Ti,downloadFloat32MatrixFromBuffer:Ni,downloadByteEncodedFloatMatrixFromOutputTexture:Fi,downloadPackedMatrixFromBuffer:_i,downloadMatrixFromPackedOutputTexture:Oi}),Bi=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=i().getNumber(\"WEBGL_VERSION\");null!=t?(this.gl=t,Kt(e,t)):this.gl=jt(e);var n=\"WEBGL_color_buffer_float\";if(1===i().getNumber(\"WEBGL_VERSION\")){if(this.textureFloatExtension=re(this.gl,this.debug,\"OES_texture_float\"),Pe(this.gl,\"OES_texture_half_float\"))this.textureHalfFloatExtension=re(this.gl,this.debug,\"OES_texture_half_float\");else if(i().get(\"WEBGL_FORCE_F16_TEXTURES\"))throw new Error(\"GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.\");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Pe(this.gl,\"EXT_color_buffer_half_float\"))this.colorBufferHalfFloatExtension=re(this.gl,this.debug,\"EXT_color_buffer_half_float\");else if(i().get(\"WEBGL_FORCE_F16_TEXTURES\"))throw new Error(\"GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.\")}else if(n=\"EXT_color_buffer_float\",Pe(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Pe(this.gl,\"EXT_color_buffer_half_float\"))throw new Error(\"GL context does not support color renderable floats\");this.colorBufferHalfFloatExtension=this.gl.getExtension(\"EXT_color_buffer_half_float\")}this.vertexBuffer=xi(this.gl,this.debug),this.indexBuffer=bi(this.gl,this.debug),this.framebuffer=me(this.gl,this.debug),this.textureConfig=Qt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,\"debug\",{get:function(){return i().getBool(\"DEBUG\")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn(\"Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing.\"),null!=this.outputTexture&&console.warn(\"Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.\");var e=this.gl;Jt(e,this.debug,(function(){return e.finish()})),Jt(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Jt(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Jt(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Jt(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Jt(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),Ci(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),Ei(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),Ri(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),Di(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),Ai(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ki(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),Ii(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(Ee(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Jt(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Fi(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,o,a){return _i(this.gl,t,0,0,0,o,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return Ni(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=Ti(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(i().getBool(\"WEBGL_FENCE_API_ENABLED\")){var o=t,a=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=o.clientWaitSync(a,0,0);return t===o.ALREADY_SIGNALED||t===o.CONDITION_SATISFIED},e=a}else i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Oi(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=ae(e,this.debug,t),r=yi(e,this.debug),o=ce(e,this.debug);return Jt(e,this.debug,(function(){return e.attachShader(o,r)})),Jt(e,this.debug,(function(){return e.attachShader(o,n)})),le(e,this.debug,o),this.debug&&he(e,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=Si(e,this.debug,this.program,this.vertexBuffer)),o},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&Jt(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&he(this.gl,this.debug,this.program),Jt(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?xe(this.gl,this.debug,t,e):be(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Jt(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),we(this.gl,this.debug,this.program,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=$t(e,n),o=r[0],a=r[1];this.setOutputMatrixTextureDriver(t,o,a)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error(\"setOutputPackedMatrixWriteRegion not implemented.\")},t.prototype.debugValidate=function(){null!=this.program&&he(this.gl,this.debug,this.program),Re(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Jt(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Jt(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=re(this.gl,this.debug,2===i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")?\"EXT_disjoint_timer_query_webgl2\":\"EXT_disjoint_timer_query\")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},t.prototype.endQuery=function(){if(2!==i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return n(this,void 0,void 0,(function(){var e=this;return r(this,(function(n){switch(n.label){case 0:return[4,F((function(){return e.disposed||e.isQueryAvailable(t,i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e){(0,this.itemsToPoll[e].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||F((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Ce(this.gl,this.debug,t,this.framebuffer),this.debug&&Re(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Ce(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Re(this.gl)):Ee(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;Ce(r,this.debug,t,this.framebuffer),this.debug&&Re(r),this.outputTexture=t,Jt(r,this.debug,(function(){return r.viewport(0,0,e,n)})),Jt(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var o=this;this.throwIfDisposed(),Jt(this.gl,this.debug,(function(){return o.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error(\"Attempted to use disposed GPGPUContext.\")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error(\"No GPU program is currently set.\")},t}();function Pi(t,e){if(t.length!==e.length)throw Error(\"Binary was compiled with \"+t.length+\" inputs, but was executed with \"+e.length+\" inputs\");t.forEach((function(t,n){var r=t.logicalShape,o=e[n],a=o.shape;if(!S(r,a))throw Error(\"Binary was compiled with different shapes than the current args. Shapes \"+r+\" and \"+a+\" must match\");if(!t.isUniform||!o.isUniform){var i=t.texShape,s=o.isUniform?null:o.texData.texShape;if(!S(i,s))throw Error(\"Binary was compiled with different texture shapes than the current args. Shape \"+i+\" and \"+s+\" must match\")}}))}var Li=function(t,e,n){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,o=n.inChannels,a=n.strideWidth,i=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,h=n.dataFormat,f=s.left,d=s.top,p=o*r,v=ua(),m=\"channelsLast\"===h,g=m?0:1,y=m?1:2,x=\"\",b=0;b<=1;b++)for(var w=0;w<=1;w++)x+=\"\\n          blockIndex = rc.y + \"+w+\";\\n          pos = rc.x + \"+b+\";\\n\\n          if(blockIndex < \"+t[1]+\" && pos < \"+t[0]+\") {\\n            offsetY = int(blockIndex / (\"+u+\")) * \"+i+\" - \"+d+\";\\n            d0 = offsetY + \"+l+\" * (pos / \"+p+\");\\n\\n            if(d0 < \"+e[g]+\" && d0 >= 0) {\\n\\n              offsetX = int(mod(float(blockIndex), \"+u+\".) * \"+a+\". - \"+f+\".);\\n              d1 = offsetX + \"+c+\" * (int(mod(float(pos), \"+p+\".) / \"+o+\".));\\n\\n              if(d1 < \"+e[y]+\" && d1 >= 0) {\\n\\n                ch = int(mod(float(pos), \"+o+\".));\\n\\n                if (\"+m+\") {\\n                  innerDims = vec2(d1, ch);\\n                  result[\"+(2*b+w)+\"] = getChannel(\\n                    getA(d0, int(innerDims.x),\\n                    int(innerDims.y)), innerDims);\\n                } else {\\n                  innerDims = vec2(d0, d1);\\n                  result[\"+(2*b+w)+\"] = getChannel(\\n                    getA(ch, int(innerDims.x),\\n                    int(innerDims.y)), innerDims);\\n                }\\n              }\\n            }\\n          }\\n        \";this.userCode=\"\\n      void main() {\\n        ivec2 rc = getOutputCoords();\\n\\n        vec4 result = vec4(0);\\n\\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\\n        vec2 innerDims;\\n\\n        \"+x+\"\\n\\n        \"+v.output+\" = result;\\n      }\\n    \"},Wi=function(t,e,n,r,o){this.variableNames=[\"x\"],this.outputShape=[];var a,i=e,s=t[3]-1;this.outputShape=t;var u=\"float(\"+n+\") + float(\"+r+\") * sum\";a=.5===o?\"inversesqrt(\"+u+\")\":1===o?\"1.0/(\"+u+\")\":\"exp(log(\"+u+\") * float(-\"+o+\"));\",this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int r = coords[1];\\n        int c = coords[2];\\n        int d = coords[3];\\n        float x = getX(b, r, c, d);\\n        float sum = 0.0;\\n        for (int j = -\"+i+\"; j <= \"+i+\"; j++) {\\n          int idx = d + j;\\n          if (idx >= 0 && idx <=  \"+s+\") {\\n            float z = getX(b, r, c, idx);\\n            sum += z * z;\\n          }\\n        }\\n        float val = x * \"+a+\";\\n        setOutput(val);\\n      }\\n    \"},Ui=function(t,e,n,r,o){this.variableNames=[\"inputImage\",\"outputImage\",\"dy\"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=o,this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int r = coords[1];\\n        int c = coords[2];\\n\\n        float result = 0.0;\\n        for (int d = 0; d < \"+this.depth+\"; ++d) {\\n          int depthBegin = int(max(0.0, float(d - \"+e+\")));\\n          int depthEnd = int(min(float(\"+this.depth+\"),\\n              float(d + \"+e+\" + 1)));\\n\\n          const int MIN_DEPTH_BEGIN = 0;\\n          const int MAX_DEPTH_END = \"+this.depth+\";\\n\\n          float norm = 0.0;\\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\\n            if (k < depthBegin){\\n              continue;\\n            }\\n            else if (k >= depthBegin && k < depthEnd) {\\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\\n            }\\n            else {\\n              break;\\n            }\\n          }\\n\\n          norm = float(\"+r+\") * norm + float(\"+n+\");\\n\\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\\n            if (k < depthBegin){\\n              continue;\\n            }\\n            else if (k >= depthBegin && k < depthEnd){\\n              float dyi = -2.0 * float(\"+r+\")\\n                * float(\"+o+\")\\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\\n                / norm;\\n              if (k == d) {\\n                dyi += pow(norm, -1.0 * \"+o+\");\\n              }\\n              if (k == coords[3]) {\\n                dyi *= getDy(b, r, c, d);\\n                result += dyi;\\n              }\\n            }\\n            else {\\n              break;\\n            }\\n          }\\n      }\\n      setOutput(result);\\n      }\\n    \"},Vi=function(t,e,n,r,o){this.variableNames=[\"x\"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,i=e,s=t[3]-1;this.outputShape=t;var u=\"float(\"+n+\") + float(\"+r+\") * sum\";a=.5===o?\"inversesqrt(\"+u+\")\":1===o?\"1.0/(\"+u+\")\":\"exp(log(\"+u+\") * float(-\"+o+\"));\",this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords.x;\\n        int r = coords.y;\\n        int c = coords.z;\\n        int d = coords.w;\\n\\n        bool hasNextCol = d < \"+this.outputShape[3]+\";\\n        bool hasNextRow = c < \"+this.outputShape[2]+\";\\n\\n        vec4 sum = vec4(0.);\\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\\n\\n        vec4 xAtOutputCoords = vec4(\\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\\n          hasNextCol ?\\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\\n          hasNextRow ?\\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\\n          (hasNextRow && hasNextCol) ?\\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\\n        );\\n\\n        int firstChannel = d - \"+i+\";\\n        vec2 cache = vec2(0.);\\n        if(firstChannel >= 0){\\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\\n            if(hasNextRow){\\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\\n            }\\n        }\\n\\n        ivec2 depth = ivec2(d, d + 1);\\n        for (int j = - \"+i+\"; j <= \"+i+\"; j++) {\\n          ivec2 idx = depth + j;\\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(\"+s+\"));\\n\\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\\n\\n          if(depthInRange || depthPlusOneInRange){\\n            vec4 z = vec4(0.);\\n            vec4 xFragAtCurrentDepth;\\n            z.xz = cache.xy;\\n            if(depthPlusOneInRange && hasNextCol){\\n              xFragAtCurrentDepth = idx.y != d ?\\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\\n              if(hasNextRow){\\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\\n              }\\n            }\\n            cache.xy = z.yw;\\n            sum += z * z;\\n          }\\n        }\\n        vec4 result = xAtOutputCoords * \"+a+\";\\n        setOutput(result);\\n      }\\n    \"},zi=function(t){this.variableNames=[\"dy\",\"maxPos\"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,a=t.effectiveFilterWidth,i=o-1-t.padInfo.top,s=a-1-t.padInfo.left,u=o*a-1;this.userCode=\"\\n      const ivec2 pads = ivec2(\"+i+\", \"+s+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n\\n        ivec2 dyRCCorner = coords.yz - pads;\\n        int dyRCorner = dyRCCorner.x;\\n        int dyCCorner = dyRCCorner.y;\\n\\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+o+\";\\n          wR += \"+r+\") {\\n          float dyR = float(dyRCorner + wR) / \"+e+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          for (int wC = 0; wC < \"+a+\"; wC++) {\\n            float dyC = float(dyCCorner + wC) / \"+n+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            float dyValue = getDy(b, idyR, idyC, d);\\n            int maxPosValue = \"+u+\" - int(getMaxPos(b, idyR, idyC, d));\\n\\n            // Get the current value, check it against the value from the\\n            // position matrix.\\n            int curPosValue = wR * \"+a+\" + wC;\\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\\n\\n            dotProd += dyValue * mask;\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Gi=function(t){this.variableNames=[\"dy\",\"maxPos\"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,i=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,h=u-1-t.padInfo.top,f=c-1-t.padInfo.left,d=s*u*c-1;this.userCode=\"\\n      const ivec3 pads = ivec3(\"+l+\", \"+h+\", \"+f+\");\\n\\n      void main() {\\n        ivec5 coords = getOutputCoords();\\n        int batch = coords.x;\\n        int ch = coords.u;\\n\\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\\n        int dyDCorner = dyCorner.x;\\n        int dyRCorner = dyCorner.y;\\n        int dyCCorner = dyCorner.z;\\n\\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\\n        // dx(xD, xR, xC, ch).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n\\n        for (int wD = 0; wD < \"+s+\";\\n           wD += \"+o+\") {\\n          float dyD = float(dyDCorner + wD) / \"+e+\".0;\\n\\n          if (dyD < 0.0 || dyD >= \"+t.outDepth+\".0 || fract(dyD) > 0.0) {\\n            continue;\\n          }\\n          int idyD = int(dyD);\\n\\n          for (int wR = 0; wR < \"+u+\";\\n              wR += \"+a+\") {\\n            float dyR = float(dyRCorner + wR) / \"+n+\".0;\\n\\n            if (dyR < 0.0 || dyR >= \"+t.outHeight+\".0 ||\\n                fract(dyR) > 0.0) {\\n              continue;\\n            }\\n            int idyR = int(dyR);\\n\\n            for (int wC = 0; wC < \"+c+\";\\n                wC += \"+i+\") {\\n              float dyC = float(dyCCorner + wC) / \"+r+\".0;\\n\\n              if (dyC < 0.0 || dyC >= \"+t.outWidth+\".0 ||\\n                  fract(dyC) > 0.0) {\\n                continue;\\n              }\\n              int idyC = int(dyC);\\n\\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\\n              int maxPosValue = \"+d+\" -\\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\\n\\n              // Get the current value, check it against the value from the\\n              // position matrix.\\n              int curPosValue =\\n                  wD * \"+u+\" * \"+c+\" +\\n                  wR * \"+c+\" + wC;\\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\\n\\n              dotProd += dyValue * mask;\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"},Hi=function(t,e,n,r,o,a,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===i&&(i=!1),this.variableNames=[\"matrixA\",\"matrixB\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?\"i * 2, rc.y\":\"rc.y, i * 2\",l=r?\"rc.z, i * 2\":\"i * 2, rc.z\",h=n?[\"a.xxyy\",\"a.zzww\"]:[\"a.xxzz\",\"a.yyww\"],f=r?[\"b.xzxz\",\"b.ywyw\"]:[\"b.xyxy\",\"b.zwzw\"],d=\"\",p=\"\";a&&(d=i?\"vec4 activation(vec4 a) {\\n          vec4 b = getPreluActivationWeightsAtOutCoords();\\n          \"+a+\"\\n        }\":\"vec4 activation(vec4 x) {\\n          \"+a+\"\\n        }\",p=\"result = activation(result);\");var v=o?\"result += getBiasAtOutCoords();\":\"\";o&&this.variableNames.push(\"bias\"),i&&this.variableNames.push(\"preluActivationWeights\"),this.userCode=\"\\n      \"+d+\"\\n\\n      const float sharedDimension = \"+u+\".0;\\n\\n      vec4 dot2x2ARowBCol(ivec3 rc) {\\n        vec4 result = vec4(0);\\n        for (int i = 0; i < \"+u+\"; i++) {\\n          vec4 a = getMatrixA(rc.x, \"+c+\");\\n          vec4 b = getMatrixB(rc.x, \"+l+\");\\n\\n          // These swizzled products need to be separately added.\\n          // See: https://github.com/tensorflow/tfjs/issues/1735\\n          result += (\"+h[0]+\" * \"+f[0]+\");\\n          result += (\"+h[1]+\" * \"+f[1]+\");\\n        }\\n        return result;\\n      }\\n\\n      void main() {\\n        ivec3 rc = getOutputCoords();\\n        vec4 result = dot2x2ARowBCol(rc);\\n\\n        \"+v+\"\\n\\n        \"+p+\"\\n\\n        setOutput(result);\\n      }\\n    \"},qi=function(){function t(t,e,n){this.variableNames=[\"probs\"],this.outputShape=[t,n],this.userCode=\"\\n      uniform float seed;\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n\\n        float r = random(seed);\\n        float cdf = 0.0;\\n\\n        for (int i = 0; i < \"+(e-1)+\"; i++) {\\n          cdf += getProbs(batch, i);\\n\\n          if (r < cdf) {\\n            setOutput(float(i));\\n            return;\\n          }\\n        }\\n\\n        // If no other event happened, last event happened.\\n        setOutput(float(\"+(e-1)+\"));\\n      }\\n    \"}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,\"seed\")),n.gl.uniform1f(e.seedLoc,t)}},t}(),Ki=function(t,e,n,r){this.variableNames=[\"indices\"],this.outputShape=[t,e],this.userCode=\"\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int index = round(getIndices(coords.x));\\n        setOutput(mix(float(\"+r+\"), float(\"+n+\"),\\n                      float(index == coords.y)));\\n      }\\n    \"},ji=function(t){this.variableNames=[\"A\"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(0===e)this.userCode=\"\\n        void main() {\\n          setOutput(vec4(getA(), 0., 0., 0.));\\n        }\\n      \";else{var n=sa(\"rc\",e),r=wa(e),o=function(t,e,n){if(1===t)return\"rc > \"+e[0];for(var r=\"\",o=t-2;o<t;o++)r+=n[o]+\" >= \"+e[o],o<t-1&&(r+=\"||\");return r}(e,t,n),a=function(t,e,n,r){if(1===t)return\"\";var o=r.slice(-2);return\"\\n    int r = \"+o[0]+\";\\n    int c = \"+o[1]+\";\\n    int rp1 = r + 1;\\n    int cp1 = c + 1;\\n\\n    bool cEdge = cp1 >= \"+e+\";\\n    bool rEdge = rp1 >= \"+n+\";\\n  \"}(e,t[t.length-1],t[t.length-2],n),i=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var o=0;o<=1;o++){for(var a=(0===r?\"r\":\"rp1\")+\", \"+(0===o?\"c\":\"cp1\"),i=2;i<t;i++)a=e[e.length-1-i]+\",\"+a;n.push(a)}return n}(n,e);return 1===n?\"getA(rc),\\n            rc + 1 >= \"+t[0]+\" ? 0. : getA(rc + 1),\\n            0, 0\":\"getA(\"+r[0]+\"),\\n          cEdge ? 0. : getA(\"+r[1]+\"),\\n          rEdge ? 0. : getA(\"+r[2]+\"),\\n          rEdge || cEdge ? 0. : getA(\"+r[3]+\")\"}(t,n);this.userCode=\"\\n        void main() {\\n          \"+r+\" rc = getOutputCoords();\\n\\n          if(\"+o+\") {\\n            setOutput(vec4(0));\\n          } else {\\n            \"+a+\"\\n\\n            setOutput(vec4(\"+i+\"));\\n          }\\n        }\\n      \"}};var Xi=function(t,e,n){this.variableNames=[\"x\"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,o=wa(r),a=e.map((function(t){return t[0]})).join(\",\"),i=e.map((function(e,n){return e[0]+t[n]})).join(\",\"),s=[\"coords[0]\",\"coords[1]\",\"coords[2]\",\"coords[3]\"].slice(0,r);this.userCode=1!==r?\"\\n      \"+o+\" start = \"+o+\"(\"+a+\");\\n      \"+o+\" end = \"+o+\"(\"+i+\");\\n\\n      void main() {\\n        \"+o+\" outC = getOutputCoords();\\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\\n          setOutput(float(\"+n+\"));\\n        } else {\\n          \"+o+\" coords = outC - start;\\n          setOutput(getX(\"+s+\"));\\n        }\\n      }\\n    \":\"\\n        int start = \"+a+\";\\n        int end = \"+i+\";\\n\\n        void main() {\\n          int outC = getOutputCoords();\\n          if (outC < start || outC >= end) {\\n            setOutput(float(\"+n+\"));\\n          } else {\\n            setOutput(getX(outC - start));\\n          }\\n        }\\n      \"},Yi=function(t,e,n){this.variableNames=[\"x\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,o=wa(r),a=e.map((function(t){return t[0]})).join(\",\"),i=e.map((function(e,n){return e[0]+t[n]})).join(\",\"),s=sa(\"rc\",r),u=sa(\"source\",r),c=s[r-1]+\" < \"+this.outputShape[r-1],l=1===r?\"source\":\"vec2(\"+u.slice(-2).join()+\")\",h=[o+\" rc = outputLoc;\",s[r-1]+\" += 1;\\n       if(\"+c+\") {\\n      \",1===r?\"\":\"}\\n       rc = outputLoc;\\n       \"+s[r-2]+\" += 1;\\n       if(\"+s[r-2]+\" < \"+this.outputShape[r-2]+\") {\",1===r?\"\":\"  \"+s[r-1]+\" += 1;\\n         if(\"+c+\") {\"],f=1===r?\"rc < start || rc >= end\":\"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))\",d=\"\",p=0,v=1===r?2:4;p<v;p++)d+=\"\\n        \"+h[p]+\"\\n        if (\"+f+\") {\\n          result[\"+p+\"] = float(\"+n+\");\\n        } else {\\n          \"+o+\" source = rc - start;\\n          result[\"+p+\"] = getChannel(getX(\"+u.join()+\"), \"+l+\");\\n        }\\n      \";d+=1===r?\"} \":\"}}\",this.userCode=\"\\n      const \"+o+\" start = \"+o+\"(\"+a+\");\\n      const \"+o+\" end = \"+o+\"(\"+i+\");\\n\\n      void main() {\\n        \"+o+\" outputLoc = getOutputCoords();\\n        vec4 result = vec4(0.);\\n        \"+d+\"\\n        setOutput(result);\\n      }\\n    \"},$i=function(t,e,n){if(this.variableNames=[\"x\"],\"avg\"===e&&n)throw new Error(\"Cannot compute positions for average pool.\");var r=t.filterWidth,o=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var f=\"avg\"===e,d=\"0.0\";if(f||(d=\"-1.0 / 1e-20\"),n)this.userCode=\"\\n        const ivec2 strides = ivec2(\"+o+\", \"+a+\");\\n        const ivec2 pads = ivec2(\"+l+\", \"+h+\");\\n\\n        void main() {\\n          ivec4 coords = getOutputCoords();\\n          int batch = coords[0];\\n          int d = coords[3];\\n\\n          ivec2 xRCCorner = coords.yz * strides - pads;\\n          int xRCorner = xRCCorner.x;\\n          int xCCorner = xRCCorner.y;\\n\\n          // max/min x(?, ?, d) to get y(yR, yC, d).\\n          // ? = to be determined\\n          float minMaxValue = 0.0;\\n          float minMaxValueFound = 0.0;\\n          int minMaxPosition = 0;\\n          float avgValue = 0.0;\\n\\n          for (int wR = 0; wR < \"+u+\";\\n              wR += \"+i+\") {\\n            int xR = xRCorner + wR;\\n\\n            if (xR < 0 || xR >= \"+t.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int wC = 0; wC < \"+c+\";\\n                wC += \"+s+\") {\\n              int xC = xCCorner + wC;\\n\\n              if (xC < 0 || xC >= \"+t.inWidth+\") {\\n                continue;\\n              }\\n\\n              float value = getX(batch, xR, xC, d);\\n\\n              // If a min / max value has already been found, use it. If not,\\n              // use the current value.\\n              float currMinMaxValue = mix(\\n                  value, minMaxValue, minMaxValueFound);\\n              if (value >= currMinMaxValue) {\\n                minMaxValue = value;\\n                minMaxValueFound = 1.0;\\n                minMaxPosition = wR * \"+c+\" + wC;\\n              }\\n            }\\n          }\\n          setOutput(float(minMaxPosition));\\n        }\\n      \";else{var p=e+\"(\"+e+\"(\"+e+\"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])\";\"avg\"===e&&(p=\"avgValue / count\");var v=4*Math.floor(r/4),m=r%4,g=\"\\n      if (\"+f+\") {\\n        avgValue += dot(values, ones);\\n      } else {\\n        minMaxValue = max(values, minMaxValue);\\n      }\\n    \";this.userCode=\"\\n      const ivec2 strides = ivec2(\"+o+\", \"+a+\");\\n      const ivec2 pads = ivec2(\"+l+\", \"+h+\");\\n      const float initializationValue = \"+d+\";\\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n      float count = 0.0;\\n\\n      float getValue(int batch, int xR, int xC, int d) {\\n        if (xC < 0 || xC >= \"+t.inWidth+\") {\\n          return initializationValue;\\n        }\\n        count += 1.0;\\n        return getX(batch, xR, xC, d);\\n      }\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d = coords[3];\\n\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // max/min x(?, ?, d) to get y(yR, yC, d).\\n        // ? = to be determined\\n        vec4 minMaxValue = vec4(\"+d+\");\\n        float avgValue = 0.0;\\n        count = 0.0;\\n\\n        for (int wR = 0; wR < \"+u+\";\\n            wR += \"+i+\") {\\n          int xR = xRCorner + wR;\\n\\n          if (xR < 0 || xR >= \"+t.inHeight+\") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \"+v+\"; wC += 4) {\\n            int xC = xCCorner + wC * \"+s+\";\\n\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              getValue(batch, xR, xC + \"+s+\", d),\\n              getValue(batch, xR, xC + 2 * \"+s+\", d),\\n              getValue(batch, xR, xC + 3 * \"+s+\", d)\\n            );\\n\\n            \"+g+\"\\n          }\\n\\n          int xC = xCCorner + \"+v+\";\\n          if (\"+(1===m)+\") {\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              initializationValue,\\n              initializationValue,\\n              initializationValue\\n            );\\n\\n            \"+g+\"\\n          } else if (\"+(2===m)+\") {\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              getValue(batch, xR, xC + \"+s+\", d),\\n              initializationValue,\\n              initializationValue\\n            );\\n\\n            \"+g+\"\\n          } else if (\"+(3===m)+\") {\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              getValue(batch, xR, xC + \"+s+\", d),\\n              getValue(batch, xR, xC + 2 * \"+s+\", d),\\n              initializationValue\\n            );\\n\\n            \"+g+\"\\n          }\\n        }\\n        setOutput(\"+p+\");\\n      }\\n    \"}},Qi=function(t,e,n){if(this.variableNames=[\"x\"],\"avg\"===e&&n)throw new Error(\"Cannot compute positions for average pool.\");var r=t.filterWidth,o=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var m=\"avg\"===e,g=\"0.0\";if(m||(g=\"-1.0 / 1e-20\"),n)this.userCode=\"\\n        const ivec3 strides =\\n            ivec3(\"+o+\", \"+a+\", \"+i+\");\\n        const ivec3 pads = ivec3(\"+d+\", \"+p+\", \"+v+\");\\n\\n        void main() {\\n          ivec5 coords = getOutputCoords();\\n          int batch = coords.x;\\n          int ch = coords.u;\\n\\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\\n          int xDCorner = xCorner.x;\\n          int xRCorner = xCorner.y;\\n          int xCCorner = xCorner.z;\\n\\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\\n          // ? = to be determined\\n          float minMaxValue = 0.0;\\n          float minMaxValueFound = 0.0;\\n          int minMaxPosition = 0;\\n\\n          for (int wD = 0; wD < \"+l+\";\\n              wD += \"+s+\") {\\n            int xD = xDCorner + wD;\\n\\n            if (xD < 0 || xD >= \"+t.inDepth+\") {\\n              continue;\\n            }\\n\\n            for (int wR = 0; wR < \"+h+\";\\n                wR += \"+u+\") {\\n              int xR = xRCorner + wR;\\n\\n              if (xR < 0 || xR >= \"+t.inHeight+\") {\\n                continue;\\n              }\\n\\n              for (int wC = 0; wC < \"+f+\";\\n                  wC += \"+c+\") {\\n                int xC = xCCorner + wC;\\n\\n                if (xC < 0 || xC >= \"+t.inWidth+\") {\\n                  continue;\\n                }\\n\\n                float value = getX(batch, xD, xR, xC, ch);\\n\\n                // If a min / max value has already been found, use it. If not,\\n                // use the current value.\\n                float currMinMaxValue = mix(\\n                    value, minMaxValue, minMaxValueFound);\\n                if (value >= currMinMaxValue) {\\n                  minMaxValue = value;\\n                  minMaxValueFound = 1.0;\\n                  minMaxPosition =\\n                      wD * \"+h+\" * \"+f+\" +\\n                      wR * \"+f+\" + wC;;\\n                }\\n              }\\n            }\\n          }\\n          setOutput(float(minMaxPosition));\\n        }\\n      \";else{var y=e+\"(\"+e+\"(\"+e+\"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])\";\"avg\"===e&&(y=\"avgValue / count\");var x=4*Math.floor(r/4),b=r%4,w=\"\\n      if (\"+m+\") {\\n        avgValue += dot(values, ones);\\n      } else {\\n        minMaxValue = max(values, minMaxValue);\\n      }\\n    \";this.userCode=\"\\n      const ivec3 strides =\\n        ivec3(\"+o+\", \"+a+\", \"+i+\");\\n      const ivec3 pads = ivec3(\"+d+\", \"+p+\", \"+v+\");\\n      const float initializationValue = \"+g+\";\\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n      float count = 0.0;\\n\\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\\n        if (xC < 0 || xC >= \"+t.inWidth+\") {\\n          return initializationValue;\\n        }\\n        count += 1.0;\\n        return getX(batch, xD, xR, xC, ch);\\n      }\\n\\n      void main() {\\n        ivec5 coords = getOutputCoords();\\n        int batch = coords.x;\\n        int ch = coords.u;\\n\\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\\n        int xDCorner = xCorner.x;\\n        int xRCorner = xCorner.y;\\n        int xCCorner = xCorner.z;\\n\\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\\n        // ? = to be determined\\n        vec4 minMaxValue = vec4(\"+g+\");\\n        float avgValue = 0.0;\\n        count = 0.0;\\n\\n        for (int wD = 0; wD < \"+l+\";\\n            wD += \"+s+\") {\\n          int xD = xDCorner + wD;\\n\\n          if (xD < 0 || xD >= \"+t.inDepth+\") {\\n            continue;\\n          }\\n\\n          for (int wR = 0; wR < \"+h+\";\\n            wR += \"+u+\") {\\n            int xR = xRCorner + wR;\\n\\n            if (xR < 0 || xR >= \"+t.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int wC = 0; wC < \"+x+\"; wC += 4) {\\n              int xC = xCCorner + wC * \"+c+\";\\n\\n              vec4 values = vec4(\\n                getValue(batch, xD, xR, xC, ch),\\n                getValue(batch, xD, xR, xC + \"+c+\", ch),\\n                getValue(batch, xD, xR, xC + 2 * \"+c+\", ch),\\n                getValue(batch, xD, xR, xC + 3 * \"+c+\", ch)\\n              );\\n\\n              \"+w+\"\\n            }\\n\\n            int xC = xCCorner + \"+x+\";\\n            if (\"+(1===b)+\") {\\n              vec4 values = vec4(\\n                getValue(batch, xD, xR, xC, ch),\\n                initializationValue,\\n                initializationValue,\\n                initializationValue\\n              );\\n\\n              \"+w+\"\\n            } else if (\"+(2===b)+\") {\\n              vec4 values = vec4(\\n                getValue(batch, xD, xR, xC, ch),\\n                getValue(batch, xD, xR, xC + \"+c+\", ch),\\n                initializationValue,\\n                initializationValue\\n              );\\n\\n              \"+w+\"\\n            } else if (\"+(3===b)+\") {\\n              vec4 values = vec4(\\n                getValue(batch, xD, xR, xC, ch),\\n                getValue(batch, xD, xR, xC + \"+c+\", ch),\\n                getValue(batch, xD, xR, xC + 2 * \"+c+\", ch),\\n                initializationValue\\n              );\\n\\n              \"+w+\"\\n            }\\n          }\\n          setOutput(\"+y+\");\\n        }\\n      }\\n    \"}},Ji=function(t,e){this.variableNames=[\"x\"];var n=t.windowSize,r=t.batchSize,o=t.inSize,a=Math.ceil(o/n);this.outputShape=[r,a];var i=\"0.0\",s=\"\";\"prod\"===e?i=\"1.0\":\"min\"===e?(i=\"1.0 / 1e-20\",s=\"min\"):\"max\"===e&&(i=\"-1.0 / 1e-20\",s=\"max\");var u=e+\"(\"+e+\"(\"+e+\"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])\";\"sum\"===e?u=\"sumValue\":\"prod\"===e?u=\"prodValue\":\"all\"===e?u=\"allValue\":\"any\"===e&&(u=\"anyValue\");var c=4*Math.floor(n/4),l=n%4,h=\"\\n      if (\"+(\"sum\"===e)+\") {\\n        sumValue += dot(values, ones);\\n      } else if (\"+(\"prod\"===e)+\") {\\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\\n        prodValue *= tmp[0] * tmp[1];\\n      } else {\\n        minMaxValue = \"+s+\"(values, minMaxValue);\\n      }\\n    \",f=\"vec4\";\"all\"===e?(i=\"1.0\",h=\"\\n        bool reducedAllValue = all(values);\\n        float floatedReducedAllValue = float(reducedAllValue);\\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\\n      \",f=\"bvec4\"):\"any\"===e&&(i=\"0.0\",h=\"\\n        bool reducedAnyValue = any(values);\\n        float floatedReducedAnyValue = float(reducedAnyValue);\\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\\n      \",f=\"bvec4\");var d=\"\";o%n>0&&(d=\"\\n        if (inIdx < 0 || inIdx >= \"+o+\") {\\n          return initializationValue;\\n        }\\n      \"),this.userCode=\"\\n      const float initializationValue = \"+i+\";\\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n      float getValue(int batch, int inIdx) {\\n        \"+d+\"\\n        return getX(batch, inIdx);\\n      }\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int outIdx = coords[1];\\n        int inOffset = outIdx * \"+n+\";\\n\\n        vec4 minMaxValue = vec4(\"+i+\");\\n        float prodValue = 1.0;\\n        float sumValue = 0.0;\\n        float allValue = 1.0;\\n        float anyValue = 0.0;\\n\\n        for (int i = 0; i < \"+c+\"; i += 4) {\\n          int inIdx = inOffset + i;\\n          \"+f+\" values = \"+f+\"(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            getValue(batch, inIdx + 3)\\n          );\\n\\n          \"+h+\"\\n        }\\n\\n        int inIdx = inOffset + \"+c+\";\\n        if (\"+(1===l)+\") {\\n          \"+f+\" values = \"+f+\"(\\n            getValue(batch, inIdx),\\n            initializationValue,\\n            initializationValue,\\n            initializationValue\\n          );\\n\\n          \"+h+\"\\n        } else if (\"+(2===l)+\") {\\n          \"+f+\" values = \"+f+\"(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            initializationValue,\\n            initializationValue\\n          );\\n\\n          \"+h+\"\\n        } else if (\"+(3===l)+\") {\\n          \"+f+\" values = \"+f+\"(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            initializationValue\\n          );\\n\\n          \"+h+\"\\n        }\\n        setOutput(\"+u+\");\\n      }\\n    \"},Zi=function(t,e){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n=\"\",r=0;r<4;r++){var o=\"thisRC = rc;\";r%2==1&&(o+=\"thisRC.z += 1;\"),r>1&&(o+=\"thisRC.y += 1;\"),n+=\"\\n        \"+o+\"\\n        \"+(r>0?\"if(thisRC.y < rows && thisRC.z < cols){\":\"\")+\"\\n          int flatIndex = getFlatIndex(thisRC);\\n\\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\\n\\n          result[\"+r+\"] =\\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\\n        \"+(r>0?\"}\":\"\")+\"\\n      \"}this.userCode=\"\\n      \\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\\n      \"+ca([\"r\",\"c\",\"d\"],e)+\"\\n      return ivec3(r, c, d);\\n    }\\n  \\n      \"+la(t)+\"\\n\\n      void main() {\\n        ivec3 rc = getOutputCoords();\\n\\n        vec4 result = vec4(0.);\\n\\n        ivec3 thisRC;\\n        int rows = \"+t[1]+\";\\n        int cols = \"+t[2]+\";\\n\\n        \"+n+\"\\n\\n        setOutput(result);\\n      }\\n    \"};var ts=function(t,e,n){this.variableNames=[\"dy\"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],a=r[2],i=t.shape,s=i[1],u=i[2],c=[n&&s>1?o-1:o,n&&u>1?a-1:a],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],d=1/h,p=1/f,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n        int r = coords[1];\\n        int c = coords[2];\\n\\n        float accumulator = 0.0;\\n\\n        const float heightScale = float(\"+h+\");\\n        const float widthScale = float(\"+f+\");\\n\\n        const float invHeightScale = float(\"+d+\");\\n        const float invWidthScale = float(\"+p+\");\\n\\n        const int winHeight = int(\"+v+\");\\n        const int winWidth = int(\"+m+\");\\n\\n        // Compute bounds for where in dy we will look\\n        float startRLerp = floor(float(r) * invHeightScale);\\n        int startDyR = int(startRLerp - float(winHeight / 2));\\n\\n        float startCLerp = floor(float(c) * invWidthScale);\\n        int startDyC = int(startCLerp - float(winWidth / 2));\\n\\n        // Loop over dy\\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\\n          int dyR = dyROffset + startDyR;\\n\\n          // Guard against the window exceeding the bounds of dy\\n          if (dyR < 0 || dyR >= \"+s+\") {\\n            continue;\\n          }\\n\\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\\n            int dyC = dyCOffset + startDyC;\\n\\n            // Guard against the window exceeding the bounds of dy\\n            if (dyC < 0 || dyC >= \"+u+\") {\\n              continue;\\n            }\\n\\n            float dxR = float(dyR) * heightScale;\\n            int topDxRIndex = int(floor(dxR));\\n            int bottomDxRIndex = int(min(ceil(dxR), \"+(o-1)+\".0));\\n            float dxRLerp = dxR - float(topDxRIndex);\\n            float inverseDxRLerp = 1.0 - dxRLerp;\\n\\n            float dxC = float(dyC) * widthScale;\\n            int leftDxCIndex = int(floor(dxC));\\n            int rightDxCIndex = int(min(ceil(dxC), \"+(a-1)+\".0));\\n            float dxCLerp = dxC - float(leftDxCIndex);\\n            float inverseDxCLerp = 1.0 - dxCLerp;\\n\\n            if (r == topDxRIndex && c == leftDxCIndex) {\\n              // topLeft\\n              accumulator +=\\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\\n            }\\n\\n            if (r == topDxRIndex && c == rightDxCIndex) {\\n              // topRight\\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\\n            }\\n\\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\\n              // bottomLeft\\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\\n            }\\n\\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\\n              // bottomRight\\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\\n            }\\n          }\\n        }\\n        // End loop over dy\\n\\n        setOutput(accumulator);\\n      }\\n    \"},es=function(t,e,n,r){this.variableNames=[\"A\"],this.outputShape=[];var o=t[0],a=t[1],i=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?a-1:a,r&&n>1?i-1:i],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=\"\\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\\n          \"+u[0]/c[0]+\",\\n          \"+u[1]/c[1]+\");\\n      const vec2 inputShapeRC = vec2(\"+a+\".0, \"+i+\".0);\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n        ivec2 yRC = coords.yz;\\n\\n        // Fractional source index.\\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\\n\\n        // Compute the four integer indices.\\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\\n        ivec2 sourceCeilRC = ivec2(\\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\\n\\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\\n\\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\\n\\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\\n        float newValue = top + (bottom - top) * fracRC.x;\\n\\n        setOutput(newValue);\\n      }\\n    \"},ns=function(t,e,n,r){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=t[0],a=t[1],i=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?a-1:a,r&&n>1?i-1:i],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=\"\\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\\n          \"+u[0]/c[0]+\",\\n          \"+u[1]/c[1]+\",\\n          \"+u[1]/c[1]+\");\\n      const vec3 inputShapeRC = vec3(\"+a+\".0, \"+i+\".0,\\n                                     \"+i+\".0);\\n\\n      float getAValue(int b, int r, int c, int d) {\\n        return getChannel(getA(b, r, c, d), vec2(c, d));\\n      }\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n        // Calculate values for next column in yRC.z.\\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\\n\\n        // Fractional source index.\\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\\n\\n        // Compute the four integer indices.\\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\\n        ivec3 sourceCeilRC = ivec3(\\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\\n\\n        // Should we calculate next column and row elements in 2x2 packed cell.\\n        bool hasNextCol = d < \"+(s-1)+\";\\n        bool hasNextRow = coords.z < \"+(n-1)+\";\\n\\n        // In parallel, construct four corners for all four components in\\n        // packed 2x2 cell.\\n        vec4 topLeft = vec4(\\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\\n                     : 0.0,\\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\\n                     : 0.0,\\n          (hasNextRow && hasNextCol) ?\\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\\n\\n        vec4 bottomLeft = vec4(\\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\\n                     : 0.0,\\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\\n                     : 0.0,\\n          (hasNextRow && hasNextCol) ?\\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\\n\\n        vec4 topRight = vec4(\\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\\n                     : 0.0,\\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\\n                     : 0.0,\\n          (hasNextRow && hasNextCol) ?\\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\\n\\n        vec4 bottomRight = vec4(\\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\\n                     : 0.0,\\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\\n                     : 0.0,\\n          (hasNextRow && hasNextCol) ?\\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\\n\\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\\n\\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\\n        vec4 newValue = mix(top, bottom, fracRC.x);\\n\\n        setOutput(newValue);\\n      }\\n    \"},rs=function(t,e,n){this.variableNames=[\"dy\"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],a=r[2],i=t.shape,s=i[1],u=i[2],c=[n&&s>1?o-1:o,n&&u>1?a-1:a],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],d=1/h,p=1/f,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n        int r = coords[1];\\n        int c = coords[2];\\n\\n        float accumulator = 0.0;\\n\\n        const float heightScale = float(\"+h+\");\\n        const float widthScale = float(\"+f+\");\\n\\n        const float invHeightScale = float(\"+d+\");\\n        const float invWidthScale = float(\"+p+\");\\n\\n        const int winHeight = int(\"+v+\");\\n        const int winWidth = int(\"+m+\");\\n\\n        // Compute bounds for where in dy we will look\\n        float startRLerp = floor(float(r) * invHeightScale);\\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\\n\\n        float startCLerp = floor(float(c) * invWidthScale);\\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\\n\\n        // Loop over dy\\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\\n          int dyR = dyROffset + startDyR;\\n\\n          // Guard against the window exceeding the bounds of dy\\n          if (dyR < 0 || dyR >= \"+s+\") {\\n            continue;\\n          }\\n\\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\\n            int dyC = dyCOffset + startDyC;\\n\\n            // Guard against the window exceeding the bounds of dy\\n            if (dyC < 0 || dyC >= \"+u+\") {\\n              continue;\\n            }\\n\\n            float sourceFracRow =\\n              float(\"+c[0]+\") *\\n                (float(dyR) / float(\"+l[0]+\"));\\n\\n            float sourceFracCol =\\n                float(\"+c[1]+\") *\\n                  (float(dyC) / float(\"+l[1]+\"));\\n\\n            int sourceNearestRow = int(min(\\n                float(int(\"+o+\") - 1),\\n                \"+n+\" ? float(round(sourceFracRow)) :\\n                                  float(floor(sourceFracRow))));\\n\\n            int sourceNearestCol = int(min(\\n                float(int(\"+a+\") - 1),\\n                \"+n+\" ? float(round(sourceFracCol)) :\\n                                  float(floor(sourceFracCol))));\\n\\n            if (r == sourceNearestRow && c == sourceNearestCol) {\\n              accumulator += getDy(b, dyR, dyC, d);\\n            }\\n          }\\n        }\\n        // End loop over dy\\n\\n        setOutput(accumulator);\\n      }\\n    \"},os=function(t,e,n,r){this.variableNames=[\"A\"],this.outputShape=[];var o=t[0],a=t[1],i=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?a-1:a,r&&n>1?i-1:i],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?\"0.5\":\"0.0\";this.userCode=\"\\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\\n          \"+u[0]/c[0]+\",\\n          \"+u[1]/c[1]+\");\\n      const vec2 inputShapeRC = vec2(\"+a+\".0, \"+i+\".0);\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n        ivec2 yRC = coords.yz;\\n\\n        // Fractional source index.\\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\\n\\n        // Compute the coordinators of nearest neighbor point.\\n        ivec2 sourceNearestRC = ivec2(\\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + \"+l+\")));\\n\\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\\n\\n        setOutput(newValue);\\n      }\\n    \"},as=function(t,e){this.variableNames=[\"x\"];var n=t.length;if(n>4)throw new Error(\"WebGL backend: Reverse of rank-\"+n+\" tensor is not yet supported\");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+\" - coords[\"+n+\"] - 1\":\"coords[\"+n+\"]\"}(r)})).join(\",\"),o=wa(n);this.userCode=\"\\n      void main() {\\n        \"+o+\" coords = getOutputCoords();\\n        setOutput(getX(\"+r+\"));\\n      }\\n    \"}else this.userCode=\"\\n        void main() {\\n          int coord = getOutputCoords();\\n          setOutput(getX(\"+t[0]+\" - coord - 1));\\n        }\\n      \"},is=function(t,e){this.variableNames=[\"x\"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error(\"WebGL backend: Reverse of rank-\"+n+\" tensor is not yet supported\");this.outputShape=t;var r=sa(\"rc\",n),o=r[n-1]+\" + 1 < \"+this.outputShape[n-1],a=r[n-2]+\" + 1 < \"+this.outputShape[n-2],i=wa(n);function s(n){var r=t.map((function(r,o){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+\" - \"+r[n]+\" - 1\":\"\"+r[n]}(o,n)}));return\"getChannel(getX(\"+r.join(\",\")+\"), vec2(\"+r.slice(-2).join(\",\")+\"))\"}this.userCode=1===n?\"\\n        void main(){\\n          int rc = getOutputCoords();\\n          vec4 result = vec4(0.);\\n          result.r = getChannel(getX(\"+t[0]+\" - rc - 1),\\n            \"+t[0]+\" - rc - 1);\\n          if(\"+o+\"){\\n              result.g = getChannel(getX(\"+t[0]+\" - (rc  + 1) - 1),\\n                \"+t[0]+\" - (rc  + 1) - 1);\\n          }\\n          setOutput(result);\\n        }\\n      \":\"\\n        void main() {\\n          \"+i+\" rc = getOutputCoords();\\n          vec4 result = vec4(0.);\\n          result.r = \"+function(t){return s(t)}(r.slice())+\";\\n          if(\"+o+\"){\\n            result.g = \"+function(t){return t[n-1]=\"(\"+t[n-1]+\" + 1)\",s(t)}(r.slice())+\";\\n          }\\n          if(\"+a+\") {\\n            result.b = \"+function(t){return t[n-2]=\"(\"+t[n-2]+\" + 1)\",s(t)}(r.slice())+\";\\n            if(\"+o+\") {\\n              result.a = \"+function(t){return t[n-1]=\"(\"+t[n-1]+\" + 1)\",t[n-2]=\"(\"+t[n-2]+\" + 1)\",s(t)}(r.slice())+\";\\n            }\\n          }\\n          setOutput(result);\\n        }\\n    \"},ss=function(t,e,n,r,o,a,i){void 0===i&&(i=!0),this.variableNames=[\"updates\",\"indices\",\"defaultValue\"],this.outputShape=a;var s=wa(o.length),u=wa(a.length),c=\"\";1===n?c=\"i\":2===n&&(c=\"i, j\");var l=\"getIndices(\"+c+\")\",h=\"\";1===r?h=\"i\":2===r&&(h=\"i, coords[1]\");var f=\"getUpdates(\"+h+\")\",d=e>1?\"strides[j]\":\"strides\";this.userCode=\"\\n        \"+s+\" strides = \"+s+\"(\"+o+\");\\n\\n        void main() {\\n          \"+u+\" coords = getOutputCoords();\\n          float sum = 0.0;\\n          bool found = false;\\n          for (int i = 0; i < \"+t+\"; i++) {\\n            int flattenedIndex = 0;\\n            for (int j = 0; j < \"+e+\"; j++) {\\n              int index = round(\"+l+\");\\n              flattenedIndex += index * \"+d+\";\\n            }\\n            if (flattenedIndex == coords[0]) {\\n              sum += \"+f+\";\\n              found = true;\\n            }\\n          }\\n          setOutput(mix(getDefaultValue(), sum, float(found)));\\n        }\\n      \"},us=function(t,e){this.variableNames=[\"x\",\"segmentIds\"];var n=t.windowSize,r=t.batchSize,o=t.inSize,a=t.numSegments,i=a*Math.ceil(o/n);this.outputShape=[r,i];var s=4*Math.floor(n/4),u=n%4,c=\"\\n        sumValue += dot(values, segFilter);\\n    \",l=\"\";o%n>0&&(l=\"\\n        if (inIdx < 0 || inIdx >= \"+o+\") {\\n          return initializationValue;\\n        }\\n      \");var h=\"\";o%n>0&&(h=\"\\n        if (inIdx < 0 || inIdx >= \"+o+\") {\\n          return -1.0;\\n        }\\n      \"),this.userCode=\"\\n      const float initializationValue = 0.0;\\n\\n      float getValue(int batch, int inIdx) {\\n        \"+l+\"\\n        return getX(batch, inIdx);\\n      }\\n\\n      float getSegmentIdAtIndex(int inIdx) {\\n        \"+h+\"\\n        return getSegmentIds(inIdx);\\n      }\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int outIdx = coords[1];\\n        int inOffset = int(floor(float(outIdx) / float(\\n          \"+a+\")) * float(\"+n+\"));\\n        int currentSeg = int(mod(float(outIdx), float(\"+a+\")));\\n\\n        float sumValue = 0.0;\\n\\n        for (int i = 0; i < \"+s+\"; i += 4) {\\n          int inIdx = inOffset + i;\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            getValue(batch, inIdx + 3)\\n          );\\n\\n          vec4 segFilter = vec4(\\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\\n          );\\n\\n          \"+c+\"\\n        }\\n\\n        int inIdx = inOffset + \"+s+\";\\n        if (\"+(1===u)+\") {\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            initializationValue,\\n            initializationValue,\\n            initializationValue\\n          );\\n\\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\\n\\n          vec4 segFilter = vec4(\\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\\n            0,\\n            0,\\n            0\\n          );\\n\\n          \"+c+\"\\n        } else if (\"+(2===u)+\") {\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            initializationValue,\\n            initializationValue\\n          );\\n\\n          vec4 segFilter = vec4(\\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\\n              0,\\n              0\\n          );\\n\\n          \"+c+\"\\n        } else if (\"+(3===u)+\") {\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            initializationValue\\n          );\\n\\n          vec4 segFilter = vec4(\\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\\n            0\\n          );\\n\\n          \"+c+\"\\n        }\\n        setOutput(sumValue);\\n      }\\n    \"},cs=function(t,e,n){var r,o;if(this.variableNames=[\"c\",\"a\",\"b\"],this.outputShape=e,n>4)throw Error(\"Where for rank \"+n+\" is not yet supported\");if(1===n)o=\"resRC\",r=\"resRC\";else{for(var a=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\"],i=[],s=[],u=0;u<e.length;u++)s.push(\"\"+a[u]),u<t&&i.push(\"\"+a[u]);r=i.join(),o=s.join()}var c=wa(n);this.userCode=\"\\n      void main() {\\n        \"+c+\" resRC = getOutputCoords();\\n        float cVal = getC(\"+r+\");\\n        if (cVal >= 1.0) {\\n          setOutput(getA(\"+o+\"));\\n        } else {\\n          setOutput(getB(\"+o+\"));\\n        }\\n      }\\n    \"},ls=function(){function t(t){this.variableNames=[\"source\"],this.outputShape=t,this.rank=t.length;var e,n=wa(this.rank),r=\"uniform int start[\"+this.rank+\"];\",o=function(t){if(1===t)return\"sourceLoc\";if(t<=6)return hs.slice(0,t).map((function(t){return\"sourceLoc.\"+t})).join(\",\");throw Error(\"Slicing for rank \"+t+\" is not yet supported\")}(this.rank);e=\"\\n        \"+n+\" sourceLoc;\\n        \"+n+\" coords = getOutputCoords();\\n        \"+t.map((function(t,e){return\"sourceLoc.\"+hs[e]+\" = start[\"+e+\"] + coords.\"+hs[e]+\";\"})).join(\"\\n\")+\"\\n      \",this.userCode=\"\\n      \"+r+\"\\n      void main() {\\n        \"+e+\"\\n        setOutput(getSource(\"+o+\"));\\n      }\\n    \"}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error(\"The rank (\"+this.rank+\") of the program must match the length of start (\"+t.length+\")\");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,\"start\"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),hs=[\"x\",\"y\",\"z\",\"w\",\"u\",\"v\"];var fs=function(){function t(t){this.variableNames=[\"source\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=wa(this.rank),n=sa(\"coords\",this.rank),r=sa(\"sourceLoc\",this.rank),o=1===this.rank?\"sourceLoc\":\"vec2(\"+r.slice(-2).join()+\")\",a=\"getChannel(getSource(\"+r.join()+\"), \"+o+\")\",i=\"\\n      result.x = \"+a+\";\\n      if (++\"+n[this.rank-1]+\" < \"+t[this.rank-1]+\") {\\n        ++\"+r[this.rank-1]+\";\\n        result.y = \"+a+\";\\n        --\"+r[this.rank-1]+\";\\n      }\\n    \",s=1===this.rank?\"\":\"\\n      --\"+n[this.rank-1]+\";\\n      if (++\"+n[this.rank-2]+\" < \"+t[this.rank-2]+\") {\\n        ++\"+r[this.rank-2]+\";\\n        result.z = \"+a+\";\\n        if (++\"+n[this.rank-1]+\" < \"+t[this.rank-1]+\") {\\n          ++\"+r[this.rank-1]+\";\\n          result.w = \"+a+\";\\n        }\\n      }\\n    \",u=this.rank<=4?\"sourceLoc = coords +\\n            \"+e+\"(\"+t.map((function(t,e){return\"start[\"+e+\"]\"})).join()+\");\":t.map((function(t,e){return r[e]+\" = \"+n[e]+\" + start[\"+e+\"];\"})).join(\"\\n\");this.userCode=\"\\n      uniform int start[\"+this.rank+\"];\\n      void main() {\\n        \"+e+\" coords = getOutputCoords();\\n        \"+e+\" sourceLoc;\\n        \"+u+\"\\n        vec4 result = vec4(0.);\\n        \"+i+\"\\n        \"+s+\"\\n        setOutput(result);\\n      }\\n    \"}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error(\"The rank (\"+this.rank+\") of the program must match the length of start (\"+t.length+\")\");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,\"start\"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),ds=function(t,e,n){this.variableNames=[\"x\"],this.outputShape=n;var r=n.length,o=wa(n.length),a=wa(n.length),i=\"\";if(1===r)i=\"coords * strides + begin\";else{var s=0;i=n.map((function(t,e){return s++,1===n.length?\"coords * strides[\"+e+\"] + begin[\"+e+\"]\":\"coords[\"+(s-1)+\"] * strides[\"+e+\"] + begin[\"+e+\"]\"})).join(\",\")}this.userCode=\"\\n      \"+o+\" begin = \"+o+\"(\"+t+\");\\n      \"+o+\" strides = \"+o+\"(\"+e+\");\\n\\n      void main() {\\n        \"+a+\" coords = getOutputCoords();\\n        setOutput(getX(\"+i+\"));\\n      }\\n    \"},ps=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,o=vs(e,n),a=ms(t,o,n);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var i=this.freeTextures[a].shift();return this.usedTextures[a].push(i),i}return this.numUsedTextures++,this.log(),o===Gt.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):o===Gt.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):o===Gt.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):o===Gt.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):o===Gt.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var o=ms(e,vs(n,r),r);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[o],i=a.indexOf(t);if(i<0)throw new Error(\"Cannot release a texture that was never provided by this texture manager\");a.splice(i,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log(\"Free/Used\",this.numFreeTextures+\" / \"+this.numUsedTextures,\"(\"+t+\")\")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function vs(t,e){if(t===zt.UPLOAD)return Gt.PACKED_2X2_FLOAT32;if(t===zt.RENDER||null==t)return function(t){return i().getBool(\"WEBGL_RENDER_FLOAT32_ENABLED\")?t?Gt.PACKED_2X2_FLOAT32:Gt.UNPACKED_FLOAT32:t?Gt.PACKED_2X2_FLOAT16:Gt.UNPACKED_FLOAT16}(e);if(t===zt.DOWNLOAD||t===zt.PIXELS)return Gt.PACKED_4X1_UNSIGNED_BYTE;throw new Error(\"Unknown logical texture type \"+t)}function ms(t,e,n){return t[0]+\"_\"+t[1]+\"_\"+e+\"_\"+n}var gs=function(t,e){this.variableNames=[\"A\"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var o=wa(this.rank),a=function(t){var e=t.length;if(e>5)throw Error(\"Tile for rank \"+e+\" is not yet supported\");if(1===e)return\"imod(resRC, \"+t[0]+\")\";for(var n=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\",\"resRC.u\"],r=[],o=0;o<t.length;o++)r.push(\"imod(\"+n[o]+\", \"+t[o]+\")\");return r.join()}(t);this.userCode=\"\\n      void main() {\\n        \"+o+\" resRC = getOutputCoords();\\n        setOutput(getA(\"+a+\"));\\n      }\\n    \"};var ys=function(t,e){this.variableNames=[\"A\"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var o=wa(this.rank),a=function(t){var e=t.length;if(e>6)throw Error(\"Transpose for rank \"+e+\" is not yet supported\");for(var n=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\",\"resRC.u\",\"resRC.v\"],r=new Array(e),o=0;o<t.length;o++)r[t[o]]=n[o];return r.join()}(e);this.userCode=\"\\n    void main() {\\n      \"+o+\" resRC = getOutputCoords();\\n      setOutput(getA(\"+a+\"));\\n    }\\n    \"};var xs=function(t,e){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(\"Packed transpose for rank \"+this.rank+\" is not yet supported.\");var o=wa(this.rank),a=ia(\"rc\",this.rank),i=new Array(this.rank);for(r=0;r<e.length;r++)i[e[r]]=a[r];var s=\"vec2(\"+i.slice(-2).join()+\")\",u=\"++\"+a[this.rank-1]+\" < \"+n[this.rank-1],c=\"getChannel(getA(\"+i.join()+\"), \"+s+\")\";this.userCode=\"\\n    void main() {\\n      \"+o+\" rc = getOutputCoords();\\n      vec4 result = vec4(0.);\\n      result[0] = \"+c+\";\\n      if(\"+u+\") {\\n        result[1] = \"+c+\";\\n      }\\n      --\"+a[this.rank-1]+\";\\n      if(++\"+a[this.rank-2]+\" < \"+n[this.rank-2]+\") {\\n        result[2] = \"+c+\";\\n        if(\"+u+\") {\\n          result[3] = \"+c+\";\\n        }\\n      }\\n      setOutput(result);\\n    }\\n    \"},bs=1.7580993408473768,ws=1.0507009873554805,Cs=function(t,e){this.variableNames=[\"A\"],this.outputShape=t,this.userCode=\"\\n      float unaryOperation(float x) {\\n        \"+e+\"\\n      }\\n\\n      void main() {\\n        float x = getAAtOutCoords();\\n        float y = unaryOperation(x);\\n\\n        setOutput(y);\\n      }\\n    \"},Es=\"if (isnan(x)) return x;\",Rs=\"return x;\",Is=\"return abs(x);\",ks=Es+\"\\n  return (x < 0.0) ? 0.0 : x;\\n\",Ss=Es+\"\\n  return (x < 0.0) ? 0.0 : min(6.0, x);\\n\",As=\"return (x >= 0.0) ? x : (exp(x) - 1.0);\",Ds=\"\\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\\n  // see: https://arxiv.org/abs/1706.02515\\n  float scaleAlpha = \"+bs+\";\\n  float scale = \"+ws+\";\\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\\n\";var Ts=\"return -x;\",Ns=\"return ceil(x);\",Fs=\"return floor(x);\",_s=\"return exp(x);\",Os=\"return exp(x) - 1.0;\",Ms=Es+\"\\n  return sin(x);\\n\",Bs=Es+\"\\n  return cos(x);\\n\",Ps=Es+\"\\n  if (abs(x) > 1.) {\\n    return NAN;\\n  }\\n  return asin(x);\\n\",Ls=Es+\"\\n  if (abs(x) > 1.) {\\n    return NAN;\\n  }\\n  return acos(x);\\n\",Ws=Es+\"\\n  return atan(x);\\n\",Us=Es+\"return log(x + sqrt(x * x + 1.0));\",Vs=Es+\"\\n  if (x < 1.0) return NAN;\\n  return log(x + sqrt(x * x - 1.0));\",zs=Es+\"\\n  if ((x < -1.0) || (x > 1.0)) return NAN;\\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;\",Gs=\"return x;\",Hs=\"return x;\",qs=\"\\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\\n  bvec4 isNaN = isnan(x);\\n\\n  result.r = isNaN.r ? x.r : result.r;\\n  result.g = isNaN.g ? x.g : result.g;\\n  result.b = isNaN.b ? x.b : result.b;\\n  result.a = isNaN.a ? x.a : result.a;\\n\\n  return result;\\n\",Ks=\"\\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\\n  bvec4 isNaN = isnan(x);\\n\\n  result.r = isNaN.r ? x.r : result.r;\\n  result.g = isNaN.g ? x.g : result.g;\\n  result.b = isNaN.b ? x.b : result.b;\\n  result.a = isNaN.a ? x.a : result.a;\\n\\n  return result;\\n\",js=\"\\n  vec4 result;\\n\\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\\n\\n  return result;\\n\",Xs=function(t,e){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=\"\\n      vec4 unaryOperation(vec4 x) {\\n        \"+e+\"\\n      }\\n\\n      void main() {\\n        vec4 x = getAAtOutCoords();\\n        vec4 y = unaryOperation(x);\\n\\n        setOutput(y);\\n      }\\n    \"},Ys=function(t){this.variableNames=[\"A\"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=sa(\"rc\",e),r=wa(e),o=function(t,e){if(1===t)return\"rc\";for(var n=\"\",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=\",\");return n}(e,n),a=n.slice(-2),i=e<=1?\"rc\":\"vec2(\"+a.join(\",\")+\")\";this.userCode=\"\\n      void main() {\\n        \"+r+\" rc = getOutputCoords();\\n        vec4 packedInput = getA(\"+o+\");\\n\\n        setOutput(getChannel(packedInput, \"+i+\"));\\n      }\\n    \"},$s={};function Qs(t,e){if(void 0===e&&(e=!1),\"linear\"===t)return e?Hs:Rs;if(\"relu\"===t)return e?qs:ks;if(\"elu\"===t)return e?js:As;if(\"relu6\"===t)return e?Ks:Ss;if(\"prelu\"===t)return e?Pa:Ma;throw new Error(\"Activation \"+t+\" has not been implemented for the WebGL backend.\")}var Js=600;var Zs=function(t){function o(e){var n,r=t.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!i().getBool(\"HAS_WEBGL\"))throw new Error(\"WebGL is not supported on this device\");if(null==e){var o=jt(i().getNumber(\"WEBGL_VERSION\"));r.binaryCache=(n=i().getNumber(\"WEBGL_VERSION\"))in $s?$s[n]:($s[n]={},$s[n]),r.gpgpu=new Bi(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new ps(r.gpgpu),r.numMBBeforeWarning=null==i().global.screen?1024:i().global.screen.height*i().global.screen.width*window.devicePixelRatio*Js/1024/1024,r.texData=new xo(r,Lt),r}return e(o,t),o.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},o.prototype.write=function(t,e,n){if(i().getBool(\"DEBUG\")&&this.checkNumericalProblems(t),\"complex64\"===n&&null!=t)throw new Error(\"Cannot write to a complex64 dtype. Please use tf.complex(real, imag).\");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:zt.UPLOAD}),r},o.prototype.move=function(t,e,n,r){if(i().getBool(\"DEBUG\")&&this.checkNumericalProblems(e),\"complex64\"===r)throw new Error(\"Cannot write to a complex64 dtype. Please use tf.complex(real, imag).\");this.texData.set(t,{shape:n,dtype:r,values:e,usage:zt.UPLOAD})},o.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,o=e.complexTensors,a=e.slice,i=e.shape,s=e.isPacked;if(null!=a){var u=void 0;u=s?new Xs(i,Gs):new Cs(i,Gs);var c=this.runWebGLProgram(u,[{dataId:t,shape:i,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(t);if(\"string\"===r)return n;var h,f,d=null!=this.activeTimers;(d&&(h=et()),\"complex64\"===r)?f=Vo(o.real.dataSync(),o.imag.dataSync()):f=this.getValuesFromTexture(t);return d&&(this.downloadWaitMs+=et()-h),this.convertAndCacheOnCPU(t,f)},o.prototype.read=function(t){return n(this,void 0,void 0,(function(){var e,n,o,a,s,u,c,l,h,f,d,p,v,m,g,y,x,b,w,C,E,R;return r(this,(function(r){switch(r.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),o=n.values,a=n.shape,s=n.slice,u=n.dtype,c=n.complexTensors,l=n.isPacked,null!=s)return h=void 0,h=l?new Xs(a,Gs):new Cs(a,Gs),f=this.runWebGLProgram(h,[{dataId:t,shape:a,dtype:u}],u),d=this.read(f.dataId),this.disposeData(f.dataId),[2,d];if(null!=o)return[2,this.convertAndCacheOnCPU(t)];if(!i().getBool(\"WEBGL_DOWNLOAD_FLOAT_ENABLED\")&&2===i().getNumber(\"WEBGL_VERSION\"))throw new Error(\"tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.\");return p=null,\"complex64\"!==u&&i().get(\"WEBGL_BUFFER_SUPPORTED\")&&(v=this.decode(t),m=this.texData.get(v.dataId),p=(R=this.gpgpu).createBufferFromTexture.apply(R,[m.texture].concat(Yt(a)))),this.pendingRead.set(t,[]),\"complex64\"===u?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:r.sent(),r.label=2;case 2:return\"complex64\"!==u?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return y=r.sent(),x=y[0],b=y[1],g=Vo(x,b),[3,5];case 4:null==p?g=this.getValuesFromTexture(t):(w=k(a),g=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),r.label=5;case 5:return null!=v&&this.disposeData(v.dataId),C=this.convertAndCacheOnCPU(t,g),E=this.pendingRead.get(t),this.pendingRead.delete(t),E.forEach((function(t){return t(C)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,C]}}))}))},o.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!ee(n)){if(i().getBool(\"WEBGL_RENDER_FLOAT32_CAPABLE\"))throw Error(\"The value \"+n+\" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'\");throw Error(\"The value \"+n+\" cannot be represented on this device.\")}}},o.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),r=n.shape,o=n.dtype,a=n.isPacked,s=k(r);if(i().getBool(\"WEBGL_DOWNLOAD_FLOAT_ENABLED\")){var u=this.decode(t),c=this.texData.get(u.dataId),l=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[c.texture].concat(Yt(r))).subarray(0,s);return this.disposeData(u.dataId),l}var h=i().getBool(\"WEBGL_PACK\")&&!0===a,f=h?Te(r):r,d=h?new ci(f):new ui(f),p=this.runWebGLProgram(d,[{shape:f,dtype:o,dataId:t}],\"float32\"),v=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,s);return this.disposeData(p.dataId),m},o.prototype.time=function(t){return n(this,void 0,void 0,(function(){var e,n,o,a,s,u,c;return r(this,(function(r){switch(r.label){case 0:return e=this.activeTimers,n=[],o=!1,null==this.programTimersStack?(this.programTimersStack=n,o=!0):this.activeTimers.push(n),this.activeTimers=n,t(),a=I(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),s=I(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,o&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\")>0?[4,Promise.all(a)]:[3,2];case 1:return c=r.sent(),u.kernelMs=w(c),u.getExtraProfileInfo=function(){return c.map((function(t,e){return{name:s[e],ms:t}})).map((function(t){return t.name+\": \"+t.ms})).join(\", \")},[3,3];case 2:u.kernelMs={error:\"WebGL query timers are not supported in this environment.\"},r.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},o.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},o.prototype.startTimer=function(){return i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\")>0?this.gpgpu.beginQuery():{startMs:et(),endMs:null}},o.prototype.endTimer=function(t){return i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\")>0?(this.gpgpu.endQuery(),t):(t.endMs=et(),t)},o.prototype.getQueryTime=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){return i().getNumber(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},o.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}},o.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,o=e.texShape,a=e.usage,i=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(n,o,a,i)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},o.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},o.prototype.getDataInfo=function(t){return this.texData.get(t)},o.prototype.getCPUBackend=function(){return i().getBool(\"WEBGL_CPU_FORWARD\")?(null==this.cpuBackend&&(this.cpuBackend=Lt.findBackend(\"cpu\")),this.cpuBackend):null},o.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},o.prototype.getGPGPUContext=function(){return this.gpgpu},o.prototype.complex=function(t,e){var n=this.makeOutput(t.shape,\"complex64\");return this.texData.get(n.dataId).complexTensors={real:Lt.keep(t.clone()),imag:Lt.keep(e.clone())},n},o.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},o.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},o.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===k(n))return Fn([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,o=io(t.shape,e,n);if(r||!o){var a=i().getBool(\"WEBGL_PACK_ARRAY_OPERATIONS\")?new fs(n):new ls(n),s=a.getCustomSetupFunc(e);return this.compileAndRun(a,[t],null,s)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},o.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),o=this.makeOutput(n,t.dtype),a=this.texData.get(o.dataId);Object.assign(a,r),a.shape=n,a.dtype=t.dtype;var i=so(e,t.strides);r.slice&&(i+=r.slice.flatOffset),a.slice={flatOffset:i,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,s+1),o},o.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var o=ro(e,n,r);if(o.some((function(t){return 0===t})))return Fn([],o);var a=new ds(e,r,o);return this.compileAndRun(a,[t])},o.prototype.reverse=function(t,e){var n=i().getBool(\"WEBGL_PACK_ARRAY_OPERATIONS\")?new is(t.shape,e):new as(t.shape,e);return this.compileAndRun(n,[t])},o.prototype.concat=function(t,e){if(\"complex64\"===t[0].dtype){var n=t.map((function(t){return Tn(t)})),r=t.map((function(t){return Nn(t)}));return Dn(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>i().getNumber(\"WEBGL_MAX_TEXTURES_IN_SHADER\")){var o=Math.floor(t.length/2),a=this.concat(t.slice(0,o),e),s=this.concat(t.slice(o),e);return this.concat([a,s],e)}if(i().getBool(\"WEBGL_PACK_ARRAY_OPERATIONS\")&&t[0].rank>1){var u=new Ga(t.map((function(t){return t.shape})),e);return this.compileAndRun(u,t)}var c=Sn(t.map((function(t){return t.shape})),e),l=t.map((function(t){return t.as2D(-1,k(t.shape.slice(e)))})),h=new za(l.map((function(t){return t.shape})));return this.compileAndRun(h,l).reshape(c)},o.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,Ts,t.dtype);var e=new Cs(t.shape,Ts);return this.compileAndRun(e,[t])},o.prototype.batchMatMul=function(t,e,n,r){var o=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],i=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===o||1===a)&&i>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===a?t:t.as3D(s,i,1),c=1===a?2:1,l=1===a?e.as3D(s,1,i):e;return this.multiply(u,l).sum(c,!0)}var h=Dt(t.dtype,e.dtype),f=new Hi(t.shape,[s,o,a],n,r);return this.compileAndRun(f,[t,e],h)},o.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,o=t.transposeB,a=t.bias,i=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=o?n.shape[1]:n.shape[2],l=e.shape[0],h=Dt(e.dtype,n.dtype),f=null!=a,d=null!=s,p=i?Qs(i,!0):null,v=new Hi(e.shape,[l,u,c],r,o,f,p,d),m=[e,n];return a&&m.push(a),s&&m.push(s),this.compileAndRun(v,m,h)},o.prototype.multiply=function(t,e){if(\"complex64\"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),o=new Na(Da,t.shape,e.shape),a=new Na(Ta,t.shape,e.shape),s=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],u=this.compileAndRun(o,s),c=this.compileAndRun(a,s),l=this.complex(u,c);return u.dispose(),c.dispose(),l}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,Oa,t.dtype);var h=new Ba(Oa,t.shape,e.shape);return this.compileAndRun(h,[t,e],t.dtype)},o.prototype.batchNormalization=function(t,e,n,r,o,a){var s=[t,e,n],u=null;null!=a&&(u=a.shape,s.push(a));var c=null;if(null!=o&&(c=o.shape,s.push(o)),i().getBool(\"WEBGL_PACK_NORMALIZATION\")){var l=new Aa(t.shape,e.shape,n.shape,u,c,r);return this.compileAndRun(l,s)}var h=new Sa(t.shape,e.shape,n.shape,u,c,r);return this.compileAndRun(h,s)},o.prototype.localResponseNormalization4D=function(t,e,n,r,o){var a=i().getBool(\"WEBGL_PACK_NORMALIZATION\")?new Vi(t.shape,e,n,r,o):new Wi(t.shape,e,n,r,o);return this.compileAndRun(a,[t])},o.prototype.LRNGrad=function(t,e,n,r,o,a,i){var s=new Ui(e.shape,r,o,a,i);return this.compileAndRun(s,[e,n,t])},o.prototype.tile=function(t,e){if(\"string\"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return ot(t)}));return ta(dr(t.shape,t.dtype,n),e)}var r=new gs(t.shape,e);return this.compileAndRun(r,[t])},o.prototype.pad=function(t,e,n){var r=i().getBool(\"WEBGL_PACK_ARRAY_OPERATIONS\")?new Yi(t.shape,e,n):new Xi(t.shape,e,n);return this.compileAndRun(r,[t])},o.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=i().getBool(\"WEBGL_PACK_ARRAY_OPERATIONS\")?new xs(t.shape,e):new ys(t.shape,e);return this.compileAndRun(n,[t])},o.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new mi(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},o.prototype.batchToSpaceND=function(t,e,n){C(t.rank<=4,(function(){return\"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet\"}));var r=e.reduce((function(t,e){return t*e})),o=zr(t.shape,e,r),a=Gr(o.length,e.length),i=Hr(t.shape,e,r),s=qr(n,e.length),u=Kr(i,n,e.length);return t.reshape(o).transpose(a).reshape(i).slice(s,u)},o.prototype.spaceToBatchND=function(t,e,n){C(t.rank<=4,(function(){return\"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet\"}));var r=e.reduce((function(t,e){return t*e})),o=[[0,0]];o.push.apply(o,n);for(var a=1+e.length;a<t.shape.length;++a)o.push([0,0]);var i=t.pad(o),s=zr(i.shape,e,r,!1),u=Gr(s.length,e.length,!1),c=Hr(i.shape,e,r,!1);return i.reshape(s).transpose(u).reshape(c)},o.prototype.reduce=function(t,e,n){var r=t.shape[0],o=t.shape[1],a=$r(o),i=new Ji({windowSize:a,inSize:o,batchSize:r},e),s=this.compileAndRun(i,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)},o.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],o=t.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var a=$r(o),i=new aa({windowSize:a,inSize:o,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var u=this.compileAndRun(i,s,\"int32\");return 1===u.shape[1]?u:this.argReduce(t,e,u)},o.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,o=$r(r[r.length-1]),a=new Ra(r,o,e,null==n),i=null==n?[t]:[t,n],s=this.compileAndRun(a,i,\"int32\");return s.rank===t.rank?this.argReducePacked(t,e,s):s},o.prototype.sum=function(t,e){Cn(\"sum\",e,t.rank);var n=bn(t.shape,e),r=n[0],o=k(n[1]),a=t.as2D(-1,o),i=Tt(t.dtype);return this.reduce(a,\"sum\",i).reshape(r)},o.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=bn(t.shape,e),r=n[0],o=k(n[1]),a=t.as2D(-1,o),i=Tt(t.dtype);return this.reduce(a,\"prod\",i).reshape(r)},o.prototype.unsortedSegmentSum=function(t,e,n){var r=0,o=En([r],t.rank),a=t;null!=o&&(a=t.transpose(o),r=In(1,t.rank)[0]);var i=function(t,e,n){for(var r=[],o=t.length,a=0;a<o;a++)a!==e?r.push(t[a]):r.push(n);return r}(a.shape,r,n),s=k([a.shape[r]]),u=a.as2D(-1,s),c=Tt(t.dtype),l=this.segOpCompute(u,\"unsortedSegmentSum\",e,c,n).reshape(i);return null!=o&&(l=l.transpose(Rn(o))),l},o.prototype.segOpCompute=function(t,e,n,r,o){var a=t.shape[0],i=t.shape[1],s=function(t,e){var n,r=!1;for(t<=Yr?(n=t,r=!0):n=Y(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Y(t,n+1);return n}(i,o),u=new us({windowSize:s,inSize:i,batchSize:a,numSegments:o},e),c=this.compileAndRun(u,[t,n],r);return c.shape[1]===o?c:(n=Kn(0,o).tile([i/s]),this.segOpCompute(c,e,n,r,o))},o.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(Cn(\"arg\"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!i().getBool(\"WEBGL_PACK_REDUCE\")||t.rank<=2){var o=bn(t.shape,r),a=o[0],s=k(o[1]),u=t.as2D(-1,s);return this.argReduce(u,n).reshape(a)}return this.argReducePacked(t,n)},o.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,\"min\")},o.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,\"max\")},o.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error(\"WebGL cumsum shader expects an inner-most axis=\"+(t.rank-1)+\" but got axis=\"+e);var o=new ni(t.shape,n,r);return this.compileAndRun(o,[t])},o.prototype.equal=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(equal(a, b));\\n\",\"bool\");var n=new Ba(\"return float(a == b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.notEqual=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(notEqual(a, b));\\n\",\"bool\");var n=new Ba(\"return float(a != b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(lessThan(a, b));\\n\",\"bool\");var n=new Ba(\"return float(a < b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.lessEqual=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(lessThanEqual(a, b));\\n\",\"bool\");var n=new Ba(\"return float(a <= b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(greaterThan(a, b));\\n\",\"bool\");var n=new Ba(\"return float(a > b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.greaterEqual=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(greaterThanEqual(a, b));\\n\",\"bool\");var n=new Ba(\"return float(a >= b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.logicalNot=function(t){var e=new Cs(t.shape,\"return float(!(x >= 1.0));\");return this.compileAndRun(e,[t])},o.prototype.logicalAnd=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return vec4(\\n    vec4(greaterThanEqual(a, vec4(1.0))) *\\n    vec4(greaterThanEqual(b, vec4(1.0))));\\n\",\"bool\");var n=new Ba(\"return float(a >= 1.0 && b >= 1.0);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.logicalOr=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  return min(\\n    vec4(greaterThanEqual(a, vec4(1.0))) +\\n    vec4(greaterThanEqual(b, vec4(1.0))),\\n    vec4(1.0));\\n\",\"bool\");var n=new Ba(\"return float(a >= 1.0 || b >= 1.0);\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"bool\")},o.prototype.select=function(t,e,n){var r=new cs(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],Dt(e.dtype,n.dtype))},o.prototype.where=function(t){dn(\"tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead\");var e=t.dataSync();return na(t.shape,e)},o.prototype.topk=function(t,e,n){return ea(t.dataSync(),t.shape,t.dtype,e)},o.prototype.min=function(t,e){Cn(\"min\",e,t.rank);var n=bn(t.shape,e),r=n[0],o=k(n[1]),a=t.as2D(-1,o);return this.reduce(a,\"min\",a.dtype).reshape(r)},o.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"\\n  vec4 result = vec4(min(a, b));\\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\\n  \\n  result.r = isNaN.r > 0. ? NAN : result.r;\\n  result.g = isNaN.g > 0. ? NAN : result.g;\\n  result.b = isNaN.b > 0. ? NAN : result.b;\\n  result.a = isNaN.a > 0. ? NAN : result.a;\\n\\n  return result;\\n\",t.shape,e.shape):new Ba(\"\\n  if (isnan(a)) return a;\\n  if (isnan(b)) return b;\\n\\n  return min(a, b);\\n\",t.shape,e.shape);return this.compileAndRun(n,[t,e])},o.prototype.mod=function(t,e){var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"\\n  vec4 result = mod(a, b);\\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\\n  \\n  result.r = isNaN.r > 0. ? NAN : result.r;\\n  result.g = isNaN.g > 0. ? NAN : result.g;\\n  result.b = isNaN.b > 0. ? NAN : result.b;\\n  result.a = isNaN.a > 0. ? NAN : result.a;\\n\\n  return result;\\n\",t.shape,e.shape):new Ba(\"if (b == 0.0) return NAN;\\n  return mod(a, b);\",t.shape,e.shape);return this.compileAndRun(n,[t,e])},o.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);Cn(\"max\",e,t.rank);var n=bn(t.shape,e),r=n[0],o=k(n[1]),a=t.as2D(-1,o);return this.reduce(a,\"max\",a.dtype).reshape(r)},o.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"\\n  vec4 result = vec4(max(a, b));\\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\\n  \\n  result.r = isNaN.r > 0. ? NAN : result.r;\\n  result.g = isNaN.g > 0. ? NAN : result.g;\\n  result.b = isNaN.b > 0. ? NAN : result.b;\\n  result.a = isNaN.a > 0. ? NAN : result.a;\\n\\n  return result;\\n\",t.shape,e.shape):new Ba(\"\\n  if (isnan(a)) return a;\\n  if (isnan(b)) return b;\\n\\n  return max(a, b);\\n\",t.shape,e.shape);return this.compileAndRun(n,[t,e])},o.prototype.all=function(t,e){Cn(\"all\",e,t.rank);var n=bn(t.shape,e),r=n[0],o=k(n[1]),a=t.as2D(-1,o);return this.reduce(a,\"all\",a.dtype).reshape(r)},o.prototype.any=function(t,e){Cn(\"any\",e,t.rank);var n=bn(t.shape,e),r=n[0],o=k(n[1]),a=t.as2D(-1,o);return this.reduce(a,\"any\",a.dtype).reshape(r)},o.prototype.realDivide=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")){return this.packedBinaryOp(t,e,\"\\n  // vec4 one = vec4(equal(a, b));\\n  // return one + (vec4(1.0) - one) * a / b;\\n  vec4 result = a / b;\\n  if(a.x == b.x) {\\n    result.x = 1.;\\n  }\\n  if(a.y == b.y) {\\n    result.y = 1.;\\n  }\\n  if(a.z == b.z) {\\n    result.z = 1.;\\n  }\\n  if(a.w == b.w) {\\n    result.w = 1.;\\n  }\\n\\n  return result;\\n\",\"float32\",!0)}var n=new Ba(\"\\nif (a == b) {\\n  return 1.0;\\n};\\nreturn a / b;\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"float32\")},o.prototype.floorDiv=function(t,e){if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,\"\\n  ivec4 ia = round(a);\\n  ivec4 ib = round(b);\\n  bvec4 cond = notEqual(ib, ivec4(0));\\n  ivec4 result = ivec4(0);\\n  vec4 s = sign(a) * sign(b);\\n\\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\\n  if (cond[0]) {\\n    result[0] = idiv(ia[0], ib[0], s[0]);\\n  }\\n  if (cond[1]) {\\n    result[1] = idiv(ia[1], ib[1], s[1]);\\n  }\\n  if (cond[2]) {\\n    result[2] = idiv(ia[2], ib[2], s[2]);\\n  }\\n  if (cond[3]) {\\n    result[3] = idiv(ia[3], ib[3], s[3]);\\n  }\\n  return vec4(result);\\n\",\"int32\");var n=new Ba(\"\\n  float s = sign(a) * sign(b);\\n  int ia = round(a);\\n  int ib = round(b);\\n  if (ib != 0) {\\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\\n    return float(idiv(ia, ib, s));\\n  } else {\\n    return NAN;\\n  }\\n\",t.shape,e.shape);return this.compileAndRun(n,[t,e],\"int32\")},o.prototype.add=function(t,e){if(\"complex64\"===t.dtype&&\"complex64\"===e.dtype)return this.complexSeparableBinaryOp(t,e,Fa);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=Dt(t.dtype,e.dtype);if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,Fa,n);var r=new Ba(Fa,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},o.prototype.packedUnaryOp=function(t,e,n){var r=new Xs(t.shape,e);return this.compileAndRun(r,[t],n)},o.prototype.packedBinaryOp=function(t,e,n,r,o){void 0===o&&(o=!1);var a=new La(n,t.shape,e.shape,o);return this.compileAndRun(a,[t,e],r)},o.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,o=this.texData.get(t.dataId),a=this.texData.get(e.dataId),i=[[o.complexTensors.real,a.complexTensors.real],[o.complexTensors.imag,a.complexTensors.imag]].map((function(o){var a=o[0],i=o[1],s=r.makeComplexComponentTensorInfo(t,a),u=r.makeComplexComponentTensorInfo(e,i),c=new Ba(n,t.shape,e.shape);return r.compileAndRun(c,[s,u],Dt(a.dtype,i.dtype))})),s=i[0],u=i[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},o.prototype.makeComplexComponentTensorInfo=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},o.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>i().get(\"WEBGL_MAX_TEXTURES_IN_SHADER\")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var o=t.map((function(t){return t.dtype})).reduce((function(t,e){return Dt(t,e)})),a=t.map((function(t){return t.shape})),s=i().getBool(\"WEBGL_PACK\")?new oa(t[0].shape,a):new ra(t[0].shape,a);return this.compileAndRun(s,t,o)},o.prototype.subtract=function(t,e){if(\"complex64\"===t.dtype&&\"complex64\"===e.dtype)return this.complexSeparableBinaryOp(t,e,_a);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=Dt(t.dtype,e.dtype);if(i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\"))return this.packedBinaryOp(t,e,_a,t.dtype);var r=new Ba(_a,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},o.prototype.pow=function(t,e){var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"\\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\\n  vec4 result = multiplier * pow(abs(a), b);\\n\\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\\n  bvec4 isExpZero = equal(b, vec4(0.0));\\n  result.r = isExpZero.r ? 1.0 : result.r;\\n  result.g = isExpZero.g ? 1.0 : result.g;\\n  result.b = isExpZero.b ? 1.0 : result.b;\\n  result.a = isExpZero.a ? 1.0 : result.a;\\n\\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\\n  \\n  result.r = isNaN.r > 0. ? NAN : result.r;\\n  result.g = isNaN.g > 0. ? NAN : result.g;\\n  result.b = isNaN.b > 0. ? NAN : result.b;\\n  result.a = isNaN.a > 0. ? NAN : result.a;\\n\\n  return result;\\n\",t.shape,e.shape):new Ba(\"\\nif(a < 0.0 && floor(b) < b){\\n  return NAN;\\n}\\nif (b == 0.0) {\\n  return 1.0;\\n}\\nreturn (round(mod(b, 2.0)) != 1) ?\\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\\n\",t.shape,e.shape),r=Dt(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)},o.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,Ns,t.dtype);var e=new Cs(t.shape,Ns);return this.compileAndRun(e,[t])},o.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,Fs,t.dtype);var e=new Cs(t.shape,Fs);return this.compileAndRun(e,[t])},o.prototype.sign=function(t){var e=new Cs(t.shape,\"\\n  if (isnan(x)) { return 0.0; }\\n  return sign(x);\\n\");return this.compileAndRun(e,[t])},o.prototype.isNaN=function(t){var e=new Cs(t.shape,\"return float(isnan(x));\");return this.compileAndRun(e,[t],\"bool\")},o.prototype.isInf=function(t){var e=new Cs(t.shape,\"return float(isinf(x));\");return this.compileAndRun(e,[t],\"bool\")},o.prototype.isFinite=function(t){var e=new Cs(t.shape,\"return float(!isnan(x) && !isinf(x));\");return this.compileAndRun(e,[t],\"bool\")},o.prototype.round=function(t){var e=new Cs(t.shape,\"\\n  // OpenGL ES does not support round function.\\n  // The algorithm is based on banker's rounding.\\n  float base = floor(x);\\n  if ((x - base) < 0.5) {\\n    return floor(x);\\n  } else if ((x - base) > 0.5) {\\n    return ceil(x);\\n  } else {\\n    if (mod(base, 2.0) == 0.0) {\\n      return base;\\n    } else {\\n      return base + 1.0;\\n    }\\n  }\\n\");return this.compileAndRun(e,[t])},o.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,_s,t.dtype);var e=new Cs(t.shape,_s);return this.compileAndRun(e,[t])},o.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,Os,t.dtype);var e=new Cs(t.shape,Os);return this.compileAndRun(e,[t])},o.prototype.softmax=function(t,e){var n=O([e],t.shape),r=this.max(t,n),o=wn(r.shape,n),a=this.subtract(t,r.reshape(o)),i=this.exp(a),s=this.sum(i,n).reshape(o);return this.realDivide(i,s)},o.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,\"\\n  vec4 result = log(x);\\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\\n\\n  return result;\\n\",t.dtype);var e=new Cs(t.shape,\"if (x < 0.0) return NAN;\\n  return log(x);\");return this.compileAndRun(e,[t])},o.prototype.log1p=function(t){var e=new Cs(t.shape,\"return log(1.0 + x);\");return this.compileAndRun(e,[t])},o.prototype.sqrt=function(t){var e=new Cs(t.shape,\"return sqrt(x);\");return this.compileAndRun(e,[t])},o.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new Cs(t.shape,\"return inversesqrt(x);\");return this.compileAndRun(e,[t])},o.prototype.reciprocal=function(t){var e=new Cs(t.shape,\"return 1.0 / x;\");return this.compileAndRun(e,[t])},o.prototype.relu=function(t){var e;return e=i().getBool(\"WEBGL_PACK\")?new Xs(t.shape,qs):new Cs(t.shape,ks),this.compileAndRun(e,[t])},o.prototype.relu6=function(t){var e;return e=i().getBool(\"WEBGL_PACK\")?new Xs(t.shape,Ks):new Cs(t.shape,Ss),this.compileAndRun(e,[t])},o.prototype.prelu=function(t,e){var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(Pa,t.shape,e.shape):new Ba(Ma,t.shape,e.shape);return this.compileAndRun(n,[t,e])},o.prototype.elu=function(t){if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,js,t.dtype);var e=new Cs(t.shape,As);return this.compileAndRun(e,[t])},o.prototype.eluDer=function(t,e){var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"\\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\\n\",t.shape,e.shape):new Ba(\"return (b >= 1.0) ? a : a * (b + 1.0);\",t.shape,e.shape);return this.compileAndRun(n,[t,e])},o.prototype.selu=function(t){var e=new Cs(t.shape,Ds);return this.compileAndRun(e,[t])},o.prototype.int=function(t){var e=new Cs(t.shape,\"return float(int(x));\");return this.compileAndRun(e,[t],\"int32\")},o.prototype.clip=function(t,e,n){var r,o=(r=i().getBool(\"WEBGL_PACK_CLIP\")?new Ua(t.shape):new Wa(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,o)},o.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(i().getBool(\"WEBGL_PACK_UNARY_OPERATIONS\"))return this.packedUnaryOp(t,Is,t.dtype);var e=new Cs(t.shape,Is);return this.compileAndRun(e,[t])},o.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new Va(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},o.prototype.sigmoid=function(t){var e=new Cs(t.shape,\"return 1.0 / (1.0 + exp(-1.0 * x));\");return this.compileAndRun(e,[t])},o.prototype.softplus=function(t){var e=new Cs(t.shape,\"\\n  float epsilon = 1.1920928955078125e-7;\\n  float threshold = log(epsilon) + 2.0;\\n\\n  bool too_large = x > -threshold;\\n  bool too_small = x < threshold;\\n\\n  float result;\\n  float exp_x = exp(x);\\n\\n  if (too_large){\\n    result = x;\\n  }\\n  else if (too_small){\\n    result = exp_x;\\n  }\\n  else{\\n    result = log(exp_x + 1.0);\\n  }\\n  return result;\\n\");return this.compileAndRun(e,[t])},o.prototype.sin=function(t){var e=new Cs(t.shape,Ms);return this.compileAndRun(e,[t])},o.prototype.cos=function(t){var e=new Cs(t.shape,Bs);return this.compileAndRun(e,[t])},o.prototype.tan=function(t){var e=new Cs(t.shape,\"return tan(x);\");return this.compileAndRun(e,[t])},o.prototype.asin=function(t){var e=new Cs(t.shape,Ps);return this.compileAndRun(e,[t])},o.prototype.acos=function(t){var e=new Cs(t.shape,Ls);return this.compileAndRun(e,[t])},o.prototype.atan=function(t){var e=new Cs(t.shape,Ws);return this.compileAndRun(e,[t])},o.prototype.atan2=function(t,e){var n=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"\\n  vec4 result = atan(a, b);\\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\\n  \\n  result.r = isNaN.r > 0. ? NAN : result.r;\\n  result.g = isNaN.g > 0. ? NAN : result.g;\\n  result.b = isNaN.b > 0. ? NAN : result.b;\\n  result.a = isNaN.a > 0. ? NAN : result.a;\\n\\n  return result;\\n\",t.shape,e.shape):new Ba(\"\\n  if (isnan(a)) return a;\\n  if (isnan(b)) return b;\\n\\n  return atan(a, b);\\n\",t.shape,e.shape);return this.compileAndRun(n,[t,e])},o.prototype.sinh=function(t){var e=new Cs(t.shape,\"\\n  float e2x = exp(x);\\n  return (e2x - 1.0 / e2x) / 2.0;\\n\");return this.compileAndRun(e,[t])},o.prototype.cosh=function(t){var e=new Cs(t.shape,\"\\n  float e2x = exp(-x);\\n  return (e2x + 1.0 / e2x) / 2.0;\\n\");return this.compileAndRun(e,[t])},o.prototype.tanh=function(t){var e=new Cs(t.shape,\"\\n  float e2x = exp(-2.0 * abs(x));\\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\\n\");return this.compileAndRun(e,[t])},o.prototype.asinh=function(t){var e=new Cs(t.shape,Us);return this.compileAndRun(e,[t])},o.prototype.acosh=function(t){var e=new Cs(t.shape,Vs);return this.compileAndRun(e,[t])},o.prototype.atanh=function(t){var e=new Cs(t.shape,zs);return this.compileAndRun(e,[t])},o.prototype.erf=function(t){var e=new Cs(t.shape,'\\n  // Error function is calculated approximately with elementary function.\\n  // See \"Handbook of Mathematical Functions with Formulas,\\n  // Graphs, and Mathematical Tables\", Abramowitz and Stegun.\\n  float p = 0.3275911;\\n  float a1 = 0.254829592;\\n  float a2 = -0.284496736;\\n  float a3 = 1.421413741;\\n  float a4 = -1.453152027;\\n  float a5 = 1.061405429;\\n\\n  float sign = sign(x);\\n  x = abs(x);\\n  float t = 1.0 / (1.0 + p * x);\\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\\n');return this.compileAndRun(e,[t])},o.prototype.step=function(t,e){var n=new Cs(t.shape,function(t){return void 0===t&&(t=0),Es+\"\\n    return x > 0.0 ? 1.0 : float(\"+t+\");\\n  \"}(e));return this.compileAndRun(n,[t])},o.prototype.conv2dByMatMul=function(t,e,n,r,o,a){var s=t.shape,u=this.texData.get(t.dataId),c=n.inChannels,l=s[0]*s[1]*s[2],h=n.outChannels,f=\"channelsLast\"===n.dataFormat,d=(1===l||1===h)&&c>1e3,p=s[2]%2!=0&&!!u.isPacked;if(d||!i().getBool(\"WEBGL_LAZILY_UNPACK\")||!i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")||!p){var v=f?s[0]*s[1]*s[2]:s[0]*s[2]*s[3],m=this.reshape(t,[1,v,n.inChannels]),g=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:g,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:a}),n.outShape)}var y=f?s[0]*s[1]*(s[2]+1):s[0]*s[2]*(s[3]+1),x={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},b=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,C(_e(u.shape,x.shape),(function(){return\"packed reshape \"+u.shape+\" to \"+x.shape+\" isn't free\"}));var w=this.reshape(e,[1,n.inChannels,n.outChannels]),E=this.fusedBatchMatMul({a:x,b:w,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:a}),R=this.texData.get(E.dataId);return C(R.isPacked,(function(){return\"batchMatMul result is expected to be packed\"})),u.shape=b,R.shape=n.outShape,Lt.makeTensorFromDataId(E.dataId,n.outShape,E.dtype)},o.prototype.conv2dWithIm2Row=function(t,e,n,r,o,a){var i=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,h=\"channelsLast\"===n.dataFormat,f=i*s*u,d=l*c,p=[f,d],v=t.squeeze([0]),m=e.reshape([1,f,-1]),g=new Li(p,v.shape,n),y=this.compileAndRun(g,[v]).reshape([1,p[0],p[1]]),x=null!=r,b=null!=a,w=o?Qs(o,!0):null,C=new Hi(y.shape,[1,d,n.outChannels],!0,!1,x,w,b),E=[y,m];r&&E.push(r),b&&E.push(a);var R=this.compileAndRun(C,E);return h?R.reshape([1,l,c,n.outChannels]):R.reshape([1,n.outChannels,l,c])},o.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,o=t.bias,a=t.activation,s=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&(\"SAME\"===r.padInfo.type||\"VALID\"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,o,a,s);if(i().getBool(\"WEBGL_CONV_IM2COL\")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,o,a,s);var u=null!=o,c=null!=s,l=a?Qs(a,!1):null,h=new Qa(r,u,l,c),f=[e,n];return o&&f.push(o),s&&f.push(s),this.compileAndRun(h,f)},o.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&(\"SAME\"===n.padInfo.type||\"VALID\"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(i().getBool(\"WEBGL_CONV_IM2COL\")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new Qa(n);return this.compileAndRun(r,[t,e])},o.prototype.conv2dDerInput=function(t,e,n){var r=new Ka(n);return this.compileAndRun(r,[t,e])},o.prototype.conv2dDerFilter=function(t,e,n){var r=new qa(n);return this.compileAndRun(r,[t,e])},o.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,o=t.convInfo,a=t.bias,s=t.activation,u=t.preluActivationWeights,c=i().getBool(\"WEBGL_PACK_DEPTHWISECONV\")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,l=s?Qs(s,c):null,h=[n,r],f=null!=a,d=null!=u;return f&&h.push(a),d&&h.push(u),c?(e=new ti(o,f,l,d),this.compileAndRun(e,h)):(e=new Za(o,f,l,d),this.compileAndRun(e,h))},o.prototype.depthwiseConv2D=function(t,e,n){var r;return i().getBool(\"WEBGL_PACK_DEPTHWISECONV\")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new ti(n),this.compileAndRun(r,[t,e])):(r=new Za(n),this.compileAndRun(r,[t,e]))},o.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new $a(n);return this.compileAndRun(r,[t,e])},o.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new Ya(n);return this.compileAndRun(r,[t,e])},o.prototype.conv3d=function(t,e,n){var r=new Ja(n);return this.compileAndRun(r,[t,e])},o.prototype.conv3dDerInput=function(t,e,n){var r=new Xa(n);return this.compileAndRun(r,[t,e])},o.prototype.conv3dDerFilter=function(t,e,n){var r=new ja(n);return this.compileAndRun(r,[t,e])},o.prototype.maxPool=function(t,e){var n=new $i(e,\"max\",!1);return this.compileAndRun(n,[t])},o.prototype.avgPool=function(t,e){var n=new $i(e,\"avg\",!1);return this.compileAndRun(n,[t],\"float32\")},o.prototype.maxPoolBackprop=function(t,e,n,r){var o=new $i(r,\"max\",!0),a=this.compileAndRun(o,[e]),i=new zi(r),s=this.compileAndRun(i,[t,a],e.dtype);return a.dispose(),s},o.prototype.avgPoolBackprop=function(t,e,n){var r=new Ia(n);return this.compileAndRun(r,[t],e.dtype)},o.prototype.cast=function(t,e){return Po(t,e,this)},o.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),o=0,a=0;a<t.rank;a++)a!==e&&(r[o++]=t.shape[a]);var i=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(a=0;a<u.length;a++)i[e]=a,u[a]=this.slice(t,i,s).reshape(r);return u},o.prototype.avgPool3d=function(t,e){var n=new Qi(e,\"avg\",!1);return this.compileAndRun(n,[t],\"float32\")},o.prototype.avgPool3dBackprop=function(t,e,n){var r=new ka(n);return this.compileAndRun(r,[t],e.dtype)},o.prototype.maxPool3d=function(t,e){var n=new Qi(e,\"max\",!1);return this.compileAndRun(n,[t],\"float32\")},o.prototype.maxPool3dBackprop=function(t,e,n,r){var o=new Qi(r,\"max\",!0),a=this.compileAndRun(o,[e]),i=new Gi(r),s=this.compileAndRun(i,[t,a],e.dtype);return a.dispose(),s},o.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!_e(t.shape,e)&&(null===n.texture||!_e(n.shape,e))){var r=this.packedReshape(t,e);return Lt.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Lo(t,e)},o.prototype.resizeBilinear=function(t,e,n,r){var o=i().getBool(\"WEBGL_PACK_IMAGE_OPERATIONS\")?new ns(t.shape,e,n,r):new es(t.shape,e,n,r);return this.compileAndRun(o,[t],\"float32\")},o.prototype.resizeBilinearBackprop=function(t,e,n){var r=new ts(t,e,n);return this.compileAndRun(r,[t])},o.prototype.resizeNearestNeighbor=function(t,e,n,r){var o=new os(t.shape,e,n,r);return this.compileAndRun(o,[t])},o.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new rs(t,e,n);return this.compileAndRun(r,[t])},o.prototype.multinomial=function(t,e,n,r){var o=e?t:go(t),a=o.shape[0],i=o.shape[1],s=new qi(a,i,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[o],\"int32\",u)},o.prototype.oneHot=function(t,e,n,r){var o=new Ki(t.size,e,n,r);return this.compileAndRun(o,[t])},o.prototype.diag=function(t){var e=new si(t.size);return this.compileAndRun(e,[t])},o.prototype.nonMaxSuppression=function(t,e,n,r,o){return dn(\"tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead\"),jo(t.dataSync(),e.dataSync(),n,r,o)},o.prototype.cropAndResize=function(t,e,n,r,o,a){var i=new ei(t.shape,e.shape,r,o,a);return this.compileAndRun(i,[t,e,n],\"float32\")},o.prototype.depthToSpace=function(t,e,n){C(e>1,(function(){return\"blockSize should be > 1 for depthToSpace, but was: \"+e}));var r=t.shape[0],o=\"NHWC\"===n?t.shape[1]:t.shape[2],a=\"NHWC\"===n?t.shape[2]:t.shape[3],i=\"NHWC\"===n?t.shape[3]:t.shape[1],s=o*e,u=a*e,c=i/(e*e),l=new ii(\"NHWC\"===n?[r,s,u,c]:[r,c,s,u],e,n);return this.compileAndRun(l,[t])},o.prototype.split=function(t,e,n){return Zo(t,e,n)},o.prototype.scatterND=function(t,e,n){var r=Zr(0,t,n),o=r.sliceRank,a=r.numUpdates,i=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/i,i],l=t.reshape([a,o]),h=e.reshape([a,i]);if(0===u)return Lo(Fn([]),n);var f=On(0),d=new ss(a,o,l.rank,h.rank,s,c);return this.compileAndRun(d,[h,l,f]).reshape(n)},o.prototype.sparseToDense=function(t,e,n,r){var o=Zr(0,t,n),a=o.sliceRank,i=o.numUpdates,s=o.strides,u=o.outputSize,c=new ss(i,a,t.rank,e.rank,s,[u,1],!1);return this.compileAndRun(c,[e,t,r]).reshape(n)},o.prototype.fft=function(t){return this.fftImpl(t,!1)},o.prototype.ifft=function(t){return this.fftImpl(t,!0)},o.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new pi(fi,t.shape,e),o=new pi(di,t.shape,e),a=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],i=this.compileAndRun(r,a),s=this.compileAndRun(o,a),u=this.complex(i,s).as2D(t.shape[0],t.shape[1]);return i.dispose(),s.dispose(),u},o.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],o=jr(t,e),a=o[0],i=o[1],s=o[2],u=o[3],c=e.reshape([i,r]),l=t.reshape([t.size/s,s]),h=new gi(r,u,[i,s]);return this.compileAndRun(h,[l,c]).reshape(a)},o.prototype.fill=function(t,e,n){if(\"string\"===(n=n||j(e))){var r=P(n,k(t));return r.fill(e),Lt.makeTensor(r,t,n,this)}var o=new vi(t,e),a=o.getCustomSetupFunc(e);return this.compileAndRun(o,[],n,a)},o.prototype.onesLike=function(t){if(\"string\"===t.dtype)throw new Error(\"onesLike is not supported under string dtype\");return this.fill(t.shape,1,t.dtype)},o.prototype.zerosLike=function(t){return this.fill(t.shape,\"string\"===t.dtype?\"\":0,t.dtype)},o.prototype.linspace=function(t,e,n){return Wo(t,e,n)},o.prototype.makeTensorInfo=function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}},o.prototype.makeOutput=function(t,e){var n=this.makeTensorInfo(t,e).dataId;return Lt.makeTensorFromDataId(n,t,e,this)},o.prototype.unpackTensor=function(t){var e=new Ys(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},o.prototype.packTensor=function(t){var e=new ji(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},o.prototype.packedReshape=function(t,e){var n=[Ae(t.shape)].concat(De(t.shape)),r={dtype:t.dtype,shape:n,dataId:t.dataId},o=[Ae(e)].concat(De(e)),a=new Zi(o,n),i=this.runWebGLProgram(a,[r],t.dtype,null,!0);return{dataId:i.dataId,shape:e,dtype:i.dtype}},o.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,o=n.shape,a=n.dtype,i=Te(o);e=r?new ai(i):new oi(i);return{dtype:a,shape:o,dataId:this.runWebGLProgram(e,[{shape:i,dtype:a,dataId:t}],a,null,!0).dataId}},o.prototype.runWebGLProgram=function(t,e,n,r,o){var a=this;void 0===o&&(o=!1);var s=this.makeTensorInfo(t.outputShape,n),u=this.texData.get(s.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===Vt.DENSE){var c=Yt(t.outputShape);u.texShape=c.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(u.usage=t.outTexUsage),0===k(s.shape))return u.values=B(s.dtype,0),s;var l=[],h=e.map((function(e){if(\"complex64\"===e.dtype)throw new Error(\"GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.\");var n=a.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&k(e.shape)<=i().getNumber(\"WEBGL_SIZE_UPLOAD_UNIFORM\"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?a.unpackTensor(e):a.packTensor(e),l.push(e),n=a.texData.get(e.dataId);else if(n.isPacked&&!_e(n.shape,e.shape)){var r=e,o=e.shape;e.shape=n.shape,e=a.packedReshape(e,o),l.push(e),n=a.texData.get(e.dataId),r.shape=o}return a.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var f,d={shape:s.shape,texData:u,isUniform:!1},p=function(t,e,n){var r=\"\";e.concat(n).forEach((function(t){var e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?\"uniform\":t.texData.texShape;r+=t.shape+\"_\"+n+\"_\"+e}));var o=t.userCode,a=t.constructor.name;return a+=\"_\"+r+\"_\"+o}(t,h,d),v=this.getAndSaveBinary(p,(function(){return function(t,e,n,r){var o=e.userCode,a=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),s=a.map((function(t){return t.shapeInfo})),u={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},c=fa(a,u,o,e.packedInputs),l=t.createProgram(c),h=null,f=t.getUniformLocation(l,\"NAN\",!1);1===i().getNumber(\"WEBGL_VERSION\")&&(h=t.getUniformLocation(l,\"INFINITY\",!1));for(var d={},p=0;p<e.variableNames.length;p++){var v=e.variableNames[p];d[v]=t.getUniformLocation(l,v,!1),d[\"offset\"+v]=t.getUniformLocation(l,\"offset\"+v,!1)}return{program:e,source:c,webGLProgram:l,uniformLocations:d,inShapeInfos:s,outShapeInfo:u,infLoc:h,nanLoc:f}}(a.gpgpu,t,h,d)})),m=null!=this.activeTimers;if(m&&(f=this.startTimer()),function(t,e,n,r,o){Pi(e.inShapeInfos,n),Pi([e.outShapeInfo],[r]);var a=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(a,s[0],s[1]):t.setOutputMatrixTexture(a,s[0],s[1]),t.setProgram(e.webGLProgram),1===i().getNumber(\"WEBGL_VERSION\")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var o=e.program.variableNames[r],a=e.uniformLocations[o],i=e.uniformLocations[\"offset\"+o];if(null!=a)if(n.isUniform)if(k(n.shape)<2)t.gl.uniform1f(a,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(a,s)}else null!=n.texData.slice&&null!=i&&t.gl.uniform1i(i,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,a,r)})),null!=o&&o(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,v,h,d,r),l.forEach((function(t){return a.disposeData(t.dataId)})),m&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!i().getBool(\"WEBGL_LAZILY_UNPACK\")&&u.isPacked&&!1===o){var g=this.unpackTensor(s);return this.disposeData(s.dataId),g}return s},o.prototype.compileAndRun=function(t,e,n,r,o){void 0===o&&(o=!1),n=n||e[0].dtype;var a=this.runWebGLProgram(t,e,n,r,o);return Lt.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},o.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},o.prototype.getTextureManager=function(){return this.textureManager},o.prototype.dispose=function(){var t=this;if(!this.disposed){if(!i().getBool(\"IS_TEST\"))Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]}));this.textureManager.dispose(),null!=this.canvas&&\"undefined\"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}},o.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ze((function(){if(!i().get(\"WEBGL_RENDER_FLOAT32_ENABLED\")){var e=i().getBool(\"DEBUG\");i().set(\"DEBUG\",!1);var n=t.abs(On(1e-8)).dataSync()[0];if(i().set(\"DEBUG\",e),n>0)return 32}return 16}))),this.floatPrecisionValue},o.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},o.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,o=n.dtype,a=n.values,i=n.texture,s=n.usage,u=n.isPacked;if(null==i){var c,l=null!=this.activeTimers;l&&(c=et());var h=n.texShape;if(null==h&&(h=Ne(r,u),n.texShape=h),null!=a){var f=Te(r),d=void 0,p=h[1],v=h[0],m=a instanceof Uint8Array;u?(p=(e=$t(h[0],h[1]))[0],v=e[1],d=new hi(f,[v,p],m)):d=new li(f,[v,p],m);var g=this.makeTensorInfo([v,p],o);this.texData.get(g.dataId).usage=m?zt.PIXELS:zt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),p,v,a);var y=this.runWebGLProgram(d,[g],o,null,!0),x=this.texData.get(y.dataId);n.texture=x.texture,n.texShape=x.texShape,n.isPacked=x.isPacked,n.usage=x.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=et()-c)}else{var b=this.acquireTexture(h,s,o,u);n.texture=b}}},o.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if(\"float32\"===e||\"complex64\"===e)return t;if(\"int32\"===e||\"bool\"===e){for(var n=\"int32\"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error(\"Unknown dtype \"+e)}(e,r)),n.values},o.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(\"High memory usage in GPU: \"+o+\" MB, most likely due to a memory leak\")}return this.textureManager.acquireTexture(t,e,r)},o.prototype.computeBytes=function(t,e){return t[0]*t[1]*z(e)},o}(bo);Wt()&&Lt.registerBackend(\"webgl\",(function(){return new Zs}),2);var tu=An({square_:function(t){var e=mn(t,\"x\",\"square\"),n=[e];return Lt.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},null,\"Square\",{},n,[])}}),eu=\"SquaredDifference\";var nu=An({squaredDifference_:function(t,e){var n,r=mn(t,\"a\",\"squaredDifference\"),o=mn(e,\"b\",\"squaredDifference\");n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape);var a={a:r,b:o},i=[r,o];return Lt.runKernelFunc((function(t,e){var n=t.squaredDifference(r,o);return e([r,o]),n}),a,(function(t,e){var n=e[0],r=e[1],o=On(2);return{a:function(){return t.mul(n.sub(r).mul(o))},b:function(){return t.mul(r.sub(n).mul(o))}}}),eu,{},i,[])}});var ru=An({abs_:function(t){var e=mn(t,\"x\",\"abs\");return\"complex64\"===e.dtype?Lt.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Lt.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),\"Abs\")}}),ou=An({acos_:function(t){var e=mn(t,\"x\",\"acos\");return Lt.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(On(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),au=An({acosh_:function(t){var e=mn(t,\"x\",\"acosh\");return Lt.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),iu=An({asin_:function(t){var e=mn(t,\"x\",\"asin\");return Lt.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(On(1).sub(n.toFloat().square()).sqrt())}}}))}}),su=An({asinh_:function(t){var e=mn(t,\"x\",\"asinh\");return Lt.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(On(1).add(n.toFloat().square()).sqrt())}}}))}}),uu=An({atan_:function(t){var e=mn(t,\"x\",\"atan\");return Lt.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),cu=An({atanh_:function(t){var e=mn(t,\"x\",\"atanh\");return Lt.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(On(1).sub(n.toFloat().square()))}}}))}}),lu=An({ceil_:function(t){var e=mn(t,\"x\",\"ceil\");return Lt.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),hu=An({clipByValue_:function(t,e,n){var r=mn(t,\"x\",\"clipByValue\");C(e<=n,(function(){return\"Error in clip: min (\"+e+\") must be less than or equal to max (\"+n+\").\"}));var o=[r],a={min:e,max:n};return Lt.runKernelFunc((function(t,o){var a=t.clip(r,e,n);return o([r]),a}),{x:r},(function(t,r){var o=r[0];return{x:function(){return t.where(o.greaterEqual(e).logicalAnd(o.lessEqual(n)),Xn(t))}}}),\"ClipByValue\",a,o)}}),fu=An({cos_:function(t){var e=mn(t,\"x\",\"cos\"),n=[e];return Lt.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().sin().neg().mul(t)}}}),\"Cos\",{},n)}}),du=An({cosh_:function(t){var e=mn(t,\"x\",\"cosh\");return Lt.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),pu=An({erf_:function(t){var e=mn(t,\"x\",\"erf\");return C(\"int32\"===e.dtype||\"float32\"===e.dtype,(function(){return\"Input dtype must be `int32` or `float32`.\"})),\"int32\"===e.dtype&&(e=e.toFloat()),Lt.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),vu=An({exp_:function(t){var e=mn(t,\"x\",\"exp\");return Lt.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{x:e},(function(t,e){return{x:function(){return t.mulStrict(e[0])}}}),\"Exp\",{},[],[!0])}}),mu=An({expm1_:function(t){var e=mn(t,\"x\",\"expm1\");return Lt.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),gu=An({floor_:function(t){var e=mn(t,\"x\",\"floor\");return Lt.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),yu=An({log_:function(t){var e=mn(t,\"x\",\"log\"),n=[e];return Lt.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.toFloat())}}}),\"Log\",{},n)}}),xu=An({log1p_:function(t){var e=mn(t,\"x\",\"log1p\");return Lt.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),bu=An({logSigmoid_:function(t){var e=mn(t,\"x\",\"logSigmoid\");return Lt.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),wu=An({neg_:function(t){var e=mn(t,\"x\",\"neg\"),n=[e];return Lt.runKernelFunc((function(t){return t.neg(e)}),{x:e},(function(t){return{x:function(){return t.neg()}}}),\"Neg\",{},n)}}),Cu=An({reciprocal_:function(t){var e=mn(t,\"x\",\"reciprocal\");return Lt.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),Eu=An({round_:function(t){var e=mn(t,\"x\",\"round\");return Lt.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),Ru=An({rsqrt_:function(t){var e=mn(t,\"x\",\"rsqrt\"),n=[e];return Lt.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}),\"Rsqrt\",{},n)}}),Iu=An({sigmoid_:function(t){var e=mn(t,\"x\",\"sigmoid\");return Lt.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.mul(On(1).sub(n)))}}}),\"Sigmoid\")}}),ku=An({sign_:function(t){var e=mn(t,\"x\",\"sign\");return Lt.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),Su=An({isNaN_:function(t){var e=mn(t,\"x\",\"isNaN\");return Lt.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),Au=An({isInf_:function(t){var e=mn(t,\"x\",\"isInf\");return Lt.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),Du=An({isFinite_:function(t){var e=mn(t,\"x\",\"isFinite\");return Lt.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Xn(t)}}}))}}),Tu=An({sin_:function(t){var e=mn(t,\"x\",\"sin\"),n=[e];return Lt.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().cos().mul(t)}}}),\"Sin\",{},n)}}),Nu=An({sinh_:function(t){var e=mn(t,\"x\",\"sinh\");return Lt.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),Fu=An({softplus_:function(t){var e=mn(t,\"x\",\"softplus\");return Lt.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),_u=An({sqrt_:function(t){var e=mn(t,\"x\",\"sqrt\");return Lt.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),Ou=An({step_:function(t,e){void 0===e&&(e=0);var n=mn(t,\"x\",\"step\");return Lt.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Xn(t)}}}))}}),Mu=An({tan_:function(t){var e=mn(t,\"x\",\"tan\");return Lt.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),Bu=An({tanh_:function(t){var e=mn(t,\"x\",\"tanh\");return Lt.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return On(1).sub(n.square()).mulStrict(t)}}}),\"Tanh\",{},null,[!0])}});function Pu(t,e,n,r,o,a){var i,s,u=mn(t,\"x\",\"batchNorm\"),c=mn(e,\"mean\",\"batchNorm\"),l=mn(n,\"variance\",\"batchNorm\");return null!=o&&(i=mn(o,\"scale\",\"batchNorm\")),null!=r&&(s=mn(r,\"offset\",\"batchNorm\")),C(2===u.rank,(function(){return\"Error in batchNorm3D: x must be rank 3 but got rank \"+u.rank+\".\"})),C(2===c.rank||1===c.rank,(function(){return\"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank \"+c.rank+\".\"})),C(2===l.rank||1===l.rank,(function(){return\"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank \"+l.rank+\".\"})),null!=i&&C(2===i.rank||1===i.rank,(function(){return\"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank \"+i.rank+\".\"})),null!=s&&C(2===s.rank||1===s.rank,(function(){return\"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank \"+s.rank+\".\"})),Uu(u,c,l,s,i,a)}function Lu(t,e,n,r,o,a){var i,s,u=mn(t,\"x\",\"batchNorm\"),c=mn(e,\"mean\",\"batchNorm\"),l=mn(n,\"variance\",\"batchNorm\");return null!=o&&(i=mn(o,\"scale\",\"batchNorm\")),null!=r&&(s=mn(r,\"offset\",\"batchNorm\")),C(3===u.rank,(function(){return\"Error in batchNorm3D: x must be rank 3 but got rank \"+u.rank+\".\"})),C(3===c.rank||1===c.rank,(function(){return\"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank \"+c.rank+\".\"})),C(3===l.rank||1===l.rank,(function(){return\"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank \"+l.rank+\".\"})),null!=i&&C(3===i.rank||1===i.rank,(function(){return\"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank \"+i.rank+\".\"})),null!=s&&C(3===s.rank||1===s.rank,(function(){return\"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank \"+s.rank+\".\"})),Uu(u,c,l,s,i,a)}function Wu(t,e,n,r,o,a){var i,s,u=mn(t,\"x\",\"batchNorm\"),c=mn(e,\"mean\",\"batchNorm\"),l=mn(n,\"variance\",\"batchNorm\");return null!=o&&(i=mn(o,\"scale\",\"batchNorm\")),null!=r&&(s=mn(r,\"offset\",\"batchNorm\")),C(4===u.rank,(function(){return\"Error in batchNorm4D: x must be rank 4 but got rank \"+u.rank+\".\"})),C(4===c.rank||1===c.rank,(function(){return\"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank \"+c.rank+\".\"})),C(4===l.rank||1===l.rank,(function(){return\"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank \"+l.rank+\".\"})),null!=i&&C(4===i.rank||1===i.rank,(function(){return\"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank \"+i.rank+\".\"})),null!=s&&C(4===s.rank||1===s.rank,(function(){return\"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank \"+s.rank+\".\"})),Uu(u,c,l,s,i,a)}function Uu(t,e,n,r,o,a){null==a&&(a=.001);var i,s,u,c=mn(t,\"x\",\"batchNorm\"),l=mn(e,\"mean\",\"batchNorm\"),h=mn(n,\"variance\",\"batchNorm\");null!=o&&(i=mn(o,\"scale\",\"batchNorm\")),null!=r&&(s=mn(r,\"offset\",\"batchNorm\")),C(l.rank===h.rank,(function(){return\"Batch normalization gradient requires mean and variance to have equal ranks.\"})),C(null==s||l.rank===s.rank,(function(){return\"Batch normalization gradient requires mean and offset to have equal ranks.\"})),C(null==i||l.rank===i.rank,(function(){return\"Batch normalization gradient requires mean and scale to have equal ranks.\"})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,l,h,i];return Lt.runKernelFunc((function(t,e){var n=t.batchNormalization(u,Vu(l),Vu(h),a,Vu(i),Vu(s));return e([c,l,h,i]),n}),{x:c,mean:l,variance:h,scale:i,offset:s},(function(t,e){var n=e,r=n[0],o=n[1],i=n[2],s=n[3],c=null==s?On(1):s,l=Eo(o.shape,u.shape),h=[];if(1===o.rank){for(var f=0;f<u.shape.length-1;++f)h.push(u.shape[f]);h.push(1)}var d=r.sub(o),p=t.mul(c),v=Ru(i.add(On(a))),m=v.mul(v).mul(v).mul(On(-.5));return{x:function(){return 1===o.rank?t.mul(Lr(v.as4D(1,1,1,o.shape[0]),h)).mul(c).reshape(r.shape):t.mul(v).mul(c).reshape(r.shape)},mean:function(){var t=v.mul(On(-1)).mul(p);return 1===o.rank&&(t=t.sum(l)),t.reshape(o.shape)},variance:function(){var t=m.mul(d).mul(p);return 1===o.rank&&(t=t.sum(l)),t.reshape(o.shape)},scale:function(){var e=d.mul(v),n=t.mul(e);return 1===o.rank&&(n=n.sum(l)),n.reshape(o.shape)},offset:function(){var e=t;return 1===o.rank&&(e=e.sum(l)),e.reshape(o.shape)}}}),\"BatchNormalization\",{varianceEpsilon:a},f).reshape(c.shape)}function Vu(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function zu(){Xe(\"tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon\")}var Gu=An({batchNormalization2d_:function(t,e,n,r,o,a){return void 0===r&&(r=.001),zu(),Pu(t,e,n,a,o,r)}}),Hu=An({batchNormalization3d_:function(t,e,n,r,o,a){return void 0===r&&(r=.001),zu(),Lu(t,e,n,a,o,r)}}),qu=An({batchNormalization4d_:function(t,e,n,r,o,a){return void 0===r&&(r=.001),zu(),Wu(t,e,n,a,o,r)}}),Ku=An({batchNormalization_:function(t,e,n,r,o,a){return void 0===r&&(r=.001),zu(),Uu(t,e,n,a,o,r)}}),ju=An({batchNorm_:Uu}),Xu=An({batchNorm2d_:Pu}),Yu=An({batchNorm3d_:Lu}),$u=An({batchNorm4d_:Wu});var Qu=An({logicalAnd_:function(t,e){var n=mn(t,\"a\",\"logicalAnd\",\"bool\"),r=mn(e,\"b\",\"logicalAnd\",\"bool\");return Ro(n.shape,r.shape),Lt.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{a:n,b:r},null,\"LogicalAnd\")}}),Ju=An({logicalNot_:function(t){var e=mn(t,\"x\",\"logicalNot\",\"bool\");return Lt.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),Zu=An({logicalOr_:function(t,e){var n=mn(t,\"a\",\"logicalOr\",\"bool\"),r=mn(e,\"b\",\"logicalOr\",\"bool\");return Ro(n.shape,r.shape),Lt.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),tc=An({logicalXor_:function(t,e){var n=mn(t,\"a\",\"logicalXor\",\"bool\"),r=mn(e,\"b\",\"logicalXor\",\"bool\");return Ro(n.shape,r.shape),Zu(t,e).logicalAnd(Qu(t,e).logicalNot())}}),ec=An({where_:function(t,e,n){var r=mn(e,\"a\",\"where\"),o=mn(n,\"b\",\"where\"),a=mn(t,\"condition\",\"where\",\"bool\");return E(r.shape,o.shape,\"Error in where: \"),1===a.rank?C(a.shape[0]===r.shape[0],(function(){return\"The first dimension of `a` must match the size of `condition`.\"})):E(a.shape,o.shape,\"Error in where: \"),Lt.runKernelFunc((function(t,e){var n=t.select(a,r,o);return e([a]),n}),{$condition:a,$a:r,$b:o},(function(t,e){var n=e[0];return{$condition:function(){return Xn(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),nc=function(t){return n(this,void 0,void 0,(function(){var e,n,o;return r(this,(function(r){switch(r.label){case 0:return[4,(e=mn(t,\"condition\",\"whereAsync\",\"bool\")).data()];case 1:return n=r.sent(),o=na(e.shape,n),t!==e&&e.dispose(),[2,o]}}))}))};var rc=An({add_:function(t,e){var n,r=mn(t,\"a\",\"add\"),o=mn(e,\"b\",\"add\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t){return t.add(r,o)}),{a:r,b:o},(function(t){return{a:function(){var e=t,n=Eo(r.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=Eo(o.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(o.shape)}}}),\"Add\")}}),oc=An({addN_:function(t){C(Array.isArray(t),(function(){return\"The argument passed to tf.addN() must be a list of tensors\"})),C(t.length>=1,(function(){return\"Must pass at least one tensor to tf.addN(), but got \"+t.length}));var e=t.map((function(t,e){return mn(t,\"tensors\"+e,\"addN\")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error(\"All tensors passed to tf.addN() must have the same dtype\")})),e.forEach((function(t){if(!S(t.shape,n.shape))throw new Error(\"All tensors passed to tf.addN() must have the same shape\")}));var r=e;return Lt.runKernelFunc((function(t){return t.addN(e)}),r,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}),\"AddN\")}}),ac=An({addStrict_:function(t,e){var n=mn(t,\"a\",\"addStrict\"),r=mn(e,\"b\",\"addStrict\");return E(n.shape,r.shape,\"Error in addStrict: \"),n.add(r)}}),ic=An({atan2_:function(t,e){var n,r=mn(t,\"a\",\"atan2\"),o=mn(e,\"b\",\"atan2\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t,e){var n=t.atan2(r,o);return e([r,o]),n}),{$a:r,$b:o},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=rc(n.square(),r.square()),o=t.mul(r.div(e)),i=Eo(n.shape,a);return i.length>0&&(o=o.sum(i)),o.reshape(n.shape)},$b:function(){var e=rc(n.square(),r.square()),o=wu(t.mul(n.div(e))),i=Eo(r.shape,a);return i.length>0&&(o=o.sum(i)),o.reshape(r.shape)}}}))}}),sc=An({div_:function(t,e){var n,r=mn(t,\"a\",\"div\"),o=mn(e,\"b\",\"div\");if(n=Nt(r,o),r=n[0],o=n[1],\"int32\"===r.dtype&&\"int32\"===o.dtype)return lc(r,o);var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t,e){var n=t.realDivide(r,o);return e([r,o]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),o=Eo(n.shape,a);return o.length>0?e.sum(o).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),o=Eo(r.shape,a);o.length>0&&(e=e.sum(o).reshape(r.shape));var i=r.square();return e.div(i.toFloat()).neg()}}}),\"Div\")}}),uc=An({divNoNan_:function(t,e){var n,r=mn(t,\"a\",\"div\"),o=mn(e,\"b\",\"div\");r=(n=Nt(r,o))[0],o=n[1];var a=sc(r,o),i=Xn(a),s=o.equal(i);return ec(s,i,a)}}),cc=An({divStrict_:function(t,e){var n=mn(t,\"a\",\"div\"),r=mn(e,\"b\",\"div\");return E(n.shape,r.shape,\"Error in divideStrict: \"),n.div(r)}}),lc=An({floorDiv_:function(t,e){var n,r=mn(t,\"a\",\"floorDiv\"),o=mn(e,\"b\",\"floorDiv\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t,e){var n=t.floorDiv(r,o);return e([r,o]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),o=Eo(n.shape,a);return o.length>0?e.sum(o).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),o=Eo(r.shape,a);o.length>0&&(e=e.sum(o).reshape(r.shape));var i=r.square();return e.div(i.toFloat()).neg()}}}),\"FloorDiv\")}}),hc=An({maximum_:function(t,e){var n,r=mn(t,\"a\",\"maximum\"),o=mn(e,\"b\",\"maximum\");return n=Nt(r,o),r=n[0],o=n[1],\"bool\"===r.dtype&&(r=r.toInt(),o=o.toInt()),Ro(r.shape,o.shape),Lt.runKernelFunc((function(t,e){var n=t.maximum(r,o);return e([r,o]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.greaterEqual(r).toFloat())},b:function(){return t.mul(n.less(r).toFloat())}}}),\"Maximum\")}}),fc=An({maximumStrict_:function(t,e){var n=mn(t,\"a\",\"maximumStrict\"),r=mn(e,\"b\",\"maximumStrict\");return E(n.shape,r.shape,\"Error in maximumStrict: \"),n.maximum(r)}}),dc=An({minimum_:function(t,e){var n,r=mn(t,\"a\",\"minimum\"),o=mn(e,\"b\",\"minimum\");return n=Nt(r,o),r=n[0],o=n[1],\"bool\"===r.dtype&&(r=r.toInt(),o=o.toInt()),Ro(r.shape,o.shape),Lt.runKernelFunc((function(t,e){var n=t.minimum(r,o);return e([r,o]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.lessEqual(r).toFloat())},b:function(){return t.mul(n.greater(r).toFloat())}}}),\"Minimum\")}}),pc=An({minimumStrict_:function(t,e){var n=mn(t,\"a\",\"minimumStrict\"),r=mn(e,\"b\",\"minimumStrict\");return E(n.shape,r.shape,\"Error in minimumStrict: \"),n.minimum(r)}}),vc=An({mod_:function(t,e){var n,r=mn(t,\"a\",\"mod\"),o=mn(e,\"b\",\"mod\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t,e){var n=t.mod(r,o);return e([r,o]),n}),{$a:r,$b:o},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=Eo(n.shape,a);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),o=Eo(r.shape,a);return o.length>0?e.sum(o).reshape(r.shape):e}}}))}}),mc=An({modStrict_:function(t,e){var n=mn(t,\"a\",\"modStrict\"),r=mn(e,\"b\",\"modStrict\");return E(n.shape,r.shape,\"Error in modStrict: \"),n.mod(r)}}),gc=An({mul_:function(t,e){var n,r=mn(t,\"a\",\"mul\"),o=mn(e,\"b\",\"mul\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t,e){var n=t.multiply(r,o);return e([r,o]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.mul(r.toFloat()),o=Eo(n.shape,a);return o.length>0?e.sum(o).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),o=Eo(r.shape,a);return o.length>0?e.sum(o).reshape(r.shape):e}}}),\"Mul\")}}),yc=An({mulStrict_:function(t,e){var n=mn(t,\"a\",\"mul\"),r=mn(e,\"b\",\"mul\");return E(n.shape,r.shape,\"Error in multiplyStrict: \"),n.mul(r)}}),xc=An({pow_:function(t,e){var n,r=mn(t,\"base\",\"pow\"),o=mn(e,\"exp\",\"pow\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape),i=[r,o];return Lt.runKernelFunc((function(t,e){var n=t.pow(r,o);return e([r,o,n]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1],o=e[2];return{a:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(On(1))))),i=Eo(n.shape,a);return i.length>0&&(o=o.sum(i)),o.reshape(n.shape)},b:function(){var e=n.greater(0),i=n.log().where(e,Xn(n)),s=t.mul(o.mul(i)),u=Eo(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),\"Pow\",{},i,[!0])}}),bc=An({powStrict_:function(t,e){return E(t.shape,e.shape,\"Error in powStrict: \"),t.pow(e)}}),wc=An({squaredDifferenceStrict_:function(t,e){var n=mn(t,\"a\",\"squaredDifferenceStrict\"),r=mn(e,\"b\",\"squaredDifferenceStrict\");return E(n.shape,r.shape,\"Error in squaredDifferenceStrict: \"),n.squaredDifference(r)}}),Cc=An({sub_:function(t,e){var n,r=mn(t,\"a\",\"sub\"),o=mn(e,\"b\",\"sub\");n=Nt(r,o),r=n[0],o=n[1];var a=Ro(r.shape,o.shape);return Lt.runKernelFunc((function(t){return t.subtract(r,o)}),{a:r,b:o},(function(t){return{a:function(){var e=t,n=Eo(r.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=Eo(o.shape,a);return n.length>0&&(e=e.sum(n)),e.neg().reshape(o.shape)}}}),\"Sub\")}}),Ec=An({subStrict_:function(t,e){var n=mn(t,\"a\",\"subStrict\"),r=mn(e,\"b\",\"subStrict\");return E(n.shape,r.shape,\"Error in subStrict: \"),n.sub(r)}});var Rc=An({equal_:function(t,e){var n,r=mn(t,\"a\",\"equal\"),o=mn(e,\"b\",\"equal\");return n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape),Lt.runKernelFunc((function(t){return t.equal(r,o)}),{$a:r,$b:o})}}),Ic=An({equalStrict_:function(t,e){var n=mn(t,\"a\",\"equalStrict\"),r=mn(e,\"b\",\"equalStrict\");return E(n.shape,r.shape,\"Error in equalStrict: \"),n.equal(r)}}),kc=An({greater_:function(t,e){var n,r=mn(t,\"a\",\"greater\"),o=mn(e,\"b\",\"greater\");return n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape),Lt.runKernelFunc((function(t){return t.greater(r,o)}),{a:r,b:o},null,\"Greater\")}}),Sc=An({greaterEqual_:function(t,e){var n,r=mn(t,\"a\",\"greaterEqual\"),o=mn(e,\"b\",\"greaterEqual\");return n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape),Lt.runKernelFunc((function(t,e){var n=t.greaterEqual(r,o);return e([r,o]),n}),{a:r,b:o},(function(t,e){var n=e[0],r=e[1];return{a:function(){return Xn(n)},b:function(){return Xn(r)}}}),\"GreaterEqual\")}}),Ac=An({greaterEqualStrict_:function(t,e){var n=mn(t,\"a\",\"greaterEqualStrict\"),r=mn(e,\"b\",\"greaterEqualStrict\");return E(n.shape,r.shape,\"Error in greaterEqualStrict: \"),n.greaterEqual(r)}}),Dc=An({greaterStrict_:function(t,e){var n=mn(t,\"a\",\"greaterStrict\"),r=mn(e,\"b\",\"greaterStrict\");return E(n.shape,r.shape,\"Error in greaterStrict: \"),n.greater(r)}}),Tc=An({less_:function(t,e){var n,r=mn(t,\"a\",\"less\"),o=mn(e,\"b\",\"less\");return n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape),Lt.runKernelFunc((function(t){return t.less(r,o)}),{a:r,b:o},null,\"Less\")}}),Nc=An({lessEqual_:function(t,e){var n,r=mn(t,\"a\",\"lessEqual\"),o=mn(e,\"b\",\"lessEqual\");return n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape),Lt.runKernelFunc((function(t,e){var n=t.lessEqual(r,o);return e([r,o]),n}),{a:r,b:o},null,\"LessEqual\")}}),Fc=An({lessEqualStrict_:function(t,e){var n=mn(t,\"a\",\"lessEqualStrict\"),r=mn(e,\"b\",\"lessEqualStrict\");return E(n.shape,r.shape,\"Error in lessEqualStrict: \"),n.lessEqual(r)}}),_c=An({lessStrict_:function(t,e){var n=mn(t,\"a\",\"lessStrict\"),r=mn(e,\"b\",\"lessStrict\");return E(n.shape,r.shape,\"Error in lessStrict: \"),n.less(r)}}),Oc=An({notEqual_:function(t,e){var n,r=mn(t,\"a\",\"notEqual\"),o=mn(e,\"b\",\"notEqual\");return n=Nt(r,o),r=n[0],o=n[1],Ro(r.shape,o.shape),Lt.runKernelFunc((function(t){return t.notEqual(r,o)}),{a:r,b:o},null,\"NotEqual\")}}),Mc=An({notEqualStrict_:function(t,e){var n=mn(t,\"a\",\"notEqualStrict\"),r=mn(e,\"b\",\"notEqualStrict\");return E(n.shape,r.shape,\"Error in notEqualStrict: \"),n.notEqual(r)}});function Bc(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Pc(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var Lc=An({gather_:function(t,e,n){void 0===n&&(n=0);var r=mn(t,\"x\",\"gather\"),o=mn(e,\"indices\",\"gather\",\"int32\");n=O(n,r.shape)[0];var a=function(t,e,n){for(var r=t.shape[n],o=[],a=1,i=1,s=0;s<n;s++)o.push(t.shape[s]),a*=t.shape[s];for(s=0;s<e.rank;s++)o.push(e.shape[s]);for(s=n+1;s<t.rank;s++)o.push(t.shape[s]),i*=t.shape[s];return{batchSize:a,sliceSize:i,dimSize:r,outputShape:o}}(r,o,n);return Lt.runKernelFunc((function(t,e){var a=t.gather(r,o.flatten(),n);return e([o]),a}),{x:r,indices:o},(function(t,e){var o=e[0];return{x:function(){var e=r.shape,a=o.size,i=e.slice(0,n),s=i.length,u=e.slice(n,e.length).slice(1),c=u.length,l=Bc(0,s),h=Bc(s+1,s+1+c),f=Pc([i,[a],u]),d=t.reshape(f),p=o.reshape([a]),v=Pc([[s],l,h]),m=d.transpose(v),g=Wc(m,p,r.shape[n]),y=Rn(v);return g=g.transpose(y)},indices:function(){return o}}}),\"Gather\",{axis:n}).reshape(a.outputShape)}}),Wc=An({unsortedSegmentSum_:function(t,e,n){var r=mn(t,\"x\",\"unsortedSegmentSum\"),o=mn(e,\"segmentIds\",\"unsortedSegmentSum\",\"int32\");return C(A(n),(function(){return\"numSegments must be of dtype int\"})),Lt.runKernelFunc((function(t,e){var a=t.unsortedSegmentSum(r,o,n);return e([o]),a}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=hc(e,Xn(e)),r=Lc(t,n),o=Sc(e,On(0,\"int32\")),a=r.rank-o.rank,i=0;i<a;++i)o=wr(o,i+1);o=Qu(o,zn(r.shape,\"bool\"));var s=Xn(r);return ec(o,r,s)}(t,n)}}}))}});var Uc=function(t,e,o){return n(this,void 0,void 0,(function(){var n,a,i,s,u,c,l,h,f,d,p,v,m;return r(this,(function(r){switch(r.label){case 0:for(n=mn(t,\"tensor\",\"boolMask\"),a=mn(e,\"mask\",\"boolMask\",\"bool\"),i=null==o?0:o,s=a.rank,u=n.shape,C(s>0,(function(){return\"mask cannot be scalar\"})),E(u.slice(i,i+s),a.shape,\"mask's shape must match the first K dimensions of tensor's shape,\"),c=1,l=i;l<i+s;l++)c*=u[l];return h=u.slice(0,i).concat([c],u.slice(i+s)),f=n.reshape(h),d=a.reshape([-1]),[4,nc(d)];case 1:return p=r.sent(),v=p.squeeze([1]),m=Lc(f,v,i),t!==n&&n.dispose(),e!==a&&a.dispose(),v.dispose(),f.dispose(),d.dispose(),p.dispose(),[2,m]}}))}))};function Vc(t,e,n,r,o,a,i){void 0===a&&(a=\"NHWC\"),C(t.length===e.rank,(function(){return\"Length of inShape (\"+t.length+\") and rank of dy (\"+e.rank+\") must match\"}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),C(4===s.length,(function(){return\"Error in conv2dDerInput: inShape must be length 4, but got length \"+s.length+\".\"})),C(4===u.rank,(function(){return\"Error in conv2dDerInput: dy must be rank 4, but got rank \"+u.rank})),C(4===n.rank,(function(){return\"Error in conv2dDerInput: filter must be rank 4, but got rank \"+n.rank}));var l=\"NHWC\"===a?s[3]:s[1],h=\"NHWC\"===a?u.shape[3]:u.shape[1];C(l===n.shape[2],(function(){return\"Error in conv2dDerInput: depth of input (\"+l+\") must match input depth for filter \"+n.shape[2]+\".\"})),C(h===n.shape[3],(function(){return\"Error in conv2dDerInput: depth of output (\"+h+\") must match output depth for filter \"+n.shape[3]+\".\"})),null!=i&&C(A(o),(function(){return\"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode \"+i+\" but got pad \"+o+\".\"}));var f=Bo(a),d=So(s,n.shape,r,1,o,i,!1,f),p=Lt.runKernelFunc((function(t,e){var r=t.conv2dDerInput(u,n,d);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return qc(t,n,r,o,a,1,i)},filter:function(){return jc(t,s,n.shape,r,o,a,i)}}}));return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function zc(t){var e=function(t){return\"number\"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t),n=e[0],r=e[1],o=e[2];return 1===n&&1===r&&1===o}function Gc(t,e,n,r,o){C(t.length===e.rank,(function(){return\"Length of inShape (\"+t.length+\") and rank of dy (\"+e.rank+\") must match\"}));var a=t,i=e,s=!1;4===e.rank&&(s=!0,i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),a=[1,t[0],t[1],t[2],t[3]]);var u=a[4],c=i.shape[4];C(5===a.length,(function(){return\"Error in conv3dDerInput: inShape must be length 5, but got length \"+a.length+\".\"})),C(5===i.rank,(function(){return\"Error in conv3dDerInput: dy must be rank 5, but got rank \"+i.rank})),C(5===n.rank,(function(){return\"Error in conv3dDerInput: filter must be rank 5, but got rank \"+n.rank})),C(u===n.shape[3],(function(){return\"Error in conv3dDerInput: depth of input (\"+u+\") must match input depth for filter \"+n.shape[3]+\".\"})),C(c===n.shape[4],(function(){return\"Error in conv3dDerInput: depth of output (\"+c+\") must match output depth for filter \"+n.shape[4]+\".\"}));var l=Ao(a,n.shape,r,1,o),h=Lt.runKernelFunc((function(t){return t.conv3dDerInput(i,n,l)}),{dy5D:i});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var Hc=An({conv1d_:function(t,e,n,r,o,a,i){void 0===o&&(o=\"NWC\"),void 0===a&&(a=1);var s=mn(t,\"x\",\"conv1d\"),u=mn(e,\"filter\",\"conv1d\"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),C(3===c.rank,(function(){return\"Error in conv1d: input must be rank 3, but got rank \"+c.rank+\".\"})),C(3===u.rank,(function(){return\"Error in conv1d: filter must be rank 3, but got rank \"+u.rank+\".\"})),null!=i&&C(A(r),(function(){return\"Error in conv1d: pad must be an integer when using, dimRoundingMode \"+i+\" but got pad \"+r+\".\"})),C(c.shape[2]===u.shape[1],(function(){return\"Error in conv1d: depth of input (\"+c.shape[2]+\") must match input depth for filter \"+u.shape[1]+\".\"})),C(Mo(n,a),(function(){return\"Error in conv1D: Either stride or dilation must be 1. Got stride \"+n+\" and dilation '\"+a+\"'\"})),C(\"NWC\"===o,(function(){return\"Error in conv1d: got dataFormat of \"+o+\" but only NWC is currently supported.\"}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),d=qc(f,h,[1,n],r,\"NHWC\",[1,a],i);return l?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),qc=An({conv2d_:function(t,e,n,r,o,a,i){void 0===o&&(o=\"NHWC\"),void 0===a&&(a=[1,1]);var s=mn(t,\"x\",\"conv2d\"),u=mn(e,\"filter\",\"conv2d\"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),C(4===c.rank,(function(){return\"Error in conv2d: input must be rank 4, but got rank \"+c.rank+\".\"})),C(4===u.rank,(function(){return\"Error in conv2d: filter must be rank 4, but got rank \"+u.rank+\".\"})),null!=i&&C(A(r),(function(){return\"Error in conv2d: pad must be an integer when using, dimRoundingMode \"+i+\" but got pad \"+r+\".\"}));var h=\"NHWC\"===o?c.shape[3]:c.shape[1];C(h===u.shape[2],(function(){return\"Error in conv2d: depth of input (\"+h+\") must match input depth for filter \"+u.shape[2]+\".\"})),C(Mo(n,a),(function(){return\"Error in conv2D: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+a+\"'\"}));var f=Bo(o),d=So(c.shape,u.shape,n,a,r,i,!1,f),p=[u,c],v=Lt.runKernelFunc((function(t,e){var n=t.conv2d(c,u,d);return e([u,c]),n}),{x:c,filter:u},(function(t,e){var i=e,s=i[0],u=i[1];return C(Oo(a),(function(){return\"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '\"+a+\"'\"})),{x:function(){return Xc(u.shape,t,s,n,r,o)},filter:function(){return jc(u,t,s.shape,n,r,o)}}}),\"Conv2D\",d,p);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Kc=An({conv3d_:function(t,e,n,r,o,a){void 0===o&&(o=\"NDHWC\"),void 0===a&&(a=[1,1,1]);var i=mn(t,\"x\",\"conv3d\"),s=mn(e,\"filter\",\"conv3d\"),u=i,c=!1;4===i.rank&&(c=!0,u=i.as5D(1,i.shape[0],i.shape[1],i.shape[2],i.shape[3])),C(5===u.rank,(function(){return\"Error in conv3d: input must be rank 5, but got rank \"+u.rank+\".\"})),C(5===s.rank,(function(){return\"Error in conv3d: filter must be rank 5, but got rank \"+s.rank+\".\"})),C(u.shape[4]===s.shape[3],(function(){return\"Error in conv3d: depth of input (\"+u.shape[4]+\") must match input depth for filter \"+s.shape[3]+\".\"})),C(function(t,e){return zc(t)||zc(e)}(n,a),(function(){return\"Error in conv3D: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+a+\"'\"})),C(\"NDHWC\"===o,(function(){return\"Error in conv3d: got dataFormat of \"+o+\" but only NDHWC is currently supported.\"}));var l=Ao(u.shape,s.shape,n,a,r),h=Lt.runKernelFunc((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){C(zc(a),(function(){return\"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '\"+a+\"'\"}));var o=e[0],i=e[1];return{x:function(){return Gc(o.shape,t,i,n,r)},$filter:function(){return function(t,e,n,r,o){var a=t;4===t.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var i=e;4===i.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));C(5===a.rank,(function(){return\"Error in conv3dDerFilter: input must be rank 5, but got shape \"+a.shape+\".\"})),C(5===i.rank,(function(){return\"Error in conv3dDerFilter: dy must be rank 5, but got shape \"+i.shape+\".\"})),C(5===n.length,(function(){return\"Error in conv3dDerFilter: filterShape must be length 5, but got \"+n+\".\"})),C(a.shape[4]===n[3],(function(){return\"Error in conv3dDerFilter: depth of input \"+a.shape[4]+\") must match input depth in filter (\"+n[3]+\".\"})),C(i.shape[4]===n[4],(function(){return\"Error in conv3dDerFilter: depth of dy (\"+i.shape[4]+\") must match output depth for filter (\"+n[4]+\").\"}));var s=Ao(a.shape,n,r,1,o);return Lt.runKernelFunc((function(t){return t.conv3dDerFilter(a,i,s)}),{x5D:a,dy5D:i})}(o,t,i.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),jc=An({conv2dDerFilter_:function(t,e,n,r,o,a,i){void 0===a&&(a=\"NHWC\");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),C(4===s.rank,(function(){return\"Error in conv2dDerFilter: input must be rank 4, but got shape \"+s.shape+\".\"})),C(4===u.rank,(function(){return\"Error in conv2dDerFilter: dy must be rank 4, but got shape \"+u.shape+\".\"})),C(4===n.length,(function(){return\"Error in conv2dDerFilter: filterShape must be length 4, but got \"+n+\".\"}));var c=\"NHWC\"===a?s.shape[3]:s.shape[1],l=\"NHWC\"===a?u.shape[3]:u.shape[1];C(c===n[2],(function(){return\"Error in conv2dDerFilter: depth of input \"+c+\") must match input depth in filter (\"+n[2]+\".\"})),C(l===n[3],(function(){return\"Error in conv2dDerFilter: depth of dy (\"+l+\") must match output depth for filter (\"+n[3]+\").\"})),null!=i&&C(A(o),(function(){return\"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode \"+i+\" but got pad \"+o+\".\"}));var h=Bo(a),f=So(s.shape,n,r,1,o,i,!1,h);return Lt.runKernelFunc((function(t){return t.conv2dDerFilter(s,u,f)}),{x4D:s,dy4D:u})}}),Xc=An({conv2dDerInput_:Vc}),Yc=An({depthwiseConv2d_:function(t,e,n,r,o,a,i){void 0===o&&(o=\"NHWC\"),void 0===a&&(a=[1,1]);var s=mn(t,\"x\",\"depthwiseConv2d\"),u=mn(e,\"filter\",\"depthwiseConv2d\"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),C(4===c.rank,(function(){return\"Error in depthwiseConv2d: input must be rank 4, but got rank \"+c.rank+\".\"})),C(4===u.rank,(function(){return\"Error in depthwiseConv2d: filter must be rank 4, but got rank \"+u.rank+\".\"})),C(c.shape[3]===u.shape[2],(function(){return\"Error in depthwiseConv2d: number of input channels (\"+c.shape[3]+\") must match the inChannels dimension in filter \"+u.shape[2]+\".\"})),null==a&&(a=[1,1]),C(Mo(n,a),(function(){return\"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+a+\"'\"})),null!=i&&C(A(r),(function(){return\"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode \"+i+\" but got pad \"+r+\".\"}));var h=So(c.shape,u.shape,n,a,r,i,!0),f=[c,u],d=Lt.runKernelFunc((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,filter:u},(function(t,e){C(Oo(a),(function(){return\"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '\"+a+\"'\"}));var n=e[0],r=e[1];return{x:function(){return $c(n.shape,t,r,h)},filter:function(){return Qc(n,t,r.shape,h)}}}),\"DepthwiseConv2dNative\",h,f);return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),$c=An({depthwiseConv2dDerInput_:function(t,e,n,r){var o=e,a=!1;3===e.rank&&(a=!0,o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=Lt.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(o,n,r)}),{dy4D:o});return a?i.as3D(i.shape[1],i.shape[2],i.shape[3]):i}}),Qc=An({depthwiseConv2dDerFilter_:function(t,e,n,r){var o=t;3===t.rank&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=e;return 3===a.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Lt.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(o,a,r)}),{x4D:o,dy4D:a})}}),Jc=An({separableConv2d_:function(t,e,n,r,o,a,i){void 0===a&&(a=[1,1]),void 0===i&&(i=\"NHWC\");var s=mn(t,\"x\",\"separableConv2d\"),u=mn(e,\"depthwiseFilter\",\"separableConv2d\"),c=mn(n,\"pointwiseFilter\",\"separableConv2d\"),l=s,h=!1;if(3===s.rank&&(h=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),\"NCHW\"===i)throw new Error(\"separableConv2d currently does not support dataFormat NCHW; only NHWC is supported\");C(4===l.rank,(function(){return\"Error in separableConv2d: input must be rank 4, but got rank \"+l.rank+\".\"})),C(4===u.rank,(function(){return\"Error in separableConv2d: depthwise filter must be rank 4, but got rank \"+u.rank+\".\"})),C(4===c.rank,(function(){return\"Error in separableConv2d: pointwise filter must be rank 4, but got rank \"+u.rank+\".\"})),C(1===c.shape[0],(function(){return\"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got \"+c.shape[0]+\".\"})),C(1===c.shape[1],(function(){return\"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got \"+c.shape[1]+\".\"}));var f=u.shape[2],d=u.shape[3];C(c.shape[2]===f*d,(function(){return\"Error in separableConv2d: the third dimension of pointwise filter must be \"+f*d+\", but got \"+c.shape[2]+\".\"}));var p=Yc(l,u,r,o,i,a),v=qc(p,c,1,\"valid\",i);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Zc=An({conv2dTranspose_:function(t,e,n,r,o,a){return Vc(n,mn(t,\"x\",\"conv2dTranspose\"),mn(e,\"filter\",\"conv2dTranspose\"),r,o,\"NHWC\",a)}}),tl=An({conv3dTranspose_:function(t,e,n,r,o){return Gc(n,mn(t,\"x\",\"conv3dTranspose\"),mn(e,\"filter\",\"conv3dTranspose\"),r,o)}});var el=An({matMul_:function(t,e,n,r){var o;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=mn(t,\"a\",\"matMul\"),i=mn(e,\"b\",\"matMul\");o=Nt(a,i),a=o[0],i=o[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?i.shape[i.rank-1]:i.shape[i.rank-2],c=n?a.shape[a.rank-1]:a.shape[a.rank-2],l=r?i.shape[i.rank-2]:i.shape[i.rank-1],h=a.shape.slice(0,-2),f=i.shape.slice(0,-2),d=k(h),p=k(f);C(a.rank>=2&&i.rank>=2&&a.rank===i.rank,(function(){return\"Error in matMul: inputs must have the same rank of at least 2, got ranks \"+a.rank+\" and \"+i.rank+\".\"})),C(S(h,f),(function(){return\"Error in matMul: outer dimensions (\"+h+\") and (\"+f+\") of Tensors with shapes \"+a.shape+\" and \"+i.shape+\" must match.\"})),C(s===u,(function(){return\"Error in matMul: inner shapes (\"+s+\") and (\"+u+\") of Tensors with shapes \"+a.shape+\" and \"+i.shape+\" and transposeA=\"+n+\" and transposeB=\"+r+\" must match.\"}));var v=a.shape.slice(0,-2).concat([c,l]),m=n?a.as3D(d,s,c):a.as3D(d,c,s),g=r?i.as3D(p,l,u):i.as3D(p,u,l),y={transposeA:n,transposeB:r};return Lt.runKernelFunc((function(t,e){var o=t.batchMatMul(m,g,n,r);return e([m,g]),o}),{a:m,b:g},(function(t,e){var o=e,a=o[0],i=o[1];return n||r?!n&&r?{a:function(){return t.matMul(i,!1,!1)},b:function(){return t.matMul(a,!0,!1)}}:n&&!r?{a:function(){return i.matMul(t,!1,!0)},b:function(){return a.matMul(t,!1,!1)}}:{a:function(){return i.matMul(t,!0,!0)},b:function(){return t.matMul(a,!0,!0)}}:{a:function(){return t.matMul(i,!1,!0)},b:function(){return a.matMul(t,!0,!1)}}}),\"BatchMatMul\",y).reshape(v)}}),nl=An({dot_:function(t,e){var n=mn(t,\"t1\",\"dot\"),r=mn(e,\"t2\",\"dot\");C(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return\"Error in dot: inputs must all be rank 1 or 2, but got ranks \"+n.rank+\" and \"+r.rank+\".\"}));var o=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];return C(o===a,(function(){return\"Error in dot: inner dimensions of inputs must match, but got \"+o+\" and \"+a+\".\"})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),rl=An({outerProduct_:function(t,e){var n=mn(t,\"v1\",\"outerProduct\"),r=mn(e,\"v2\",\"outerProduct\");return C(1===n.rank&&1===r.rank,(function(){return\"Error in outerProduct: inputs must be rank 1, but got ranks \"+n.rank+\" and \"+r.rank+\".\"})),n.as2D(-1,1).matMul(r.as2D(1,-1))}});var ol=An({reverse_:function(t,e){var n=mn(t,\"x\",\"reverse\");if(0===n.rank)return n.clone();var r=O(e,n.shape);return Lt.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),al=An({reverse1d_:function(t){var e=mn(t,\"x\",\"reverse\");return C(1===e.rank,(function(){return\"Error in reverse1D: x must be rank 1 but got rank \"+e.rank+\".\"})),ol(e,0)}}),il=An({reverse2d_:function(t,e){var n=mn(t,\"x\",\"reverse\");return C(2===n.rank,(function(){return\"Error in reverse2D: x must be rank 2 but got rank \"+n.rank+\".\"})),ol(n,e)}}),sl=An({reverse3d_:function(t,e){var n=mn(t,\"x\",\"reverse\");return C(3===n.rank,(function(){return\"Error in reverse3D: x must be rank 3 but got rank \"+n.rank+\".\"})),ol(n,e)}}),ul=An({reverse4d_:function(t,e){var n=mn(t,\"x\",\"reverse\");return C(4===n.rank,(function(){return\"Error in reverse4D: x must be rank 4 but got rank \"+n.rank+\".\"})),ol(n,e)}});function cl(t,e,n,r,o,a){var i=mn(t,\"x\",\"maxPool\"),s=i,u=!1;3===i.rank&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),null==r&&(r=[1,1]),C(4===s.rank,(function(){return\"Error in maxPool: input must be rank 4 but got rank \"+s.rank+\".\"})),C(Mo(n,r),(function(){return\"Error in maxPool: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+r+\"'\"})),null!=a&&C(A(o),(function(){return\"Error in maxPool: pad must be an integer when using, dimRoundingMode \"+a+\" but got pad \"+o+\".\"}));var c=Io(s.shape,e,n,r,o,a);if(1===c.filterWidth&&1===c.filterHeight&&S(c.inShape,c.outShape))return i.clone();var l=[s],h=Lt.runKernelFunc((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,a){var i=a[0],s=a[1];return{x:function(){return function(t,e,n,r,o,a,i,s){var u=mn(t,\"dy\",\"maxPoolBackprop\"),c=mn(e,\"input\",\"maxPoolBackprop\"),l=mn(n,\"output\",\"maxPoolBackprop\");C(c.rank===u.rank,(function(){return\"Rank of input (\"+c.rank+\") does not match rank of dy (\"+u.rank+\")\"})),null==a&&(a=[1,1]);C(Mo(o,a),(function(){return\"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides \"+o+\" and dilations '\"+a+\"'\"})),C(4===u.rank,(function(){return\"Error in maxPoolBackprop: dy must be rank 4 but got rank \"+u.rank+\".\"})),C(4===c.rank,(function(){return\"Error in maxPoolBackprop: input must be rank 4 but got rank \"+c.rank+\".\"})),null!=s&&C(A(i),(function(){return\"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode \"+s+\" but got pad \"+i+\".\"}));var h=Io(c.shape,r,o,a,i,s);return Lt.runKernelFunc((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,i,s,e,n,r,o)}}}),\"MaxPool\",c,l);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function ll(t,e,n,r,o,a){var i=mn(t,\"x\",\"avgPool\",\"float32\");null==r&&(r=[1,1]),C(Mo(n,r),(function(){return\"Error in avgPool: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+r+\"'\"}));var s=i,u=!1;3===i.rank&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),C(4===s.rank,(function(){return\"Error in avgPool: x must be rank 4 but got rank \"+s.rank+\".\"})),null!=a&&C(A(o),(function(){return\"Error in avgPool: pad must be an integer when using, dimRoundingMode \"+a+\" but got pad \"+o+\".\"}));var c=Io(s.shape,e,n,r,o,a);if(1===c.filterWidth&&1===c.filterHeight&&S(c.inShape,c.outShape))return i.clone();var l=Lt.runKernelFunc((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,o,a){var i=mn(t,\"dy\",\"avgPoolBackprop\"),s=mn(e,\"input\",\"avgPoolBackprop\");C(s.rank===i.rank,(function(){return\"Rank of input (\"+s.rank+\") does not match rank of dy (\"+i.rank+\")\"})),null==o&&(o=[1,1]);C(Mo(r,o),(function(){return\"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides \"+r+\" and dilations '\"+o+\"'\"}));var u=s,c=i,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));C(4===c.rank,(function(){return\"Error in avgPoolBackprop: dy must be rank 4 but got rank \"+c.rank+\".\"})),C(4===u.rank,(function(){return\"Error in avgPoolBackprop: input must be rank 4 but got rank \"+u.rank+\".\"}));var h=Io(u.shape,n,r,o,a),f=Lt.runKernelFunc((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});if(l)return f.as3D(f.shape[1],f.shape[2],f.shape[3]);return f}(t,s,e,n,r,o)}}}),\"AvgPool\",c);return l=l.cast(i.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var hl=An({maxPool_:function(t,e,n,r,o){return cl(t,e,n,1,r,o)}}),fl=An({avgPool_:function(t,e,n,r,o){return ll(t,e,n,1,r,o)}}),dl=An({pool_:function(t,e,n,r,o,a){null==o&&(o=[1,1]),null==a&&(a=1),0===r&&(r=\"valid\");var i=mn(t,\"x\",\"maxPool\"),s=i,u=!1;3===i.rank&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),C(Mo(a,o),(function(){return\"Error in pool: Either strides or dilations must be 1. Got strides \"+a+\" and dilations '\"+o+\"'\"}));var c,l=Io(s.shape,e,a,o,r),h=[l.dilationHeight,l.dilationWidth];c=\"same\"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),o=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],o[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],d=function(t,e,n){var r=n.map((function(t){return t[0]})),o=n.map((function(t){return t[1]})),a=t.concat(r,o),i=e.map((function(t,e){return(t-a[e]%t)%t})),s=o.map((function(t,e){return t+i[e]})),u=e.map((function(t,e){return[r[e],s[e]]})),c=e.map((function(t,e){return[0,i[e]]}));return[u,c]}([l.inHeight,l.inWidth],h,c),p=d[0],v=d[1],m=f?r:\"valid\",g=f?s:Mr(s,h,p),y=(\"avg\"===n?function(){return ll(g,e,a,1,m)}:function(){return cl(g,e,a,1,m)})(),x=f?y:vr(y,h,v);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),pl=An({maxPool3d_:function(t,e,n,r,o,a,i){void 0===a&&(a=\"NDHWC\");var s=mn(t,\"x\",\"maxPool3d\"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==i&&(i=[1,1,1]),C(5===u.rank,(function(){return\"Error in maxPool3d: x must be rank 5 but got rank \"+u.rank+\".\"})),C(\"NDHWC\"===a,(function(){return\"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of \"+a})),C(Mo(n,i),(function(){return\"Error in maxPool3d: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+i+\"'\"})),null!=o&&C(A(r),(function(){return\"Error in maxPool3d: pad must be an integer when using, dimRoundingMode \"+o+\" but got pad \"+r+\".\"}));var l=ko(u.shape,e,n,i,r,o,a),h=Lt.runKernelFunc((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,a){var s=a[0],u=a[1];return{x:function(){return function(t,e,n,r,o,a,i,s){var u=mn(t,\"dy\",\"maxPool3dBackprop\"),c=mn(e,\"input\",\"maxPool3dBackprop\"),l=mn(n,\"output\",\"maxPool3dBackprop\"),h=u,f=c,d=l,p=!1;4===c.rank&&(p=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),f=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]));C(5===h.rank,(function(){return\"Error in maxPool3dBackprop: dy must be rank 5 but got rank \"+h.rank+\".\"})),C(5===f.rank,(function(){return\"Error in maxPool3dBackprop: input must be rank 5 but got rank \"+f.rank+\".\"})),C(5===d.rank,(function(){return\"Error in maxPool3dBackprop: output must be rank 5 but got rank \"+d.rank+\".\"})),null==a&&(a=[1,1,1]);C(Mo(o,a),(function(){return\"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides \"+o+\" and dilations '\"+a+\"'\"})),null!=s&&C(A(i),(function(){return\"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode \"+s+\" but got pad \"+i+\".\"}));var v=ko(f.shape,r,o,a,i,s),m=Lt.runKernelFunc((function(t){return t.maxPool3dBackprop(h,f,d,v)}),{dy5D:h,input5D:f});if(p)return m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]);return m}(t,s,u,e,n,i,r,o)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),vl=An({avgPool3d_:function(t,e,n,r,o,a,i){void 0===a&&(a=\"NDHWC\");var s=mn(t,\"x\",\"avgPool3d\",\"float32\"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==i&&(i=[1,1,1]),C(5===u.rank,(function(){return\"Error in avgPool3d: x must be rank 5 but got rank \"+u.rank+\".\"})),C(\"NDHWC\"===a,(function(){return\"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of \"+a})),C(Mo(n,i),(function(){return\"Error in avgPool3d: Either strides or dilations must be 1. Got strides \"+n+\" and dilations '\"+i+\"'\"})),null!=o&&C(A(r),(function(){return\"Error in avgPool3d: pad must be an integer when using, dimRoundingMode \"+o+\" but got pad \"+r+\".\"}));var l=ko(u.shape,e,n,i,r,o,a),h=Lt.runKernelFunc((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,o,a,i){var s=mn(t,\"dy\",\"avgPool3dBackprop\"),u=mn(e,\"input\",\"avgPool3dBackprop\"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]));C(5===c.rank,(function(){return\"Error in avgPool3dBackprop: dy must be rank 5 but got rank \"+c.rank+\".\"})),C(5===l.rank,(function(){return\"Error in avgPool3dBackprop: input must be rank 5 but got rank \"+l.rank+\".\"})),null==o&&(o=[1,1,1]);C(Mo(r,o),(function(){return\"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides \"+r+\" and dilations '\"+o+\"'\"})),null!=i&&C(A(a),(function(){return\"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode \"+i+\" but got pad \"+a+\".\"}));var f=ko(l.shape,n,r,o,a,i),d=Lt.runKernelFunc((function(t){return t.avgPool3dBackprop(c,l,f)}),{dy5D:c,input5D:l});if(h)return d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]);return d}(t,u,e,n,i,r,o)}}}));return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}});var ml=An({slice_:function(t,e,n){var r,o,a=mn(t,\"x\",\"slice\");if(0===a.rank)throw new Error(\"Slicing scalar is not possible\");(r=\"number\"==typeof e?[e].concat(new Array(a.rank-1).fill(0)):e.length<a.rank?e.concat(new Array(a.rank-e.length).fill(0)):e.slice()).forEach((function(t){C(-1!==t,(function(){return\"slice() does not support negative begin indexing.\"}))})),o=(o=null==n?new Array(a.rank).fill(-1):\"number\"==typeof n?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(C(-1===t,(function(){return\"Negative size values should be exactly -1 but got \"+t+\" for the slice() size at index \"+e+\".\"})),a.shape[e]-r[e])})),eo(a,r,o);var i=a.shape,s={begin:r,size:o};return Lt.runKernelFunc((function(t){return t.slice(a,r,o)}),{x:a},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],i[n]-r[n]-o[n]]);return{x:function(){return t.pad(e)}}}),\"Slice\",s)}}),gl=An({slice1d_:function(t,e,n){var r=mn(t,\"x\",\"slice1d\");return C(1===r.rank,(function(){return\"slice1d expects a rank-1 tensor, but got a rank-\"+r.rank+\" tensor\"})),ml(r,[e],[n])}}),yl=An({slice2d_:function(t,e,n){var r=mn(t,\"x\",\"slice2d\");return C(2===r.rank,(function(){return\"slice2d expects a rank-2 tensor, but got a rank-\"+r.rank+\" tensor\"})),ml(r,e,n)}}),xl=An({slice3d_:function(t,e,n){var r=mn(t,\"x\",\"slice3d\");return C(3===r.rank,(function(){return\"slice3d expects a rank-3 tensor, but got a rank-\"+r.rank+\" tensor\"})),ml(r,e,n)}}),bl=An({slice4d_:function(t,e,n){var r=mn(t,\"x\",\"slice4d\");return C(4===r.rank,(function(){return\"slice4d expects a rank-4 tensor, but got a rank-\"+r.rank+\" tensor\"})),ml(r,e,n)}});function wl(t,e,n,r,o){return e.rank<n.rank&&(e=e.reshape(wn(e.shape,r))),t.rank<n.rank&&(t=t.reshape(wn(t.shape,r))),{x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==o?r:r.transpose(o)}}}var Cl=An({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"all\",\"bool\"),o=O(e,r.shape),a=o,i=En(a,r.rank);null!=i&&(r=r.transpose(i),a=In(a.length,r.rank));var s=Lt.runKernelFunc((function(t){return t.all(r,a)}),{$x:r});if(n){var u=wn(s.shape,o);return s.reshape(u)}return s}}),El=An({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"any\",\"bool\"),o=O(e,r.shape),a=o,i=En(a,r.rank);null!=i&&(r=r.transpose(i),a=In(a.length,r.rank));var s=Lt.runKernelFunc((function(t){return t.any(r,a)}),{$x:r});if(n){var u=wn(s.shape,o);return s.reshape(u)}return s}}),Rl=An({argMax_:function(t,e){void 0===e&&(e=0);var n=mn(t,\"x\",\"argMax\");null==e&&(e=0);var r=O(e,n.shape),o=En(r,n.rank);null!=o&&(n=n.transpose(o),r=In(r.length,n.rank));var a={axis:r[0]},i=[n];return Lt.runKernelFunc((function(t,e){var o=t.argMax(n,r[0]);return e([n]),o}),{x:n},(function(t,e){var n=e[0];return{x:function(){return Xn(n)}}}),\"ArgMax\",a,i)}}),Il=An({argMin_:function(t,e){void 0===e&&(e=0);var n=mn(t,\"x\",\"argMin\");null==e&&(e=0);var r=O(e,n.shape),o=En(r,n.rank);return null!=o&&(n=n.transpose(o),r=In(r.length,n.rank)),Lt.runKernelFunc((function(t,e){var o=t.argMin(n,r[0]);return e([n]),o}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Xn(n)}}}))}}),kl=An({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"logSumExp\"),o=O(e,r.shape),a=r.max(o,!0),i=r.sub(a).exp().sum(o).log(),s=a.reshape(i.shape).add(i);if(n){var u=wn(s.shape,o);return s.reshape(u)}return s}}),Sl=An({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"max\"),o=r,a=O(e,r.shape),i=a,s=En(i,r.rank);null!=s&&(r=r.transpose(s),i=In(i.length,r.rank));var u=[r],c=Lt.runKernelFunc((function(t,e){var n=t.max(r,i);return e([o,n]),n}),{x:r},(function(t,e){return wl(t,e[1],e[0],a,s)}),\"Max\",{axes:i},u,[!0]);if(n){var l=wn(c.shape,a);c=c.reshape(l)}return c}}),Al=An({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"mean\"),o=O(e,r.shape),a=k(bn(r.shape,o)[1]);return vo((function(t){var r=On(a);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return o.forEach((function(t){n[t]=1})),e.reshape(n).mul(zn(t.shape,\"float32\")).div(a)}}}))(r)}}),Dl=An({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"min\"),o=r,a=O(e,r.shape),i=a,s=En(i,r.rank);null!=s&&(r=r.transpose(s),i=In(i.length,r.rank));var u=[r],c=Lt.runKernelFunc((function(t,e){var n=t.min(r,i);return e([o,n]),n}),{x:r},(function(t,e){return wl(t,e[1],e[0],a,s)}),\"Min\",{axes:i},u,[!0]);if(n){var l=wn(c.shape,a);c=c.reshape(l)}return c}}),Tl=An({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=O(e,(t=mn(t,\"x\",\"moments\")).shape),o=t.mean(r,n),a=o.shape;n||(a=wn(o.shape,r));var i=t.toFloat().sub(o.reshape(a)).square();return{mean:o,variance:i.mean(r,n)}}}),Nl=An({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"sum\");\"bool\"===r.dtype&&(r=r.toInt());var o=O(e,r.shape);return vo((function(t){var e=En(o,t.rank),r=o,a=t;null!=e&&(a=t.transpose(e),r=In(r.length,t.rank));var i=function(e){var n=t.shape.slice();return o.forEach((function(t){n[t]=1})),e.reshape(n).mul(zn(t.shape,\"float32\"))},s={axes:r},u=Lt.runKernelFunc((function(t){return t.sum(a,r)}),{x:a},(function(t){return{x:function(){return i(t)}}}),\"Sum\",s);if(n){var c=wn(u.shape,o);u=u.reshape(c)}return{value:u,gradFunc:i}}))(r)}}),Fl=An({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=mn(t,\"x\",\"prod\");\"bool\"===r.dtype&&(r=r.toInt());var o=O(e,r.shape),a=En(o,r.rank),i=o,s=r;null!=a&&(s=r.transpose(a),i=In(i.length,r.rank));var u=Lt.runKernelFunc((function(t){return t.prod(s,i)}),{permutedX:s});if(n){var c=wn(u.shape,o);u=u.reshape(c)}return u}});var _l=An({elu_:function(t){var e=mn(t,\"x\",\"elu\");return Lt.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Lt.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),Ol=An({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=mn(t,\"x\",\"leakyRelu\");return hc(On(e).mul(n),n)}}),Ml=An({prelu_:function(t,e){var n=mn(t,\"x\",\"prelu\"),r=mn(e,\"alpha\",\"prelu\");return Lt.runKernelFunc((function(t,e){var o=t.prelu(n,r);return e([n,r]),o}),{x:n,alpha:r},(function(t,e){var n=e[0],r=e[1],o=n.greater(0);return{x:function(){return ec(o,t,t.mul(r))},alpha:function(){var e=ec(o,Xn(t),t.mul(n)),a=Eo(r.shape,t.shape);return a.length>0&&(e=e.sum(a)),e.reshape(r.shape)}}}),\"Prelu\")}}),Bl=An({relu_:function(t){var e=mn(t,\"x\",\"relu\");return\"bool\"===e.dtype?e.toInt():Lt.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mulStrict(n.step().toFloat())}}}),\"Relu\")}}),Pl=An({relu6_:function(t){var e=mn(t,\"x\",\"relu6\");return\"bool\"===e.dtype?e.toInt():Lt.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return t.mulStrict(r.toFloat())}}}),\"Relu6\")}}),Ll=An({selu_:function(t){var e=mn(t,\"x\",\"selu\");return Lt.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(On(0)),r=On(bs),o=On(ws),a=t.mul(o),i=t.mul(r).mul(n.toFloat().exp());return ec(e,a,i)}}}))}});var Wl=An({transpose_:function(t,e){var n=mn(t,\"x\",\"transpose\");if(null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),C(n.rank===e.length,(function(){return\"Error in transpose: rank of input \"+n.rank+\" must match length of perm \"+e+\".\"})),e.forEach((function(t){C(t>=0&&t<n.rank,(function(){return\"All entries in 'perm' must be between 0 and \"+(n.rank-1)+\" but got \"+e}))})),n.rank<=1)return n.clone();var r={perm:e};return Lt.runKernelFunc((function(t){return t.transpose(n,e)}),{x:n},(function(t){var n=Rn(e);return{x:function(){return t.transpose(n)}}}),\"Transpose\",r)}});var Ul=An({localResponseNormalization_:function(t,e,n,r,o){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5);var a=mn(t,\"x\",\"localResponseNormalization\");C(4===a.rank||3===a.rank,(function(){return\"Error in localResponseNormalization: x must be rank 3 or 4 but got\\n               rank \"+a.rank+\".\"})),C(A(e),(function(){return\"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius \"+e+\".\"}));var i=a,s=!1;3===a.rank&&(s=!0,i=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=Lt.runKernelFunc((function(t,a){var s=t.localResponseNormalization4D(i,e,n,r,o);return a([i,s]),s}),{x4D:i},(function(t,a){var i=a[0],s=a[1];return{x4D:function(){return Lt.runKernelFunc((function(a){return a.LRNGrad(t,i,s,e,n,r,o)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}});var Vl=An({norm_:function(t,e,n,r){void 0===e&&(e=\"euclidean\"),void 0===n&&(n=null),void 0===r&&(r=!1);var o=function t(e,n,r){void 0===r&&(r=null);if(0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||\"number\"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if(\"euclidean\"===n||2===n)return e.abs().pow(On(2,\"int32\")).sum(r).sqrt();throw new Error(\"Error in norm: invalid ord value: \"+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if(\"fro\"===n||\"euclidean\"===n)return e.square().sum(r).sqrt();throw new Error(\"Error in norm: invalid ord value: \"+n)}throw new Error(\"Error in norm: invalid axis: \"+r)}(t=mn(t,\"x\",\"norm\"),e,n),a=o.shape;if(r){var i=O(n,t.shape);a=wn(o.shape,i)}return o.reshape(a)}});var zl=An({basicLSTMCell_:function(t,e,n,r,o,a){var i=mn(t,\"forgetBias\",\"basicLSTMCell\"),s=mn(e,\"lstmKernel\",\"basicLSTMCell\"),u=mn(n,\"lstmBias\",\"basicLSTMCell\"),c=mn(r,\"data\",\"basicLSTMCell\"),l=mn(o,\"c\",\"basicLSTMCell\"),h=mn(a,\"h\",\"basicLSTMCell\"),f=c.concat(h,1).matMul(s).add(u),d=f.shape[0],p=f.shape[1]/4,v=[d,p],m=f.slice([0,0],v),g=f.slice([0,p],v),y=f.slice([0,2*p],v),x=f.slice([0,3*p],v),b=m.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(i.add(y).sigmoid())),w=b.tanh().mulStrict(x.sigmoid());return[b,w]}}),Gl=An({multiRNNCell_:function(t,e,n,r){for(var o=mn(e,\"data\",\"multiRNNCell\"),a=gn(n,\"c\",\"multiRNNCell\"),i=gn(r,\"h\",\"multiRNNCell\"),s=o,u=[],c=0;c<t.length;c++){var l=t[c](s,a[c],i[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],f=[];for(c=0;c<u.length;c+=2)h.push(u[c]),f.push(u[c+1]);return[h,f]}});var Hl=An({movingAverage_:function(t,e,n,r,o){void 0===o&&(o=!0);var a=mn(t,\"v\",\"movingAverage\"),i=mn(e,\"x\",\"movingAverage\"),s=mn(n,\"decay\",\"movingAverage\");Ft(a,i),C(S(a.shape,i.shape),(function(){return\"Shape mismatch in v and x\"}));var u=On(1),c=u.sub(s),l=i.sub(a).mul(c);if(o){C(null!=r,(function(){return\"When using zeroDebias: true, step is required.\"}));var h=mn(r,\"step\",\"movingAverage\");l=l.div(u.sub(xc(s,h)))}return a.add(l)}});var ql=An({stridedSlice_:function(t,e,n,r,o,a,i,s,u){if(void 0===o&&(o=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==i)throw new Error(\"ellipsis mask is not yet supported\");var c=mn(t,\"x\",\"stridedSlice\"),l=no(s),h=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),c=c.reshape(h);for(var f=0;f<c.rank;f++)e[f]=oo(o,e,r,c.shape,f),n[f]=ao(a,n,r,c.shape,f),r[f]=r[f]||1;var d=no(u);d.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var p=ro(e,n,r),v=p.filter((function(t,e){return-1===d.indexOf(e)}));return r.every((function(t){return 1===t}))?ml(c,e,p).reshape(v):Lt.runKernelFunc((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(v)}});var Kl=An({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=mn(t,\"x\",\"topk\");if(0===r.rank)throw new Error(\"topk() expects the input to be of rank 1 or higher\");var o=r.shape[r.shape.length-1];if(e>o)throw new Error(\"'k' passed to topk() must be <= the last dimension (\"+o+\") but got \"+e);var a=Lt.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r});return{values:a[0],indices:a[1]}}});var jl=An({scatterND_:function(t,e,n){var r=mn(t,\"indices\",\"scatterND\",\"int32\"),o=mn(e,\"updates\",\"scatterND\");return Jr(o,r,n),Lt.runKernelFunc((function(t){return t.scatterND(r,o,n)}),{indices:r,updates:o},null,\"ScatterNd\",{shape:n})}});var Xl=An({fft_:function(t){C(\"complex64\"===t.dtype,(function(){return\"The dtype for tf.spectral.fft() must be complex64 but got \"+t.dtype+\".\"}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Lt.runKernelFunc((function(t){return t.fft(r)}),{input:t}).reshape(t.shape)}}),Yl=An({ifft_:function(t){C(\"complex64\"===t.dtype,(function(){return\"The dtype for tf.spectral.ifft() must be complex64 but got \"+t.dtype+\".\"}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Lt.runKernelFunc((function(t){return t.ifft(r)}),{input:t}).reshape(t.shape)}}),$l=An({rfft_:function(t,e){C(\"float32\"===t.dtype,(function(){return\"The dtype for rfft() must be real value but got \"+t.dtype}));var n,r=t.shape[t.shape.length-1],o=t.size/r;if(null!=e&&e<r){var a=t.shape.map((function(t){return 0})),i=t.shape.map((function(t){return t}));i[t.shape.length-1]=e,n=t.slice(a,i),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(Gn(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=Dn(n,u).as2D(o,r),l=Xl(c),h=Math.floor(r/2)+1,f=Tn(l),d=Nn(l),p=f.split([h,r-h],f.shape.length-1),v=d.split([h,r-h],d.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=h,Dn(p[0],v[0]).reshape(m)}}),Ql=An({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),o=Yl(r);return Tn(o)}var a=[n,2*(e-1)],i=Tn(t).as2D(n,e),s=Nn(t).as2D(n,e),u=i.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(On(-1)),l=i.concat(u,1),h=s.concat(c,1);return r=Dn(l,h).as2D(a[0],a[1]),o=Yl(r),Tn(o)}}),Jl=Object.freeze({fft:Xl,ifft:Yl,rfft:$l,irfft:Ql});var Zl=An({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var o=mn(t,\"sparseIndices\",\"sparseToDense\",\"int32\"),a=mn(e,\"sparseValues\",\"sparseToDense\"),i=mn(r,\"defaultValue\",\"sparseToDense\",a.dtype);return function(t,e,n,r){if(\"int32\"!==t.dtype)throw new Error(\"tf.sparseToDense() expects the indices to be int32 type, but the dtype was \"+t.dtype+\".\");if(t.rank>2)throw new Error(\"sparseIndices should be a scalar, vector, or matrix, but got shape \"+t.shape+\".\");var o=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error(\"outputShape has incorrect number of elements:, \"+n.length+\", should be: \"+a+\".\");var i=e.size;if(0!==e.rank&&(1!==e.rank||i!==o))throw new Error(\"sparseValues has incorrect shape \"+e.shape+\", should be [] or [\"+o+\"]\");if(e.dtype!==r.dtype)throw new Error(\"sparseValues.dtype must match defaultValues.dtype\")}(o,a,n,i),Lt.runKernelFunc((function(t){return t.sparseToDense(o,a,n,i)}),{$sparseIndices:o,$sparseValues:a,$defaultValue:i})}});var th=An({gatherND_:function(t,e){var n=mn(e,\"indices\",\"gatherND\",\"int32\"),r=mn(t,\"x\",\"gatherND\");return Lt.runKernelFunc((function(t){return t.gatherND(r,n)}),{x:r,indices:n},null,\"GatherNd\")}});var eh=An({diag_:function(t){var e=mn(t,\"x\",\"diag\").flatten(),n=t.shape.concat(t.shape);return Lt.runKernelFunc((function(t){return t.diag(e)}),{$x:e}).reshape(n)}});var nh=An({dropout_:function(t,e,n,r){var o=mn(t,\"x\",\"dropout\");if(C(\"float32\"===o.dtype,(function(){return\"x has to be a floating point tensor since it's going to be scaled, but got a \"+o.dtype+\" tensor instead.\"})),C(e>=0&&e<1,(function(){return\"rate must be a float in the range [0, 1), but got \"+e+\".\"})),0===e)return t instanceof wt?o.clone():o;var a=function(t,e){if(null==e)return t.shape.slice();if(S(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(o,n),i=1-e,s=_r(a,0,1,\"float32\",r).add(i).floor().div(i);return o.mul(s)}});function rh(t,e,n){for(var r=1-t%2,o=new Float32Array(t),a=0;a<t;++a){var i=2*Math.PI*a/(t+r-1);o[a]=e-n*Math.cos(i)}return Mn(o,\"float32\")}var oh=An({hannWindow_:function(t){return rh(t,.5,.5)}}),ah=An({hammingWindow_:function(t){return rh(t,.54,.46)}}),ih=An({frame_:function(t,e,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var a=0,i=[];a+e<=t.size;)i.push(ml(t,a,e)),a+=n;if(r)for(;a<t.size;){var s=a+e-t.size,u=Yn([ml(t,a,e-s),Hn([s],o)]);i.push(u),a+=n}return 0===i.length?Bn([],[0,e]):Yn(i).as2D(i.length,e)}}),sh=An({stft_:function(t,e,n,r,o){var a;void 0===o&&(o=oh),null==r&&(a=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var i=ih(t,e,n),s=gc(i,o(e)),u=[],c=0;c<i.shape[0];c++)u.push($l(s.slice([c,0],[1,e]),r));return Yn(u)}}),uh=Object.freeze({hannWindow:oh,hammingWindow:ah,frame:ih,stft:sh});var ch,lh=function(t,e,o){return void 0===o&&(o=1),n(this,void 0,void 0,(function(){var n,a,i,s,u,c,l,h,f,d,p,v,m,g;return r(this,(function(r){switch(r.label){case 0:return n=mn(t,\"predictions\",\"inTopK\"),a=mn(e,\"targets\",\"inTopK\"),C(n.rank>1,(function(){return\"inTopK() expects the predictions to be of rank 2 or higher, but got \"+n.rank})),C(n.rank-1===a.rank,(function(){return\"predictions rank should be 1 larger than targets rank, but got predictions rank \"+n.rank+\" and targets rank \"+a.rank})),E(n.shape.slice(0,n.shape.length-1),a.shape,\"predictions's shape should be align with the targets' shape, except the last dimension.\"),i=n.shape[n.shape.length-1],C(o>0&&o<=i,(function(){return\"'k' passed to inTopK() must be > 0 && <= the predictions last dimension (\"+i+\"), but got \"+o})),[4,n.data()];case 1:return s=r.sent(),[4,a.data()];case 2:for(u=r.sent(),c=[s.length/i,i],h=c[1],f=B(\"bool\",l=c[0]),d=0;d<l;d++){for(p=d*h,v=s.subarray(p,p+h),m=[],g=0;g<v.length;g++)m.push({value:v[g],index:g});for(m.sort((function(t,e){return e.value-t.value})),f[d]=0,g=0;g<o;g++)if(m[g].index===u[d]){f[d]=1;break}}return t!==n&&n.dispose(),e!==a&&a.dispose(),[2,Fn(f,a.shape,\"bool\")]}}))}))};!function(t){t[t.NONE=0]=\"NONE\",t[t.MEAN=1]=\"MEAN\",t[t.SUM=2]=\"SUM\",t[t.SUM_BY_NONZERO_WEIGHTS=3]=\"SUM_BY_NONZERO_WEIGHTS\"}(ch||(ch={}));var hh=An({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=ch.SUM_BY_NONZERO_WEIGHTS);var o=mn(t,\"labels\",\"absoluteDifference\"),a=mn(e,\"predictions\",\"absoluteDifference\"),i=null;null!=n&&(i=mn(n,\"weights\",\"absoluteDifference\")),E(o.shape,a.shape,\"Error in absoluteDifference: \");var s=o.sub(a).abs();return fh(s,i,r)}}),fh=An({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=ch.SUM_BY_NONZERO_WEIGHTS);var r=mn(t,\"losses\",\"computeWeightedLoss\"),o=null;null!=e&&(o=mn(e,\"weights\",\"computeWeightedLoss\"));var a=null==o?r:r.mul(o);if(n===ch.NONE)return a;if(n===ch.SUM)return a.sum();if(n===ch.MEAN){if(null==o)return a.mean();var i=r.size/o.size,s=a.sum().div(o.sum());return i>1?s.div(On(i)):s}if(n===ch.SUM_BY_NONZERO_WEIGHTS){if(null==o)return a.sum().div(On(r.size));var u=o.mul(zn(r.shape)).notEqual(On(0)).sum().toFloat();return a.sum().div(u)}throw Error(\"Unknown reduction: \"+n)}}),dh=An({cosineDistance_:function(t,e,n,r,o){void 0===o&&(o=ch.SUM_BY_NONZERO_WEIGHTS);var a=mn(t,\"labels\",\"cosineDistance\"),i=mn(e,\"predictions\",\"cosineDistance\"),s=null;null!=r&&(s=mn(r,\"weights\",\"cosineDistance\")),E(a.shape,i.shape,\"Error in cosineDistance: \");var u=On(1).sub(a.mul(i).sum(n,!0));return fh(u,s,o)}}),ph=An({hingeLoss_:function(t,e,n,r){void 0===r&&(r=ch.SUM_BY_NONZERO_WEIGHTS);var o=mn(t,\"labels\",\"hingeLoss\"),a=mn(e,\"predictions\",\"hingeLoss\"),i=null;null!=n&&(i=mn(n,\"weights\",\"hingeLoss\")),E(o.shape,a.shape,\"Error in hingeLoss: \");var s=On(1);o=On(2).mul(o).sub(s);var u=s.sub(o.mul(a)).relu();return fh(u,i,r)}}),vh=An({huberLoss_:function(t,e,n,r,o){void 0===r&&(r=1),void 0===o&&(o=ch.SUM_BY_NONZERO_WEIGHTS);var a=mn(t,\"labels\",\"huberLoss\"),i=mn(e,\"predictions\",\"huberLoss\"),s=null;null!=n&&(s=mn(n,\"weights\",\"huberLoss\")),E(a.shape,i.shape,\"Error in huberLoss: \");var u=On(r),c=i.sub(a).abs(),l=dc(c,u),h=c.sub(l),f=On(.5).mul(l.square()).add(u.mul(h));return fh(f,s,o)}}),mh=An({logLoss_:function(t,e,n,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=ch.SUM_BY_NONZERO_WEIGHTS);var a=mn(t,\"labels\",\"logLoss\"),i=mn(e,\"predictions\",\"logLoss\"),s=null;null!=n&&(s=mn(n,\"weights\",\"logLoss\")),E(a.shape,i.shape,\"Error in logLoss: \");var u=On(1),c=On(r),l=a.mul(i.add(c).log()).neg().sub(u.sub(a).mul(u.sub(i).add(c).log()));return fh(l,s,o)}}),gh=An({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=ch.SUM_BY_NONZERO_WEIGHTS);var o=mn(t,\"labels\",\"meanSquaredError\"),a=mn(e,\"predictions\",\"meanSquaredError\"),i=null;null!=n&&(i=mn(n,\"weights\",\"meanSquaredError\")),E(o.shape,a.shape,\"Error in meanSquaredError: \");var s=o.squaredDifference(a);return fh(s,i,r)}}),yh=An({sigmoidCrossEntropy_:function(t,e,n,r,o){void 0===r&&(r=0),void 0===o&&(o=ch.SUM_BY_NONZERO_WEIGHTS);var a=mn(t,\"multiClassLabels\",\"sigmoidCrossEntropy\"),i=mn(e,\"logits\",\"sigmoidCrossEntropy\"),s=null;if(null!=n&&(s=mn(n,\"weights\",\"sigmoidCrossEntropy\")),E(a.shape,i.shape,\"Error in sigmoidCrossEntropy: \"),r>0){var u=On(r),c=On(1),l=On(.5);a=a.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=mn(t,\"labels\",\"sigmoidCrossEntropyWithLogits\"),r=mn(e,\"logits\",\"sigmoidCrossEntropyWithLogits\");E(n.shape,r.shape,\"Error in sigmoidCrossEntropyWithLogits: \");var o=r.relu(),a=r.mul(n),i=r.abs().neg().exp().log1p();return o.sub(a).add(i)}(a,i);return fh(h,s,o)}}),xh=An({softmaxCrossEntropy_:function(t,e,n,r,o){void 0===r&&(r=0),void 0===o&&(o=ch.SUM_BY_NONZERO_WEIGHTS);var a=mn(t,\"onehotLabels\",\"softmaxCrossEntropy\"),i=mn(e,\"logits\",\"softmaxCrossEntropy\"),s=null;if(null!=n&&(s=mn(n,\"weights\",\"softmaxCrossEntropy\")),E(a.shape,i.shape,\"Error in softmaxCrossEntropy: \"),r>0){var u=On(r),c=On(1),l=On(a.shape[1]);a=a.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(\"Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank \"+e.rank+\" and dim was \"+n);return vo((function(t,e,r){var o=e.logSumExp([n],!0),a=e.toFloat().sub(o);r([t,a]);return{value:a.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],o=e[1],a=wn(t.shape,[n]);return[t.reshape(a).mul(r.toFloat().sub(o.exp())),t.reshape(a).mul(o.exp().sub(r.toFloat()))]}}}))(t,e)}(a,i);return fh(h,s,o)}}),bh=Object.freeze({get Reduction(){return ch},absoluteDifference:hh,computeWeightedLoss:fh,cosineDistance:dh,hingeLoss:ph,huberLoss:vh,logLoss:mh,meanSquaredError:gh,sigmoidCrossEntropy:yh,softmaxCrossEntropy:xh});function wh(t,e){return void 0===e&&(e=!1),Lt.tidy((function(){if(2!==t.shape.length)throw new Error(\"qr2d() requires a 2D Tensor, but got a \"+t.shape.length+\"D Tensor.\");for(var n=t.shape[0],r=t.shape[1],o=Cr(n),a=t.clone(),i=Bn([[1]],[1,1]),s=i.clone(),u=n>=r?r:n,c=function(t){var e,u=a,c=s,l=o;e=Lt.tidy((function(){var e=a.slice([t,t],[n-t,1]),u=e.norm(),c=a.slice([t,t],[1,1]),l=Bn([[-1]]).where(c.greater(0),Bn([[1]])),h=c.sub(l.mul(u)),f=e.div(h);s=1===f.shape[0]?i.clone():i.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var d=l.matMul(h).div(u).neg(),p=a.slice([t,0],[n-t,r]),v=d.mul(s);if(0===t)a=p.sub(v.matMul(s.transpose().matMul(p)));else{var m=p.sub(v.matMul(s.transpose().matMul(p)));a=a.slice([0,0],[t,r]).concat(m,0)}var g=o.slice([0,t],[n,o.shape[1]-t]);if(0===t)o=g.sub(g.matMul(s).matMul(v.transpose()));else{var y=g.sub(g.matMul(s).matMul(v.transpose()));o=o.slice([0,0],[n,t]).concat(y,1)}return[s,a,o]})),s=e[0],a=e[1],o=e[2],tn([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(o=o.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[o,a]}))}var Ch=An({bandPart_:function(t,e,n){if(e%1!=0)throw new Error(\"bandPart(): numLower must be an integer, got \"+e+\".\");if(n%1!=0)throw new Error(\"bandPart(): numUpper must be an integer, got \"+n+\".\");var r=mn(t,\"a\",\"bandPart\");if(r.rank<2)throw new Error(\"bandPart(): Rank must be at least 2, got \"+r.rank+\".\");var o=r.shape,a=r.shape.slice(-2),i=a[0],s=a[1];if(!(e<=i))throw new Error(\"bandPart(): numLower (\"+e+\") must not be greater than the number of rows (\"+i+\").\");if(!(n<=s))throw new Error(\"bandPart(): numUpper (\"+n+\") must not be greater than the number of columns (\"+s+\").\");e<0&&(e=i),n<0&&(n=s);var u=Kn(0,i,1,\"int32\").reshape([-1,1]),c=Kn(0,s,1,\"int32\"),l=Cc(u,c),h=Qu(l.lessEqual(On(+e,\"int32\")),l.greaterEqual(On(-n,\"int32\"))),f=Gn([i,s],r.dtype);return Pr(Ur(r.reshape([-1,i,s])).map((function(t){return ec(h,t,f)}))).reshape(o)}}),Eh=An({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,C(null!=t&&t.length>0,(function(){return\"Gram-Schmidt process: input must not be null, undefined, or empty\"}));for(var n=t[0].shape[0],r=function(e){C(t[e].shape[0]===n,(function(){return\"Gram-Schmidt: Non-unique lengths found in the input vectors: (\"+t[e].shape[0]+\" vs. \"+n+\")\"}))},o=1;o<t.length;++o)r(o)}else e=!0,t=tr(t,t.shape[0],0).map((function(t){return Br(t,[0])}));C(t.length<=t[0].shape[0],(function(){return\"Gram-Schmidt: Number of vectors (\"+t.length+\") exceeds number of dimensions (\"+t[0].shape[0]+\").\"}));var a=[],i=t,s=function(t){a.push(Lt.tidy((function(){var e=i[t];if(t>0)for(var n=0;n<t;++n){var r=Nl(a[n].mulStrict(e)).mul(a[n]);e=e.sub(r)}return e.div(Vl(e,\"euclidean\"))})))};for(o=0;o<t.length;++o)s(o);return e?Pr(a,0):a}}),Rh=An({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error(\"qr() requires input tensor to have a rank >= 2, but got rank \"+t.rank);if(2===t.rank)return wh(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Ur(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],a=[];return r.forEach((function(t){var n=wh(t,e),r=n[0],i=n[1];o.push(r),a.push(i)})),[Pr(o,0).reshape(t.shape),Pr(a,0).reshape(t.shape)]}}),Ih=Object.freeze({bandPart:Ch,gramSchmidt:Eh,qr:Rh});function kh(t,e,n,r,o,a){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==a&&(a=0);var i=t.shape[0];return n=Math.min(n,i),C(0<=r&&r<=1,(function(){return\"iouThreshold must be in [0, 1], but was '\"+r+\"'\"})),C(2===t.rank,(function(){return\"boxes must be a 2D tensor, but was of rank '\"+t.rank+\"'\"})),C(4===t.shape[1],(function(){return\"boxes must have 4 columns, but 2nd dimension was \"+t.shape[1]})),C(1===e.rank,(function(){return\"scores must be a 1D tensor\"})),C(e.shape[0]===i,(function(){return\"scores has incompatible shape with boxes. Expected \"+i+\", but was \"+e.shape[0]})),C(0<=a&&a<=1,(function(){return\"softNmsSigma must be in [0, 1], but was '\"+a+\"'\"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:a}}var Sh=An({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=mn(t,\"images\",\"resizeBilinear\");C(3===r.rank||4===r.rank,(function(){return\"Error in resizeBilinear: x must be rank 3 or 4, but got rank \"+r.rank+\".\"})),C(2===e.length,(function(){return\"Error in resizeBilinear: new shape must 2D, but got shape \"+e+\".\"}));var o=r,a=!1;3===r.rank&&(a=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=e[0],s=e[1],u=Lt.runKernelFunc((function(t,e){return e([o]),t.resizeBilinear(o,i,s,n)}),{x:o},(function(t,e){return{x:function(){return Lt.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}),\"ResizeBilinear\",{alignCorners:n,newHeight:i,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ah=An({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=mn(t,\"images\",\"resizeNearestNeighbor\");C(3===r.rank||4===r.rank,(function(){return\"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank \"+r.rank+\".\"})),C(2===e.length,(function(){return\"Error in resizeNearestNeighbor: new shape must 2D, but got shape \"+e+\".\"})),C(\"float32\"===r.dtype||\"int32\"===r.dtype,(function(){return\"`images` must have `int32` or `float32` as dtype\"}));var o=r,a=!1;3===r.rank&&(a=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=e[0],s=e[1],u=Lt.runKernelFunc((function(t,e){return e([o]),t.resizeNearestNeighbor(o,i,s,n)}),{batchImages:o},(function(t,e){return{batchImages:function(){return Lt.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Dh=An({nonMaxSuppression_:function(t,e,n,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var a=mn(t,\"boxes\",\"nonMaxSuppression\"),i=mn(e,\"scores\",\"nonMaxSuppression\"),s=kh(a,i,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return Lt.runKernelFunc((function(t){return t.nonMaxSuppression(a,i,n,r,o)}),{boxes:a,scores:i},null,\"NonMaxSuppressionV3\",u)}}),Th=function(t,e,o,a,i){return void 0===a&&(a=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),n(this,void 0,void 0,(function(){var n,s,u,c,l,h,f;return r(this,(function(r){switch(r.label){case 0:return n=mn(t,\"boxes\",\"nonMaxSuppressionAsync\"),s=mn(e,\"scores\",\"nonMaxSuppressionAsync\"),u=kh(n,s,o,a,i),o=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,[4,Promise.all([n.data(),s.data()])];case 1:return c=r.sent(),l=c[0],h=c[1],f=jo(l,h,o,a,i),n!==t&&n.dispose(),s!==e&&s.dispose(),[2,f]}}))}))},Nh=An({nonMaxSuppressionWithScore_:function(t,e,n,r,o,a){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===a&&(a=0);var i=mn(t,\"boxes\",\"nonMaxSuppression\"),s=mn(e,\"scores\",\"nonMaxSuppression\"),u=kh(i,s,n,r,o,a),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},l=Lt.runKernel(\"NonMaxSuppressionV5\",{boxes:i,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),Fh=function(t,e,o,a,i,s){return void 0===a&&(a=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===s&&(s=0),n(this,void 0,void 0,(function(){var n,u,c,l,h,f,d;return r(this,(function(r){switch(r.label){case 0:return n=mn(t,\"boxes\",\"nonMaxSuppressionAsync\"),u=mn(e,\"scores\",\"nonMaxSuppressionAsync\"),c=kh(n,u,o,a,i,s),o=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,s=c.softNmsSigma,[4,Promise.all([n.data(),u.data()])];case 1:return l=r.sent(),h=l[0],f=l[1],d=Xo(h,f,o,a,i,s),n!==t&&n.dispose(),u!==e&&u.dispose(),[2,d]}}))}))},_h=An({cropAndResize_:function(t,e,n,r,o,a){var i=mn(t,\"image\",\"cropAndResize\"),s=mn(e,\"boxes\",\"cropAndResize\",\"float32\"),u=mn(n,\"boxInd\",\"cropAndResize\",\"int32\");o=o||\"bilinear\",a=a||0;var c=s.shape[0];return C(4===i.rank,(function(){return\"Error in cropAndResize: image must be rank 4,but got rank \"+i.rank+\".\"})),C(2===s.rank&&4===s.shape[1],(function(){return\"Error in cropAndResize: boxes must be have size [\"+c+\",4] but had shape \"+s.shape+\".\"})),C(1===u.rank&&u.shape[0]===c,(function(){return\"Error in cropAndResize: boxInd must be have size [\"+c+\"] but had shape \"+s.shape+\".\"})),C(2===r.length,(function(){return\"Error in cropAndResize: cropSize must be of length 2, but got length \"+r.length+\".\"})),C(r[0]>=1&&r[1]>=1,(function(){return\"cropSize must be atleast [1,1], but was \"+r})),C(\"bilinear\"===o||\"nearest\"===o,(function(){return\"method must be bilinear or nearest, but was \"+o})),Lt.runKernelFunc((function(t,e){return t.cropAndResize(i,s,u,r,o,a)}),{images:i,boxes:s,boxInd:u},null,\"CropAndResize\",{method:o,extrapolationValue:a,cropSize:r})}}),Oh=Object.freeze({resizeBilinear:Sh,resizeNearestNeighbor:Ah,nonMaxSuppression:Dh,nonMaxSuppressionAsync:Th,nonMaxSuppressionWithScore:Nh,nonMaxSuppressionWithScoreAsync:Fh,cropAndResize:_h}),Mh=function(t,e){return!(t>0)||\"linear\"===e},Bh=function(t,e,n){if(null==n||\"linear\"===n)return t;if(\"relu\"===n)return t.mul(e.step());throw new Error(\"Gradient for activation \"+n+\" has not been implemented yet.\")},Ph=function(t,e){var n=e,r=Eo(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},Lh=function(t,e,n){if(\"linear\"===e)return t;if(\"relu\"===e)return Bl(t);if(\"elu\"===e)return _l(t);if(\"relu6\"===e)return Pl(t);if(\"prelu\"===e)return Ml(t,n);throw new Error(\"Unknown fused activation \"+e+\".\")};var Wh=An({fusedMatMul_:function(t){var e,n=t.a,r=t.b,o=t.transposeA,a=void 0!==o&&o,i=t.transposeB,s=void 0!==i&&i,u=t.bias,c=t.activation,l=void 0===c?\"linear\":c,h=t.preluActivationWeights;if(!1===Mh(Lt.state.gradientDepth,l)){var f=el(n,r,a,s);return null!=u&&(f=rc(f,u)),Lh(f,l,h)}var d=mn(n,\"a\",\"fused matMul\"),p=mn(r,\"b\",\"fused matMul\");e=Nt(d,p),d=e[0],p=e[1];var v=a?d.shape[d.rank-2]:d.shape[d.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],g=a?d.shape[d.rank-1]:d.shape[d.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],x=d.shape.slice(0,-2),b=p.shape.slice(0,-2),w=k(x),E=k(b);C(d.rank>=2&&p.rank>=2&&d.rank===p.rank,(function(){return\"Error in fused matMul: inputs must have the same rank of at least 2, got ranks \"+d.rank+\" and \"+p.rank+\".\"})),C(S(x,b),(function(){return\"Error in fused matMul: outer dimensions (\"+x+\") and (\"+b+\") of Tensors with shapes \"+d.shape+\" and \"+p.shape+\" must match.\"})),C(v===m,(function(){return\"Error in fused matMul: inner shapes (\"+v+\") and (\"+m+\") of Tensors with shapes \"+d.shape+\" and \"+p.shape+\" and transposeA=\"+a+\" and transposeB=\"+s+\" must match.\"}));var R,I,A=d.shape.slice(0,-2).concat([g,y]),D=a?d.as3D(w,v,g):d.as3D(w,g,v),T=s?p.as3D(E,y,m):p.as3D(E,m,y);null!=u&&Ro(A,(R=Nt(R=mn(u,\"bias\",\"fused matMul\"),d)[0]).shape),null!=h&&(I=mn(h,\"prelu weights\",\"fused matMul\"));var N={a:D,b:T};null!=u&&(N.bias=R),null!=h&&(N.preluActivationWeights=I);var F=[D,T];return Lt.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:D,b:T,transposeA:a,transposeB:s,bias:R,activation:l,preluActivationWeights:I});return e([D,T,n]),n}),N,(function(t,e){var n=e[0],r=e[1],o=e[2],i=Bh(t,o,l),c={};return null!=u&&(c={bias:function(){return Ph(R,i)}}),a||s?!a&&s?Object.assign({a:function(){return i.matMul(r,!1,!1)},b:function(){return i.matMul(n,!0,!1)}},c):a&&!s?Object.assign({a:function(){return r.matMul(i,!1,!0)},b:function(){return n.matMul(i,!1,!1)}},c):Object.assign({a:function(){return r.matMul(i,!0,!0)},b:function(){return i.matMul(n,!0,!0)}},c):Object.assign({a:function(){return i.matMul(r,!1,!0)},b:function(){return n.matMul(i,!0,!1)}},c)}),\"_FusedMatMul\",{transposeA:a,transposeB:s,activation:l},F,[!0]).reshape(A)}}),Uh=An({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,a=t.dataFormat,i=void 0===a?\"NHWC\":a,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,h=t.activation,f=void 0===h?\"linear\":h,d=t.preluActivationWeights;if(f=f||\"linear\",!1===Mh(Lt.state.gradientDepth,f)){var p=qc(e,n,r,o,i,u,c);return null!=l&&(p=rc(p,l)),Lh(p,f,d)}var v=mn(e,\"x\",\"conv2d\"),m=mn(n,\"filter\",\"conv2d\"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),C(4===g.rank,(function(){return\"Error in fused conv2d: input must be rank 4, but got rank \"+g.rank+\".\"})),C(4===m.rank,(function(){return\"Error in fused conv2d: filter must be rank 4, but got rank \"+m.rank+\".\"})),null!=c&&C(A(o),(function(){return\"Error in fused conv2d: pad must be an integer when using, dimRoundingMode \"+c+\" but got pad \"+o+\".\"})),C(g.shape[3]===m.shape[2],(function(){return\"Error in conv2d: depth of input (\"+g.shape[3]+\") must match input depth for filter \"+m.shape[2]+\".\"})),C(Mo(r,u),(function(){return\"Error in conv2D: Either strides or dilations must be 1. Got strides \"+r+\" and dilations '\"+u+\"'\"})),C(\"NHWC\"===i,(function(){return\"Error in conv2d: got dataFormat of \"+i+\" but only NHWC is currently supported.\"}));var x,b,w=So(g.shape,m.shape,r,u,o,c);null!=l&&(x=Nt(x=mn(l,\"bias\",\"fused conv2d\"),v)[0],Ro(w.outShape,x.shape)),null!=d&&(b=mn(d,\"prelu weights\",\"fused conv2d\"));var E={x:g,filter:m};null!=l&&(E.bias=x),null!=d&&(E.preluActivationWeights=b);var R=[m,g],I=Lt.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:g,filter:m,convInfo:w,bias:x,activation:f,preluActivationWeights:b});return e([m,g,n]),n}),E,(function(t,e){var n=e,a=n[0],i=n[1],s=n[2],c=Bh(t,s,f);C(Oo(u),(function(){return\"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '\"+u+\"'\"}));var h={};return null!=l&&(h={bias:function(){return Ph(x,c)}}),Object.assign({x:function(){return Xc(i.shape,c,a,r,o)},filter:function(){return jc(i,c,a.shape,r,o)}},h)}),\"FusedConv2D\",{convInfo:w,activation:f},R,[!0]);return y?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),Vh=An({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,a=t.dataFormat,i=void 0===a?\"NHWC\":a,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,h=t.activation,f=void 0===h?\"linear\":h,d=t.preluActivationWeights;if(!1===Mh(Lt.state.gradientDepth,f)){var p=Yc(e,n,r,o,i,u,c);return null!=l&&(p=rc(p,l)),Lh(p,f,d)}var v=mn(e,\"x\",\"depthwiseConv2d\"),m=mn(n,\"filter\",\"depthwiseConv2d\"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),C(4===g.rank,(function(){return\"Error in fused depthwiseConv2d: input must be rank 4, but got rank \"+g.rank+\".\"})),C(4===m.rank,(function(){return\"Error in fused depthwiseConv2d: filter must be rank 4, but got rank \"+m.rank+\".\"})),C(g.shape[3]===m.shape[2],(function(){return\"Error in fused depthwiseConv2d: number of input channels (\"+g.shape[3]+\") must match the inChannels dimension in filter \"+m.shape[2]+\".\"})),null==u&&(u=[1,1]),C(Mo(r,u),(function(){return\"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides \"+r+\" and dilations '\"+u+\"'\"})),null!=c&&C(A(o),(function(){return\"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode \"+c+\" but got pad \"+o+\".\"}));var x,b,w=So(g.shape,m.shape,r,u,o,c,!0);null!=l&&(x=Nt(x=mn(l,\"bias\",\"fused conv2d\"),v)[0],Ro(w.outShape,x.shape)),null!=d&&(b=mn(d,\"prelu weights\",\"fused depthwiseConv2d\"));var E={x:g,filter:m};null!=l&&(E.bias=x),null!=d&&(E.preluActivationWeights=b);var R=[m,g],I=Lt.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:g,filter:m,convInfo:w,bias:x,activation:f,preluActivationWeights:b});return e([m,g,n]),n}),E,(function(t,e){C(Oo(u),(function(){return\"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '\"+u+\"'\"}));var n=e[0],r=e[1],o=e[2],a=Bh(t,o,f),i={};return null!=l&&(i={bias:function(){return Ph(x,a)}}),Object.assign({x:function(){return $c(r.shape,a,n,w)},filter:function(){return Qc(r,a,n.shape,w)}},i)}),\"FusedDepthwiseConv2D\",{convInfo:w,activation:f},R,[!0]);return y?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),zh=Object.freeze({matMul:Wh,conv2d:Uh,depthwiseConv2d:Vh}),Gh=Object.freeze({image:Oh,linalg:Ih,losses:bh,spectral:Jl,fused:zh,signal:uh,square:tu,squaredDifference:nu,conv1d:Hc,conv2d:qc,conv3d:Kc,depthwiseConv2d:Yc,separableConv2d:Jc,conv2dTranspose:Zc,conv3dTranspose:tl,op:An,batchNormalization2d:Gu,batchNormalization3d:Hu,batchNormalization4d:qu,batchNormalization:Ku,batchNorm:ju,batchNorm2d:Xu,batchNorm3d:Yu,batchNorm4d:$u,booleanMaskAsync:Uc,complex:Dn,real:Tn,imag:Nn,concat:Yn,concat1d:$n,concat2d:Qn,concat3d:Jn,concat4d:Zn,split:tr,matMul:el,dot:nl,outerProduct:rl,reverse:ol,reverse1d:al,reverse2d:il,reverse3d:sl,reverse4d:ul,maxPool:hl,avgPool:fl,pool:dl,maxPool3d:pl,avgPool3d:vl,slice:ml,slice1d:gl,slice2d:yl,slice3d:xl,slice4d:bl,abs:ru,acos:ou,acosh:au,asin:iu,asinh:su,atan:uu,atanh:cu,ceil:lu,clipByValue:hu,cos:fu,cosh:du,erf:pu,exp:vu,expm1:mu,floor:gu,log:yu,log1p:xu,logSigmoid:bu,neg:wu,reciprocal:Cu,round:Eu,rsqrt:Ru,sigmoid:Iu,sign:ku,isNaN:Su,isInf:Au,isFinite:Du,sin:Tu,sinh:Nu,softplus:Fu,sqrt:_u,step:Ou,tan:Mu,tanh:Bu,all:Cl,any:El,argMax:Rl,argMin:Il,logSumExp:kl,max:Sl,mean:Al,min:Dl,moments:Tl,sum:Nl,prod:Fl,equal:Rc,equalStrict:Ic,greater:kc,greaterEqual:Sc,greaterEqualStrict:Ac,greaterStrict:Dc,less:Tc,lessEqual:Nc,lessEqualStrict:Fc,lessStrict:_c,notEqual:Oc,notEqualStrict:Mc,add:rc,addN:oc,addStrict:ac,atan2:ic,div:sc,divNoNan:uc,divStrict:cc,floorDiv:lc,maximum:hc,maximumStrict:fc,minimum:dc,minimumStrict:pc,mod:vc,modStrict:mc,mul:gc,mulStrict:yc,pow:xc,powStrict:bc,squaredDifferenceStrict:wc,sub:Cc,subStrict:Ec,elu:_l,leakyRelu:Ol,prelu:Ml,relu:Bl,relu6:Pl,selu:Ll,logicalAnd:Qu,logicalNot:Ju,logicalOr:Zu,logicalXor:tc,where:ec,whereAsync:nc,buffer:dr,print:pr,batchToSpaceND:vr,broadcastTo:mr,cast:gr,clone:yr,cumsum:xr,depthToSpace:br,expandDims:wr,eye:Cr,multinomial:Er,oneHot:Rr,pad:Ir,pad1d:kr,pad2d:Sr,pad3d:Ar,pad4d:Dr,rand:Tr,randomNormal:Nr,randomGamma:Fr,randomUniform:_r,reshape:Or,spaceToBatchND:Mr,squeeze:Br,stack:Pr,tile:Lr,truncatedNormal:Wr,unstack:Ur,setdiff1dAsync:Vr,fill:Hn,linspace:qn,ones:zn,range:Kn,scalar:On,tensor:Fn,tensor1d:Mn,tensor2d:Bn,tensor3d:Pn,tensor4d:Ln,tensor5d:Wn,tensor6d:Un,variable:Vn,zeros:Gn,onesLike:jn,zerosLike:Xn,transpose:Wl,softmax:go,logSoftmax:yo,localResponseNormalization:Ul,norm:Vl,gather:Lc,unsortedSegmentSum:Wc,basicLSTMCell:zl,multiRNNCell:Gl,movingAverage:Hl,stridedSlice:ql,topk:Kl,scatterND:jl,fft:Xl,ifft:Yl,rfft:$l,irfft:Ql,sparseToDense:Zl,gatherND:th,diag:eh,dropout:nh,hannWindow:oh,hammingWindow:ah,frame:ih,stft:sh,inTopKAsync:lh});function Hh(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&C(\"complex64\"!==t.dtype,(function(){return e+\" does not support complex64 tensors.\"}))}))}function qh(t,e,n,r){if(\"linear\"===n)return t.linear(e);if(\"relu\"===n)return t.relu(e);if(\"elu\"===n)return t.elu(e);if(\"relu6\"===n)return t.relu6(e);if(\"prelu\"===n)return t.prelu(e,r);throw new Error(\"Activation \"+n+\" has not been implemented for the CPU backend.\")}var Kh=function(t){function o(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new xo(e,Lt),e}return e(o,t),o.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,i().get(\"IS_NODE\")&&dn(\"\\n============================\\nHi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\\n============================\"));var r={};return this.data.set(r,{values:t,dtype:n}),r},o.prototype.move=function(t,e,n,r){this.data.set(t,{values:e,dtype:r})},o.prototype.numDataIds=function(){return this.data.numDataIds()},o.prototype.read=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){return[2,this.readSync(t)]}))}))},o.prototype.readSync=function(t){var e=this.data.get(t),n=e.dtype,r=e.complexTensors;return\"complex64\"===n?Vo(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(t).values},o.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if(\"string\"===t.dtype)try{n=e.map((function(t){return ot(t)}))}catch(t){throw new Error(\"Failed to decode encoded string bytes into utf-8\")}return dr(t.shape,t.dtype,n)},o.prototype.makeOutput=function(t,e,n){var r=this.write(t,e,n);return Lt.makeTensorFromDataId(r,e,n,this)},o.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},o.prototype.time=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){return e=et(),t(),[2,{kernelMs:et()-e}]}))}))},o.prototype.memory=function(){return{unreliable:!0,reasons:[\"The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less.\"]}},o.prototype.complex=function(t,e){var n=this.makeOutput(null,t.shape,\"complex64\");return this.data.get(n.dataId).complexTensors={real:Lt.keep(t.clone()),imag:Lt.keep(e.clone())},n},o.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},o.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},o.prototype.slice=function(t,e,n){if(Hh(t,\"slice\"),io(t.shape,e,n)){var r=so(e,t.strides),o=k(n);return Fn(this.readSync(t.dataId).subarray(r,r+o),n,t.dtype)}for(var a=dr(n,t.dtype),i=this.bufferSync(t),s=0;s<a.size;++s){var u=a.indexToLoc(s).map((function(t,n){return t+e[n]}));a.values[s]=i.get.apply(i,u)}return a.toTensor()},o.prototype.stridedSlice=function(t,e,n,r){Hh(t,\"stridedSlice\");var o=ro(e,n,r);if(o.some((function(t){return 0===t})))return Fn([],o);for(var a=dr(o,t.dtype),i=this.bufferSync(t),s=0;s<a.size;s++){for(var u=a.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];a.set.apply(a,[i.get.apply(i,c)].concat(u))}return a.toTensor()},o.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=dr([t.size,t.size],t.dtype),r=n.values,o=0;o<e.length;o++)r[o*t.size+o]=e[o];return n.toTensor()},o.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),o=0,a=0;a<t.rank;a++)a!==e&&(r[o++]=t.shape[a]);var i=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(a=0;a<u.length;a++)i[e]=a,u[a]=this.slice(t,i,s).reshape(r);return u},o.prototype.reverse=function(t,e){Hh(t,\"reverse\");for(var n=dr(t.shape,t.dtype),r=this.bufferSync(t),o=function(o){var a=n.indexToLoc(o),i=a.slice();e.forEach((function(e){return i[e]=t.shape[e]-1-i[e]})),n.set.apply(n,[r.get.apply(r,i)].concat(a))},a=0;a<n.size;a++)o(a);return n.toTensor()},o.prototype.concat=function(t,e){var n=this;if(\"complex64\"===t[0].dtype){var r=t.map((function(t){return Tn(t)})),o=t.map((function(t){return Nn(t)}));return Dn(this.concat(r,e),this.concat(o,e))}var a=t.map((function(t){var n=k(t.shape.slice(e));return t.as2D(-1,n)})),i=Sn(a.map((function(t){return t.shape})),1),s=dr(i,t[0].dtype).values;if(1===a[0].shape[0]){var u=0;a.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;a.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,o=0;o<t.shape[0];++o)for(var a=o*i[1]+c,u=0;u<t.shape[1];++u)s[a+u]=e[r++];c+=t.shape[1]}))}var l=Sn(t.map((function(t){return t.shape})),e);return Fn(s,l,t[0].dtype)},o.prototype.neg=function(t){return Hh(t,\"neg\"),this.multiply(On(-1),t)},o.prototype.add=function(t,e){return\"complex64\"===t.dtype||\"complex64\"===e.dtype?this.broadcastedBinaryComplexOp(t.cast(\"complex64\"),e.cast(\"complex64\"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t+e}))},o.prototype.addN=function(t){var e=this;Hh(t,\"addN\");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=dr(t[0].shape,t[0].dtype),o=r.values,a=0;a<t.length;a++)for(var i=n[a],s=0;s<o.length;s++)o[s]+=i[s];return r.toTensor()},o.prototype.softmax=function(t,e){var n=O([e],t.shape),r=this.max(t,n),o=wn(r.shape,n),a=this.subtract(t,r.reshape(o)),i=this.exp(a),s=this.sum(i,n).reshape(o);return this.realDivide(i,s)},o.prototype.subtract=function(t,e){return\"complex64\"===t.dtype||\"complex64\"===e.dtype?this.broadcastedBinaryComplexOp(t.cast(\"complex64\"),e.cast(\"complex64\"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t-e}))},o.prototype.pow=function(t,e){return Hh([t,e],\"pow\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},o.prototype.batchMatMul=function(t,e,n,r){Hh([t,e],\"matMul\");for(var o=n?t.shape[1]:t.shape[2],a=n?t.shape[2]:t.shape[1],i=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],f=l[1],d=l[2],p=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],v=p[0],m=p[1],g=p[2],y=a*i,x=dr([s,a,i],t.dtype),b=x.values,w=this.blockSize,C=0;C<s;C++)for(var E=0;E<a;E+=w)for(var R=0;R<i;R+=w)for(var I=0;I<o;I+=w)for(var k=Math.min(E+w,a),S=Math.min(R+w,i),A=Math.min(I+w,o),D=E;D<k;D++)for(var T=R;T<S;T++){for(var N=0,F=I;F<A;F++)N+=u[C*h+D*f+F*d]*c[F*v+T*m+C*g];b[C*y+(D*i+T)]+=N}return x.toTensor()},o.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,o=t.transposeB,a=t.bias,i=t.activation,s=t.preluActivationWeights,u=this.batchMatMul(e,n,r,o);return a&&(u=this.add(u,a)),i&&(u=qh(this,u,i,s)),u},o.prototype.multiply=function(t,e){return\"complex64\"===t.dtype||\"complex64\"===e.dtype?this.broadcastedBinaryComplexOp(t.cast(\"complex64\"),e.cast(\"complex64\"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t*e}))},o.prototype.realDivide=function(t,e){Hh([t,e],\"realDivide\");return this.broadcastedBinaryOp(t,e,\"float32\",(function(t,e){return t/e}))},o.prototype.floorDiv=function(t,e){Hh([t,e],\"floorDiv\");return this.broadcastedBinaryOp(t,e,\"int32\",(function(t,e){return Math.floor(t/e)}))},o.prototype.sum=function(t,e){Hh(t,\"sum\"),Cn(\"sum\",e,t.rank);for(var n=bn(t.shape,e),r=n[0],o=n[1],a=Gn(r,Dt(t.dtype,\"int32\")),i=k(o),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*i,h=0,f=0;f<i;++f)h+=u[l+f];s[c]=h}return a},o.prototype.prod=function(t,e){Hh(t,\"sum\");for(var n=bn(t.shape,e),r=n[0],o=n[1],a=Gn(r,Dt(t.dtype,\"int32\")),i=k(o),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*i,h=1,f=0;f<i;++f)h*=u[l+f];s[c]=h}return a},o.prototype.unsortedSegmentSum=function(t,e,n){Hh(t,\"unsortedSegmentSum\");for(var r=[],o=t.rank-e.rank,a=0;a<o;++a)e=e.expandDims(a+1);for(a=0;a<n;++a){var i=On(a,\"int32\"),s=Rc(i,e).asType(\"float32\").mul(t).sum(0);r.push(s)}return Pr(r)},o.prototype.argMin=function(t,e){Hh(t,\"argMin\");var n=[e];Cn(\"argMin\",n,t.rank);for(var r=bn(t.shape,n),o=r[0],a=r[1],i=Gn(o,\"int32\"),s=k(a),u=this.readSync(i.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],d=0,p=0;p<s;++p){var v=c[h+p];v<f&&(f=v,d=p)}u[l]=d}return i},o.prototype.argMax=function(t,e){Hh(t,\"argMax\");var n=[e];Cn(\"argMax\",n,t.rank);for(var r=bn(t.shape,n),o=r[0],a=r[1],i=Gn(o,\"int32\"),s=k(a),u=this.readSync(i.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],d=0,p=0;p<s;++p){var v=c[h+p];v>f&&(f=v,d=p)}u[l]=d}return i},o.prototype.cumsum=function(t,e,n,r){if(Hh(t,\"cumsum\"),e!==t.rank-1)throw new Error(\"backend.cumsum in CPU expects an inner-most axis=\"+(t.rank-1)+\" but got axis=\"+e);for(var o=Dt(t.dtype,\"int32\"),a=Gn(t.shape,o),i=this.readSync(a.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var h=0;h<u;h++){var f=c(l,h);if(0===h)i[f]=n?0:s[f];else{var d=c(l,h-1);i[f]=n?s[d]+i[d]:s[f]+i[d]}}return a},o.prototype.equal=function(t,e){return Hh([t,e],\"equal\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t===e?1:0}))},o.prototype.notEqual=function(t,e){return Hh([t,e],\"notEqual\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t!==e?1:0}))},o.prototype.less=function(t,e){return Hh([t,e],\"less\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t<e?1:0}))},o.prototype.lessEqual=function(t,e){return Hh([t,e],\"lessEqual\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t<=e?1:0}))},o.prototype.greater=function(t,e){return Hh([t,e],\"greater\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t>e?1:0}))},o.prototype.greaterEqual=function(t,e){return Hh([t,e],\"greaterEqual\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t>=e?1:0}))},o.prototype.logicalNot=function(t){Hh(t,\"logicalNot\");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,\"bool\")},o.prototype.logicalAnd=function(t,e){return Hh([t,e],\"logicalAnd\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t&&e}))},o.prototype.logicalOr=function(t,e){return Hh([t,e],\"logicalOr\"),this.broadcastedBinaryOp(t,e,\"bool\",(function(t,e){return t||e}))},o.prototype.select=function(t,e,n){Hh([t,e,n],\"select\");for(var r=this.readSync(t.dataId),o=this.readSync(e.dataId),a=this.readSync(n.dataId),i=Gn(e.shape,Dt(e.dtype,n.dtype)),s=this.readSync(i.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:k(e.shape.slice(1)),l=0;l<r.length;l++)for(var h=0;h<c;h++)1===r[l]?s[u++]=o[l]:s[u++]=a[l];return i},o.prototype.where=function(t){Hh([t],\"where\");var e=this.readSync(t.dataId);return na(t.shape,e)},o.prototype.topk=function(t,e,n){return Hh(t,\"topk\"),ea(this.readSync(t.dataId),t.shape,t.dtype,e)},o.prototype.min=function(t,e){Hh(t,\"min\"),Cn(\"min\",e,t.rank);for(var n=bn(t.shape,e),r=n[0],o=n[1],a=Gn(r,t.dtype),i=k(o),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*i,h=u[l],f=0;f<i;++f){var d=u[l+f];d<h&&(h=d)}s[c]=h}return a},o.prototype.minimum=function(t,e){return Hh([t,e],\"minimum\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},o.prototype.mod=function(t,e){return Hh([t,e],\"mod\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},o.prototype.max=function(t,e){Hh(t,\"max\"),Cn(\"max\",e,t.rank);for(var n=bn(t.shape,e),r=n[0],o=n[1],a=Gn(r,t.dtype),i=k(o),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*i,h=u[l],f=0;f<i;++f){var d=u[l+f];d>h&&(h=d)}s[c]=h}return a},o.prototype.maximum=function(t,e){return Hh([t,e],\"maximum\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},o.prototype.all=function(t,e){Hh(t,\"all\"),Cn(\"all\",e,t.rank);for(var n=bn(t.shape,e),r=n[0],o=n[1],a=Gn(r,t.dtype),i=k(o),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*i,h=u[l],f=0;f<i;++f){var d=u[l+f];h=h&&d}s[c]=h}return a},o.prototype.any=function(t,e){Hh(t,\"any\"),Cn(\"any\",e,t.rank);for(var n=bn(t.shape,e),r=n[0],o=n[1],a=Gn(r,t.dtype),i=k(o),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*i,h=u[l],f=0;f<i;++f){var d=u[l+f];h=h||d}s[c]=h}return a},o.prototype.squaredDifference=function(t,e){return Hh([t,e],\"squaredDifference\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},o.prototype.ceil=function(t){Hh(t,\"ceil\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,\"float32\")},o.prototype.floor=function(t){Hh(t,\"floor\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,\"float32\")},o.prototype.sign=function(t){Hh(t,\"x\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)e[r]<0?n[r]=-1:e[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,t.shape,\"float32\")},o.prototype.isNaN=function(t){Hh(t,\"x\");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,\"bool\")},o.prototype.isInf=function(t){Hh(t,\"x\");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,\"bool\")},o.prototype.isFinite=function(t){Hh(t,\"x\");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,\"bool\")},o.prototype.round=function(t){Hh(t,\"round\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var o=Math.floor(e[r]);e[r]-o<.5?n[r]=Math.floor(e[r]):e[r]-o>.5?n[r]=Math.ceil(e[r]):n[r]=o%2==0?o:o+1}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.exp=function(t){Hh(t,\"exp\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,\"float32\")},o.prototype.expm1=function(t){Hh(t,\"expm1\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,\"float32\")},o.prototype.log=function(t){Hh(t,\"log\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var o=e[r];n[r]=Math.log(o)}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.log1p=function(t){Hh(t,\"log1p\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var o=e[r];n[r]=Math.log1p(o)}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.sqrt=function(t){Hh(t,\"sqrt\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var o=e[r];n[r]=Math.sqrt(o)}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.rsqrt=function(t){Hh(t,\"rsqrt\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var o=e[r];n[r]=1/Math.sqrt(o)}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.reciprocal=function(t){Hh(t,\"reciprocal\");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,\"float32\")},o.prototype.linear=function(t){return t},o.prototype.relu=function(t){Hh(t,\"relu\");for(var e=Gn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),o=0;o<r.length;++o)n[o]=Math.max(0,r[o]);return e},o.prototype.relu6=function(t){Hh(t,\"relu\");for(var e=Gn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),o=0;o<r.length;++o)n[o]=Math.min(Math.max(0,r[o]),6);return e},o.prototype.prelu=function(t,e){return Hh([t,e],\"prelu\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},o.prototype.elu=function(t){Hh(t,\"elu\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var o=n[r];e[r]=o>=0?o:Math.exp(o)-1}return this.makeOutput(e,t.shape,\"float32\")},o.prototype.eluDer=function(t,e){Hh([t,e],\"eluDer\");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),o=this.readSync(t.dataId),a=0;a<r.length;++a){var i=r[a];n[a]=i>=1?o[a]:o[a]*(i+1)}return this.makeOutput(n,e.shape,\"float32\")},o.prototype.selu=function(t){Hh(t,\"selu\");for(var e=bs,n=ws,r=new Float32Array(t.size),o=this.readSync(t.dataId),a=0;a<o.length;++a){var i=o[a];r[a]=i>=0?n*i:e*(Math.exp(i)-1)}return this.makeOutput(r,t.shape,\"float32\")},o.prototype.clip=function(t,e,n){Hh(t,\"clip\");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),a=0;a<o.length;++a){var i=o[a];r[a]=i>n?n:i<e?e:i}return this.makeOutput(r,t.shape,\"float32\")},o.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r){var o=n[2*r],a=n[2*r+1];e[r]=Math.hypot(o,a)}return this.makeOutput(e,t.shape,\"float32\")},o.prototype.int=function(t){Hh(t,\"int\");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,\"int32\")},o.prototype.sigmoid=function(t){Hh(t,\"sigmoid\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,\"float32\")},o.prototype.softplus=function(t){Hh(t,\"softplus\");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),o=0;o<r.length;++o){var a=r[o]>-e,i=r[o]<e,s=Math.exp(r[o]),u=void 0;u=i?s:a?r[o]:Math.log(1+s),n[o]=u}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.sin=function(t){Hh(t,\"sin\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.cos=function(t){Hh(t,\"cos\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.tan=function(t){Hh(t,\"tan\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.asin=function(t){Hh(t,\"asin\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.acos=function(t){Hh(t,\"acos\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.atan=function(t){Hh(t,\"atan\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.atan2=function(t,e){return Hh([t,e],\"atan2\"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},o.prototype.sinh=function(t){Hh(t,\"sinh\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.cosh=function(t){Hh(t,\"cosh\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.tanh=function(t){Hh(t,\"tanh\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=D(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.asinh=function(t){Hh(t,\"asinh\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.acosh=function(t){Hh(t,\"acosh\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.atanh=function(t){Hh(t,\"atanh\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,\"float32\")},o.prototype.erf=function(t){Hh(t,\"erf\");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var o=Math.sign(n[r]),a=Math.abs(n[r]),i=1/(1+.3275911*a);e[r]=o*(1-((((1.061405429*i-1.453152027)*i+1.421413741)*i-.284496736)*i+.254829592)*i*Math.exp(-a*a))}return this.makeOutput(e,t.shape,\"float32\")},o.prototype.step=function(t,e){void 0===e&&(e=0),Hh(t,\"step\");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),o=0;o<r.length;++o){var a=r[o];isNaN(a)?n[o]=NaN:n[o]=a>0?1:e}return this.makeOutput(n,t.shape,\"float32\")},o.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,o=t.bias,a=t.activation,i=t.preluActivationWeights,s=this.conv2d(e,n,r);return o&&(s=this.add(s,o)),a&&(s=qh(this,s,a,i)),s},o.prototype.conv2d=function(t,e,n){Hh([t,e],\"conv2d\");for(var r=n.filterHeight,o=n.filterWidth,a=n.dilationHeight,i=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=\"channelsLast\"===n.dataFormat,l=dr(n.outShape,t.dtype),h=t.strides[0],f=c?t.strides[1]:t.strides[2],d=c?t.strides[2]:1,p=c?1:t.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],x=this.readSync(t.dataId),b=this.readSync(e.dataId),w=l.values,C=0;C<n.batchSize;++C)for(var E=C*h,R=C*v,I=0;I<n.outHeight;++I)for(var k=R+I*m,S=I*n.strideHeight-u,A=0;A<r;A++){var D=S+A*a;if(!(D<0||D>=n.inHeight))for(var T=A*e.strides[0],N=E+D*f,F=0;F<n.outWidth;++F)for(var _=k+F*g,O=F*n.strideWidth-s,M=0;M<o;M++){var B=O+M*i;if(!(B<0||B>=n.inWidth))for(var P=N+B*d,L=T+M*e.strides[1],W=0;W<n.inChannels;++W){for(var U=x[P+W*p],V=0;V<n.outChannels;++V)w[_+V*y]+=U*b[L+V];L+=n.outChannels}}}return l.toTensor()},o.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,o=n.filterHeight,a=n.filterWidth,i=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,f=dr(n.outShape,t.dtype),d=this.readSync(t.dataId),p=this.readSync(e.dataId),v=f.values,m=0;m<n.batchSize;++m)for(var g=m*t.strides[0],y=m*f.strides[0],x=0;x<n.outDepth;++x)for(var b=y+x*f.strides[1],w=x*n.strideDepth-c,C=0;C<r;C++){var E=w+C*i;if(!(E<0||E>=n.inDepth))for(var R=C*e.strides[0],I=g+E*t.strides[1],k=0;k<n.outHeight;++k)for(var S=b+k*f.strides[2],A=k*n.strideHeight-h,D=0;D<o;D++){var T=A+D*s;if(!(T<0||T>=n.inHeight))for(var N=R+D*e.strides[1],F=I+T*t.strides[2],_=0;_<n.outWidth;++_)for(var O=S+_*n.outChannels,M=_*n.strideWidth-l,B=0;B<a;B++){var P=M+B*u;if(!(P<0||P>=n.inWidth))for(var L=N+B*e.strides[2],W=F+P*n.inChannels,U=L,V=0;V<n.inChannels;++V){for(var z=d[W+V],G=0;G<n.outChannels;++G)v[O+G]+=z*p[U+G];U+=n.outChannels}}}}return f.toTensor()},o.prototype.conv2dDerInput=function(t,e,n){Hh([t,e],\"conv2dDerInput\");for(var r=dr(n.inShape,\"float32\"),o=r.values,a=this.readSync(t.dataId),i=this.readSync(e.dataId),s=e.strides,u=s[0],c=s[1],l=s[2],h=n.batchSize,f=n.filterHeight,d=n.filterWidth,p=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,x=n.outWidth,b=n.strideHeight,w=n.strideWidth,C=n.dataFormat,E=f-1-n.padInfo.top,R=d-1-n.padInfo.left,I=\"channelsLast\"===C,k=r.strides[0],S=I?r.strides[1]:r.strides[2],A=I?r.strides[2]:1,D=I?1:r.strides[1],T=t.strides[0],N=I?t.strides[1]:t.strides[2],F=I?t.strides[2]:1,_=I?1:t.strides[1],O=0;O<h;++O)for(var M=0;M<p;++M)for(var B=0;B<v;++B)for(var P=B-E,L=Math.max(0,Math.ceil(P/b)),W=Math.min(y,(f+P)/b),U=0;U<m;++U){for(var V=U-R,z=Math.max(0,Math.ceil(V/w)),G=Math.min(x,(d+V)/w),H=0,q=L;q<W;++q)for(var K=q*b-P,j=z;j<G;++j)for(var X=T*O+N*q+F*j,Y=u*(f-1-K)+c*(d-1-(j*w-V))+l*M,$=0;$<g;++$){H+=a[X+_*$]*i[Y+$]}o[k*O+S*B+A*U+D*M]=H}return r.toTensor()},o.prototype.conv3dDerInput=function(t,e,n){for(var r=dr(n.inShape,\"float32\"),o=r.values,a=r.strides,i=a[0],s=a[1],u=a[2],c=a[3],l=this.readSync(t.dataId),h=t.strides,f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(e.dataId),g=e.strides,y=g[0],x=g[1],b=g[2],w=g[3],C=n.batchSize,E=n.filterDepth,R=n.filterHeight,I=n.filterWidth,k=n.inChannels,S=n.inDepth,A=n.inHeight,D=n.inWidth,T=n.outChannels,N=n.outDepth,F=n.outHeight,_=n.outWidth,O=n.strideDepth,M=n.strideHeight,B=n.strideWidth,P=E-1-n.padInfo.front,L=R-1-n.padInfo.top,W=I-1-n.padInfo.left,U=0;U<C;++U)for(var V=0;V<k;++V)for(var z=0;z<S;++z)for(var G=z-P,H=Math.max(0,Math.ceil(G/O)),q=Math.min(N,(E+G)/O),K=0;K<A;++K)for(var j=K-L,X=Math.max(0,Math.ceil(j/M)),Y=Math.min(F,(R+j)/M),$=0;$<D;++$){for(var Q=$-W,J=Math.max(0,Math.ceil(Q/B)),Z=Math.min(_,(I+Q)/B),tt=0,et=H;et<q;++et)for(var nt=et*O-G,rt=X;rt<Y;++rt)for(var ot=rt*M-j,at=J;at<Z;++at)for(var it=f*U+d*et+p*rt+v*at,st=y*(E-1-nt)+x*(R-1-ot)+b*(I-1-(at*B-Q))+w*V,ut=0;ut<T;++ut){tt+=l[it+ut]*m[st+ut]}o[i*U+s*z+u*K+c*$+V]=tt}return r.toTensor()},o.prototype.conv2dDerFilter=function(t,e,n){Hh([t,e],\"conv2dDerFilter\");for(var r=n.strideHeight,o=n.strideWidth,a=n.filterHeight,i=n.filterWidth,s=\"channelsLast\"===n.dataFormat,u=dr(n.filterShape,\"float32\"),c=n.padInfo.left,l=n.padInfo.top,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<a;++d)for(var p=Math.max(0,Math.ceil((l-d)/r)),v=Math.min(n.outHeight,(n.inHeight+l-d)/r),m=0;m<i;++m)for(var g=Math.max(0,Math.ceil((c-m)/o)),y=Math.min(n.outWidth,(n.inWidth+c-m)/o),x=0;x<n.inChannels;++x)for(var b=0;b<n.outChannels;++b){for(var w=0,C=0;C<n.batchSize;++C)for(var E=p;E<v;++E)for(var R=d+E*r-l,I=g;I<y;++I){var k=m+I*o-c;w+=s?h.get(C,R,k,x)*f.get(C,E,I,b):h.get(C,x,R,k)*f.get(C,b,E,I)}u.set(w,d,m,x,b)}return u.toTensor()},o.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,o=n.strideHeight,a=n.strideWidth,i=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=dr(n.filterShape,\"float32\"),l=c.values,h=c.strides,f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(e.dataId),g=e.strides,y=g[0],x=g[1],b=g[2],w=g[3],C=this.readSync(t.dataId),E=t.strides,R=E[0],I=E[1],k=E[2],S=E[3],A=n.padInfo.front,D=n.padInfo.left,T=n.padInfo.top,N=0;N<i;++N)for(var F=Math.max(0,Math.ceil((A-N)/r)),_=Math.min(n.outDepth,(n.inDepth+A-N)/r),O=N*f,M=0;M<s;++M)for(var B=Math.max(0,Math.ceil((T-M)/o)),P=Math.min(n.outHeight,(n.inHeight+T-M)/o),L=M*d+O,W=0;W<u;++W)for(var U=Math.max(0,Math.ceil((D-W)/a)),V=Math.min(n.outWidth,(n.inWidth+D-W)/a),z=W*p+L,G=0;G<n.inChannels;++G)for(var H=G*v+z,q=0;q<n.outChannels;++q){for(var K=0,j=0;j<n.batchSize;++j)for(var X=j*R,Y=j*y,$=F;$<_;++$)for(var Q=(N+$*r-A)*I+X,J=$*x+Y,Z=B;Z<P;++Z)for(var tt=(M+Z*o-T)*k+Q,et=Z*b+J,nt=U;nt<V;++nt){var rt=nt*w+et;K+=C[(W+nt*a-D)*S+tt+G]*m[rt+q]}l[H+q]=K}return c.toTensor()},o.prototype.fusedDepthwiseConv2D=function(t){var e=t.input,n=t.filter,r=t.convInfo,o=t.bias,a=t.activation,i=t.preluActivationWeights,s=this.depthwiseConv2D(e,n,r);return o&&(s=this.add(s,o)),a&&(s=qh(this,s,a,i)),s},o.prototype.depthwiseConv2D=function(t,e,n){Hh([t,e],\"depthwiseConv2D\");for(var r=n.filterHeight,o=n.filterWidth,a=n.dilationHeight,i=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=dr(n.outShape,t.dtype),h=this.readSync(t.dataId),f=this.readSync(e.dataId),d=l.values,p=0;p<n.batchSize;++p)for(var v=p*t.strides[0],m=p*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],x=g*n.strideHeight-s,b=0;b<r;++b){var w=x+b*a;if(!(w<0||w>=n.inHeight))for(var C=b*e.strides[0],E=v+w*t.strides[1],R=0;R<n.outWidth;++R)for(var I=y+R*l.strides[2],k=R*n.strideWidth-u,S=0;S<o;++S){var A=k+S*i;if(!(A<0||A>=n.inWidth))for(var D=C+S*e.strides[1],T=E+A*n.inChannels,N=I,F=D,_=0;_<n.inChannels;++_){for(var O=h[T+_],M=0;M<c;++M)d[N+M]+=O*f[F+M];N+=c,F+=c}}}return l.toTensor()},o.prototype.depthwiseConv2DDerInput=function(t,e,n){Hh([t,e],\"depthwiseConv2DDerInput\");for(var r=dr(n.inShape,\"float32\"),o=r.values,a=r.strides,i=a[0],s=a[1],u=a[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],f=l[1],d=l[2],p=this.readSync(e.dataId),v=e.strides,m=v[0],g=v[1],y=v[2],x=n.batchSize,b=n.filterHeight,w=n.filterWidth,C=n.inChannels,E=n.inHeight,R=n.inWidth,I=n.outChannels,k=n.outHeight,S=n.outWidth,A=n.strideHeight,D=n.strideWidth,T=b-1-n.padInfo.top,N=w-1-n.padInfo.left,F=I/C,_=0;_<x;++_)for(var O=0;O<C;++O)for(var M=0;M<E;++M)for(var B=M-T,P=Math.max(0,Math.ceil(B/A)),L=Math.min(k,(b+B)/A),W=0;W<R;++W){for(var U=W-N,V=Math.max(0,Math.ceil(U/D)),z=Math.min(S,(w+U)/D),G=0,H=P;H<L;++H)for(var q=H*A-B,K=V;K<z;++K)for(var j=h*_+f*H+d*K,X=m*(b-1-q)+g*(w-1-(K*D-U))+y*O,Y=0;Y<F;++Y){G+=c[j+(O*F+Y)]*p[X+Y]}o[i*_+s*M+u*W+O]=G}return r.toTensor()},o.prototype.depthwiseConv2DDerFilter=function(t,e,n){Hh([t,e],\"depthwiseConv2DDerFilter\");for(var r=n.strideHeight,o=n.strideWidth,a=n.filterHeight,i=n.filterWidth,s=dr(n.filterShape,\"float32\"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<a;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<i;++m)for(var g=Math.max(0,Math.ceil((u-m)/o)),y=Math.min(n.outWidth,(n.inWidth+u-m)/o),x=0;x<n.outChannels;++x){for(var b=Math.trunc(x/l),w=x%l,C=0,E=0;E<n.batchSize;++E)for(var R=p;R<v;++R)for(var I=d+R*r-c,k=g;k<y;++k){var S=m+k*o-u;C+=h.get(E,I,S,b)*f.get(E,R,k,x)}s.set(C,d,m,b,w)}return s.toTensor()},o.prototype.tile=function(t,e){return Hh(t,\"tile\"),ta(this.bufferSync(t),e)},o.prototype.pad=function(t,e,n){Hh(t,\"pad\");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),o=e.map((function(t){return t[0]})),a=this.bufferSync(t),i=dr(r,t.dtype);0!==n&&i.values.fill(n);for(var s=0;s<t.size;s++){var u=a.indexToLoc(s),c=u.map((function(t,e){return t+o[e]}));i.set.apply(i,[a.get.apply(a,u)].concat(c))}return i.toTensor()},o.prototype.transpose=function(t,e){Hh(t,\"transpose\");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var o=this.readSync(t.dataId),a=dr(n,t.dtype),i=this.bufferSync(t);for(r=0;r<t.size;++r){for(var s=i.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[e[c]];var l=a.locToIndex(u);a.values[l]=o[r]}return a.toTensor()},o.prototype.gather=function(t,e,n){Hh([t,e],\"gather\");var r=t.shape.slice(),o=this.readSync(e.dataId);r[n]=o.length;for(var a=dr(r,t.dtype),i=this.bufferSync(t),s=0;s<a.size;++s){var u=a.indexToLoc(s),c=u.slice();c[n]=o[u[n]];var l=i.locToIndex(c);a.values[s]=i.values[l]}return a.toTensor()},o.prototype.batchToSpaceND=function(t,e,n){Hh([t],\"batchToSpaceND\");var r=e.reduce((function(t,e){return t*e})),o=zr(t.shape,e,r),a=Gr(o.length,e.length),i=Hr(t.shape,e,r),s=qr(n,e.length),u=Kr(i,n,e.length);return t.reshape(o).transpose(a).reshape(i).slice(s,u)},o.prototype.spaceToBatchND=function(t,e,n){Hh([t],\"spaceToBatchND\");var r=e.reduce((function(t,e){return t*e})),o=[[0,0]];o.push.apply(o,n);for(var a=1+e.length;a<t.shape.length;++a)o.push([0,0]);var i=t.pad(o),s=zr(i.shape,e,r,!1),u=Gr(s.length,e.length,!1),c=Hr(i.shape,e,r,!1);return i.reshape(s).transpose(u).reshape(c)},o.prototype.pool=function(t,e,n){Hh(t,\"pool\");for(var r=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=\"max\"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,f=this.readSync(t.dataId),d=dr(e.outShape,t.dtype),p=d.values,v=e.outShape[1]*e.outShape[2]*e.outShape[3],m=e.outShape[2]*e.outShape[3],g=e.outShape[3],y=0;y<e.batchSize;++y)for(var x=y*v,b=y*t.strides[0],w=0;w<e.inChannels;++w)for(var C=0;C<e.outHeight;++C)for(var E=C*r-c,R=Math.max(0,E),I=Math.min(e.inHeight,s+E),k=x+C*m,S=0;S<e.outWidth;++S){for(var A=S*o-l,D=Math.max(0,A),T=Math.min(e.inWidth,u+A),N=h,F=0,_=0,O=R;O<I;O+=a){for(var M=b+O*t.strides[1],B=D;B<T;B+=i){var P=f[M+B*t.strides[2]+w];\"max\"===n&&P>N?N=P:\"avg\"===n&&(F+=P,_++)}if(isNaN(N))break}p[k+S*g+w]=\"avg\"===n?F/_:N}return d.toTensor()},o.prototype.maxPool=function(t,e){return this.pool(t,e,\"max\")},o.prototype.maxPoolPositions=function(t,e){for(var n=dr(e.outShape,\"int32\"),r=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=this.bufferSync(t),f=0;f<e.batchSize;++f)for(var d=0;d<e.inChannels;++d)for(var p=0;p<e.outHeight;++p){for(var v=p*r-c,m=v;m<0;)m+=a;for(var g=Math.min(e.inHeight,s+v),y=0;y<e.outWidth;++y){for(var x=y*o-l,b=x;b<0;)b+=i;for(var w=Math.min(e.inWidth,u+x),C=Number.NEGATIVE_INFINITY,E=-1,R=m;R<g;R+=a)for(var I=R-v,k=b;k<w;k+=i){var S=k-x,A=h.get(f,R,k,d);A>C&&(C=A,E=I*u+S)}n.set(E,f,p,y,d)}}return n.toTensor()},o.prototype.maxPoolBackprop=function(t,e,n,r){Hh([e,n],\"maxPoolBackprop\");for(var o=this.maxPoolPositions(e,r),a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,h=l-1-r.padInfo.left,f=c-1-r.padInfo.top,d=dr(e.shape,\"float32\"),p=this.bufferSync(o),v=this.bufferSync(t),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var x=0;x<r.inWidth;++x){for(var b=y-f,w=x-h,C=0,E=0;E<c;E+=s){var R=(b+E)/a;if(!(R<0||R>=r.outHeight||Math.floor(R)!==R))for(var I=0;I<l;I+=u){var k=(w+I)/i;if(!(k<0||k>=r.outWidth||Math.floor(k)!==k)){var S=c*l-1-p.get(m,R,k,g)===E*l+I?1:0;if(0!==S)C+=v.get(m,R,k,g)*S}}}d.set(C,m,y,x,g)}return d.toTensor()},o.prototype.avgPoolBackprop=function(t,e,n){Hh([t,e],\"avgPoolBackprop\");for(var r=n.strideHeight,o=n.strideWidth,a=n.filterHeight,i=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,f=c-1-n.padInfo.top,d=dr(e.shape,\"float32\"),p=1/(a*i),v=this.bufferSync(t),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var x=0;x<n.inWidth;++x){for(var b=y-f,w=x-h,C=0,E=0;E<c;E+=s){var R=(b+E)/r;if(!(R<0||R>=n.outHeight||Math.floor(R)!==R))for(var I=0;I<l;I+=u){var k=(w+I)/o;if(!(k<0||k>=n.outWidth||Math.floor(k)!==k))C+=v.get(m,R,k,g)}}d.set(C*p,m,y,x,g)}return d.toTensor()},o.prototype.pool3d=function(t,e,n){Hh(t,\"pool3d\");for(var r=e.strideDepth,o=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left,v=\"max\"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(t.dataId),g=dr(e.outShape,t.dtype),y=g.values,x=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],b=e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[3]*e.outShape[4],C=e.outShape[4],E=0;E<e.batchSize;++E)for(var R=E*x,I=E*t.strides[0],k=0;k<e.inChannels;++k)for(var S=0;S<e.outDepth;++S){for(var A=S*r-f,D=A;D<0;)D+=i;for(var T=Math.min(e.inDepth,c+A),N=R+S*b,F=0;F<e.outHeight;++F){for(var _=F*o-d,O=_;O<0;)O+=s;for(var M=Math.min(e.inHeight,l+_),B=N+F*w,P=0;P<e.outWidth;++P){for(var L=P*a-p,W=L;W<0;)W+=u;for(var U=Math.min(e.inWidth,h+L),V=B+P*C,z=v,G=0,H=0,q=D;q<T;q+=i){for(var K=I+q*t.strides[1],j=O;j<M;j+=s){for(var X=K+j*t.strides[2],Y=W;Y<U;Y+=u){var $=m[X+Y*t.strides[3]+k];if(\"max\"===n&&$>z?z=$:\"avg\"===n&&(G+=$,H++),isNaN(z))break}if(isNaN(z))break}if(isNaN(z))break}y[V+k]=\"avg\"===n?G/H:z}}}return g.toTensor()},o.prototype.avgPool3d=function(t,e){return Hh(t,\"avgPool3d\"),this.pool3d(t,e,\"avg\").toFloat()},o.prototype.avgPool3dBackprop=function(t,e,n){Hh([t,e],\"avgPool3dBackprop\");for(var r=n.strideDepth,o=n.strideHeight,a=n.strideWidth,i=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,h=n.dilationWidth,f=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=f-1-n.padInfo.front,m=p-1-n.padInfo.left,g=d-1-n.padInfo.top,y=dr(e.shape,\"float32\"),x=1/(i*s*u),b=this.bufferSync(t),w=0;w<n.batchSize;++w)for(var C=0;C<n.inChannels;++C)for(var E=0;E<n.inDepth;++E)for(var R=0;R<n.inHeight;++R)for(var I=0;I<n.inWidth;++I){for(var k=E-v,S=R-g,A=I-m,D=0,T=0;T<f;T+=c){var N=(k+T)/r;if(!(N<0||N>=n.outDepth||Math.floor(N)!==N))for(var F=0;F<d;F+=l){var _=(S+F)/o;if(!(_<0||_>=n.outHeight||Math.floor(_)!==_))for(var O=0;O<p;O+=h){var M=(A+O)/a;if(!(M<0||M>=n.outWidth||Math.floor(M)!==M))D+=b.get(w,N,_,M,C)}}}y.set(D*x,w,E,R,I,C)}return y.toTensor()},o.prototype.maxPool3d=function(t,e){return Hh(t,\"maxPool3d\"),this.pool3d(t,e,\"max\").toFloat()},o.prototype.maxPool3dPositions=function(t,e){for(var n=dr(e.outShape,\"int32\"),r=e.strideDepth,o=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left,v=this.bufferSync(t),m=0;m<e.batchSize;++m)for(var g=0;g<e.inChannels;++g)for(var y=0;y<e.outDepth;++y){for(var x=y*r-f,b=x;b<0;)b+=i;for(var w=Math.min(e.inDepth,c+x),C=0;C<e.outHeight;++C){for(var E=C*o-d,R=E;R<0;)R+=s;for(var I=Math.min(e.inHeight,l+E),k=0;k<e.outWidth;++k){for(var S=k*a-p,A=S;A<0;)A+=u;for(var D=Math.min(e.inWidth,h+S),T=Number.NEGATIVE_INFINITY,N=-1,F=b;F<w;F+=i)for(var _=F-x,O=R;O<I;O+=s)for(var M=O-E,B=A;B<D;B+=u){var P=B-S,L=v.get(m,F,O,B,g);L>=T&&(T=L,N=_*l*h+M*l+P)}n.set(N,m,y,C,k,g)}}}return n.toTensor()},o.prototype.maxPool3dBackprop=function(t,e,n,r){Hh([e,n],\"maxPool3dBackprop\");for(var o=this.maxPool3dPositions(e,r),a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=h-1-r.padInfo.front,v=d-1-r.padInfo.left,m=f-1-r.padInfo.top,g=dr(e.shape,\"float32\"),y=this.bufferSync(o),x=this.bufferSync(t),b=0;b<r.batchSize;++b)for(var w=0;w<r.inChannels;++w)for(var C=0;C<r.inDepth;++C)for(var E=0;E<r.inHeight;++E)for(var R=0;R<r.inWidth;++R){for(var I=C-p,k=E-m,S=R-v,A=0,D=0;D<h;D+=u){var T=(I+D)/a;if(!(T<0||T>=r.outDepth||Math.floor(T)!==T))for(var N=0;N<f;N+=c){var F=(k+N)/i;if(!(F<0||F>=r.outHeight||Math.floor(F)!==F))for(var _=0;_<d;_+=l){var O=(S+_)/s;if(!(O<0||O>=r.outWidth||Math.floor(O)!==O)){var M=h*f*d-1-y.get(b,T,F,O,w)===D*f*d+N*d+_?1:0;if(0!==M)A+=x.get(b,T,F,O,w)*M}}}}g.set(A,b,C,E,R,w)}return g.toTensor()},o.prototype.cast=function(t,e){return Po(t,e,this)},o.prototype.reshape=function(t,e){return Lo(t,e)},o.prototype.avgPool=function(t,e){return Hh(t,\"avgPool\"),this.pool(t,e,\"avg\").toFloat()},o.prototype.resizeBilinear=function(t,e,n,r){Hh(t,\"resizeBilinear\");for(var o=t.shape,a=o[0],i=o[1],s=o[2],u=o[3],c=this.readSync(t.dataId),l=new Float32Array(k([a,e,n,u])),h=[r&&e>1?i-1:i,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=0,p=h[0]/f[0],v=h[1]/f[1],m=0;m<a;m++)for(var g=0;g<e;g++)for(var y=p*g,x=Math.floor(y),b=y-x,w=Math.min(i-1,Math.ceil(y)),C=m*t.strides[0]+x*t.strides[1],E=m*t.strides[0]+w*t.strides[1],R=0;R<n;R++)for(var I=v*R,S=Math.floor(I),A=I-S,D=Math.min(s-1,Math.ceil(I)),T=C+S*t.strides[2],N=E+S*t.strides[2],F=C+D*t.strides[2],_=E+D*t.strides[2],O=0;O<u;O++){var M=c[T+O],B=c[N+O],P=M+(c[F+O]-M)*A,L=P+(B+(c[_+O]-B)*A-P)*b;l[d++]=L}return Fn(l,[a,e,n,u])},o.prototype.resizeBilinearBackprop=function(t,e,n){Hh([t,e],\"resizeBilinearBackprop\");for(var r=e.shape,o=r[0],a=r[1],i=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(o*a*i*s),f=[n&&c>1?a-1:a,n&&l>1?i-1:i],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=f[0]/d[0],v=f[1]/d[1],m=this.readSync(t.dataId),g=0,y=0;y<o;y++)for(var x=y*e.strides[0],b=0;b<c;b++)for(var w=b*p,C=Math.floor(w),E=Math.min(Math.ceil(w),a-1),R=x+C*e.strides[1],I=x+E*e.strides[1],k=w-C,S=1-k,A=0;A<l;A++)for(var D=A*v,T=Math.floor(D),N=Math.min(Math.ceil(D),i-1),F=D-T,_=1-F,O=R+T*e.strides[2],M=R+N*e.strides[2],B=I+T*e.strides[2],P=I+N*e.strides[2],L=S*_,W=S*F,U=k*_,V=k*F,z=0;z<s;z++){var G=m[g++];h[O+z]+=G*L,h[M+z]+=G*W,h[B+z]+=G*U,h[P+z]+=G*V}return Ln(h,[o,i,a,s],e.dtype)},o.prototype.resizeNearestNeighbor=function(t,e,n,r){Hh(t,\"resizeNearestNeighbor\");for(var o=t.shape,a=o[0],i=o[1],s=o[2],u=o[3],c=this.readSync(t.dataId),l=new Float32Array(a*e*n*u),h=[r&&e>1?i-1:i,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=h[0]/f[0],p=h[1]/f[1],v=0,m=0;m<a;m++)for(var g=m*t.strides[0],y=0;y<e;y++)for(var x=d*y,b=g+Math.min(i-1,r?Math.round(x):Math.floor(x))*t.strides[1],w=0;w<n;w++)for(var C=p*w,E=b+Math.min(s-1,r?Math.round(C):Math.floor(C))*t.strides[2],R=0;R<u;R++){var I=c[E+R];l[v++]=I}return Fn(l,[a,e,n,u],t.dtype)},o.prototype.resizeNearestNeighborBackprop=function(t,e,n){Hh([t,e],\"resizeNearestNeighborBackprop\");for(var r=e.shape,o=r[0],a=r[1],i=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(o*a*i*s),f=this.readSync(t.dataId),d=[n&&c>1?a-1:a,n&&l>1?i-1:i],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=d[0]/p[0],m=d[1]/p[1],g=1/v,y=1/m,x=2*Math.ceil(g)+2,b=2*Math.ceil(y)+2,w=0;w<o;w++)for(var C=w*e.strides[0],E=0;E<a;E++)for(var R=C+E*e.strides[1],I=Math.floor(E*g),k=Math.floor(I-x/2),S=0;S<i;S++)for(var A=R+S*e.strides[2],D=Math.floor(S*y),T=Math.floor(D-b/2),N=0;N<s;N++){for(var F=0,_=0;_<x;_++){var O=_+k;if(!(O<0||O>=c)){var M=C+O*t.strides[1],B=O*v;if(E===Math.min(a-1,n?Math.round(B):Math.floor(B)))for(var P=0;P<b;P++){var L=P+T;if(!(L<0||L>=l)){var W=M+L*t.strides[2],U=L*m;S===Math.min(i-1,n?Math.round(U):Math.floor(U))&&(F+=f[W+N])}}}}h[A+N]=F}return Ln(h,e.shape,e.dtype)},o.prototype.batchNormalization=function(t,e,n,r,o,a){Hh([t,e,n,o,a],\"batchNorm\");for(var i=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=o?this.readSync(o.dataId):new Float32Array([1]),l=a?this.readSync(a.dataId):new Float32Array([0]),h=new Float32Array(i.length),f=l.length,d=c.length,p=u.length,v=s.length,m=0,g=0,y=0,x=0,b=0;b<i.length;++b)h[b]=l[m++]+(i[b]-s[g++])*c[y++]/Math.sqrt(u[x++]+r),m>=f&&(m=0),g>=v&&(g=0),y>=d&&(y=0),x>=p&&(x=0);return Ln(h,t.shape)},o.prototype.localResponseNormalization4D=function(t,e,n,r,o){Hh(t,\"localResponseNormalization4D\");var a=t.shape[3],i=a-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%a,r=t-n+Math.max(0,n-e),o=t-n+Math.min(n+e,i),u=0;r<=o;r++){var c=s[r];u+=c*c}return u}for(var h=0;h<u;h++){var f=l(h),d=s[h]*Math.pow(n+r*f,-o);c[h]=d}return Ln(c,t.shape)},o.prototype.LRNGrad=function(t,e,n,r,o,a,i){Hh(t,\"LRNGrad\");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),f=t.size,d=0;d<f;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),m=d-p+Math.min(s,p+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);g=a*g+o;for(y=v;y<m;y++){var x=-2*a*i*c[y]*l[d]/g;d===y&&(x+=Math.pow(g,-i)),x*=u[d],h[y]+=x}}return Ln(h,t.shape)},o.prototype.multinomial=function(t,e,n,r){Hh(t,\"multinomial\");for(var o=e?t:go(t),a=o.shape[0],i=o.shape[1],s=Gn([a,n],\"int32\"),u=this.readSync(s.dataId),c=this.readSync(o.dataId),l=0;l<a;++l){var h=l*i,f=new Float32Array(i-1);f[0]=c[h];for(var d=1;d<f.length;++d)f[d]=f[d-1]+c[h+d];for(var p=cr(r.toString()),v=l*n,m=0;m<n;++m){var g=p();u[v+m]=f.length;for(var y=0;y<f.length;y++)if(g<f[y]){u[v+m]=y;break}}}return s},o.prototype.oneHot=function(t,e,n,r){Hh(t,\"oneHot\");var o=new Float32Array(t.size*e);o.fill(r);for(var a=this.readSync(t.dataId),i=0;i<t.size;++i)a[i]>=0&&a[i]<e&&(o[i*e+a[i]]=n);return Bn(o,[t.size,e],\"int32\")},o.prototype.nonMaxSuppression=function(t,e,n,r,o){return Hh(t,\"nonMaxSuppression\"),jo(this.readSync(t.dataId),this.readSync(e.dataId),n,r,o)},o.prototype.fft=function(t){return this.fftBatch(t,!1)},o.prototype.ifft=function(t){return this.fftBatch(t,!0)},o.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],o=dr(t.shape,\"float32\"),a=dr(t.shape,\"float32\"),i=Tn(t).as2D(n,r),s=Nn(t).as2D(n,r),u=0;u<n;u++)for(var c=i.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),h=Dn(c,l),f=this.readSync(this.fftImpl(h,e).dataId),d=0;d<r;d++){var p=zo(f,d);o.values[u*r+d]=p.real,a.values[u*r+d]=p.imag}return Dn(o.toTensor(),a.toTensor()).as2D(n,r)},o.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var o=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(o=Dn(Tn(o).div(On(r)),Nn(o).div(On(r)))),o}var a=this.readSync(t.dataId),i=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(a,r,e));return Dn(i.real,i.imag).as2D(t.shape[0],t.shape[1])},o.prototype.isExponentOf2=function(t){return 0==(t&t-1)},o.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),o=e/2,a=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),o=0;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:n,imag:r}}(r),i=Dn(a.real,a.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),o=2;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:n,imag:r}}(r),u=Dn(s.real,s.imag).as1D();i=this.fftRadix2(i,o,n),u=this.fftRadix2(u,o,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),o=0;o<Math.ceil(t/2);o++){var a=(e?2:-2)*Math.PI*(o/t);n[o]=Math.cos(a),r[o]=Math.sin(a)}return{real:n,imag:r}}(e,n),l=Dn(c.real,c.imag).mul(u),h=i.add(l),f=i.sub(l),d=Tn(h).concat(Tn(f)),p=Nn(h).concat(Nn(f));return Dn(d,p).as1D()},o.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),o=0;o<e;o++){for(var a=0,i=0,s=0;s<e;s++){var u=Ho(o*s,e,n),c=zo(t,s);a+=c.real*u.real-c.imag*u.imag,i+=c.real*u.imag+c.imag*u.real}n&&(a/=e,i/=e),Go(r,a,i,o)}return r},o.prototype.depthToSpace=function(t,e,n){C(\"NHWC\"===n,(function(){return\"Only NHWC dataFormat supported on CPU for depthToSpace. Got \"+n})),C(e>1,(function(){return\"blockSize should be > 1 for depthToSpace, but was: \"+e}));for(var r=t.shape[0],o=t.shape[1],a=t.shape[2],i=t.shape[3],s=o*e,u=a*e,c=i/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*s*u*c),f=0,d=0;d<r;++d)for(var p=0;p<s;++p)for(var v=Math.floor(p/e),m=p%e,g=0;g<u;++g)for(var y=Math.floor(g/e),x=(m*e+g%e)*c,b=0;b<c;++b){var w=b+x+i*(y+a*(v+o*d));h[f++]=l[w]}return Ln(h,[r,s,u,c])},o.prototype.broadcastedBinaryOp=function(t,e,n,r){var o=Ro(t.shape,e.shape),a=dr(o,n),i=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Co(t.shape,o),c=Co(e.shape,o),l=a.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(i[h%i.length],s[h%s.length]);else{var f=this.bufferSync(t),d=this.bufferSync(e),p=function(n){var o=a.indexToLoc(n),h=o.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=f.locToIndex(h),v=o.slice(-e.rank);c.forEach((function(t){return v[t]=0}));var m=d.locToIndex(v);l[n]=r(i[p],s[m])};for(h=0;h<l.length;++h)p(h)}return a.toTensor()},o.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=Ro(t.shape,e.shape),o=dr(r,\"float32\"),a=dr(r,\"float32\"),i=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Co(t.shape,r),c=Co(e.shape,r),l=o.values,h=a.values;if(u.length+c.length===0)for(var f=0;f<l.length;f++){var d=f%i.length,p=f%s.length,v=n(i[2*d],i[2*d+1],s[2*p],s[2*p+1]);l[f]=v.real,h[f]=v.imag}else{var m=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var a=o.indexToLoc(r),f=a.slice(-t.rank);u.forEach((function(t){return f[t]=0}));var d=m.locToIndex(f),p=a.slice(-e.rank);c.forEach((function(t){return p[t]=0}));var v=g.locToIndex(p),y=n(i[2*d],i[2*d+1],s[2*v],s[2*v+1]);l[r]=y.real,h[r]=y.imag};for(f=0;f<l.length;f++)y(f)}return this.complex(o.toTensor(),a.toTensor())},o.prototype.split=function(t,e,n){return Zo(t,e,n)},o.prototype.dispose=function(){},o.prototype.floatPrecision=function(){return 32},o.prototype.epsilon=function(){return 1e-7},o.prototype.cropAndResize=function(t,e,n,r,o,a){for(var i=t.shape,s=i[0],u=i[1],c=i[2],l=i[3],h=e.shape[0],f=r[0],d=r[1],p=dr([h,f,d,l],\"float32\"),v=this.readSync(e.dataId),m=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,x=p.strides,b=0;b<h;b++){var w=4*b,C=v[w],E=v[w+1],R=v[w+2],I=v[w+3],k=m[b];if(!(k>=s))for(var S=f>1?(R-C)*(u-1)/(f-1):0,A=d>1?(I-E)*(c-1)/(d-1):0,D=0;D<f;D++){var T=f>1?C*(u-1)+D*S:.5*(C+R)*(u-1);if(T<0||T>u-1)for(var N=0;N<d;N++)for(var F=0;F<l;F++){var _=F+N*x[2]+D*x[1]+b*x[0];p.values[_]=a}else if(\"bilinear\"===o){var O=Math.floor(T),M=Math.ceil(T),B=T-O;for(N=0;N<d;N++){if((q=d>1?E*(c-1)+N*A:.5*(E+I)*(c-1))<0||q>c-1)for(F=0;F<l;F++){_=F+N*x[2]+D*x[1]+b*x[0];p.values[_]=a}else{var P=Math.floor(q),L=Math.ceil(q),W=q-P;for(F=0;F<l;F++){var U=g[_=F+P*y[2]+O*y[1]+k*y[0]],V=g[_=F+L*y[2]+O*y[1]+k*y[0]],z=g[_=F+P*y[2]+M*y[1]+k*y[0]],G=U+(V-U)*W,H=z+(g[_=F+L*y[2]+M*y[1]+k*y[0]]-z)*W;_=F+N*x[2]+D*x[1]+b*x[0],p.values[_]=G+(H-G)*B}}}}else for(N=0;N<d;++N){var q;if((q=d>1?E*(c-1)+N*A:.5*(E+I)*(c-1))<0||q>c-1)for(F=0;F<l;F++){_=F+N*x[2]+D*x[1]+b*x[0];p.values[_]=a}else{var K=Math.round(q),j=Math.round(T);for(F=0;F<l;F++){var X=F+K*y[2]+j*y[1]+k*y[0],Y=F+N*x[2]+D*x[1]+b*x[0];p.values[Y]=g[X]}}}}}return p.toTensor()},o.prototype.sparseToDense=function(t,e,n,r){var o=Zr(0,t,n),a=o.sliceRank,i=o.numUpdates,s=o.sliceSize,u=o.strides,c=o.outputSize;return this.scatter(t,e,n,c,s,i,a,u,r,!1)},o.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],o=jr(t,e),a=o[0],i=o[1],s=o[2],u=o[3];if(0===i)return Fn([],a,t.dtype);for(var c=new gt([i,s],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),f=0;f<i;f++){for(var d=[],p=0,v=0;v<r;v++){var m=l[f*r+v];p+=m*u[v],d.push(m)}if(p<0||p>=t.size/s)throw new Error(\"Invalid indices: \"+d+\" does not index into \"+t.shape);for(var g=0;g<s;g++)c.values[f*s+g]=h[p*s+g]}return c.toTensor().reshape(a)},o.prototype.scatterND=function(t,e,n){var r=Zr(0,t,n),o=r.sliceRank,a=r.numUpdates,i=r.sliceSize,s=r.strides,u=r.outputSize,c=On(0);return this.scatter(t,e,n,u,i,a,o,s,c,!0)},o.prototype.fill=function(t,e,n){var r=P(n=n||j(e),k(t));return r.fill(e),Lt.makeTensor(r,t,n,this)},o.prototype.onesLike=function(t){if(\"string\"===t.dtype)throw new Error(\"onesLike is not supported for string tensors\");return this.fill(t.shape,1,t.dtype)},o.prototype.zerosLike=function(t){var e=P(t.dtype,k(t.shape));return this.makeOutput(e,t.shape,t.dtype)},o.prototype.linspace=function(t,e,n){return Wo(t,e,n)},o.prototype.scatter=function(t,e,n,r,o,a,i,s,u,c){var l=[r/o,o],h=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===r)return Fn([],n,e.dtype);var d=new gt(l,e.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<a;p++){for(var v=[],m=0,g=0;g<i;g++){var y=h[p*i+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/o)throw new Error(\"Invalid indices: \"+v+\" does not index into \"+n);for(var x=0;x<o;x++)c?d.values[m*o+x]+=f[p*o+x]:d.values[m*o+x]=0===e.rank?f[0]:f[p*o+x]}return d.toTensor().reshape(n)},o}(bo);Lt.registerBackend(\"cpu\",(function(){return new Kh}),1);for(var jh=0,Xh=[{kernelName:\"NonMaxSuppressionV5\",backendName:\"cpu\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e,a=o.boxes,i=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,h=s.softNmsSigma,f=n;Hh(a,\"NonMaxSuppressionWithScore\");var d=Xo(f.data.get(a.dataId).values,f.data.get(i.dataId).values,u,c,l,h);return[d.selectedIndices,d.selectedScores]}},{kernelName:\"Square\",backendName:\"cpu\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n;Hh(r,\"square\");for(var a=o.data.get(r.dataId).values,i=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];i[s]=u*u}return{dataId:o.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:eu,backendName:\"cpu\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,a=r.b,i=n;Hh([o,a],eu);var s=i.data.get(o.dataId).values,u=i.data.get(a.dataId).values,c=function(t,e,n,r,o,a){var i=Ro(t,e),s=i.length,u=$(i),c=B(o,k(i)),l=t.length,h=e.length,f=$(t),d=$(e),p=Co(t,i),v=Co(e,i);if(p.length+v.length===0)for(var m=0;m<c.length;++m)c[m]=a(n[m%n.length],r[m%r.length]);else{var g=function(t){var e=it(t,s,u),o=e.slice(-l);p.forEach((function(t){return o[t]=0}));var i=at(o,l,f),m=e.slice(-h);v.forEach((function(t){return m[t]=0}));var g=at(m,h,d);c[t]=a(n[i],r[g])};for(m=0;m<c.length;++m)g(m)}return[c,i]}(o.shape,a.shape,s,u,o.dtype,(function(t,e){var n=t-e;return n*n})),l=c[0],h=c[1];return{dataId:i.write(l,h,o.dtype),shape:h,dtype:o.dtype}}}];jh<Xh.length;jh++){d(Xh[jh])}var Yh,$h=function(t){this.variableNames=[\"A\"];var e=ua(),n=t[0],r=t[1];this.outputShape=t,this.userCode=\"\\n      void main() {\\n        ivec3 coords = getOutputCoords();\\n        int texR = coords[0];\\n        int texC = coords[1];\\n        int depth = coords[2];\\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(\"+r+\".0, \"+n+\".0);\\n\\n        vec4 values = \"+e.texture2D+\"(A, uv);\\n        float value;\\n        if (depth == 0) {\\n          value = values.r;\\n        } else if (depth == 1) {\\n          value = values.g;\\n        } else if (depth == 2) {\\n          value = values.b;\\n        } else if (depth == 3) {\\n          value = values.a;\\n        }\\n\\n        setOutput(floor(value * 255.0 + 0.5));\\n      }\\n    \"},Qh=function(t){this.variableNames=[\"A\"],this.packedInputs=!1,this.packedOutput=!0;var e=ua(),n=t[0],r=t[1];this.outputShape=t,this.userCode=\"\\n      void main() {\\n        ivec3 coords = getOutputCoords();\\n        int texR = coords[0];\\n        int texC = coords[1];\\n        int depth = coords[2];\\n\\n        vec4 result = vec4(0.);\\n\\n        for(int row=0; row<=1; row++) {\\n          for(int col=0; col<=1; col++) {\\n            texC = coords[1] + row;\\n            depth = coords[2] + col;\\n\\n            vec2 uv = (vec2(texC, texR) + halfCR) /\\n                       vec2(\"+r+\".0, \"+n+\".0);\\n            vec4 values = \"+e.texture2D+\"(A, uv);\\n            float value;\\n            if (depth == 0) {\\n              value = values.r;\\n            } else if (depth == 1) {\\n              value = values.g;\\n            } else if (depth == 2) {\\n              value = values.b;\\n            } else if (depth == 3) {\\n              value = values.a;\\n            }\\n\\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\\n          }\\n        }\\n\\n        \"+e.output+\" = result;\\n      }\\n    \"};for(var Jh=0,Zh=[{kernelName:\"FromPixels\",backendName:\"webgl\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e.pixels,a=r.numChannels,s=\"undefined\"!=typeof HTMLVideoElement&&o instanceof HTMLVideoElement,u=\"undefined\"!=typeof HTMLImageElement&&o instanceof HTMLImageElement,c=s?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=c[0],h=c[1],f=[h,l],d=[h,l,a];(u||s)&&(null==Yh&&(Yh=document.createElement(\"canvas\").getContext(\"2d\")),Yh.canvas.width=l,Yh.canvas.height=h,Yh.drawImage(o,0,0,l,h),o=Yh.canvas);var p=n.makeTensorInfo(f,\"int32\");n.texData.get(p.dataId).usage=zt.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),o);var v=i().getBool(\"WEBGL_PACK\")?new Qh(d):new $h(d),m=n.runWebGLProgram(v,[p],\"int32\");return n.disposeData(p.dataId),m}},{kernelName:\"NonMaxSuppressionV5\",backendName:\"webgl\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;dn(\"tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead\");var o=e,a=o.boxes,i=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,h=s.softNmsSigma,f=n,d=Xo(f.readSync(a.dataId),f.readSync(i.dataId),u,c,l,h);return[d.selectedIndices,d.selectedScores]}},{kernelName:\"Square\",backendName:\"webgl\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n,a=new Cs(r.shape,\"return x * x;\");return o.runWebGLProgram(a,[r],r.dtype)}},{kernelName:eu,backendName:\"webgl\",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,a=r.b,s=n,u=i().getBool(\"WEBGL_PACK_BINARY_OPERATIONS\")?new La(\"return (a - b) * (a - b);\",o.shape,a.shape):new Ba(\"return (a - b) * (a - b);\",o.shape,a.shape);return s.compileAndRun(u,[o,a])}}];Jh<Zh.length;Jh++){d(Zh[Jh])}for(var tf=0,ef=[{kernelName:\"Square\",gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:eu,gradFunc:function(t,e){var n=e[0],r=e[1],o=On(2);return{a:function(){return gc(t,gc(o,Cc(n,r)))},b:function(){return gc(t,gc(o,Cc(r,n)))}}}}];tf<ef.length;tf++){p(ef[tf])}var nf=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if(\"utf-8\"!==e&&\"utf8\"!==e)throw new Error(\"Browser's encoder only supports utf-8, but got \"+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();i().get(\"IS_BROWSER\")&&i().setPlatform(\"browser\",new nf);var rf,of=function(){return require(\"node-fetch\")},af=function(){function t(){this.util=require(\"util\"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=i().global.fetch?i().global.fetch(t,e):(null==rf&&(rf=of()),rf(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if(\"utf-8\"!==e&&\"utf8\"!==e)throw new Error(\"Node built-in encoder only supports utf-8, but got \"+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?\"\":new this.util.TextDecoder(e).decode(t)},t}();i().get(\"IS_NODE\")&&i().setPlatform(\"node\",new af);var sf={float32:4,int32:4,uint16:2,uint8:1,bool:1},uf=4;function cf(t,e){for(var n={},r=0,o=function(e){var o=e.name,a=e.dtype,i=e.shape,s=k(i),u=void 0;if(\"quantization\"in e){var c=e.quantization;if(\"uint8\"!==c.dtype&&\"uint16\"!==c.dtype)throw new Error(\"Weight \"+e.name+\" has unknown quantization dtype \"+c.dtype+\". Supported quantization dtypes are: 'uint8' and 'uint16'.\");var l=sf[c.dtype],h=t.slice(r,r+s*l),f=\"uint8\"===c.dtype?new Uint8Array(h):new Uint16Array(h);if(\"float32\"===a)u=Float32Array.from(f,(function(t){return t*c.scale+c.min}));else{if(\"int32\"!==a)throw new Error(\"Unsupported dtype in weight '\"+o+\"': \"+a);u=Int32Array.from(f,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if(\"string\"===a){var d=k(e.shape);u=[];for(var p=0;p<d;p++){var v=new Uint32Array(t.slice(r,r+uf))[0];r+=uf;var m=new Uint8Array(t.slice(r,r+v));u.push(m),r+=v}}else{var g=sf[a];h=t.slice(r,r+s*g);if(\"float32\"===a)u=new Float32Array(h);else if(\"int32\"===a)u=new Int32Array(h);else{if(\"bool\"!==a)throw new Error(\"Unsupported dtype in weight '\"+o+\"': \"+a);u=new Uint8Array(h)}r+=s*g}n[o]=Fn(u,i,a)},a=0,i=e;a<i.length;a++){o(i[a])}return n}function lf(t){if(null===t)throw new Error(\"Invalid input value: \"+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error(\"Unsupported TypedArray subtype: \"+t.constructor.name)}));var r=new Uint8Array(e),o=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),o),o+=t.byteLength})),r.buffer}var hf=\"undefined\"!=typeof Buffer&&(\"undefined\"==typeof Blob||\"undefined\"==typeof atob||\"undefined\"==typeof btoa);function ff(t){return hf?Buffer.byteLength(t):new Blob([t]).size}function df(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function pf(t){for(t=t.trim();t.endsWith(\"/\");)t=t.slice(0,t.length-1);var e=t.split(\"/\");return e[e.length-1]}function vf(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error(\"Expected JSON model topology, received ArrayBuffer.\");return{dateSaved:new Date,modelTopologyType:\"JSON\",modelTopologyBytes:null==t.modelTopology?0:ff(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:ff(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var mf=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,\"save\")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,\"load\",n)},t.getHandlers=function(e,n,r){var o=[];return(\"load\"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&o.push(n)})),o},t}(),gf=\"://\",yf=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){C(null!=e,(function(){return\"scheme must not be undefined or null.\"})),e.endsWith(gf)&&(e=e.slice(0,e.indexOf(gf))),C(e.length>0,(function(){return\"scheme must not be an empty string.\"}));var r=t.getInstance();C(null==r.managers[e],(function(){return\"A model store manager is already registered for scheme '\"+e+\"'.\"})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error(\"Cannot find model manager for scheme '\"+t+\"'\");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function xf(t){if(-1===t.indexOf(gf))throw new Error(\"The url string provided does not contain a scheme. Supported schemes are: \"+yf.getSchemes().join(\",\"));return{scheme:t.split(gf)[0],path:t.split(gf)[1]}}function bf(t,e,o){return void 0===o&&(o=!1),n(this,void 0,void 0,(function(){var n,a,i,s,u,c,l,h,f;return r(this,(function(r){switch(r.label){case 0:return C(t!==e,(function(){return\"Old path and new path are the same: '\"+t+\"'\"})),C((n=mf.getLoadHandlers(t)).length>0,(function(){return\"Copying failed because no load handler is found for source URL \"+t+\".\"})),C(n.length<2,(function(){return\"Copying failed because more than one (\"+n.length+\") load handlers for source URL \"+t+\".\"})),a=n[0],C((i=mf.getSaveHandlers(e)).length>0,(function(){return\"Copying failed because no save handler is found for destination URL \"+e+\".\"})),C(i.length<2,(function(){return\"Copying failed because more than one (\"+n.length+\") save handlers for destination URL \"+e+\".\"})),s=i[0],u=xf(t).scheme,c=xf(t).path,l=u===xf(t).scheme,[4,a.load()];case 1:return h=r.sent(),o&&l?[4,yf.getManager(u).removeModel(c)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[4,s.save(h)];case 4:return f=r.sent(),!o||l?[3,6]:[4,yf.getManager(u).removeModel(c)];case 5:r.sent(),r.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var wf=\"models_store\",Cf=\"model_info_store\";function Ef(){if(!i().getBool(\"IS_BROWSER\"))throw new Error(\"Failed to obtain IndexedDB factory because the current environmentis not a web browser.\");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error(\"The current browser does not appear to support IndexedDB.\");return e}function Rf(t){var e=t.result;e.createObjectStore(wf,{keyPath:\"modelPath\"}),e.createObjectStore(Cf,{keyPath:\"modelPath\"})}var If=function(){function t(t){if(this.indexedDB=Ef(),null==t||!t)throw new Error(\"For IndexedDB, modelPath must not be null, undefined or empty.\");this.modelPath=t}return t.prototype.save=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error(\"BrowserLocalStorage.save() does not support saving model topology in binary formats yet.\");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var o=n.indexedDB.open(\"tensorflowjs\",1);o.onupgradeneeded=function(){return Rf(o)},o.onsuccess=function(){var a=o.result;if(null==e){var i=a.transaction(wf,\"readonly\"),s=i.objectStore(wf).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error(\"Cannot find model with path '\"+n.modelPath+\"' in IndexedDB.\"));t(s.result.modelArtifacts)},s.onerror=function(t){return a.close(),r(s.error)},i.oncomplete=function(){return a.close()}}else{var u,c=vf(e),l=a.transaction(Cf,\"readwrite\"),h=l.objectStore(Cf),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var o=(u=a.transaction(wf,\"readwrite\")).objectStore(wf).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});o.onsuccess=function(){return t({modelArtifactsInfo:c})},o.onerror=function(t){var e=(h=l.objectStore(Cf)).delete(n.modelPath);e.onsuccess=function(){return a.close(),r(o.error)},e.onerror=function(t){return a.close(),r(o.error)}}},f.onerror=function(t){return a.close(),r(f.error)},l.oncomplete=function(){null==u?a.close():u.oncomplete=function(){return a.close()}}}},o.onerror=function(t){return r(o.error)}}))},t.URL_SCHEME=\"indexeddb://\",t}(),kf=function(t){return i().getBool(\"IS_BROWSER\")&&!Array.isArray(t)&&t.startsWith(If.URL_SCHEME)?(e=t.slice(If.URL_SCHEME.length),new If(e)):null;var e};mf.registerSaveRouter(kf),mf.registerLoadRouter(kf);var Sf=function(){function t(){this.indexedDB=Ef()}return t.prototype.listModels=function(){return n(this,void 0,void 0,(function(){var t=this;return r(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open(\"tensorflowjs\",1);r.onupgradeneeded=function(){return Rf(r)},r.onsuccess=function(){var t=r.result,o=t.transaction(Cf,\"readonly\"),a=o.objectStore(Cf).getAll();a.onsuccess=function(){for(var t={},n=0,r=a.result;n<r.length;n++){var o=r[n];t[o.modelPath]=o.modelArtifactsInfo}e(t)},a.onerror=function(e){return t.close(),n(a.error)},o.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return n(this,void 0,void 0,(function(){var e=this;return r(this,(function(n){var r;return t=(r=t).startsWith(If.URL_SCHEME)?r.slice(If.URL_SCHEME.length):r,[2,new Promise((function(n,r){var o=e.indexedDB.open(\"tensorflowjs\",1);o.onupgradeneeded=function(){return Rf(o)},o.onsuccess=function(){var e,a=o.result,i=a.transaction(Cf,\"readwrite\"),s=i.objectStore(Cf),u=s.get(t);u.onsuccess=function(){if(null==u.result)return a.close(),r(new Error(\"Cannot find model with path '\"+t+\"' in IndexedDB.\"));var o=s.delete(t),i=function(){var o=(e=a.transaction(wf,\"readwrite\")).objectStore(wf).delete(t);o.onsuccess=function(){return n(u.result.modelArtifactsInfo)},o.onerror=function(t){return r(u.error)}};o.onsuccess=i,o.onerror=function(t){return i(),a.close(),r(u.error)}},u.onerror=function(t){return a.close(),r(u.error)},i.oncomplete=function(){null==e?a.close():e.oncomplete=function(){return a.close()}}},o.onerror=function(t){return r(o.error)}}))]}))}))},t}();if(i().getBool(\"IS_BROWSER\"))try{yf.registerManager(If.URL_SCHEME,new Sf)}catch(t){}var Af=\"/\",Df=\"tensorflowjs_models\",Tf=\"info\",Nf=\"model_topology\",Ff=\"weight_specs\",_f=\"weight_data\",Of=\"model_metadata\";function Mf(t){return{info:[Df,t,Tf].join(Af),topology:[Df,t,Nf].join(Af),weightSpecs:[Df,t,Ff].join(Af),weightData:[Df,t,_f].join(Af),modelMetadata:[Df,t,Of].join(Af)}}function Bf(t){var e=t.split(Af);if(e.length<3)throw new Error(\"Invalid key format: \"+t);return e.slice(1,e.length-1).join(Af)}var Pf=function(){function t(t){if(!i().getBool(\"IS_BROWSER\")||\"undefined\"==typeof window||void 0===window.localStorage)throw new Error(\"The current environment does not support local storage.\");if(this.LS=window.localStorage,null==t||!t)throw new Error(\"For local storage, modelPath must not be null, undefined or empty.\");this.modelPath=t,this.keys=Mf(this.modelPath)}return t.prototype.save=function(t){return n(this,void 0,void 0,(function(){var e,n,o;return r(this,(function(r){if(t.modelTopology instanceof ArrayBuffer)throw new Error(\"BrowserLocalStorage.save() does not support saving model topology in binary formats yet.\");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),o=vf(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(hf)return Buffer.from(t).toString(\"base64\");for(var e=new Uint8Array(t),n=\"\",r=0,o=e.length;r<o;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(\"Failed to save model '\"+this.modelPath+\"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=\"+o.modelTopologyBytes+\", weightSpecsBytes=\"+o.weightSpecsBytes+\", weightDataBytes=\"+o.weightDataBytes+\".\")}return[2]}))}))},t.prototype.load=function(){return n(this,void 0,void 0,(function(){var t,e,n,o,a,i,s;return r(this,(function(r){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error(\"In local storage, there is no model with name '\"+this.modelPath+\"'\");if(\"JSON\"!==t.modelTopologyType)throw new Error(\"BrowserLocalStorage does not support loading non-JSON model topology yet.\");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error(\"In local storage, the topology of model '\"+this.modelPath+\"' is missing.\");if(e.modelTopology=n,null==(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error(\"In local storage, the weight specs of model '\"+this.modelPath+\"' are missing.\");if(e.weightSpecs=o,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(a),e.format=i.format,e.generatedBy=i.generatedBy,e.convertedBy=i.convertedBy,e.userDefinedMetadata=i.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error(\"In local storage, the binary weight values of model '\"+this.modelPath+\"' are missing.\");return e.weightData=function(t){if(hf){var e=Buffer.from(t,\"base64\");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),o=0;o<n.length;++o)r.set([n.charCodeAt(o)],o);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME=\"localstorage://\",t}(),Lf=function(t){return i().getBool(\"IS_BROWSER\")&&!Array.isArray(t)&&t.startsWith(Pf.URL_SCHEME)?(e=t.slice(Pf.URL_SCHEME.length),new Pf(e)):null;var e};mf.registerSaveRouter(Lf),mf.registerLoadRouter(Lf);var Wf=function(){function t(){C(i().getBool(\"IS_BROWSER\"),(function(){return\"Current environment is not a web browser\"})),C(\"undefined\"==typeof window||void 0!==window.localStorage,(function(){return\"Current browser does not appear to support localStorage\"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return n(this,void 0,void 0,(function(){var t,e,n,o,a,i;return r(this,(function(r){for(t={},e=Df+Af,n=Af+Tf,o=0;o<this.LS.length;++o)(a=this.LS.key(o)).startsWith(e)&&a.endsWith(n)&&(i=Bf(a),t[i]=JSON.parse(this.LS.getItem(a)));return[2,t]}))}))},t.prototype.removeModel=function(t){return n(this,void 0,void 0,(function(){var e,n;return r(this,(function(r){var o;if(t=(o=t).startsWith(Pf.URL_SCHEME)?o.slice(Pf.URL_SCHEME.length):o,e=Mf(t),null==this.LS.getItem(e.info))throw new Error(\"Cannot find model at path '\"+t+\"'\");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(i().getBool(\"IS_BROWSER\"))try{yf.registerManager(Pf.URL_SCHEME,new Wf)}catch(t){}var Uf=\"model\",Vf=\".json\",zf=\".weights.bin\";function Gf(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Hf=function(){function t(e){if(!i().getBool(\"IS_BROWSER\"))throw new Error(\"browserDownloads() cannot proceed because the current environment is not a browser.\");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e=Uf),this.modelTopologyFileName=e+Vf,this.weightDataFileName=e+zf}return t.prototype.save=function(t){return n(this,void 0,void 0,(function(){var e,n,o,a,i,s;return r(this,(function(r){switch(r.label){case 0:if(\"undefined\"==typeof document)throw new Error(\"Browser downloads are not supported in this environment since `document` is not present\");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:\"application/octet-stream\"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error(\"BrowserDownloads.save() does not support saving model topology in binary formats yet.\");case 1:return n=[{paths:[\"./\"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:\"application/json\"})),(i=null==this.jsonAnchor?document.createElement(\"a\"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,Gf((function(){return i.dispatchEvent(new MouseEvent(\"click\"))}))];case 2:return r.sent(),null==t.weightData?[3,4]:((s=null==this.weightDataAnchor?document.createElement(\"a\"):this.weightDataAnchor).download=this.weightDataFileName,s.href=e,[4,Gf((function(){return s.dispatchEvent(new MouseEvent(\"click\"))}))]);case 3:r.sent(),r.label=4;case 4:return[2,{modelArtifactsInfo:vf(t)}]}}))}))},t.URL_SCHEME=\"downloads://\",t}(),qf=function(){function t(t){if(null==t||t.length<1)throw new Error(\"When calling browserFiles, at least 1 file is required, but received \"+t);this.files=t}return t.prototype.load=function(){return n(this,void 0,void 0,(function(){var t,e,n=this;return r(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,o){var a=new FileReader;a.onload=function(a){var i=JSON.parse(a.target.result),s=i.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=i.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void o(t)}var l=[],h=[],f=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),f.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,o=h.indexOf(t);f[o]=n,-1===f.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:df(f),format:i.format,generatedBy:i.generatedBy,convertedBy:i.convertedBy,userDefinedMetadata:i.userDefinedMetadata})},e.onerror=function(e){return o(\"Failed to weights data from file of path '\"+t+\"'.\")},e.readAsArrayBuffer(c[t])}))}))}else o(new Error(\"weightManifest field is missing from file \"+t.name))}else o(new Error(\"modelTopology field is missing from file \"+t.name))},a.onerror=function(e){return o(\"Failed to read model topology and weights manifest JSON from file '\"+t.name+\"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.\")},a.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return pf(t.name)})),o={},a=0,i=t;a<i.length;a++){i[a].paths.forEach((function(t){var a=pf(t);if(-1!==n.indexOf(a))throw new Error(\"Duplicate file basename found in weights manifest: '\"+a+\"'\");if(n.push(a),-1===r.indexOf(a))throw new Error(\"Weight file with basename '\"+a+\"' is not provided.\");o[t]=e[r.indexOf(a)]}))}if(n.length!==e.length)throw new Error(\"Mismatch in the number of files in weights manifest (\"+n.length+\") and the number of weight files provided (\"+e.length+\").\");return o},t}();function Kf(t,e,n,r){!function(t){C(null!=t&&Array.isArray(t)&&t.length>0,(function(){return\"promises must be a none empty array\"}))}(t),function(t,e){C(t>=0&&t<=1,(function(){return\"Progress fraction must be in range [0, 1], but got startFraction \"+t})),C(e>=0&&e<=1,(function(){return\"Progress fraction must be in range [0, 1], but got endFraction \"+e})),C(e>=t,(function(){return\"startFraction must be no more than endFraction, but got startFraction \"+t+\" and endFraction \"+e}))}(n=null==n?0:n,r=null==r?1:r);var o=0;return Promise.all(t.map((function(a){return a.then((function(a){var i=n+ ++o/t.length*(r-n);return e(i),a})),a})))}function jf(t,e){return n(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,h,f;return r(this,(function(r){switch(r.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?i().platform.fetch:e.fetchFunc,o=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),a=0,s=.5,null!=e.onProgress?[3,2]:[4,Promise.all(o)];case 1:return u=r.sent(),[3,4];case 2:return[4,Kf(o,e.onProgress,a,s)];case 3:u=r.sent(),r.label=4;case 4:return c=u.map((function(t){return t.arrayBuffer()})),l=.5,h=1,null!=e.onProgress?[3,6]:[4,Promise.all(c)];case 5:return f=r.sent(),[3,8];case 6:return[4,Kf(c,e.onProgress,l,h)];case 7:f=r.sent(),r.label=8;case 8:return[2,f]}}))}))}function Xf(t){var e=this;return function(o,a,i){return void 0===a&&(a=\"\"),n(e,void 0,void 0,(function(){var e,n,s,u,c,l,h,f,d,p;return r(this,(function(r){switch(r.label){case 0:if(e=o.map((function(){return!1})),n={},s=null!=i?i.map((function(){return!1})):[],u=[],o.forEach((function(t,r){var o=0;t.weights.forEach((function(t){var a=\"quantization\"in t?t.quantization.dtype:t.dtype,c=sf[a]*k(t.shape),l=function(){e[r]=!0,null==n[r]&&(n[r]=[]),n[r].push({manifestEntry:t,groupOffset:o,sizeBytes:c})};null!=i?i.forEach((function(e,n){e===t.name&&(l(),s[n]=!0)})):l(),u.push(t.name),o+=c}))})),!s.every((function(t){return t})))throw c=i.filter((function(t,e){return!s[e]})),new Error(\"Could not find weights in manifest with names: \"+c.join(\", \")+\". \\nManifest JSON has weights with names: \"+u.join(\", \")+\".\");return l=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),h=[],l.forEach((function(t){o[t].paths.forEach((function(t){var e=a+(a.endsWith(\"/\")?\"\":\"/\")+t;h.push(e)}))})),[4,t(h)];case 1:return f=r.sent(),d={},p=0,l.forEach((function(t){for(var e=o[t].paths.length,r=0,a=0;a<e;a++)r+=f[p+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<e;c++){var l=new Uint8Array(f[p+c]);s.set(l,u),u+=l.byteLength}n[t].forEach((function(t){var e=cf(i.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)d[n]=e[n]})),p+=e})),[2,d]}}))}))}}mf.registerSaveRouter((function(t){return i().getBool(\"IS_BROWSER\")&&!Array.isArray(t)&&t.startsWith(Hf.URL_SCHEME)?function(t){void 0===t&&(t=\"model\");return new Hf(t)}(t.slice(Hf.URL_SCHEME.length)):null}));var Yf=function(){function t(t,e){if(this.DEFAULT_METHOD=\"POST\",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(C(\"function\"==typeof e.fetchFunc,(function(){return\"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)\"})),this.fetch=e.fetchFunc):this.fetch=i().platform.fetch,C(null!=t&&t.length>0,(function(){return\"URL path for http must not be null, undefined or empty.\"})),Array.isArray(t)&&C(2===t.length,(function(){return\"URL paths for http must have a length of 2, (actual length is \"+t.length+\").\"})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error(\"requestInit is expected to have no pre-existing body, but has one.\");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return n(this,void 0,void 0,(function(){var e,n,o,a;return r(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error(\"BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.\");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:[\"./model.weights.bin\"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append(\"model.json\",new Blob([JSON.stringify(o)],{type:\"application/json\"}),\"model.json\"),null!=t.weightData&&e.body.append(\"model.weights.bin\",new Blob([t.weightData],{type:\"application/octet-stream\"}),\"model.weights.bin\"),[4,this.fetch(this.path,e)];case 1:if((a=r.sent()).ok)return[2,{modelArtifactsInfo:vf(t),responses:[a]}];throw new Error(\"BrowserHTTPRequest.save() failed due to HTTP response status \"+a.status+\".\")}}))}))},t.prototype.load=function(){return n(this,void 0,void 0,(function(){var t,e,n,o,a,i,s,u,c,l,h,f;return r(this,(function(r){switch(r.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=r.sent()).ok)throw new Error(\"Request to \"+this.path+\" failed with status code \"+t.status+\". Please verify this URL points to the model JSON of the model to load.\");r.label=2;case 2:return r.trys.push([2,4,,5]),[4,t.json()];case 3:return e=r.sent(),[3,5];case 4:throw r.sent(),n=\"Failed to parse model JSON of response from \"+this.path+\".\",this.path.endsWith(\".pb\")?n+=\" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.\":n+=\" Please make sure the server is serving valid JSON for this request.\",new Error(n);case 5:if(o=e.modelTopology,a=e.weightsManifest,i=e.generatedBy,s=e.convertedBy,u=e.format,c=e.userDefinedMetadata,null==o&&null==a)throw new Error(\"The JSON from HTTP path \"+this.path+\" contains neither model topology or manifest for weights.\");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:f=r.sent(),l=f[0],h=f[1],r.label=7;case 7:return[2,{modelTopology:o,weightSpecs:l,weightData:h,userDefinedMetadata:c,generatedBy:i,convertedBy:s,format:u}]}}))}))},t.prototype.loadWeights=function(t){return n(this,void 0,void 0,(function(){var e,n,o,a,i,s,u,c,l,h,f;return r(this,(function(r){switch(r.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf(\"/\"),n=t.lastIndexOf(\"?\"),r=t.substring(0,e),o=n>e?t.substring(n):\"\";return[r+\"/\",o]}(e),o=n[0],a=n[1],i=this.weightPathPrefix||o,s=[],u=0,c=t;u<c.length;u++)l=c[u],s.push.apply(s,l.weights);return h=[],t.forEach((function(t){t.paths.forEach((function(t){h.push(i+t+a)}))})),[4,jf(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=r.sent(),[2,[s,df(f)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\\/\\//,t}();function $f(t){return null!=t.match(Yf.URL_SCHEME_REGEX)}var Qf=function(t,e){if(\"undefined\"==typeof fetch)return null;return(Array.isArray(t)?t.every((function(t){return $f(t)})):$f(t))?Jf(t,{onProgress:e}):null};function Jf(t,e){return new Yf(t,e)}mf.registerSaveRouter(Qf),mf.registerLoadRouter(Qf);var Zf=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),td=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}();var ed=Object.freeze({browserFiles:function(t){return new qf(t)},browserHTTPRequest:function(t,e){return Jf(t,e)},concatenateArrayBuffers:df,decodeWeights:cf,encodeWeights:function(t,e){return n(this,void 0,void 0,(function(){var o,a,i,s,u,c=this;return r(this,(function(l){switch(l.label){case 0:for(o=[],a=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),s=function(s){var u=i[s],l=Array.isArray(t)?t[s].tensor:t[u];if(\"float32\"!==l.dtype&&\"int32\"!==l.dtype&&\"bool\"!==l.dtype&&\"string\"!==l.dtype)throw new Error(\"Unsupported dtype in weight '\"+u+\"': \"+l.dtype);var h={name:u,shape:l.shape,dtype:l.dtype};if(\"string\"===l.dtype){var f=new Promise((function(t){return n(c,void 0,void 0,(function(){var e,n,o,a,i,s,u;return r(this,(function(r){switch(r.label){case 0:return[4,l.bytes()];case 1:for(e=r.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+uf*e.length,o=new Uint8Array(n),a=0,i=0;i<e.length;i++)s=e[i],u=new Uint8Array(new Uint32Array([s.length]).buffer),o.set(u,a),a+=uf,o.set(s,a),a+=s.length;return t(o),[2]}}))}))}));a.push(f)}else a.push(l.data());null!=e&&(h.group=e),o.push(h)},u=0;u<i.length;++u)s(u);return[4,Promise.all(a)];case 1:return[2,{data:lf(l.sent()),specs:o}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Zf(t):(console.warn(\"Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release.\"),new Zf({modelTopology:t})):(console.warn(\"Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release.\"),new Zf({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return mf.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:vf,getSaveHandlers:function(t){return mf.getSaveHandlers(t)},http:Jf,isHTTPScheme:$f,loadWeights:function(t,e,o,a){return void 0===e&&(e=\"\"),n(this,void 0,void 0,(function(){return r(this,(function(n){return[2,Xf((function(t){return jf(t,{requestInit:a})}))(t,e,o)]}))}))},registerLoadRouter:function(t){return mf.registerLoadRouter(t)},registerSaveRouter:function(t){return mf.registerSaveRouter(t)},weightsLoaderFactory:Xf,withSaveHandler:function(t){return new td(t)},copyModel:function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){return!1,[2,bf(t,e,!1)]}))}))},listModels:function(){return n(this,void 0,void 0,(function(){var t,e,n,o,a,i,s;return r(this,(function(r){switch(r.label){case 0:t=yf.getSchemes(),e={},n=0,o=t,r.label=1;case 1:return n<o.length?(a=o[n],[4,yf.getManager(a).listModels()]):[3,4];case 2:for(s in i=r.sent())e[a+gf+s]=i[s];r.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){return!0,[2,bf(t,e,!0)]}))}))},removeModel:function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){return e=xf(t),[2,yf.getManager(e.scheme).removeModel(e.path)]}))}))}});var nd,rd=An({confusionMatrix_:function(t,e,n){var r=mn(t,\"labels\",\"confusionMatrix\"),o=mn(e,\"predictions\",\"confusionMatrix\");C(null==n||n>0&&Number.isInteger(n),(function(){return\"If provided, numClasses must be a positive integer, but got \"+n})),C(1===r.rank,(function(){return\"Expected the rank of labels to be 1, but got \"+r.rank})),C(1===o.rank,(function(){return\"Expected the rank of predictions to be 1, but got \"+o.rank})),C(r.shape[0]===o.shape[0],(function(){return\"Mismatch in the number of examples: \"+r.shape[0]+\" vs. \"+o.shape[0]+\". Labels and predictions should have the same number of elements.\"})),C(n>0&&Number.isInteger(n),(function(){return\"numClasses is required to be a positive integer, but got \"+n}));var a=Rr(r.asType(\"int32\"),n),i=Rr(o.asType(\"int32\"),n);return a.transpose().matMul(i).asType(\"int32\")}}),od=Object.freeze({confusionMatrix:rd});var ad=An({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error(\"Cannot construct Tensor with more than 4 channels from pixels.\");if(null==t)throw new Error(\"pixels passed to tf.browser.fromPixels() can not be null\");var n=!1,r=!1,o=!1,a=!1,i=!1;if(t.data instanceof Uint8Array)n=!0;else if(\"undefined\"!=typeof ImageData&&t instanceof ImageData)r=!0;else if(\"undefined\"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)o=!0;else if(\"undefined\"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else{if(null==t.getContext)throw new Error(\"pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was \"+t.constructor.name);i=!0}if(o){if(o&&t.readyState<2)throw new Error(\"The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.\")}if(null!=l(\"FromPixels\",Lt.backendName))return Lt.runKernel(\"FromPixels\",{pixels:t},{numChannels:e});var s,u,c=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],h=c[0],f=c[1];if(i?s=t.getContext(\"2d\").getImageData(0,0,h,f).data:r||n?s=t.data:(a||o)&&(null==nd&&(nd=document.createElement(\"canvas\").getContext(\"2d\")),nd.canvas.width=h,nd.canvas.height=f,nd.drawImage(t,0,0,h,f),s=nd.getImageData(0,0,h,f).data),4===e)u=new Int32Array(s);else{var d=h*f;u=new Int32Array(d*e);for(var p=0;p<d;p++)for(var v=0;v<e;++v)u[p*e+v]=s[4*p+v]}return Pn(u,[f,h,e],\"int32\")}}),id=Object.freeze({toPixels:function(t,e){return n(this,void 0,void 0,(function(){var n,o,a,i,s,u,c,l,h,f,d,p,v,m,g,y,x,b,w,C,E,R,I;return r(this,(function(r){switch(r.label){case 0:if(n=mn(t,\"img\",\"toPixels\"),t instanceof wt||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error(\"toPixels only supports rank 2 or 3 tensors, got rank \"+n.rank+\".\");if(o=n.shape.slice(0,2),a=o[0],i=o[1],(s=2===n.rank?1:n.shape[2])>4||2===s)throw new Error(\"toPixels only supports depth of size 1, 3 or 4 but got \"+s);return[4,n.data()];case 1:return u=r.sent(),c=n.min(),l=n.max(),[4,Promise.all([c.data(),l.data()])];case 2:if(h=r.sent(),f=h[0],d=h[1],p=f[0],v=d[0],c.dispose(),l.dispose(),\"float32\"===n.dtype){if(p<0||v>1)throw new Error(\"Tensor values for a float32 Tensor must be in the range [0 - 1] but got range [\"+p+\" - \"+v+\"].\")}else{if(\"int32\"!==n.dtype)throw new Error(\"Unsupported type for toPixels: \"+n.dtype+\". Please use float32 or int32 tensors.\");if(p<0||v>255)throw new Error(\"Tensor values for a int32 Tensor must be in the range [0 - 255] but got range [\"+p+\" - \"+v+\"].\")}for(m=\"float32\"===n.dtype?255:1,g=new Uint8ClampedArray(i*a*4),y=0;y<a*i;++y)x=void 0,b=void 0,w=void 0,C=void 0,1===s?(x=u[y]*m,b=u[y]*m,w=u[y]*m,C=255):3===s?(x=u[3*y]*m,b=u[3*y+1]*m,w=u[3*y+2]*m,C=255):4===s&&(x=u[4*y]*m,b=u[4*y+1]*m,w=u[4*y+2]*m,C=u[4*y+3]*m),g[(E=4*y)+0]=Math.round(x),g[E+1]=Math.round(b),g[E+2]=Math.round(w),g[E+3]=Math.round(C);return null!=e&&(e.width=i,e.height=a,R=e.getContext(\"2d\"),I=new ImageData(g,i,a),R.putImageData(I,0,0)),n!==t&&n.dispose(),[2,g]}}))}))},fromPixels:ad}),sd=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),ud=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function cd(t){C(null!=t.className,(function(){return\"Class being registered does not have the static className property defined.\"})),C(\"string\"==typeof t.className,(function(){return\"className is required to be a string, but got type \"+typeof t.className})),C(t.className.length>0,(function(){return\"Class being registered has an empty-string as its className, which is disallowed.\"})),ud.register(t)}var ld=Object.freeze({Serializable:sd,SerializationMap:ud,registerClass:cd}),hd=.001,fd=.1;function dd(){return 32===Lt.backend.floatPrecision()?hd:fd}function pd(t,e,n){var r=!0;if((V(t)||V(e))&&(r=!1),V(t)&&V(e)&&(r=!0),r){var o=t.constructor.name,a=e.constructor.name;if(o!==a)throw new Error(\"Arrays are of different type. Actual: \"+o+\". Expected: \"+a)}if(Array.isArray(t)&&Array.isArray(e)){var i=pn(t),s=pn(e);if(!S(i,s))throw new Error(\"Arrays have different shapes. Actual: [\"+i+\"]. Expected: [\"+s+\"]\")}var u=V(t)?t:I(t),c=V(e)?e:I(e);if(u.length!==c.length)throw new Error(\"Arrays have different lengths actual: \"+u.length+\" vs expected: \"+c.length+\".\\nActual:   \"+u+\".\\nExpected: \"+c+\".\");for(var l=0;l<c.length;++l){var h=u[l],f=c[l];if(!n(h,f))throw new Error(\"Arrays differ: actual[\"+l+\"] = \"+h+\", expected[\"+l+\"] = \"+f+\".\\nActual:   \"+u+\".\\nExpected: \"+c+\".\")}}function vd(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}var md=Object.freeze({TEST_EPSILON_FLOAT16:fd,expectArraysClose:function(t,e,n){return null==n&&(n=dd()),pd(t,e,(function(t,e){return vd(t,e,n)}))},testEpsilon:dd,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n=\"string\"==typeof e||\"number\"==typeof e||\"boolean\"==typeof e?[e]:e;return H(t)||H(t[0])||H(e)||H(e[0])?pd(t,n,(function(t,e){return t==e})):pd(t,e,(function(t,e){return vd(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=dd()),!vd(t,e,n))throw new Error(\"Numbers differ: actual === \"+t+\", expected === \"+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(\"Value out of range:\"+t[r]+\" low: \"+e+\", high: \"+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),gd=\"1.7.0\";var yd=Object.freeze({gpgpu_util:Mi,webgl_util:Ge,forceHalfFloat:function(){i().set(\"WEBGL_FORCE_F16_TEXTURES\",!0)},MathBackendWebGL:Zs,setWebGLContext:Kt,GPGPUContext:Bi}),xd=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return e(o,t),o.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),o=r.value,a=r.grads;if(null!=n){var i=n.map((function(t){return{name:t.name,tensor:a[t.name]}}));this.applyGradients(i)}else this.applyGradients(a);return tn(a),e?o:(o.dispose(),null)},Object.defineProperty(o.prototype,\"iterations\",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),o.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},o.prototype.computeGradients=function(t,e){return po(t,e)},o.prototype.dispose=function(){null!=this.iterations_&&tn(this.iterations_)},o.prototype.saveIterations=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:\"iter\",tensor:On(this.iterations_,\"int32\")}]}))}))},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){throw new Error(\"getWeights() is not implemented for this optimizer yet.\")}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(t){throw new Error(\"setWeights() is not implemented for this optimizer class \"+this.getClassName())}))}))},o.prototype.extractIterations=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},o}(sd);Object.defineProperty(xd,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var bd=function(t){function o(e,n,r){void 0===r&&(r=null);var o=t.call(this)||this;return o.learningRate=e,o.rho=n,o.epsilon=r,o.accumulatedGrads=[],o.accumulatedUpdates=[],null==r&&(o.epsilon=Lt.backend.epsilon()),o}return e(o,t),o.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var o=Lt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+\"/accum_grad\",variable:Ze((function(){return Xn(o).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+\"/accum_var\",variable:Ze((function(){return Xn(o).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var i=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;Ze((function(){var t=i.mul(e.rho).add(a.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(i.add(e.epsilon).sqrt()).mul(a),r=s.mul(e.rho).add(n.square().mul(1-e.rho));i.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(o);o.assign(u)}))}})),this.incrementIterations()},o.prototype.dispose=function(){null!=this.accumulatedUpdates&&(tn(this.accumulatedGrads.map((function(t){return t.variable}))),tn(this.accumulatedUpdates.map((function(t){return t.variable}))))},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,!1,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},o.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},o.className=\"Adadelta\",o}(xd);cd(bd);var wd=function(t){function o(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return e(o,t),o.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var o=Lt.registeredVariables[n];if(null==e.accumulatedGrads[r]){e.accumulatedGrads[r]={originalName:n+\"/accumulator\",variable:Ze((function(){return Hn(o.shape,e.initialAccumulatorValue).variable(!1)}))}}var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var i=e.accumulatedGrads[r].variable;Ze((function(){var t=i.add(a.square());i.assign(t);var n=a.div(t.add(Lt.backend.epsilon()).sqrt()).mul(-e.learningRate).add(o);o.assign(n)}))}})),this.incrementIterations()},o.prototype.dispose=function(){null!=this.accumulatedGrads&&tn(this.accumulatedGrads.map((function(t){return t.variable})))},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),!1,this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},o.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},o.className=\"Adagrad\",o}(xd);cd(wd);var Cd=function(t){function o(e,n,r,o){void 0===o&&(o=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=o,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Ze((function(){a.accBeta1=On(n).variable(),a.accBeta2=On(r).variable()})),null==o&&(a.epsilon=Lt.backend.epsilon()),a}return e(o,t),o.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Ze((function(){var r=Cc(1,e.accBeta1),o=Cc(1,e.accBeta2);n.forEach((function(n,a){var i=Lt.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:n+\"/m\",variable:Ze((function(){return Xn(i).variable(!1)}))}),null==e.accumulatedSecondMoment[a]&&(e.accumulatedSecondMoment[a]={originalName:n+\"/v\",variable:Ze((function(){return Xn(i).variable(!1)}))});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedSecondMoment[a].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),f=l.div(r),d=h.div(o);u.assign(l),c.assign(h);var p=f.div(d.sqrt().add(e.epsilon)).mul(-e.learningRate).add(i);i.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},o.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&tn(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&tn(this.accumulatedSecondMoment.map((function(t){return t.variable})))},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){var e,n=this;return r(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),Ze((function(){n.accBeta1.assign(xc(n.beta1,n.iterations_+1)),n.accBeta2.assign(xc(n.beta2,n.iterations_+1))})),e=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},o.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},o.className=\"Adam\",o}(xd);cd(Cd);var Ed=function(t){function o(e,n,r,o,a){void 0===o&&(o=null),void 0===a&&(a=0);var i=t.call(this)||this;return i.learningRate=e,i.beta1=n,i.beta2=r,i.epsilon=o,i.decay=a,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Ze((function(){i.iteration=On(0).variable(),i.accBeta1=On(n).variable()})),null==o&&(i.epsilon=Lt.backend.epsilon()),i}return e(o,t),o.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Ze((function(){var r=Cc(1,e.accBeta1),o=sc(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,a){var i=Lt.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:n+\"/m\",variable:Xn(i).variable(!1)}),null==e.accumulatedWeightedInfNorm[a]&&(e.accumulatedWeightedInfNorm[a]={originalName:n+\"/v\",variable:Xn(i).variable(!1)});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedWeightedInfNorm[a].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2),f=s.abs(),d=h.maximum(f);u.assign(l),c.assign(d);var p=o.div(r).mul(l.div(d.add(e.epsilon))).add(i);i.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},o.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&tn(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&tn(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){throw new Error(\"getWeights() is not implemented for Adamax yet.\")}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(t){throw new Error(\"setWeights() is not implemented for Adamax yet.\")}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},o.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},o.className=\"Adamax\",o}(xd);cd(Ed);var Rd=function(t){function o(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return e(o,t),o.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=Lt.registeredVariables[n];Ze((function(){var t=e.c.mul(o).add(a);a.assign(t)}))}})),this.incrementIterations()},o.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=en(On(-t))},o.prototype.dispose=function(){this.c.dispose()},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error(\"SGD optimizer does not have settable weights.\");return[2]}}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate}},o.fromConfig=function(t,e){return new t(e.learningRate)},o.className=\"SGD\",o}(xd);cd(Rd);var Id=function(t){function o(e,n,r){void 0===r&&(r=!1);var o=t.call(this,e)||this;return o.learningRate=e,o.momentum=n,o.useNesterov=r,o.accumulations=[],o.m=On(o.momentum),o}return e(o,t),o.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var o=Lt.registeredVariables[n];if(null==e.accumulations[r]){e.accumulations[r]={originalName:n+\"/momentum\",variable:Ze((function(){return Xn(o).variable(!1)}))}}var a=e.accumulations[r].variable,i=Array.isArray(t)?t[r].tensor:t[n];null!=i&&Ze((function(){var t,n=e.m.mul(a).add(i);t=e.useNesterov?e.c.mul(i.add(n.mul(e.m))).add(o):e.c.mul(n).add(o),a.assign(n),o.assign(t)}))})),this.incrementIterations()},o.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&tn(this.accumulations.map((function(t){return t.variable})))},o.prototype.setMomentum=function(t){this.momentum=t},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),!1,this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},o.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},o.className=\"Momentum\",o}(Rd);cd(Id);var kd=function(t){function o(e,n,r,o,a){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===a&&(a=!1);var i=t.call(this)||this;if(i.learningRate=e,i.decay=n,i.momentum=r,i.epsilon=o,i.accumulatedMeanSquares=[],i.accumulatedMoments=[],i.accumulatedMeanGrads=[],i.centered=a,null==o&&(i.epsilon=Lt.backend.epsilon()),null==e)throw new Error(\"learningRate for RMSPropOptimizer must be defined.\");return i}return e(o,t),o.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var o=Lt.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+\"/rms\",variable:Ze((function(){return Xn(o).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+\"/momentum\",variable:Ze((function(){return Xn(o).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+\"/mg\",variable:Ze((function(){return Xn(o).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var i=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;Ze((function(){var t=i.mul(e.decay).add(a.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(a.mul(1-e.decay)),c=s.mul(e.momentum).add(a.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));i.assign(t),n.assign(u),s.assign(c);var l=o.sub(c);o.assign(l)}else{var h=i.mul(e.decay).add(a.square().mul(1-e.decay));c=s.mul(e.momentum).add(a.mul(e.learningRate).div(h.add(e.epsilon).sqrt()));i.assign(h),s.assign(c);l=o.sub(c);o.assign(l)}}))}})),this.incrementIterations()},o.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&tn(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&tn(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&tn(this.accumulatedMoments.map((function(t){return t.variable})))},o.prototype.getWeights=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},o.prototype.setWeights=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=this.centered?t.length/3:t.length/2,!1,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},o.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},o.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},o.className=\"RMSProp\",o}(xd);cd(kd);var Sd=function(){function t(){}return t.sgd=function(t){return new Rd(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new Id(t,e,n)},t.rmsprop=function(t,e,n,r,o){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===o&&(o=!1),new kd(t,e,n,r,o)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new Cd(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new bd(t,e,n)},t.adamax=function(t,e,n,r,o){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===o&&(o=0),new Ed(t,e,n,r,o)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new wd(t,e)},t}(),Ad={sgd:Sd.sgd,momentum:Sd.momentum,adadelta:Sd.adadelta,adagrad:Sd.adagrad,rmsprop:Sd.rmsprop,adamax:Sd.adamax,adam:Sd.adam},Dd=\"undefined\"!=typeof requestAnimationFrame?requestAnimationFrame:\"undefined\"!=typeof setImmediate?setImmediate:function(t){return t()};function Td(){return new Promise((function(t){return Dd((function(){return t()}))}))}wt.prototype.squaredDifference=function(t){return nu(this,t)},xt=Gh;export{bd as AdadeltaOptimizer,wd as AdagradOptimizer,Cd as AdamOptimizer,Ed as AdamaxOptimizer,xo as DataStorage,s as ENV,o as Environment,bo as KernelBackend,Id as MomentumOptimizer,xd as Optimizer,kd as RMSPropOptimizer,Ct as Rank,ch as Reduction,Rd as SGDOptimizer,wt as Tensor,gt as TensorBuffer,St as Variable,ru as abs,ou as acos,au as acosh,rc as add,oc as addN,ac as addStrict,Cl as all,El as any,Rl as argMax,Il as argMin,iu as asin,su as asinh,uu as atan,ic as atan2,cu as atanh,fl as avgPool,vl as avgPool3d,hn as backend,Uo as backend_util,zl as basicLSTMCell,ju as batchNorm,Xu as batchNorm2d,Yu as batchNorm3d,$u as batchNorm4d,Ku as batchNormalization,Gu as batchNormalization2d,Hu as batchNormalization3d,qu as batchNormalization4d,vr as batchToSpaceND,Uc as booleanMaskAsync,mr as broadcastTo,id as browser,dr as buffer,gr as cast,lu as ceil,hu as clipByValue,yr as clone,Dn as complex,Yn as concat,$n as concat1d,Qn as concat2d,Jn as concat3d,Zn as concat4d,Hc as conv1d,qc as conv2d,Zc as conv2dTranspose,Kc as conv3d,tl as conv3dTranspose,fu as cos,du as cosh,xr as cumsum,vo as customGrad,Xe as deprecationWarn,br as depthToSpace,Yc as depthwiseConv2d,eh as diag,je as disableDeprecationWarnings,tn as dispose,Ye as disposeVariables,sc as div,uc as divNoNan,cc as divStrict,nl as dot,nh as dropout,_l as elu,Ke as enableDebugMode,qe as enableProdMode,$e as engine,i as env,Rc as equal,Ic as equalStrict,pu as erf,vu as exp,wr as expandDims,mu as expm1,Cr as eye,Xl as fft,Hn as fill,un as findBackend,cn as findBackendFactory,gu as floor,lc as floorDiv,ih as frame,zh as fused,Lc as gather,th as gatherND,Xr as gather_util,an as getBackend,h as getGradient,l as getKernel,f as getKernelsForBackend,co as grad,lo as grads,kc as greater,Sc as greaterEqual,Ac as greaterEqualStrict,Dc as greaterStrict,ah as hammingWindow,oh as hannWindow,Yl as ifft,Nn as imag,Oh as image,lh as inTopKAsync,ed as io,Ql as irfft,Du as isFinite,Au as isInf,Su as isNaN,en as keep,Ol as leakyRelu,Tc as less,Nc as lessEqual,Fc as lessEqualStrict,_c as lessStrict,Ih as linalg,qn as linspace,Ul as localResponseNormalization,yu as log,xu as log1p,bu as logSigmoid,yo as logSoftmax,kl as logSumExp,Qu as logicalAnd,Ju as logicalNot,Zu as logicalOr,tc as logicalXor,bh as losses,el as matMul,od as math,Sl as max,hl as maxPool,pl as maxPool3d,hc as maximum,fc as maximumStrict,Al as mean,Qe as memory,Dl as min,dc as minimum,pc as minimumStrict,vc as mod,mc as modStrict,Tl as moments,Hl as movingAverage,gc as mul,yc as mulStrict,Gl as multiRNNCell,Er as multinomial,wu as neg,Td as nextFrame,Vl as norm,Oc as notEqual,Mc as notEqualStrict,Rr as oneHot,zn as ones,jn as onesLike,An as op,rl as outerProduct,Ir as pad,kr as pad1d,Sr as pad2d,Ar as pad3d,Dr as pad4d,dl as pool,xc as pow,bc as powStrict,Ml as prelu,pr as print,Fl as prod,Je as profile,Tr as rand,Fr as randomGamma,Nr as randomNormal,_r as randomUniform,Kn as range,on as ready,Tn as real,Cu as reciprocal,ln as registerBackend,p as registerGradient,d as registerKernel,Bl as relu,Pl as relu6,sn as removeBackend,Or as reshape,ol as reverse,al as reverse1d,il as reverse2d,sl as reverse3d,ul as reverse4d,$l as rfft,Eu as round,Ru as rsqrt,On as scalar,jl as scatterND,to as scatter_util,Ll as selu,Jc as separableConv2d,ld as serialization,rn as setBackend,fn as setPlatform,Vr as setdiff1dAsync,Iu as sigmoid,ku as sign,uh as signal,Tu as sin,Nu as sinh,ml as slice,gl as slice1d,yl as slice2d,xl as slice3d,bl as slice4d,uo as slice_util,go as softmax,Fu as softplus,Mr as spaceToBatchND,Zl as sparseToDense,Jl as spectral,tr as split,_u as sqrt,tu as square,nu as squaredDifference,wc as squaredDifferenceStrict,Br as squeeze,Pr as stack,Ou as step,sh as stft,ql as stridedSlice,Cc as sub,Ec as subStrict,Nl as sum,Tt as sumOutType,Mu as tan,Bu as tanh,Fn as tensor,Mn as tensor1d,Bn as tensor2d,Pn as tensor3d,Ln as tensor4d,Wn as tensor5d,Un as tensor6d,Mt as tensor_util,md as test_util,Ze as tidy,Lr as tile,nn as time,Kl as topk,Ad as train,Wl as transpose,Wr as truncatedNormal,m as unregisterGradient,v as unregisterKernel,Wc as unsortedSegmentSum,Ur as unstack,st as util,ho as valueAndGrad,fo as valueAndGrads,Vn as variable,po as variableGrads,gd as version_core,yd as webgl,ec as where,nc as whereAsync,Gn as zeros,Xn as zerosLike};\n//# sourceMappingURL=tf-core.esm.js.map\n","import { isValidNumber } from '../utils';\r\nvar Dimensions = /** @class */ (function () {\r\n    function Dimensions(width, height) {\r\n        if (!isValidNumber(width) || !isValidNumber(height)) {\r\n            throw new Error(\"Dimensions.constructor - expected width and height to be valid numbers, instead have \" + JSON.stringify({ width: width, height: height }));\r\n        }\r\n        this._width = width;\r\n        this._height = height;\r\n    }\r\n    Object.defineProperty(Dimensions.prototype, \"width\", {\r\n        get: function () { return this._width; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Dimensions.prototype, \"height\", {\r\n        get: function () { return this._height; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Dimensions.prototype.reverse = function () {\r\n        return new Dimensions(1 / this.width, 1 / this.height);\r\n    };\r\n    return Dimensions;\r\n}());\r\nexport { Dimensions };\r\n//# sourceMappingURL=Dimensions.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { Point } from '../classes';\r\nimport { Dimensions } from '../classes/Dimensions';\r\nexport function isTensor(tensor, dim) {\r\n    return tensor instanceof tf.Tensor && tensor.shape.length === dim;\r\n}\r\nexport function isTensor1D(tensor) {\r\n    return isTensor(tensor, 1);\r\n}\r\nexport function isTensor2D(tensor) {\r\n    return isTensor(tensor, 2);\r\n}\r\nexport function isTensor3D(tensor) {\r\n    return isTensor(tensor, 3);\r\n}\r\nexport function isTensor4D(tensor) {\r\n    return isTensor(tensor, 4);\r\n}\r\nexport function isFloat(num) {\r\n    return num % 1 !== 0;\r\n}\r\nexport function isEven(num) {\r\n    return num % 2 === 0;\r\n}\r\nexport function round(num, prec) {\r\n    if (prec === void 0) { prec = 2; }\r\n    var f = Math.pow(10, prec);\r\n    return Math.floor(num * f) / f;\r\n}\r\nexport function isDimensions(obj) {\r\n    return obj && obj.width && obj.height;\r\n}\r\nexport function computeReshapedDimensions(_a, inputSize) {\r\n    var width = _a.width, height = _a.height;\r\n    var scale = inputSize / Math.max(height, width);\r\n    return new Dimensions(Math.round(width * scale), Math.round(height * scale));\r\n}\r\nexport function getCenterPoint(pts) {\r\n    return pts.reduce(function (sum, pt) { return sum.add(pt); }, new Point(0, 0))\r\n        .div(new Point(pts.length, pts.length));\r\n}\r\nexport function range(num, start, step) {\r\n    return Array(num).fill(0).map(function (_, i) { return start + (i * step); });\r\n}\r\nexport function isValidNumber(num) {\r\n    return !!num && num !== Infinity && num !== -Infinity && !isNaN(num) || num === 0;\r\n}\r\nexport function isValidProbablitiy(num) {\r\n    return isValidNumber(num) && 0 <= num && num <= 1.0;\r\n}\r\n//# sourceMappingURL=index.js.map","var Point = /** @class */ (function () {\r\n    function Point(x, y) {\r\n        this._x = x;\r\n        this._y = y;\r\n    }\r\n    Object.defineProperty(Point.prototype, \"x\", {\r\n        get: function () { return this._x; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Point.prototype, \"y\", {\r\n        get: function () { return this._y; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Point.prototype.add = function (pt) {\r\n        return new Point(this.x + pt.x, this.y + pt.y);\r\n    };\r\n    Point.prototype.sub = function (pt) {\r\n        return new Point(this.x - pt.x, this.y - pt.y);\r\n    };\r\n    Point.prototype.mul = function (pt) {\r\n        return new Point(this.x * pt.x, this.y * pt.y);\r\n    };\r\n    Point.prototype.div = function (pt) {\r\n        return new Point(this.x / pt.x, this.y / pt.y);\r\n    };\r\n    Point.prototype.abs = function () {\r\n        return new Point(Math.abs(this.x), Math.abs(this.y));\r\n    };\r\n    Point.prototype.magnitude = function () {\r\n        return Math.sqrt(Math.pow(this.x, 2) + Math.pow(this.y, 2));\r\n    };\r\n    Point.prototype.floor = function () {\r\n        return new Point(Math.floor(this.x), Math.floor(this.y));\r\n    };\r\n    return Point;\r\n}());\r\nexport { Point };\r\n//# sourceMappingURL=Point.js.map","import { isDimensions, isValidNumber } from '../utils';\r\nimport { Point } from './Point';\r\nvar Box = /** @class */ (function () {\r\n    function Box(_box, allowNegativeDimensions) {\r\n        if (allowNegativeDimensions === void 0) { allowNegativeDimensions = true; }\r\n        var box = (_box || {});\r\n        var isBbox = [box.left, box.top, box.right, box.bottom].every(isValidNumber);\r\n        var isRect = [box.x, box.y, box.width, box.height].every(isValidNumber);\r\n        if (!isRect && !isBbox) {\r\n            throw new Error(\"Box.constructor - expected box to be IBoundingBox | IRect, instead have \" + JSON.stringify(box));\r\n        }\r\n        var _a = isRect\r\n            ? [box.x, box.y, box.width, box.height]\r\n            : [box.left, box.top, box.right - box.left, box.bottom - box.top], x = _a[0], y = _a[1], width = _a[2], height = _a[3];\r\n        Box.assertIsValidBox({ x: x, y: y, width: width, height: height }, 'Box.constructor', allowNegativeDimensions);\r\n        this._x = x;\r\n        this._y = y;\r\n        this._width = width;\r\n        this._height = height;\r\n    }\r\n    Box.isRect = function (rect) {\r\n        return !!rect && [rect.x, rect.y, rect.width, rect.height].every(isValidNumber);\r\n    };\r\n    Box.assertIsValidBox = function (box, callee, allowNegativeDimensions) {\r\n        if (allowNegativeDimensions === void 0) { allowNegativeDimensions = false; }\r\n        if (!Box.isRect(box)) {\r\n            throw new Error(callee + \" - invalid box: \" + JSON.stringify(box) + \", expected object with properties x, y, width, height\");\r\n        }\r\n        if (!allowNegativeDimensions && (box.width < 0 || box.height < 0)) {\r\n            throw new Error(callee + \" - width (\" + box.width + \") and height (\" + box.height + \") must be positive numbers\");\r\n        }\r\n    };\r\n    Object.defineProperty(Box.prototype, \"x\", {\r\n        get: function () { return this._x; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"y\", {\r\n        get: function () { return this._y; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"width\", {\r\n        get: function () { return this._width; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"height\", {\r\n        get: function () { return this._height; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"left\", {\r\n        get: function () { return this.x; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"top\", {\r\n        get: function () { return this.y; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"right\", {\r\n        get: function () { return this.x + this.width; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"bottom\", {\r\n        get: function () { return this.y + this.height; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"area\", {\r\n        get: function () { return this.width * this.height; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"topLeft\", {\r\n        get: function () { return new Point(this.left, this.top); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"topRight\", {\r\n        get: function () { return new Point(this.right, this.top); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"bottomLeft\", {\r\n        get: function () { return new Point(this.left, this.bottom); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Box.prototype, \"bottomRight\", {\r\n        get: function () { return new Point(this.right, this.bottom); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Box.prototype.round = function () {\r\n        var _a = [this.x, this.y, this.width, this.height]\r\n            .map(function (val) { return Math.round(val); }), x = _a[0], y = _a[1], width = _a[2], height = _a[3];\r\n        return new Box({ x: x, y: y, width: width, height: height });\r\n    };\r\n    Box.prototype.floor = function () {\r\n        var _a = [this.x, this.y, this.width, this.height]\r\n            .map(function (val) { return Math.floor(val); }), x = _a[0], y = _a[1], width = _a[2], height = _a[3];\r\n        return new Box({ x: x, y: y, width: width, height: height });\r\n    };\r\n    Box.prototype.toSquare = function () {\r\n        var _a = this, x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n        var diff = Math.abs(width - height);\r\n        if (width < height) {\r\n            x -= (diff / 2);\r\n            width += diff;\r\n        }\r\n        if (height < width) {\r\n            y -= (diff / 2);\r\n            height += diff;\r\n        }\r\n        return new Box({ x: x, y: y, width: width, height: height });\r\n    };\r\n    Box.prototype.rescale = function (s) {\r\n        var scaleX = isDimensions(s) ? s.width : s;\r\n        var scaleY = isDimensions(s) ? s.height : s;\r\n        return new Box({\r\n            x: this.x * scaleX,\r\n            y: this.y * scaleY,\r\n            width: this.width * scaleX,\r\n            height: this.height * scaleY\r\n        });\r\n    };\r\n    Box.prototype.pad = function (padX, padY) {\r\n        var _a = [\r\n            this.x - (padX / 2),\r\n            this.y - (padY / 2),\r\n            this.width + padX,\r\n            this.height + padY\r\n        ], x = _a[0], y = _a[1], width = _a[2], height = _a[3];\r\n        return new Box({ x: x, y: y, width: width, height: height });\r\n    };\r\n    Box.prototype.clipAtImageBorders = function (imgWidth, imgHeight) {\r\n        var _a = this, x = _a.x, y = _a.y, right = _a.right, bottom = _a.bottom;\r\n        var clippedX = Math.max(x, 0);\r\n        var clippedY = Math.max(y, 0);\r\n        var newWidth = right - clippedX;\r\n        var newHeight = bottom - clippedY;\r\n        var clippedWidth = Math.min(newWidth, imgWidth - clippedX);\r\n        var clippedHeight = Math.min(newHeight, imgHeight - clippedY);\r\n        return (new Box({ x: clippedX, y: clippedY, width: clippedWidth, height: clippedHeight })).floor();\r\n    };\r\n    Box.prototype.shift = function (sx, sy) {\r\n        var _a = this, width = _a.width, height = _a.height;\r\n        var x = this.x + sx;\r\n        var y = this.y + sy;\r\n        return new Box({ x: x, y: y, width: width, height: height });\r\n    };\r\n    Box.prototype.padAtBorders = function (imageHeight, imageWidth) {\r\n        var w = this.width + 1;\r\n        var h = this.height + 1;\r\n        var dx = 1;\r\n        var dy = 1;\r\n        var edx = w;\r\n        var edy = h;\r\n        var x = this.left;\r\n        var y = this.top;\r\n        var ex = this.right;\r\n        var ey = this.bottom;\r\n        if (ex > imageWidth) {\r\n            edx = -ex + imageWidth + w;\r\n            ex = imageWidth;\r\n        }\r\n        if (ey > imageHeight) {\r\n            edy = -ey + imageHeight + h;\r\n            ey = imageHeight;\r\n        }\r\n        if (x < 1) {\r\n            edy = 2 - x;\r\n            x = 1;\r\n        }\r\n        if (y < 1) {\r\n            edy = 2 - y;\r\n            y = 1;\r\n        }\r\n        return { dy: dy, edy: edy, dx: dx, edx: edx, y: y, ey: ey, x: x, ex: ex, w: w, h: h };\r\n    };\r\n    Box.prototype.calibrate = function (region) {\r\n        return new Box({\r\n            left: this.left + (region.left * this.width),\r\n            top: this.top + (region.top * this.height),\r\n            right: this.right + (region.right * this.width),\r\n            bottom: this.bottom + (region.bottom * this.height)\r\n        }).toSquare().round();\r\n    };\r\n    return Box;\r\n}());\r\nexport { Box };\r\n//# sourceMappingURL=Box.js.map","import { __extends } from \"tslib\";\r\nimport { Box } from './Box';\r\nvar BoundingBox = /** @class */ (function (_super) {\r\n    __extends(BoundingBox, _super);\r\n    function BoundingBox(left, top, right, bottom, allowNegativeDimensions) {\r\n        if (allowNegativeDimensions === void 0) { allowNegativeDimensions = false; }\r\n        return _super.call(this, { left: left, top: top, right: right, bottom: bottom }, allowNegativeDimensions) || this;\r\n    }\r\n    return BoundingBox;\r\n}(Box));\r\nexport { BoundingBox };\r\n//# sourceMappingURL=BoundingBox.js.map","import { Box } from './Box';\r\nimport { Dimensions } from './Dimensions';\r\nvar ObjectDetection = /** @class */ (function () {\r\n    function ObjectDetection(score, classScore, className, relativeBox, imageDims) {\r\n        this._imageDims = new Dimensions(imageDims.width, imageDims.height);\r\n        this._score = score;\r\n        this._classScore = classScore;\r\n        this._className = className;\r\n        this._box = new Box(relativeBox).rescale(this._imageDims);\r\n    }\r\n    Object.defineProperty(ObjectDetection.prototype, \"score\", {\r\n        get: function () { return this._score; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"classScore\", {\r\n        get: function () { return this._classScore; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"className\", {\r\n        get: function () { return this._className; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"box\", {\r\n        get: function () { return this._box; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"imageDims\", {\r\n        get: function () { return this._imageDims; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"imageWidth\", {\r\n        get: function () { return this.imageDims.width; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"imageHeight\", {\r\n        get: function () { return this.imageDims.height; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ObjectDetection.prototype, \"relativeBox\", {\r\n        get: function () { return new Box(this._box).rescale(this.imageDims.reverse()); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ObjectDetection.prototype.forSize = function (width, height) {\r\n        return new ObjectDetection(this.score, this.classScore, this.className, this.relativeBox, { width: width, height: height });\r\n    };\r\n    return ObjectDetection;\r\n}());\r\nexport { ObjectDetection };\r\n//# sourceMappingURL=ObjectDetection.js.map","import { __extends } from \"tslib\";\r\nimport { ObjectDetection } from './ObjectDetection';\r\nvar FaceDetection = /** @class */ (function (_super) {\r\n    __extends(FaceDetection, _super);\r\n    function FaceDetection(score, relativeBox, imageDims) {\r\n        return _super.call(this, score, score, '', relativeBox, imageDims) || this;\r\n    }\r\n    FaceDetection.prototype.forSize = function (width, height) {\r\n        var _a = _super.prototype.forSize.call(this, width, height), score = _a.score, relativeBox = _a.relativeBox, imageDims = _a.imageDims;\r\n        return new FaceDetection(score, relativeBox, imageDims);\r\n    };\r\n    return FaceDetection;\r\n}(ObjectDetection));\r\nexport { FaceDetection };\r\n//# sourceMappingURL=FaceDetection.js.map","export function iou(box1, box2, isIOU) {\r\n    if (isIOU === void 0) { isIOU = true; }\r\n    var width = Math.max(0.0, Math.min(box1.right, box2.right) - Math.max(box1.left, box2.left));\r\n    var height = Math.max(0.0, Math.min(box1.bottom, box2.bottom) - Math.max(box1.top, box2.top));\r\n    var interSection = width * height;\r\n    return isIOU\r\n        ? interSection / (box1.area + box2.area - interSection)\r\n        : interSection / Math.min(box1.area, box2.area);\r\n}\r\n//# sourceMappingURL=iou.js.map","import { BoundingBox } from '../classes';\r\nexport function minBbox(pts) {\r\n    var xs = pts.map(function (pt) { return pt.x; });\r\n    var ys = pts.map(function (pt) { return pt.y; });\r\n    var minX = xs.reduce(function (min, x) { return x < min ? x : min; }, Infinity);\r\n    var minY = ys.reduce(function (min, y) { return y < min ? y : min; }, Infinity);\r\n    var maxX = xs.reduce(function (max, x) { return max < x ? x : max; }, 0);\r\n    var maxY = ys.reduce(function (max, y) { return max < y ? y : max; }, 0);\r\n    return new BoundingBox(minX, minY, maxX, maxY);\r\n}\r\n//# sourceMappingURL=minBbox.js.map","import { iou } from './iou';\r\nexport function nonMaxSuppression(boxes, scores, iouThreshold, isIOU) {\r\n    if (isIOU === void 0) { isIOU = true; }\r\n    var indicesSortedByScore = scores\r\n        .map(function (score, boxIndex) { return ({ score: score, boxIndex: boxIndex }); })\r\n        .sort(function (c1, c2) { return c1.score - c2.score; })\r\n        .map(function (c) { return c.boxIndex; });\r\n    var pick = [];\r\n    var _loop_1 = function () {\r\n        var curr = indicesSortedByScore.pop();\r\n        pick.push(curr);\r\n        var indices = indicesSortedByScore;\r\n        var outputs = [];\r\n        for (var i = 0; i < indices.length; i++) {\r\n            var idx = indices[i];\r\n            var currBox = boxes[curr];\r\n            var idxBox = boxes[idx];\r\n            outputs.push(iou(currBox, idxBox, isIOU));\r\n        }\r\n        indicesSortedByScore = indicesSortedByScore.filter(function (_, j) { return outputs[j] <= iouThreshold; });\r\n    };\r\n    while (indicesSortedByScore.length > 0) {\r\n        _loop_1();\r\n    }\r\n    return pick;\r\n}\r\n//# sourceMappingURL=nonMaxSuppression.js.map","import { __spreadArrays } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nexport function normalize(x, meanRgb) {\r\n    return tf.tidy(function () {\r\n        var r = meanRgb[0], g = meanRgb[1], b = meanRgb[2];\r\n        var avg_r = tf.fill(__spreadArrays(x.shape.slice(0, 3), [1]), r);\r\n        var avg_g = tf.fill(__spreadArrays(x.shape.slice(0, 3), [1]), g);\r\n        var avg_b = tf.fill(__spreadArrays(x.shape.slice(0, 3), [1]), b);\r\n        var avg_rgb = tf.concat([avg_r, avg_g, avg_b], 3);\r\n        return tf.sub(x, avg_rgb);\r\n    });\r\n}\r\n//# sourceMappingURL=normalize.js.map","import * as tf from '@tensorflow/tfjs-core';\r\n/**\r\n * Pads the smaller dimension of an image tensor with zeros, such that width === height.\r\n *\r\n * @param imgTensor The image tensor.\r\n * @param isCenterImage (optional, default: false) If true, add an equal amount of padding on\r\n * both sides of the minor dimension oof the image.\r\n * @returns The padded tensor with width === height.\r\n */\r\nexport function padToSquare(imgTensor, isCenterImage) {\r\n    if (isCenterImage === void 0) { isCenterImage = false; }\r\n    return tf.tidy(function () {\r\n        var _a = imgTensor.shape.slice(1), height = _a[0], width = _a[1];\r\n        if (height === width) {\r\n            return imgTensor;\r\n        }\r\n        var dimDiff = Math.abs(height - width);\r\n        var paddingAmount = Math.round(dimDiff * (isCenterImage ? 0.5 : 1));\r\n        var paddingAxis = height > width ? 2 : 1;\r\n        var createPaddingTensor = function (paddingAmount) {\r\n            var paddingTensorShape = imgTensor.shape.slice();\r\n            paddingTensorShape[paddingAxis] = paddingAmount;\r\n            return tf.fill(paddingTensorShape, 0);\r\n        };\r\n        var paddingTensorAppend = createPaddingTensor(paddingAmount);\r\n        var remainingPaddingAmount = dimDiff - paddingTensorAppend.shape[paddingAxis];\r\n        var paddingTensorPrepend = isCenterImage && remainingPaddingAmount\r\n            ? createPaddingTensor(remainingPaddingAmount)\r\n            : null;\r\n        var tensorsToStack = [\r\n            paddingTensorPrepend,\r\n            imgTensor,\r\n            paddingTensorAppend\r\n        ]\r\n            .filter(function (t) { return !!t; })\r\n            .map(function (t) { return t.toFloat(); });\r\n        return tf.concat(tensorsToStack, paddingAxis);\r\n    });\r\n}\r\n//# sourceMappingURL=padToSquare.js.map","export * from './iou';\r\nexport * from './minBbox';\r\nexport * from './nonMaxSuppression';\r\nexport * from './normalize';\r\nexport * from './padToSquare';\r\nexport * from './shuffleArray';\r\nexport function sigmoid(x) {\r\n    return 1 / (1 + Math.exp(-x));\r\n}\r\nexport function inverseSigmoid(x) {\r\n    return Math.log(x / (1 - x));\r\n}\r\n//# sourceMappingURL=index.js.map","import { __extends } from \"tslib\";\r\nimport { Box } from './Box';\r\nvar Rect = /** @class */ (function (_super) {\r\n    __extends(Rect, _super);\r\n    function Rect(x, y, width, height, allowNegativeDimensions) {\r\n        if (allowNegativeDimensions === void 0) { allowNegativeDimensions = false; }\r\n        return _super.call(this, { x: x, y: y, width: width, height: height }, allowNegativeDimensions) || this;\r\n    }\r\n    return Rect;\r\n}(Box));\r\nexport { Rect };\r\n//# sourceMappingURL=Rect.js.map","import { minBbox } from '../ops';\r\nimport { getCenterPoint } from '../utils';\r\nimport { Box } from './Box';\r\nimport { Dimensions } from './Dimensions';\r\nimport { FaceDetection } from './FaceDetection';\r\nimport { Point } from './Point';\r\nimport { Rect } from './Rect';\r\n// face alignment constants\r\nvar relX = 0.5;\r\nvar relY = 0.43;\r\nvar relScale = 0.45;\r\nvar FaceLandmarks = /** @class */ (function () {\r\n    function FaceLandmarks(relativeFaceLandmarkPositions, imgDims, shift) {\r\n        if (shift === void 0) { shift = new Point(0, 0); }\r\n        var width = imgDims.width, height = imgDims.height;\r\n        this._imgDims = new Dimensions(width, height);\r\n        this._shift = shift;\r\n        this._positions = relativeFaceLandmarkPositions.map(function (pt) { return pt.mul(new Point(width, height)).add(shift); });\r\n    }\r\n    Object.defineProperty(FaceLandmarks.prototype, \"shift\", {\r\n        get: function () { return new Point(this._shift.x, this._shift.y); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FaceLandmarks.prototype, \"imageWidth\", {\r\n        get: function () { return this._imgDims.width; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FaceLandmarks.prototype, \"imageHeight\", {\r\n        get: function () { return this._imgDims.height; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FaceLandmarks.prototype, \"positions\", {\r\n        get: function () { return this._positions; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FaceLandmarks.prototype, \"relativePositions\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return this._positions.map(function (pt) { return pt.sub(_this._shift).div(new Point(_this.imageWidth, _this.imageHeight)); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FaceLandmarks.prototype.forSize = function (width, height) {\r\n        return new this.constructor(this.relativePositions, { width: width, height: height });\r\n    };\r\n    FaceLandmarks.prototype.shiftBy = function (x, y) {\r\n        return new this.constructor(this.relativePositions, this._imgDims, new Point(x, y));\r\n    };\r\n    FaceLandmarks.prototype.shiftByPoint = function (pt) {\r\n        return this.shiftBy(pt.x, pt.y);\r\n    };\r\n    /**\r\n     * Aligns the face landmarks after face detection from the relative positions of the faces\r\n     * bounding box, or it's current shift. This function should be used to align the face images\r\n     * after face detection has been performed, before they are passed to the face recognition net.\r\n     * This will make the computed face descriptor more accurate.\r\n     *\r\n     * @param detection (optional) The bounding box of the face or the face detection result. If\r\n     * no argument was passed the position of the face landmarks are assumed to be relative to\r\n     * it's current shift.\r\n     * @returns The bounding box of the aligned face.\r\n     */\r\n    FaceLandmarks.prototype.align = function (detection, options) {\r\n        if (options === void 0) { options = {}; }\r\n        if (detection) {\r\n            var box = detection instanceof FaceDetection\r\n                ? detection.box.floor()\r\n                : new Box(detection);\r\n            return this.shiftBy(box.x, box.y).align(null, options);\r\n        }\r\n        var _a = Object.assign({}, { useDlibAlignment: false, minBoxPadding: 0.2 }, options), useDlibAlignment = _a.useDlibAlignment, minBoxPadding = _a.minBoxPadding;\r\n        if (useDlibAlignment) {\r\n            return this.alignDlib();\r\n        }\r\n        return this.alignMinBbox(minBoxPadding);\r\n    };\r\n    FaceLandmarks.prototype.alignDlib = function () {\r\n        var centers = this.getRefPointsForAlignment();\r\n        var leftEyeCenter = centers[0], rightEyeCenter = centers[1], mouthCenter = centers[2];\r\n        var distToMouth = function (pt) { return mouthCenter.sub(pt).magnitude(); };\r\n        var eyeToMouthDist = (distToMouth(leftEyeCenter) + distToMouth(rightEyeCenter)) / 2;\r\n        var size = Math.floor(eyeToMouthDist / relScale);\r\n        var refPoint = getCenterPoint(centers);\r\n        // TODO: pad in case rectangle is out of image bounds\r\n        var x = Math.floor(Math.max(0, refPoint.x - (relX * size)));\r\n        var y = Math.floor(Math.max(0, refPoint.y - (relY * size)));\r\n        return new Rect(x, y, Math.min(size, this.imageWidth + x), Math.min(size, this.imageHeight + y));\r\n    };\r\n    FaceLandmarks.prototype.alignMinBbox = function (padding) {\r\n        var box = minBbox(this.positions);\r\n        return box.pad(box.width * padding, box.height * padding);\r\n    };\r\n    FaceLandmarks.prototype.getRefPointsForAlignment = function () {\r\n        throw new Error('getRefPointsForAlignment not implemented by base class');\r\n    };\r\n    return FaceLandmarks;\r\n}());\r\nexport { FaceLandmarks };\r\n//# sourceMappingURL=FaceLandmarks.js.map","import { __extends } from \"tslib\";\r\nimport { getCenterPoint } from '../utils';\r\nimport { FaceLandmarks } from './FaceLandmarks';\r\nvar FaceLandmarks5 = /** @class */ (function (_super) {\r\n    __extends(FaceLandmarks5, _super);\r\n    function FaceLandmarks5() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FaceLandmarks5.prototype.getRefPointsForAlignment = function () {\r\n        var pts = this.positions;\r\n        return [\r\n            pts[0],\r\n            pts[1],\r\n            getCenterPoint([pts[3], pts[4]])\r\n        ];\r\n    };\r\n    return FaceLandmarks5;\r\n}(FaceLandmarks));\r\nexport { FaceLandmarks5 };\r\n//# sourceMappingURL=FaceLandmarks5.js.map","import { __extends } from \"tslib\";\r\nimport { getCenterPoint } from '../utils';\r\nimport { FaceLandmarks } from './FaceLandmarks';\r\nvar FaceLandmarks68 = /** @class */ (function (_super) {\r\n    __extends(FaceLandmarks68, _super);\r\n    function FaceLandmarks68() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FaceLandmarks68.prototype.getJawOutline = function () {\r\n        return this.positions.slice(0, 17);\r\n    };\r\n    FaceLandmarks68.prototype.getLeftEyeBrow = function () {\r\n        return this.positions.slice(17, 22);\r\n    };\r\n    FaceLandmarks68.prototype.getRightEyeBrow = function () {\r\n        return this.positions.slice(22, 27);\r\n    };\r\n    FaceLandmarks68.prototype.getNose = function () {\r\n        return this.positions.slice(27, 36);\r\n    };\r\n    FaceLandmarks68.prototype.getLeftEye = function () {\r\n        return this.positions.slice(36, 42);\r\n    };\r\n    FaceLandmarks68.prototype.getRightEye = function () {\r\n        return this.positions.slice(42, 48);\r\n    };\r\n    FaceLandmarks68.prototype.getMouth = function () {\r\n        return this.positions.slice(48, 68);\r\n    };\r\n    FaceLandmarks68.prototype.getRefPointsForAlignment = function () {\r\n        return [\r\n            this.getLeftEye(),\r\n            this.getRightEye(),\r\n            this.getMouth()\r\n        ].map(getCenterPoint);\r\n    };\r\n    return FaceLandmarks68;\r\n}(FaceLandmarks));\r\nexport { FaceLandmarks68 };\r\n//# sourceMappingURL=FaceLandmarks68.js.map","import { round } from '../utils';\r\nvar FaceMatch = /** @class */ (function () {\r\n    function FaceMatch(label, distance) {\r\n        this._label = label;\r\n        this._distance = distance;\r\n    }\r\n    Object.defineProperty(FaceMatch.prototype, \"label\", {\r\n        get: function () { return this._label; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FaceMatch.prototype, \"distance\", {\r\n        get: function () { return this._distance; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FaceMatch.prototype.toString = function (withDistance) {\r\n        if (withDistance === void 0) { withDistance = true; }\r\n        return \"\" + this.label + (withDistance ? \" (\" + round(this.distance) + \")\" : '');\r\n    };\r\n    return FaceMatch;\r\n}());\r\nexport { FaceMatch };\r\n//# sourceMappingURL=FaceMatch.js.map","import { __extends } from \"tslib\";\r\nimport { isValidNumber } from '../utils';\r\nimport { Box } from './Box';\r\nvar LabeledBox = /** @class */ (function (_super) {\r\n    __extends(LabeledBox, _super);\r\n    function LabeledBox(box, label) {\r\n        var _this = _super.call(this, box) || this;\r\n        _this._label = label;\r\n        return _this;\r\n    }\r\n    LabeledBox.assertIsValidLabeledBox = function (box, callee) {\r\n        Box.assertIsValidBox(box, callee);\r\n        if (!isValidNumber(box.label)) {\r\n            throw new Error(callee + \" - expected property label (\" + box.label + \") to be a number\");\r\n        }\r\n    };\r\n    Object.defineProperty(LabeledBox.prototype, \"label\", {\r\n        get: function () { return this._label; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return LabeledBox;\r\n}(Box));\r\nexport { LabeledBox };\r\n//# sourceMappingURL=LabeledBox.js.map","var LabeledFaceDescriptors = /** @class */ (function () {\r\n    function LabeledFaceDescriptors(label, descriptors) {\r\n        if (!(typeof label === 'string')) {\r\n            throw new Error('LabeledFaceDescriptors - constructor expected label to be a string');\r\n        }\r\n        if (!Array.isArray(descriptors) || descriptors.some(function (desc) { return !(desc instanceof Float32Array); })) {\r\n            throw new Error('LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array');\r\n        }\r\n        this._label = label;\r\n        this._descriptors = descriptors;\r\n    }\r\n    Object.defineProperty(LabeledFaceDescriptors.prototype, \"label\", {\r\n        get: function () { return this._label; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LabeledFaceDescriptors.prototype, \"descriptors\", {\r\n        get: function () { return this._descriptors; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LabeledFaceDescriptors.prototype.toJSON = function () {\r\n        return {\r\n            label: this.label,\r\n            descriptors: this.descriptors.map(function (d) { return Array.from(d); })\r\n        };\r\n    };\r\n    LabeledFaceDescriptors.fromJSON = function (json) {\r\n        var descriptors = json.descriptors.map(function (d) {\r\n            return new Float32Array(d);\r\n        });\r\n        return new LabeledFaceDescriptors(json.label, descriptors);\r\n    };\r\n    return LabeledFaceDescriptors;\r\n}());\r\nexport { LabeledFaceDescriptors };\r\n//# sourceMappingURL=LabeledFaceDescriptors.js.map","import { __extends } from \"tslib\";\r\nimport { isValidProbablitiy } from '../utils';\r\nimport { LabeledBox } from './LabeledBox';\r\nvar PredictedBox = /** @class */ (function (_super) {\r\n    __extends(PredictedBox, _super);\r\n    function PredictedBox(box, label, score, classScore) {\r\n        var _this = _super.call(this, box, label) || this;\r\n        _this._score = score;\r\n        _this._classScore = classScore;\r\n        return _this;\r\n    }\r\n    PredictedBox.assertIsValidPredictedBox = function (box, callee) {\r\n        LabeledBox.assertIsValidLabeledBox(box, callee);\r\n        if (!isValidProbablitiy(box.score)\r\n            || !isValidProbablitiy(box.classScore)) {\r\n            throw new Error(callee + \" - expected properties score (\" + box.score + \") and (\" + box.classScore + \") to be a number between [0, 1]\");\r\n        }\r\n    };\r\n    Object.defineProperty(PredictedBox.prototype, \"score\", {\r\n        get: function () { return this._score; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PredictedBox.prototype, \"classScore\", {\r\n        get: function () { return this._classScore; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return PredictedBox;\r\n}(LabeledBox));\r\nexport { PredictedBox };\r\n//# sourceMappingURL=PredictedBox.js.map","import { FaceDetection } from '../classes/FaceDetection';\r\nexport function isWithFaceDetection(obj) {\r\n    return obj['detection'] instanceof FaceDetection;\r\n}\r\nexport function extendWithFaceDetection(sourceObj, detection) {\r\n    var extension = { detection: detection };\r\n    return Object.assign({}, sourceObj, extension);\r\n}\r\n//# sourceMappingURL=WithFaceDetection.js.map","export function createBrowserEnv() {\r\n    var fetch = window['fetch'] || function () {\r\n        throw new Error('fetch - missing fetch implementation for browser environment');\r\n    };\r\n    var readFile = function () {\r\n        throw new Error('readFile - filesystem not available for browser environment');\r\n    };\r\n    return {\r\n        Canvas: HTMLCanvasElement,\r\n        CanvasRenderingContext2D: CanvasRenderingContext2D,\r\n        Image: HTMLImageElement,\r\n        ImageData: ImageData,\r\n        Video: HTMLVideoElement,\r\n        createCanvasElement: function () { return document.createElement('canvas'); },\r\n        createImageElement: function () { return document.createElement('img'); },\r\n        fetch: fetch,\r\n        readFile: readFile\r\n    };\r\n}\r\n//# sourceMappingURL=createBrowserEnv.js.map","export function createFileSystem(fs) {\r\n    var requireFsError = '';\r\n    if (!fs) {\r\n        try {\r\n            fs = require('fs');\r\n        }\r\n        catch (err) {\r\n            requireFsError = err.toString();\r\n        }\r\n    }\r\n    var readFile = fs\r\n        ? function (filePath) {\r\n            return new Promise(function (res, rej) {\r\n                fs.readFile(filePath, function (err, buffer) {\r\n                    return err ? rej(err) : res(buffer);\r\n                });\r\n            });\r\n        }\r\n        : function () {\r\n            throw new Error(\"readFile - failed to require fs in nodejs environment with error: \" + requireFsError);\r\n        };\r\n    return {\r\n        readFile: readFile\r\n    };\r\n}\r\n//# sourceMappingURL=createFileSystem.js.map","import { __assign } from \"tslib\";\r\nimport { createFileSystem } from './createFileSystem';\r\nexport function createNodejsEnv() {\r\n    var Canvas = global['Canvas'] || global['HTMLCanvasElement'];\r\n    var Image = global['Image'] || global['HTMLImageElement'];\r\n    var createCanvasElement = function () {\r\n        if (Canvas) {\r\n            return new Canvas();\r\n        }\r\n        throw new Error('createCanvasElement - missing Canvas implementation for nodejs environment');\r\n    };\r\n    var createImageElement = function () {\r\n        if (Image) {\r\n            return new Image();\r\n        }\r\n        throw new Error('createImageElement - missing Image implementation for nodejs environment');\r\n    };\r\n    var fetch = global['fetch'] || function () {\r\n        throw new Error('fetch - missing fetch implementation for nodejs environment');\r\n    };\r\n    var fileSystem = createFileSystem();\r\n    return __assign({ Canvas: Canvas || /** @class */ (function () {\r\n            function Canvas() {\r\n            }\r\n            return Canvas;\r\n        }()), CanvasRenderingContext2D: global['CanvasRenderingContext2D'] || /** @class */ (function () {\r\n            function class_1() {\r\n            }\r\n            return class_1;\r\n        }()), Image: Image || /** @class */ (function () {\r\n            function Image() {\r\n            }\r\n            return Image;\r\n        }()), ImageData: global['ImageData'] || /** @class */ (function () {\r\n            function class_2() {\r\n            }\r\n            return class_2;\r\n        }()), Video: global['HTMLVideoElement'] || /** @class */ (function () {\r\n            function class_3() {\r\n            }\r\n            return class_3;\r\n        }()), createCanvasElement: createCanvasElement,\r\n        createImageElement: createImageElement,\r\n        fetch: fetch }, fileSystem);\r\n}\r\n//# sourceMappingURL=createNodejsEnv.js.map","export function isBrowser() {\r\n    return typeof window === 'object'\r\n        && typeof document !== 'undefined'\r\n        && typeof HTMLImageElement !== 'undefined'\r\n        && typeof HTMLCanvasElement !== 'undefined'\r\n        && typeof HTMLVideoElement !== 'undefined'\r\n        && typeof ImageData !== 'undefined'\r\n        && typeof CanvasRenderingContext2D !== 'undefined';\r\n}\r\n//# sourceMappingURL=isBrowser.js.map","export function isNodejs() {\r\n    return typeof global === 'object'\r\n        && typeof require === 'function'\r\n        && typeof module !== 'undefined'\r\n        // issues with gatsby.js: module.exports is undefined\r\n        // && !!module.exports\r\n        && typeof process !== 'undefined' && !!process.version;\r\n}\r\n//# sourceMappingURL=isNodejs.js.map","import { createBrowserEnv } from './createBrowserEnv';\r\nimport { createFileSystem } from './createFileSystem';\r\nimport { createNodejsEnv } from './createNodejsEnv';\r\nimport { isBrowser } from './isBrowser';\r\nimport { isNodejs } from './isNodejs';\r\nvar environment;\r\nfunction getEnv() {\r\n    if (!environment) {\r\n        throw new Error('getEnv - environment is not defined, check isNodejs() and isBrowser()');\r\n    }\r\n    return environment;\r\n}\r\nfunction setEnv(env) {\r\n    environment = env;\r\n}\r\nfunction initialize() {\r\n    // check for isBrowser() first to prevent electron renderer process\r\n    // to be initialized with wrong environment due to isNodejs() returning true\r\n    if (isBrowser()) {\r\n        setEnv(createBrowserEnv());\r\n    }\r\n    if (isNodejs()) {\r\n        setEnv(createNodejsEnv());\r\n    }\r\n}\r\nfunction monkeyPatch(env) {\r\n    if (!environment) {\r\n        initialize();\r\n    }\r\n    if (!environment) {\r\n        throw new Error('monkeyPatch - environment is not defined, check isNodejs() and isBrowser()');\r\n    }\r\n    var _a = env.Canvas, Canvas = _a === void 0 ? environment.Canvas : _a, _b = env.Image, Image = _b === void 0 ? environment.Image : _b;\r\n    environment.Canvas = Canvas;\r\n    environment.Image = Image;\r\n    environment.createCanvasElement = env.createCanvasElement || (function () { return new Canvas(); });\r\n    environment.createImageElement = env.createImageElement || (function () { return new Image(); });\r\n    environment.ImageData = env.ImageData || environment.ImageData;\r\n    environment.Video = env.Video || environment.Video;\r\n    environment.fetch = env.fetch || environment.fetch;\r\n    environment.readFile = env.readFile || environment.readFile;\r\n}\r\nexport var env = {\r\n    getEnv: getEnv,\r\n    setEnv: setEnv,\r\n    initialize: initialize,\r\n    createBrowserEnv: createBrowserEnv,\r\n    createFileSystem: createFileSystem,\r\n    createNodejsEnv: createNodejsEnv,\r\n    monkeyPatch: monkeyPatch,\r\n    isBrowser: isBrowser,\r\n    isNodejs: isNodejs\r\n};\r\ninitialize();\r\n//# sourceMappingURL=index.js.map","import { env } from '../env';\r\nexport function resolveInput(arg) {\r\n    if (!env.isNodejs() && typeof arg === 'string') {\r\n        return document.getElementById(arg);\r\n    }\r\n    return arg;\r\n}\r\n//# sourceMappingURL=resolveInput.js.map","import { env } from '../env';\r\nimport { resolveInput } from './resolveInput';\r\nexport function getContext2dOrThrow(canvasArg) {\r\n    var _a = env.getEnv(), Canvas = _a.Canvas, CanvasRenderingContext2D = _a.CanvasRenderingContext2D;\r\n    if (canvasArg instanceof CanvasRenderingContext2D) {\r\n        return canvasArg;\r\n    }\r\n    var canvas = resolveInput(canvasArg);\r\n    if (!(canvas instanceof Canvas)) {\r\n        throw new Error('resolveContext2d - expected canvas to be of instance of Canvas');\r\n    }\r\n    var ctx = canvas.getContext('2d');\r\n    if (!ctx) {\r\n        throw new Error('resolveContext2d - canvas 2d context is null');\r\n    }\r\n    return ctx;\r\n}\r\n//# sourceMappingURL=getContext2dOrThrow.js.map","import { getContext2dOrThrow } from '../dom/getContext2dOrThrow';\r\nimport { resolveInput } from '../dom/resolveInput';\r\nexport var AnchorPosition;\r\n(function (AnchorPosition) {\r\n    AnchorPosition[\"TOP_LEFT\"] = \"TOP_LEFT\";\r\n    AnchorPosition[\"TOP_RIGHT\"] = \"TOP_RIGHT\";\r\n    AnchorPosition[\"BOTTOM_LEFT\"] = \"BOTTOM_LEFT\";\r\n    AnchorPosition[\"BOTTOM_RIGHT\"] = \"BOTTOM_RIGHT\";\r\n})(AnchorPosition || (AnchorPosition = {}));\r\nvar DrawTextFieldOptions = /** @class */ (function () {\r\n    function DrawTextFieldOptions(options) {\r\n        if (options === void 0) { options = {}; }\r\n        var anchorPosition = options.anchorPosition, backgroundColor = options.backgroundColor, fontColor = options.fontColor, fontSize = options.fontSize, fontStyle = options.fontStyle, padding = options.padding;\r\n        this.anchorPosition = anchorPosition || AnchorPosition.TOP_LEFT;\r\n        this.backgroundColor = backgroundColor || 'rgba(0, 0, 0, 0.5)';\r\n        this.fontColor = fontColor || 'rgba(255, 255, 255, 1)';\r\n        this.fontSize = fontSize || 14;\r\n        this.fontStyle = fontStyle || 'Georgia';\r\n        this.padding = padding || 4;\r\n    }\r\n    return DrawTextFieldOptions;\r\n}());\r\nexport { DrawTextFieldOptions };\r\nvar DrawTextField = /** @class */ (function () {\r\n    function DrawTextField(text, anchor, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.text = typeof text === 'string'\r\n            ? [text]\r\n            : (text instanceof DrawTextField ? text.text : text);\r\n        this.anchor = anchor;\r\n        this.options = new DrawTextFieldOptions(options);\r\n    }\r\n    DrawTextField.prototype.measureWidth = function (ctx) {\r\n        var padding = this.options.padding;\r\n        return this.text.map(function (l) { return ctx.measureText(l).width; }).reduce(function (w0, w1) { return w0 < w1 ? w1 : w0; }, 0) + (2 * padding);\r\n    };\r\n    DrawTextField.prototype.measureHeight = function () {\r\n        var _a = this.options, fontSize = _a.fontSize, padding = _a.padding;\r\n        return this.text.length * fontSize + (2 * padding);\r\n    };\r\n    DrawTextField.prototype.getUpperLeft = function (ctx, canvasDims) {\r\n        var anchorPosition = this.options.anchorPosition;\r\n        var isShiftLeft = anchorPosition === AnchorPosition.BOTTOM_RIGHT || anchorPosition === AnchorPosition.TOP_RIGHT;\r\n        var isShiftTop = anchorPosition === AnchorPosition.BOTTOM_LEFT || anchorPosition === AnchorPosition.BOTTOM_RIGHT;\r\n        var textFieldWidth = this.measureWidth(ctx);\r\n        var textFieldHeight = this.measureHeight();\r\n        var x = (isShiftLeft ? this.anchor.x - textFieldWidth : this.anchor.x);\r\n        var y = isShiftTop ? this.anchor.y - textFieldHeight : this.anchor.y;\r\n        // adjust anchor if text box exceeds canvas borders\r\n        if (canvasDims) {\r\n            var width = canvasDims.width, height = canvasDims.height;\r\n            var newX = Math.max(Math.min(x, width - textFieldWidth), 0);\r\n            var newY = Math.max(Math.min(y, height - textFieldHeight), 0);\r\n            return { x: newX, y: newY };\r\n        }\r\n        return { x: x, y: y };\r\n    };\r\n    DrawTextField.prototype.draw = function (canvasArg) {\r\n        var canvas = resolveInput(canvasArg);\r\n        var ctx = getContext2dOrThrow(canvas);\r\n        var _a = this.options, backgroundColor = _a.backgroundColor, fontColor = _a.fontColor, fontSize = _a.fontSize, fontStyle = _a.fontStyle, padding = _a.padding;\r\n        ctx.font = fontSize + \"px \" + fontStyle;\r\n        var maxTextWidth = this.measureWidth(ctx);\r\n        var textHeight = this.measureHeight();\r\n        ctx.fillStyle = backgroundColor;\r\n        var upperLeft = this.getUpperLeft(ctx, canvas);\r\n        ctx.fillRect(upperLeft.x, upperLeft.y, maxTextWidth, textHeight);\r\n        ctx.fillStyle = fontColor;\r\n        this.text.forEach(function (textLine, i) {\r\n            var x = padding + upperLeft.x;\r\n            var y = padding + upperLeft.y + ((i + 1) * fontSize);\r\n            ctx.fillText(textLine, x, y);\r\n        });\r\n    };\r\n    return DrawTextField;\r\n}());\r\nexport { DrawTextField };\r\n//# sourceMappingURL=DrawTextField.js.map","import { env } from '../env';\r\nexport function isMediaLoaded(media) {\r\n    var _a = env.getEnv(), Image = _a.Image, Video = _a.Video;\r\n    return (media instanceof Image && media.complete)\r\n        || (media instanceof Video && media.readyState >= 3);\r\n}\r\n//# sourceMappingURL=isMediaLoaded.js.map","import { env } from '../env';\r\nimport { isMediaLoaded } from './isMediaLoaded';\r\nexport function awaitMediaLoaded(media) {\r\n    return new Promise(function (resolve, reject) {\r\n        if (media instanceof env.getEnv().Canvas || isMediaLoaded(media)) {\r\n            return resolve();\r\n        }\r\n        function onLoad(e) {\r\n            if (!e.currentTarget)\r\n                return;\r\n            e.currentTarget.removeEventListener('load', onLoad);\r\n            e.currentTarget.removeEventListener('error', onError);\r\n            resolve(e);\r\n        }\r\n        function onError(e) {\r\n            if (!e.currentTarget)\r\n                return;\r\n            e.currentTarget.removeEventListener('load', onLoad);\r\n            e.currentTarget.removeEventListener('error', onError);\r\n            reject(e);\r\n        }\r\n        media.addEventListener('load', onLoad);\r\n        media.addEventListener('error', onError);\r\n    });\r\n}\r\n//# sourceMappingURL=awaitMediaLoaded.js.map","import { Dimensions } from '../classes/Dimensions';\r\nimport { env } from '../env';\r\nexport function getMediaDimensions(input) {\r\n    var _a = env.getEnv(), Image = _a.Image, Video = _a.Video;\r\n    if (input instanceof Image) {\r\n        return new Dimensions(input.naturalWidth, input.naturalHeight);\r\n    }\r\n    if (input instanceof Video) {\r\n        return new Dimensions(input.videoWidth, input.videoHeight);\r\n    }\r\n    return new Dimensions(input.width, input.height);\r\n}\r\n//# sourceMappingURL=getMediaDimensions.js.map","import { env } from '../env';\r\nimport { getContext2dOrThrow } from './getContext2dOrThrow';\r\nimport { getMediaDimensions } from './getMediaDimensions';\r\nimport { isMediaLoaded } from './isMediaLoaded';\r\nexport function createCanvas(_a) {\r\n    var width = _a.width, height = _a.height;\r\n    var createCanvasElement = env.getEnv().createCanvasElement;\r\n    var canvas = createCanvasElement();\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    return canvas;\r\n}\r\nexport function createCanvasFromMedia(media, dims) {\r\n    var ImageData = env.getEnv().ImageData;\r\n    if (!(media instanceof ImageData) && !isMediaLoaded(media)) {\r\n        throw new Error('createCanvasFromMedia - media has not finished loading yet');\r\n    }\r\n    var _a = dims || getMediaDimensions(media), width = _a.width, height = _a.height;\r\n    var canvas = createCanvas({ width: width, height: height });\r\n    if (media instanceof ImageData) {\r\n        getContext2dOrThrow(canvas).putImageData(media, 0, 0);\r\n    }\r\n    else {\r\n        getContext2dOrThrow(canvas).drawImage(media, 0, 0, width, height);\r\n    }\r\n    return canvas;\r\n}\r\n//# sourceMappingURL=createCanvas.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { env } from '../env';\r\nimport { isTensor4D } from '../utils';\r\nexport function imageTensorToCanvas(imgTensor, canvas) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var targetCanvas, _a, height, width, numChannels, imgTensor3D;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    targetCanvas = canvas || env.getEnv().createCanvasElement();\r\n                    _a = imgTensor.shape.slice(isTensor4D(imgTensor) ? 1 : 0), height = _a[0], width = _a[1], numChannels = _a[2];\r\n                    imgTensor3D = tf.tidy(function () { return imgTensor.as3D(height, width, numChannels).toInt(); });\r\n                    return [4 /*yield*/, tf.browser.toPixels(imgTensor3D, targetCanvas)];\r\n                case 1:\r\n                    _b.sent();\r\n                    imgTensor3D.dispose();\r\n                    return [2 /*return*/, targetCanvas];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=imageTensorToCanvas.js.map","import { env } from '../env';\r\nexport function isMediaElement(input) {\r\n    var _a = env.getEnv(), Image = _a.Image, Canvas = _a.Canvas, Video = _a.Video;\r\n    return input instanceof Image\r\n        || input instanceof Canvas\r\n        || input instanceof Video;\r\n}\r\n//# sourceMappingURL=isMediaElement.js.map","import { env } from '../env';\r\nimport { createCanvas, createCanvasFromMedia } from './createCanvas';\r\nimport { getContext2dOrThrow } from './getContext2dOrThrow';\r\nimport { getMediaDimensions } from './getMediaDimensions';\r\nexport function imageToSquare(input, inputSize, centerImage) {\r\n    if (centerImage === void 0) { centerImage = false; }\r\n    var _a = env.getEnv(), Image = _a.Image, Canvas = _a.Canvas;\r\n    if (!(input instanceof Image || input instanceof Canvas)) {\r\n        throw new Error('imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement');\r\n    }\r\n    var dims = getMediaDimensions(input);\r\n    var scale = inputSize / Math.max(dims.height, dims.width);\r\n    var width = scale * dims.width;\r\n    var height = scale * dims.height;\r\n    var targetCanvas = createCanvas({ width: inputSize, height: inputSize });\r\n    var inputCanvas = input instanceof Canvas ? input : createCanvasFromMedia(input);\r\n    var offset = Math.abs(width - height) / 2;\r\n    var dx = centerImage && width < height ? offset : 0;\r\n    var dy = centerImage && height < width ? offset : 0;\r\n    getContext2dOrThrow(targetCanvas).drawImage(inputCanvas, dx, dy, width, height);\r\n    return targetCanvas;\r\n}\r\n//# sourceMappingURL=imageToSquare.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { env } from '../env';\r\nimport { padToSquare } from '../ops/padToSquare';\r\nimport { computeReshapedDimensions, isTensor3D, isTensor4D, range } from '../utils';\r\nimport { createCanvasFromMedia } from './createCanvas';\r\nimport { imageToSquare } from './imageToSquare';\r\nvar NetInput = /** @class */ (function () {\r\n    function NetInput(inputs, treatAsBatchInput) {\r\n        var _this = this;\r\n        if (treatAsBatchInput === void 0) { treatAsBatchInput = false; }\r\n        this._imageTensors = [];\r\n        this._canvases = [];\r\n        this._treatAsBatchInput = false;\r\n        this._inputDimensions = [];\r\n        if (!Array.isArray(inputs)) {\r\n            throw new Error(\"NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have \" + inputs);\r\n        }\r\n        this._treatAsBatchInput = treatAsBatchInput;\r\n        this._batchSize = inputs.length;\r\n        inputs.forEach(function (input, idx) {\r\n            if (isTensor3D(input)) {\r\n                _this._imageTensors[idx] = input;\r\n                _this._inputDimensions[idx] = input.shape;\r\n                return;\r\n            }\r\n            if (isTensor4D(input)) {\r\n                var batchSize = input.shape[0];\r\n                if (batchSize !== 1) {\r\n                    throw new Error(\"NetInput - tf.Tensor4D with batchSize \" + batchSize + \" passed, but not supported in input array\");\r\n                }\r\n                _this._imageTensors[idx] = input;\r\n                _this._inputDimensions[idx] = input.shape.slice(1);\r\n                return;\r\n            }\r\n            var canvas = input instanceof env.getEnv().Canvas ? input : createCanvasFromMedia(input);\r\n            _this._canvases[idx] = canvas;\r\n            _this._inputDimensions[idx] = [canvas.height, canvas.width, 3];\r\n        });\r\n    }\r\n    Object.defineProperty(NetInput.prototype, \"imageTensors\", {\r\n        get: function () {\r\n            return this._imageTensors;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NetInput.prototype, \"canvases\", {\r\n        get: function () {\r\n            return this._canvases;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NetInput.prototype, \"isBatchInput\", {\r\n        get: function () {\r\n            return this.batchSize > 1 || this._treatAsBatchInput;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NetInput.prototype, \"batchSize\", {\r\n        get: function () {\r\n            return this._batchSize;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NetInput.prototype, \"inputDimensions\", {\r\n        get: function () {\r\n            return this._inputDimensions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NetInput.prototype, \"inputSize\", {\r\n        get: function () {\r\n            return this._inputSize;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NetInput.prototype, \"reshapedInputDimensions\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return range(this.batchSize, 0, 1).map(function (_, batchIdx) { return _this.getReshapedInputDimensions(batchIdx); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    NetInput.prototype.getInput = function (batchIdx) {\r\n        return this.canvases[batchIdx] || this.imageTensors[batchIdx];\r\n    };\r\n    NetInput.prototype.getInputDimensions = function (batchIdx) {\r\n        return this._inputDimensions[batchIdx];\r\n    };\r\n    NetInput.prototype.getInputHeight = function (batchIdx) {\r\n        return this._inputDimensions[batchIdx][0];\r\n    };\r\n    NetInput.prototype.getInputWidth = function (batchIdx) {\r\n        return this._inputDimensions[batchIdx][1];\r\n    };\r\n    NetInput.prototype.getReshapedInputDimensions = function (batchIdx) {\r\n        if (typeof this.inputSize !== 'number') {\r\n            throw new Error('getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet');\r\n        }\r\n        var width = this.getInputWidth(batchIdx);\r\n        var height = this.getInputHeight(batchIdx);\r\n        return computeReshapedDimensions({ width: width, height: height }, this.inputSize);\r\n    };\r\n    /**\r\n     * Create a batch tensor from all input canvases and tensors\r\n     * with size [batchSize, inputSize, inputSize, 3].\r\n     *\r\n     * @param inputSize Height and width of the tensor.\r\n     * @param isCenterImage (optional, default: false) If true, add an equal amount of padding on\r\n     * both sides of the minor dimension oof the image.\r\n     * @returns The batch tensor.\r\n     */\r\n    NetInput.prototype.toBatchTensor = function (inputSize, isCenterInputs) {\r\n        var _this = this;\r\n        if (isCenterInputs === void 0) { isCenterInputs = true; }\r\n        this._inputSize = inputSize;\r\n        return tf.tidy(function () {\r\n            var inputTensors = range(_this.batchSize, 0, 1).map(function (batchIdx) {\r\n                var input = _this.getInput(batchIdx);\r\n                if (input instanceof tf.Tensor) {\r\n                    var imgTensor = isTensor4D(input) ? input : input.expandDims();\r\n                    imgTensor = padToSquare(imgTensor, isCenterInputs);\r\n                    if (imgTensor.shape[1] !== inputSize || imgTensor.shape[2] !== inputSize) {\r\n                        imgTensor = tf.image.resizeBilinear(imgTensor, [inputSize, inputSize]);\r\n                    }\r\n                    return imgTensor.as3D(inputSize, inputSize, 3);\r\n                }\r\n                if (input instanceof env.getEnv().Canvas) {\r\n                    return tf.browser.fromPixels(imageToSquare(input, inputSize, isCenterInputs));\r\n                }\r\n                throw new Error(\"toBatchTensor - at batchIdx \" + batchIdx + \", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have \" + input);\r\n            });\r\n            var batchTensor = tf.stack(inputTensors.map(function (t) { return t.toFloat(); })).as4D(_this.batchSize, inputSize, inputSize, 3);\r\n            return batchTensor;\r\n        });\r\n    };\r\n    return NetInput;\r\n}());\r\nexport { NetInput };\r\n//# sourceMappingURL=NetInput.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport { isTensor3D, isTensor4D } from '../utils';\r\nimport { awaitMediaLoaded } from './awaitMediaLoaded';\r\nimport { isMediaElement } from './isMediaElement';\r\nimport { NetInput } from './NetInput';\r\nimport { resolveInput } from './resolveInput';\r\n/**\r\n * Validates the input to make sure, they are valid net inputs and awaits all media elements\r\n * to be finished loading.\r\n *\r\n * @param input The input, which can be a media element or an array of different media elements.\r\n * @returns A NetInput instance, which can be passed into one of the neural networks.\r\n */\r\nexport function toNetInput(inputs) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var inputArgArray, getIdxHint, inputArray;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (inputs instanceof NetInput) {\r\n                        return [2 /*return*/, inputs];\r\n                    }\r\n                    inputArgArray = Array.isArray(inputs)\r\n                        ? inputs\r\n                        : [inputs];\r\n                    if (!inputArgArray.length) {\r\n                        throw new Error('toNetInput - empty array passed as input');\r\n                    }\r\n                    getIdxHint = function (idx) { return Array.isArray(inputs) ? \" at input index \" + idx + \":\" : ''; };\r\n                    inputArray = inputArgArray.map(resolveInput);\r\n                    inputArray.forEach(function (input, i) {\r\n                        if (!isMediaElement(input) && !isTensor3D(input) && !isTensor4D(input)) {\r\n                            if (typeof inputArgArray[i] === 'string') {\r\n                                throw new Error(\"toNetInput -\" + getIdxHint(i) + \" string passed, but could not resolve HTMLElement for element id \" + inputArgArray[i]);\r\n                            }\r\n                            throw new Error(\"toNetInput -\" + getIdxHint(i) + \" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id\");\r\n                        }\r\n                        if (isTensor4D(input)) {\r\n                            // if tf.Tensor4D is passed in the input array, the batch size has to be 1\r\n                            var batchSize = input.shape[0];\r\n                            if (batchSize !== 1) {\r\n                                throw new Error(\"toNetInput -\" + getIdxHint(i) + \" tf.Tensor4D with batchSize \" + batchSize + \" passed, but not supported in input array\");\r\n                            }\r\n                        }\r\n                    });\r\n                    // wait for all media elements being loaded\r\n                    return [4 /*yield*/, Promise.all(inputArray.map(function (input) { return isMediaElement(input) && awaitMediaLoaded(input); }))];\r\n                case 1:\r\n                    // wait for all media elements being loaded\r\n                    _a.sent();\r\n                    return [2 /*return*/, new NetInput(inputArray, Array.isArray(inputs))];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=toNetInput.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport { FaceDetection } from '../classes/FaceDetection';\r\nimport { env } from '../env';\r\nimport { createCanvas } from './createCanvas';\r\nimport { getContext2dOrThrow } from './getContext2dOrThrow';\r\nimport { imageTensorToCanvas } from './imageTensorToCanvas';\r\nimport { toNetInput } from './toNetInput';\r\n/**\r\n * Extracts the image regions containing the detected faces.\r\n *\r\n * @param input The image that face detection has been performed on.\r\n * @param detections The face detection results or face bounding boxes for that image.\r\n * @returns The Canvases of the corresponding image region for each detected face.\r\n */\r\nexport function extractFaces(input, detections) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var Canvas, canvas, netInput, tensorOrCanvas, _a, ctx, boxes;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    Canvas = env.getEnv().Canvas;\r\n                    canvas = input;\r\n                    if (!!(input instanceof Canvas)) return [3 /*break*/, 5];\r\n                    return [4 /*yield*/, toNetInput(input)];\r\n                case 1:\r\n                    netInput = _b.sent();\r\n                    if (netInput.batchSize > 1) {\r\n                        throw new Error('extractFaces - batchSize > 1 not supported');\r\n                    }\r\n                    tensorOrCanvas = netInput.getInput(0);\r\n                    if (!(tensorOrCanvas instanceof Canvas)) return [3 /*break*/, 2];\r\n                    _a = tensorOrCanvas;\r\n                    return [3 /*break*/, 4];\r\n                case 2: return [4 /*yield*/, imageTensorToCanvas(tensorOrCanvas)];\r\n                case 3:\r\n                    _a = _b.sent();\r\n                    _b.label = 4;\r\n                case 4:\r\n                    canvas = _a;\r\n                    _b.label = 5;\r\n                case 5:\r\n                    ctx = getContext2dOrThrow(canvas);\r\n                    boxes = detections.map(function (det) { return det instanceof FaceDetection\r\n                        ? det.forSize(canvas.width, canvas.height).box.floor()\r\n                        : det; })\r\n                        .map(function (box) { return box.clipAtImageBorders(canvas.width, canvas.height); });\r\n                    return [2 /*return*/, boxes.map(function (_a) {\r\n                            var x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n                            var faceImg = createCanvas({ width: width, height: height });\r\n                            getContext2dOrThrow(faceImg)\r\n                                .putImageData(ctx.getImageData(x, y, width, height), 0, 0);\r\n                            return faceImg;\r\n                        })];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=extractFaces.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { FaceDetection } from '../classes/FaceDetection';\r\nimport { isTensor3D, isTensor4D } from '../utils';\r\n/**\r\n * Extracts the tensors of the image regions containing the detected faces.\r\n * Useful if you want to compute the face descriptors for the face images.\r\n * Using this method is faster then extracting a canvas for each face and\r\n * converting them to tensors individually.\r\n *\r\n * @param imageTensor The image tensor that face detection has been performed on.\r\n * @param detections The face detection results or face bounding boxes for that image.\r\n * @returns Tensors of the corresponding image region for each detected face.\r\n */\r\nexport function extractFaceTensors(imageTensor, detections) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            if (!isTensor3D(imageTensor) && !isTensor4D(imageTensor)) {\r\n                throw new Error('extractFaceTensors - expected image tensor to be 3D or 4D');\r\n            }\r\n            if (isTensor4D(imageTensor) && imageTensor.shape[0] > 1) {\r\n                throw new Error('extractFaceTensors - batchSize > 1 not supported');\r\n            }\r\n            return [2 /*return*/, tf.tidy(function () {\r\n                    var _a = imageTensor.shape.slice(isTensor4D(imageTensor) ? 1 : 0), imgHeight = _a[0], imgWidth = _a[1], numChannels = _a[2];\r\n                    var boxes = detections.map(function (det) { return det instanceof FaceDetection\r\n                        ? det.forSize(imgWidth, imgHeight).box\r\n                        : det; })\r\n                        .map(function (box) { return box.clipAtImageBorders(imgWidth, imgHeight); });\r\n                    var faceTensors = boxes.map(function (_a) {\r\n                        var x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n                        return tf.slice3d(imageTensor.as3D(imgHeight, imgWidth, numChannels), [y, x, 0], [height, width, numChannels]);\r\n                    });\r\n                    return faceTensors;\r\n                })];\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=extractFaceTensors.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport { env } from '../env';\r\nexport function fetchOrThrow(url, init) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var fetch, res;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    fetch = env.getEnv().fetch;\r\n                    return [4 /*yield*/, fetch(url, init)];\r\n                case 1:\r\n                    res = _a.sent();\r\n                    if (!(res.status < 400)) {\r\n                        throw new Error(\"failed to fetch: (\" + res.status + \") \" + res.statusText + \", from url: \" + res.url);\r\n                    }\r\n                    return [2 /*return*/, res];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=fetchOrThrow.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport { fetchOrThrow } from './fetchOrThrow';\r\nexport function fetchJson(uri) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, fetchOrThrow(uri)];\r\n                case 1: return [2 /*return*/, (_a.sent()).json()];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=fetchJson.js.map","export function getModelUris(uri, defaultModelName) {\r\n    var defaultManifestFilename = defaultModelName + \"-weights_manifest.json\";\r\n    if (!uri) {\r\n        return {\r\n            modelBaseUri: '',\r\n            manifestUri: defaultManifestFilename\r\n        };\r\n    }\r\n    if (uri === '/') {\r\n        return {\r\n            modelBaseUri: '/',\r\n            manifestUri: \"/\" + defaultManifestFilename\r\n        };\r\n    }\r\n    var protocol = uri.startsWith('http://') ? 'http://' : uri.startsWith('https://') ? 'https://' : '';\r\n    uri = uri.replace(protocol, '');\r\n    var parts = uri.split('/').filter(function (s) { return s; });\r\n    var manifestFile = uri.endsWith('.json')\r\n        ? parts[parts.length - 1]\r\n        : defaultManifestFilename;\r\n    var modelBaseUri = protocol + (uri.endsWith('.json') ? parts.slice(0, parts.length - 1) : parts).join('/');\r\n    modelBaseUri = uri.startsWith('/') ? \"/\" + modelBaseUri : modelBaseUri;\r\n    return {\r\n        modelBaseUri: modelBaseUri,\r\n        manifestUri: modelBaseUri === '/' ? \"/\" + manifestFile : modelBaseUri + \"/\" + manifestFile\r\n    };\r\n}\r\n//# sourceMappingURL=getModelUris.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { getModelUris } from '../common/getModelUris';\r\nimport { fetchJson } from './fetchJson';\r\nexport function loadWeightMap(uri, defaultModelName) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _a, manifestUri, modelBaseUri, manifest;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    _a = getModelUris(uri, defaultModelName), manifestUri = _a.manifestUri, modelBaseUri = _a.modelBaseUri;\r\n                    return [4 /*yield*/, fetchJson(manifestUri)];\r\n                case 1:\r\n                    manifest = _b.sent();\r\n                    return [2 /*return*/, tf.io.loadWeights(manifest, modelBaseUri)];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=loadWeightMap.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { getModelUris } from './common/getModelUris';\r\nimport { loadWeightMap } from './dom';\r\nimport { env } from './env';\r\nvar NeuralNetwork = /** @class */ (function () {\r\n    function NeuralNetwork(_name) {\r\n        this._name = _name;\r\n        this._params = undefined;\r\n        this._paramMappings = [];\r\n    }\r\n    Object.defineProperty(NeuralNetwork.prototype, \"params\", {\r\n        get: function () { return this._params; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NeuralNetwork.prototype, \"paramMappings\", {\r\n        get: function () { return this._paramMappings; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NeuralNetwork.prototype, \"isLoaded\", {\r\n        get: function () { return !!this.params; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    NeuralNetwork.prototype.getParamFromPath = function (paramPath) {\r\n        var _a = this.traversePropertyPath(paramPath), obj = _a.obj, objProp = _a.objProp;\r\n        return obj[objProp];\r\n    };\r\n    NeuralNetwork.prototype.reassignParamFromPath = function (paramPath, tensor) {\r\n        var _a = this.traversePropertyPath(paramPath), obj = _a.obj, objProp = _a.objProp;\r\n        obj[objProp].dispose();\r\n        obj[objProp] = tensor;\r\n    };\r\n    NeuralNetwork.prototype.getParamList = function () {\r\n        var _this = this;\r\n        return this._paramMappings.map(function (_a) {\r\n            var paramPath = _a.paramPath;\r\n            return ({\r\n                path: paramPath,\r\n                tensor: _this.getParamFromPath(paramPath)\r\n            });\r\n        });\r\n    };\r\n    NeuralNetwork.prototype.getTrainableParams = function () {\r\n        return this.getParamList().filter(function (param) { return param.tensor instanceof tf.Variable; });\r\n    };\r\n    NeuralNetwork.prototype.getFrozenParams = function () {\r\n        return this.getParamList().filter(function (param) { return !(param.tensor instanceof tf.Variable); });\r\n    };\r\n    NeuralNetwork.prototype.variable = function () {\r\n        var _this = this;\r\n        this.getFrozenParams().forEach(function (_a) {\r\n            var path = _a.path, tensor = _a.tensor;\r\n            _this.reassignParamFromPath(path, tensor.variable());\r\n        });\r\n    };\r\n    NeuralNetwork.prototype.freeze = function () {\r\n        var _this = this;\r\n        this.getTrainableParams().forEach(function (_a) {\r\n            var path = _a.path, variable = _a.tensor;\r\n            var tensor = tf.tensor(variable.dataSync());\r\n            variable.dispose();\r\n            _this.reassignParamFromPath(path, tensor);\r\n        });\r\n    };\r\n    NeuralNetwork.prototype.dispose = function (throwOnRedispose) {\r\n        if (throwOnRedispose === void 0) { throwOnRedispose = true; }\r\n        this.getParamList().forEach(function (param) {\r\n            if (throwOnRedispose && param.tensor.isDisposed) {\r\n                throw new Error(\"param tensor has already been disposed for path \" + param.path);\r\n            }\r\n            param.tensor.dispose();\r\n        });\r\n        this._params = undefined;\r\n    };\r\n    NeuralNetwork.prototype.serializeParams = function () {\r\n        return new Float32Array(this.getParamList()\r\n            .map(function (_a) {\r\n            var tensor = _a.tensor;\r\n            return Array.from(tensor.dataSync());\r\n        })\r\n            .reduce(function (flat, arr) { return flat.concat(arr); }));\r\n    };\r\n    NeuralNetwork.prototype.load = function (weightsOrUrl) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (weightsOrUrl instanceof Float32Array) {\r\n                            this.extractWeights(weightsOrUrl);\r\n                            return [2 /*return*/];\r\n                        }\r\n                        return [4 /*yield*/, this.loadFromUri(weightsOrUrl)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NeuralNetwork.prototype.loadFromUri = function (uri) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var weightMap;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (uri && typeof uri !== 'string') {\r\n                            throw new Error(this._name + \".loadFromUri - expected model uri\");\r\n                        }\r\n                        return [4 /*yield*/, loadWeightMap(uri, this.getDefaultModelName())];\r\n                    case 1:\r\n                        weightMap = _a.sent();\r\n                        this.loadFromWeightMap(weightMap);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NeuralNetwork.prototype.loadFromDisk = function (filePath) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var readFile, _a, manifestUri, modelBaseUri, fetchWeightsFromDisk, loadWeights, manifest, _b, _c, weightMap;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        if (filePath && typeof filePath !== 'string') {\r\n                            throw new Error(this._name + \".loadFromDisk - expected model file path\");\r\n                        }\r\n                        readFile = env.getEnv().readFile;\r\n                        _a = getModelUris(filePath, this.getDefaultModelName()), manifestUri = _a.manifestUri, modelBaseUri = _a.modelBaseUri;\r\n                        fetchWeightsFromDisk = function (filePaths) { return Promise.all(filePaths.map(function (filePath) { return readFile(filePath).then(function (buf) { return buf.buffer; }); })); };\r\n                        loadWeights = tf.io.weightsLoaderFactory(fetchWeightsFromDisk);\r\n                        _c = (_b = JSON).parse;\r\n                        return [4 /*yield*/, readFile(manifestUri)];\r\n                    case 1:\r\n                        manifest = _c.apply(_b, [(_d.sent()).toString()]);\r\n                        return [4 /*yield*/, loadWeights(manifest, modelBaseUri)];\r\n                    case 2:\r\n                        weightMap = _d.sent();\r\n                        this.loadFromWeightMap(weightMap);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NeuralNetwork.prototype.loadFromWeightMap = function (weightMap) {\r\n        var _a = this.extractParamsFromWeigthMap(weightMap), paramMappings = _a.paramMappings, params = _a.params;\r\n        this._paramMappings = paramMappings;\r\n        this._params = params;\r\n    };\r\n    NeuralNetwork.prototype.extractWeights = function (weights) {\r\n        var _a = this.extractParams(weights), paramMappings = _a.paramMappings, params = _a.params;\r\n        this._paramMappings = paramMappings;\r\n        this._params = params;\r\n    };\r\n    NeuralNetwork.prototype.traversePropertyPath = function (paramPath) {\r\n        if (!this.params) {\r\n            throw new Error(\"traversePropertyPath - model has no loaded params\");\r\n        }\r\n        var result = paramPath.split('/').reduce(function (res, objProp) {\r\n            if (!res.nextObj.hasOwnProperty(objProp)) {\r\n                throw new Error(\"traversePropertyPath - object does not have property \" + objProp + \", for path \" + paramPath);\r\n            }\r\n            return { obj: res.nextObj, objProp: objProp, nextObj: res.nextObj[objProp] };\r\n        }, { nextObj: this.params });\r\n        var obj = result.obj, objProp = result.objProp;\r\n        if (!obj || !objProp || !(obj[objProp] instanceof tf.Tensor)) {\r\n            throw new Error(\"traversePropertyPath - parameter is not a tensor, for path \" + paramPath);\r\n        }\r\n        return { obj: obj, objProp: objProp };\r\n    };\r\n    return NeuralNetwork;\r\n}());\r\nexport { NeuralNetwork };\r\n//# sourceMappingURL=NeuralNetwork.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function depthwiseSeparableConv(x, params, stride) {\r\n    return tf.tidy(function () {\r\n        var out = tf.separableConv2d(x, params.depthwise_filter, params.pointwise_filter, stride, 'same');\r\n        out = tf.add(out, params.bias);\r\n        return out;\r\n    });\r\n}\r\n//# sourceMappingURL=depthwiseSeparableConv.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { depthwiseSeparableConv } from '../common/depthwiseSeparableConv';\r\nexport function denseBlock3(x, denseBlockParams, isFirstLayer) {\r\n    if (isFirstLayer === void 0) { isFirstLayer = false; }\r\n    return tf.tidy(function () {\r\n        var out1 = tf.relu(isFirstLayer\r\n            ? tf.add(tf.conv2d(x, denseBlockParams.conv0.filters, [2, 2], 'same'), denseBlockParams.conv0.bias)\r\n            : depthwiseSeparableConv(x, denseBlockParams.conv0, [2, 2]));\r\n        var out2 = depthwiseSeparableConv(out1, denseBlockParams.conv1, [1, 1]);\r\n        var in3 = tf.relu(tf.add(out1, out2));\r\n        var out3 = depthwiseSeparableConv(in3, denseBlockParams.conv2, [1, 1]);\r\n        return tf.relu(tf.add(out1, tf.add(out2, out3)));\r\n    });\r\n}\r\nexport function denseBlock4(x, denseBlockParams, isFirstLayer, isScaleDown) {\r\n    if (isFirstLayer === void 0) { isFirstLayer = false; }\r\n    if (isScaleDown === void 0) { isScaleDown = true; }\r\n    return tf.tidy(function () {\r\n        var out1 = tf.relu(isFirstLayer\r\n            ? tf.add(tf.conv2d(x, denseBlockParams.conv0.filters, isScaleDown ? [2, 2] : [1, 1], 'same'), denseBlockParams.conv0.bias)\r\n            : depthwiseSeparableConv(x, denseBlockParams.conv0, isScaleDown ? [2, 2] : [1, 1]));\r\n        var out2 = depthwiseSeparableConv(out1, denseBlockParams.conv1, [1, 1]);\r\n        var in3 = tf.relu(tf.add(out1, out2));\r\n        var out3 = depthwiseSeparableConv(in3, denseBlockParams.conv2, [1, 1]);\r\n        var in4 = tf.relu(tf.add(out1, tf.add(out2, out3)));\r\n        var out4 = depthwiseSeparableConv(in4, denseBlockParams.conv3, [1, 1]);\r\n        return tf.relu(tf.add(out1, tf.add(out2, tf.add(out3, out4))));\r\n    });\r\n}\r\n//# sourceMappingURL=denseBlock.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function convLayer(x, params, padding, withRelu) {\r\n    if (padding === void 0) { padding = 'same'; }\r\n    if (withRelu === void 0) { withRelu = false; }\r\n    return tf.tidy(function () {\r\n        var out = tf.add(tf.conv2d(x, params.filters, [1, 1], padding), params.bias);\r\n        return withRelu ? tf.relu(out) : out;\r\n    });\r\n}\r\n//# sourceMappingURL=convLayer.js.map","export function disposeUnusedWeightTensors(weightMap, paramMappings) {\r\n    Object.keys(weightMap).forEach(function (path) {\r\n        if (!paramMappings.some(function (pm) { return pm.originalPath === path; })) {\r\n            weightMap[path].dispose();\r\n        }\r\n    });\r\n}\r\n//# sourceMappingURL=disposeUnusedWeightTensors.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function extractConvParamsFactory(extractWeights, paramMappings) {\r\n    return function (channelsIn, channelsOut, filterSize, mappedPrefix) {\r\n        var filters = tf.tensor4d(extractWeights(channelsIn * channelsOut * filterSize * filterSize), [filterSize, filterSize, channelsIn, channelsOut]);\r\n        var bias = tf.tensor1d(extractWeights(channelsOut));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/filters\" }, { paramPath: mappedPrefix + \"/bias\" });\r\n        return { filters: filters, bias: bias };\r\n    };\r\n}\r\n//# sourceMappingURL=extractConvParamsFactory.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function extractFCParamsFactory(extractWeights, paramMappings) {\r\n    return function (channelsIn, channelsOut, mappedPrefix) {\r\n        var fc_weights = tf.tensor2d(extractWeights(channelsIn * channelsOut), [channelsIn, channelsOut]);\r\n        var fc_bias = tf.tensor1d(extractWeights(channelsOut));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/weights\" }, { paramPath: mappedPrefix + \"/bias\" });\r\n        return {\r\n            weights: fc_weights,\r\n            bias: fc_bias\r\n        };\r\n    };\r\n}\r\n//# sourceMappingURL=extractFCParamsFactory.js.map","var SeparableConvParams = /** @class */ (function () {\r\n    function SeparableConvParams(depthwise_filter, pointwise_filter, bias) {\r\n        this.depthwise_filter = depthwise_filter;\r\n        this.pointwise_filter = pointwise_filter;\r\n        this.bias = bias;\r\n    }\r\n    return SeparableConvParams;\r\n}());\r\nexport { SeparableConvParams };\r\n//# sourceMappingURL=types.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { SeparableConvParams } from './types';\r\nexport function extractSeparableConvParamsFactory(extractWeights, paramMappings) {\r\n    return function (channelsIn, channelsOut, mappedPrefix) {\r\n        var depthwise_filter = tf.tensor4d(extractWeights(3 * 3 * channelsIn), [3, 3, channelsIn, 1]);\r\n        var pointwise_filter = tf.tensor4d(extractWeights(channelsIn * channelsOut), [1, 1, channelsIn, channelsOut]);\r\n        var bias = tf.tensor1d(extractWeights(channelsOut));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/depthwise_filter\" }, { paramPath: mappedPrefix + \"/pointwise_filter\" }, { paramPath: mappedPrefix + \"/bias\" });\r\n        return new SeparableConvParams(depthwise_filter, pointwise_filter, bias);\r\n    };\r\n}\r\nexport function loadSeparableConvParamsFactory(extractWeightEntry) {\r\n    return function (prefix) {\r\n        var depthwise_filter = extractWeightEntry(prefix + \"/depthwise_filter\", 4);\r\n        var pointwise_filter = extractWeightEntry(prefix + \"/pointwise_filter\", 4);\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return new SeparableConvParams(depthwise_filter, pointwise_filter, bias);\r\n    };\r\n}\r\n//# sourceMappingURL=extractSeparableConvParamsFactory.js.map","import { isTensor } from '../utils';\r\nexport function extractWeightEntryFactory(weightMap, paramMappings) {\r\n    return function (originalPath, paramRank, mappedPath) {\r\n        var tensor = weightMap[originalPath];\r\n        if (!isTensor(tensor, paramRank)) {\r\n            throw new Error(\"expected weightMap[\" + originalPath + \"] to be a Tensor\" + paramRank + \"D, instead have \" + tensor);\r\n        }\r\n        paramMappings.push({ originalPath: originalPath, paramPath: mappedPath || originalPath });\r\n        return tensor;\r\n    };\r\n}\r\n//# sourceMappingURL=extractWeightEntryFactory.js.map","export function extractWeightsFactory(weights) {\r\n    var remainingWeights = weights;\r\n    function extractWeights(numWeights) {\r\n        var ret = remainingWeights.slice(0, numWeights);\r\n        remainingWeights = remainingWeights.slice(numWeights);\r\n        return ret;\r\n    }\r\n    function getRemainingWeights() {\r\n        return remainingWeights;\r\n    }\r\n    return {\r\n        extractWeights: extractWeights,\r\n        getRemainingWeights: getRemainingWeights\r\n    };\r\n}\r\n//# sourceMappingURL=extractWeightsFactory.js.map","import { extractConvParamsFactory, extractSeparableConvParamsFactory, } from '../common';\r\nexport function extractorsFactory(extractWeights, paramMappings) {\r\n    var extractConvParams = extractConvParamsFactory(extractWeights, paramMappings);\r\n    var extractSeparableConvParams = extractSeparableConvParamsFactory(extractWeights, paramMappings);\r\n    function extractDenseBlock3Params(channelsIn, channelsOut, mappedPrefix, isFirstLayer) {\r\n        if (isFirstLayer === void 0) { isFirstLayer = false; }\r\n        var conv0 = isFirstLayer\r\n            ? extractConvParams(channelsIn, channelsOut, 3, mappedPrefix + \"/conv0\")\r\n            : extractSeparableConvParams(channelsIn, channelsOut, mappedPrefix + \"/conv0\");\r\n        var conv1 = extractSeparableConvParams(channelsOut, channelsOut, mappedPrefix + \"/conv1\");\r\n        var conv2 = extractSeparableConvParams(channelsOut, channelsOut, mappedPrefix + \"/conv2\");\r\n        return { conv0: conv0, conv1: conv1, conv2: conv2 };\r\n    }\r\n    function extractDenseBlock4Params(channelsIn, channelsOut, mappedPrefix, isFirstLayer) {\r\n        if (isFirstLayer === void 0) { isFirstLayer = false; }\r\n        var _a = extractDenseBlock3Params(channelsIn, channelsOut, mappedPrefix, isFirstLayer), conv0 = _a.conv0, conv1 = _a.conv1, conv2 = _a.conv2;\r\n        var conv3 = extractSeparableConvParams(channelsOut, channelsOut, mappedPrefix + \"/conv3\");\r\n        return { conv0: conv0, conv1: conv1, conv2: conv2, conv3: conv3 };\r\n    }\r\n    return {\r\n        extractDenseBlock3Params: extractDenseBlock3Params,\r\n        extractDenseBlock4Params: extractDenseBlock4Params\r\n    };\r\n}\r\n//# sourceMappingURL=extractorsFactory.js.map","import { extractWeightsFactory } from '../common';\r\nimport { extractorsFactory } from './extractorsFactory';\r\nexport function extractParams(weights) {\r\n    var paramMappings = [];\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var extractDenseBlock4Params = extractorsFactory(extractWeights, paramMappings).extractDenseBlock4Params;\r\n    var dense0 = extractDenseBlock4Params(3, 32, 'dense0', true);\r\n    var dense1 = extractDenseBlock4Params(32, 64, 'dense1');\r\n    var dense2 = extractDenseBlock4Params(64, 128, 'dense2');\r\n    var dense3 = extractDenseBlock4Params(128, 256, 'dense3');\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return {\r\n        paramMappings: paramMappings,\r\n        params: { dense0: dense0, dense1: dense1, dense2: dense2, dense3: dense3 }\r\n    };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","export function loadConvParamsFactory(extractWeightEntry) {\r\n    return function (prefix) {\r\n        var filters = extractWeightEntry(prefix + \"/filters\", 4);\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return { filters: filters, bias: bias };\r\n    };\r\n}\r\n//# sourceMappingURL=loadConvParamsFactory.js.map","import { extractWeightEntryFactory, loadSeparableConvParamsFactory } from '../common';\r\nimport { loadConvParamsFactory } from '../common/loadConvParamsFactory';\r\nexport function loadParamsFactory(weightMap, paramMappings) {\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    var extractConvParams = loadConvParamsFactory(extractWeightEntry);\r\n    var extractSeparableConvParams = loadSeparableConvParamsFactory(extractWeightEntry);\r\n    function extractDenseBlock3Params(prefix, isFirstLayer) {\r\n        if (isFirstLayer === void 0) { isFirstLayer = false; }\r\n        var conv0 = isFirstLayer\r\n            ? extractConvParams(prefix + \"/conv0\")\r\n            : extractSeparableConvParams(prefix + \"/conv0\");\r\n        var conv1 = extractSeparableConvParams(prefix + \"/conv1\");\r\n        var conv2 = extractSeparableConvParams(prefix + \"/conv2\");\r\n        return { conv0: conv0, conv1: conv1, conv2: conv2 };\r\n    }\r\n    function extractDenseBlock4Params(prefix, isFirstLayer) {\r\n        if (isFirstLayer === void 0) { isFirstLayer = false; }\r\n        var conv0 = isFirstLayer\r\n            ? extractConvParams(prefix + \"/conv0\")\r\n            : extractSeparableConvParams(prefix + \"/conv0\");\r\n        var conv1 = extractSeparableConvParams(prefix + \"/conv1\");\r\n        var conv2 = extractSeparableConvParams(prefix + \"/conv2\");\r\n        var conv3 = extractSeparableConvParams(prefix + \"/conv3\");\r\n        return { conv0: conv0, conv1: conv1, conv2: conv2, conv3: conv3 };\r\n    }\r\n    return {\r\n        extractDenseBlock3Params: extractDenseBlock3Params,\r\n        extractDenseBlock4Params: extractDenseBlock4Params\r\n    };\r\n}\r\n//# sourceMappingURL=loadParamsFactory.js.map","import { disposeUnusedWeightTensors } from '../common';\r\nimport { loadParamsFactory } from './loadParamsFactory';\r\nexport function extractParamsFromWeigthMap(weightMap) {\r\n    var paramMappings = [];\r\n    var extractDenseBlock4Params = loadParamsFactory(weightMap, paramMappings).extractDenseBlock4Params;\r\n    var params = {\r\n        dense0: extractDenseBlock4Params('dense0', true),\r\n        dense1: extractDenseBlock4Params('dense1'),\r\n        dense2: extractDenseBlock4Params('dense2'),\r\n        dense3: extractDenseBlock4Params('dense3')\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { toNetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { normalize } from '../ops';\r\nimport { denseBlock4 } from './denseBlock';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nvar FaceFeatureExtractor = /** @class */ (function (_super) {\r\n    __extends(FaceFeatureExtractor, _super);\r\n    function FaceFeatureExtractor() {\r\n        return _super.call(this, 'FaceFeatureExtractor') || this;\r\n    }\r\n    FaceFeatureExtractor.prototype.forwardInput = function (input) {\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error('FaceFeatureExtractor - load model before inference');\r\n        }\r\n        return tf.tidy(function () {\r\n            var batchTensor = input.toBatchTensor(112, true);\r\n            var meanRgb = [122.782, 117.001, 104.298];\r\n            var normalized = normalize(batchTensor, meanRgb).div(tf.scalar(255));\r\n            var out = denseBlock4(normalized, params.dense0, true);\r\n            out = denseBlock4(out, params.dense1);\r\n            out = denseBlock4(out, params.dense2);\r\n            out = denseBlock4(out, params.dense3);\r\n            out = tf.avgPool(out, [7, 7], [2, 2], 'valid');\r\n            return out;\r\n        });\r\n    };\r\n    FaceFeatureExtractor.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceFeatureExtractor.prototype.getDefaultModelName = function () {\r\n        return 'face_feature_extractor_model';\r\n    };\r\n    FaceFeatureExtractor.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMap(weightMap);\r\n    };\r\n    FaceFeatureExtractor.prototype.extractParams = function (weights) {\r\n        return extractParams(weights);\r\n    };\r\n    return FaceFeatureExtractor;\r\n}(NeuralNetwork));\r\nexport { FaceFeatureExtractor };\r\n//# sourceMappingURL=FaceFeatureExtractor.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function fullyConnectedLayer(x, params) {\r\n    return tf.tidy(function () {\r\n        return tf.add(tf.matMul(x, params.weights), params.bias);\r\n    });\r\n}\r\n//# sourceMappingURL=fullyConnectedLayer.js.map","import { extractFCParamsFactory, extractWeightsFactory } from '../common';\r\nexport function extractParams(weights, channelsIn, channelsOut) {\r\n    var paramMappings = [];\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var extractFCParams = extractFCParamsFactory(extractWeights, paramMappings);\r\n    var fc = extractFCParams(channelsIn, channelsOut, 'fc');\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return {\r\n        paramMappings: paramMappings,\r\n        params: { fc: fc }\r\n    };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { disposeUnusedWeightTensors, extractWeightEntryFactory } from '../common';\r\nexport function extractParamsFromWeigthMap(weightMap) {\r\n    var paramMappings = [];\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    function extractFcParams(prefix) {\r\n        var weights = extractWeightEntry(prefix + \"/weights\", 2);\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return { weights: weights, bias: bias };\r\n    }\r\n    var params = {\r\n        fc: extractFcParams('fc')\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","export function seperateWeightMaps(weightMap) {\r\n    var featureExtractorMap = {};\r\n    var classifierMap = {};\r\n    Object.keys(weightMap).forEach(function (key) {\r\n        var map = key.startsWith('fc') ? classifierMap : featureExtractorMap;\r\n        map[key] = weightMap[key];\r\n    });\r\n    return { featureExtractorMap: featureExtractorMap, classifierMap: classifierMap };\r\n}\r\n//# sourceMappingURL=util.js.map","import { __extends } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\r\nimport { NetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nimport { seperateWeightMaps } from './util';\r\nvar FaceProcessor = /** @class */ (function (_super) {\r\n    __extends(FaceProcessor, _super);\r\n    function FaceProcessor(_name, faceFeatureExtractor) {\r\n        var _this = _super.call(this, _name) || this;\r\n        _this._faceFeatureExtractor = faceFeatureExtractor;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(FaceProcessor.prototype, \"faceFeatureExtractor\", {\r\n        get: function () {\r\n            return this._faceFeatureExtractor;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FaceProcessor.prototype.runNet = function (input) {\r\n        var _this = this;\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error(this._name + \" - load model before inference\");\r\n        }\r\n        return tf.tidy(function () {\r\n            var bottleneckFeatures = input instanceof NetInput\r\n                ? _this.faceFeatureExtractor.forwardInput(input)\r\n                : input;\r\n            return fullyConnectedLayer(bottleneckFeatures.as2D(bottleneckFeatures.shape[0], -1), params.fc);\r\n        });\r\n    };\r\n    FaceProcessor.prototype.dispose = function (throwOnRedispose) {\r\n        if (throwOnRedispose === void 0) { throwOnRedispose = true; }\r\n        this.faceFeatureExtractor.dispose(throwOnRedispose);\r\n        _super.prototype.dispose.call(this, throwOnRedispose);\r\n    };\r\n    FaceProcessor.prototype.loadClassifierParams = function (weights) {\r\n        var _a = this.extractClassifierParams(weights), params = _a.params, paramMappings = _a.paramMappings;\r\n        this._params = params;\r\n        this._paramMappings = paramMappings;\r\n    };\r\n    FaceProcessor.prototype.extractClassifierParams = function (weights) {\r\n        return extractParams(weights, this.getClassifierChannelsIn(), this.getClassifierChannelsOut());\r\n    };\r\n    FaceProcessor.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        var _a = seperateWeightMaps(weightMap), featureExtractorMap = _a.featureExtractorMap, classifierMap = _a.classifierMap;\r\n        this.faceFeatureExtractor.loadFromWeightMap(featureExtractorMap);\r\n        return extractParamsFromWeigthMap(classifierMap);\r\n    };\r\n    FaceProcessor.prototype.extractParams = function (weights) {\r\n        var cIn = this.getClassifierChannelsIn();\r\n        var cOut = this.getClassifierChannelsOut();\r\n        var classifierWeightSize = (cOut * cIn) + cOut;\r\n        var featureExtractorWeights = weights.slice(0, weights.length - classifierWeightSize);\r\n        var classifierWeights = weights.slice(weights.length - classifierWeightSize);\r\n        this.faceFeatureExtractor.extractWeights(featureExtractorWeights);\r\n        return this.extractClassifierParams(classifierWeights);\r\n    };\r\n    return FaceProcessor;\r\n}(NeuralNetwork));\r\nexport { FaceProcessor };\r\n//# sourceMappingURL=FaceProcessor.js.map","export var FACE_EXPRESSION_LABELS = ['neutral', 'happy', 'sad', 'angry', 'fearful', 'disgusted', 'surprised'];\r\nvar FaceExpressions = /** @class */ (function () {\r\n    function FaceExpressions(probabilities) {\r\n        var _this = this;\r\n        if (probabilities.length !== 7) {\r\n            throw new Error(\"FaceExpressions.constructor - expected probabilities.length to be 7, have: \" + probabilities.length);\r\n        }\r\n        FACE_EXPRESSION_LABELS.forEach(function (expression, idx) {\r\n            _this[expression] = probabilities[idx];\r\n        });\r\n    }\r\n    FaceExpressions.prototype.asSortedArray = function () {\r\n        var _this = this;\r\n        return FACE_EXPRESSION_LABELS\r\n            .map(function (expression) { return ({ expression: expression, probability: _this[expression] }); })\r\n            .sort(function (e0, e1) { return e1.probability - e0.probability; });\r\n    };\r\n    return FaceExpressions;\r\n}());\r\nexport { FaceExpressions };\r\n//# sourceMappingURL=FaceExpressions.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { toNetInput } from '../dom';\r\nimport { FaceFeatureExtractor } from '../faceFeatureExtractor/FaceFeatureExtractor';\r\nimport { FaceProcessor } from '../faceProcessor/FaceProcessor';\r\nimport { FaceExpressions } from './FaceExpressions';\r\nvar FaceExpressionNet = /** @class */ (function (_super) {\r\n    __extends(FaceExpressionNet, _super);\r\n    function FaceExpressionNet(faceFeatureExtractor) {\r\n        if (faceFeatureExtractor === void 0) { faceFeatureExtractor = new FaceFeatureExtractor(); }\r\n        return _super.call(this, 'FaceExpressionNet', faceFeatureExtractor) || this;\r\n    }\r\n    FaceExpressionNet.prototype.forwardInput = function (input) {\r\n        var _this = this;\r\n        return tf.tidy(function () { return tf.softmax(_this.runNet(input)); });\r\n    };\r\n    FaceExpressionNet.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceExpressionNet.prototype.predictExpressions = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var netInput, out, probabilitesByBatch, predictionsByBatch;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, toNetInput(input)];\r\n                    case 1:\r\n                        netInput = _a.sent();\r\n                        return [4 /*yield*/, this.forwardInput(netInput)];\r\n                    case 2:\r\n                        out = _a.sent();\r\n                        return [4 /*yield*/, Promise.all(tf.unstack(out).map(function (t) { return __awaiter(_this, void 0, void 0, function () {\r\n                                var data;\r\n                                return __generator(this, function (_a) {\r\n                                    switch (_a.label) {\r\n                                        case 0: return [4 /*yield*/, t.data()];\r\n                                        case 1:\r\n                                            data = _a.sent();\r\n                                            t.dispose();\r\n                                            return [2 /*return*/, data];\r\n                                    }\r\n                                });\r\n                            }); }))];\r\n                    case 3:\r\n                        probabilitesByBatch = _a.sent();\r\n                        out.dispose();\r\n                        predictionsByBatch = probabilitesByBatch\r\n                            .map(function (probabilites) { return new FaceExpressions(probabilites); });\r\n                        return [2 /*return*/, netInput.isBatchInput\r\n                                ? predictionsByBatch\r\n                                : predictionsByBatch[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceExpressionNet.prototype.getDefaultModelName = function () {\r\n        return 'face_expression_model';\r\n    };\r\n    FaceExpressionNet.prototype.getClassifierChannelsIn = function () {\r\n        return 256;\r\n    };\r\n    FaceExpressionNet.prototype.getClassifierChannelsOut = function () {\r\n        return 7;\r\n    };\r\n    return FaceExpressionNet;\r\n}(FaceProcessor));\r\nexport { FaceExpressionNet };\r\n//# sourceMappingURL=FaceExpressionNet.js.map","import { FaceExpressions } from '../faceExpressionNet/FaceExpressions';\r\nexport function isWithFaceExpressions(obj) {\r\n    return obj['expressions'] instanceof FaceExpressions;\r\n}\r\nexport function extendWithFaceExpressions(sourceObj, expressions) {\r\n    var extension = { expressions: expressions };\r\n    return Object.assign({}, sourceObj, extension);\r\n}\r\n//# sourceMappingURL=WithFaceExpressions.js.map","import { FaceDetection } from '../classes/FaceDetection';\r\nimport { FaceLandmarks } from '../classes/FaceLandmarks';\r\nimport { isWithFaceDetection } from './WithFaceDetection';\r\nexport function isWithFaceLandmarks(obj) {\r\n    return isWithFaceDetection(obj)\r\n        && obj['landmarks'] instanceof FaceLandmarks\r\n        && obj['unshiftedLandmarks'] instanceof FaceLandmarks\r\n        && obj['alignedRect'] instanceof FaceDetection;\r\n}\r\nexport function extendWithFaceLandmarks(sourceObj, unshiftedLandmarks) {\r\n    var shift = sourceObj.detection.box;\r\n    var landmarks = unshiftedLandmarks.shiftBy(shift.x, shift.y);\r\n    var rect = landmarks.align();\r\n    var imageDims = sourceObj.detection.imageDims;\r\n    var alignedRect = new FaceDetection(sourceObj.detection.score, rect.rescale(imageDims.reverse()), imageDims);\r\n    var extension = {\r\n        landmarks: landmarks,\r\n        unshiftedLandmarks: unshiftedLandmarks,\r\n        alignedRect: alignedRect\r\n    };\r\n    return Object.assign({}, sourceObj, extension);\r\n}\r\n//# sourceMappingURL=WithFaceLandmarks.js.map","import { extractConvParamsFactory, extractSeparableConvParamsFactory, extractWeightsFactory } from '../common';\r\nimport { range } from '../utils';\r\nfunction extractorsFactory(extractWeights, paramMappings) {\r\n    var extractConvParams = extractConvParamsFactory(extractWeights, paramMappings);\r\n    var extractSeparableConvParams = extractSeparableConvParamsFactory(extractWeights, paramMappings);\r\n    function extractReductionBlockParams(channelsIn, channelsOut, mappedPrefix) {\r\n        var separable_conv0 = extractSeparableConvParams(channelsIn, channelsOut, mappedPrefix + \"/separable_conv0\");\r\n        var separable_conv1 = extractSeparableConvParams(channelsOut, channelsOut, mappedPrefix + \"/separable_conv1\");\r\n        var expansion_conv = extractConvParams(channelsIn, channelsOut, 1, mappedPrefix + \"/expansion_conv\");\r\n        return { separable_conv0: separable_conv0, separable_conv1: separable_conv1, expansion_conv: expansion_conv };\r\n    }\r\n    function extractMainBlockParams(channels, mappedPrefix) {\r\n        var separable_conv0 = extractSeparableConvParams(channels, channels, mappedPrefix + \"/separable_conv0\");\r\n        var separable_conv1 = extractSeparableConvParams(channels, channels, mappedPrefix + \"/separable_conv1\");\r\n        var separable_conv2 = extractSeparableConvParams(channels, channels, mappedPrefix + \"/separable_conv2\");\r\n        return { separable_conv0: separable_conv0, separable_conv1: separable_conv1, separable_conv2: separable_conv2 };\r\n    }\r\n    return {\r\n        extractConvParams: extractConvParams,\r\n        extractSeparableConvParams: extractSeparableConvParams,\r\n        extractReductionBlockParams: extractReductionBlockParams,\r\n        extractMainBlockParams: extractMainBlockParams\r\n    };\r\n}\r\nexport function extractParams(weights, numMainBlocks) {\r\n    var paramMappings = [];\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var _b = extractorsFactory(extractWeights, paramMappings), extractConvParams = _b.extractConvParams, extractSeparableConvParams = _b.extractSeparableConvParams, extractReductionBlockParams = _b.extractReductionBlockParams, extractMainBlockParams = _b.extractMainBlockParams;\r\n    var entry_flow_conv_in = extractConvParams(3, 32, 3, 'entry_flow/conv_in');\r\n    var entry_flow_reduction_block_0 = extractReductionBlockParams(32, 64, 'entry_flow/reduction_block_0');\r\n    var entry_flow_reduction_block_1 = extractReductionBlockParams(64, 128, 'entry_flow/reduction_block_1');\r\n    var entry_flow = {\r\n        conv_in: entry_flow_conv_in,\r\n        reduction_block_0: entry_flow_reduction_block_0,\r\n        reduction_block_1: entry_flow_reduction_block_1\r\n    };\r\n    var middle_flow = {};\r\n    range(numMainBlocks, 0, 1).forEach(function (idx) {\r\n        middle_flow[\"main_block_\" + idx] = extractMainBlockParams(128, \"middle_flow/main_block_\" + idx);\r\n    });\r\n    var exit_flow_reduction_block = extractReductionBlockParams(128, 256, 'exit_flow/reduction_block');\r\n    var exit_flow_separable_conv = extractSeparableConvParams(256, 512, 'exit_flow/separable_conv');\r\n    var exit_flow = {\r\n        reduction_block: exit_flow_reduction_block,\r\n        separable_conv: exit_flow_separable_conv\r\n    };\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return {\r\n        paramMappings: paramMappings,\r\n        params: { entry_flow: entry_flow, middle_flow: middle_flow, exit_flow: exit_flow }\r\n    };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { disposeUnusedWeightTensors, extractWeightEntryFactory, loadSeparableConvParamsFactory, } from '../common';\r\nimport { loadConvParamsFactory } from '../common/loadConvParamsFactory';\r\nimport { range } from '../utils';\r\nfunction loadParamsFactory(weightMap, paramMappings) {\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    var extractConvParams = loadConvParamsFactory(extractWeightEntry);\r\n    var extractSeparableConvParams = loadSeparableConvParamsFactory(extractWeightEntry);\r\n    function extractReductionBlockParams(mappedPrefix) {\r\n        var separable_conv0 = extractSeparableConvParams(mappedPrefix + \"/separable_conv0\");\r\n        var separable_conv1 = extractSeparableConvParams(mappedPrefix + \"/separable_conv1\");\r\n        var expansion_conv = extractConvParams(mappedPrefix + \"/expansion_conv\");\r\n        return { separable_conv0: separable_conv0, separable_conv1: separable_conv1, expansion_conv: expansion_conv };\r\n    }\r\n    function extractMainBlockParams(mappedPrefix) {\r\n        var separable_conv0 = extractSeparableConvParams(mappedPrefix + \"/separable_conv0\");\r\n        var separable_conv1 = extractSeparableConvParams(mappedPrefix + \"/separable_conv1\");\r\n        var separable_conv2 = extractSeparableConvParams(mappedPrefix + \"/separable_conv2\");\r\n        return { separable_conv0: separable_conv0, separable_conv1: separable_conv1, separable_conv2: separable_conv2 };\r\n    }\r\n    return {\r\n        extractConvParams: extractConvParams,\r\n        extractSeparableConvParams: extractSeparableConvParams,\r\n        extractReductionBlockParams: extractReductionBlockParams,\r\n        extractMainBlockParams: extractMainBlockParams\r\n    };\r\n}\r\nexport function extractParamsFromWeigthMap(weightMap, numMainBlocks) {\r\n    var paramMappings = [];\r\n    var _a = loadParamsFactory(weightMap, paramMappings), extractConvParams = _a.extractConvParams, extractSeparableConvParams = _a.extractSeparableConvParams, extractReductionBlockParams = _a.extractReductionBlockParams, extractMainBlockParams = _a.extractMainBlockParams;\r\n    var entry_flow_conv_in = extractConvParams('entry_flow/conv_in');\r\n    var entry_flow_reduction_block_0 = extractReductionBlockParams('entry_flow/reduction_block_0');\r\n    var entry_flow_reduction_block_1 = extractReductionBlockParams('entry_flow/reduction_block_1');\r\n    var entry_flow = {\r\n        conv_in: entry_flow_conv_in,\r\n        reduction_block_0: entry_flow_reduction_block_0,\r\n        reduction_block_1: entry_flow_reduction_block_1\r\n    };\r\n    var middle_flow = {};\r\n    range(numMainBlocks, 0, 1).forEach(function (idx) {\r\n        middle_flow[\"main_block_\" + idx] = extractMainBlockParams(\"middle_flow/main_block_\" + idx);\r\n    });\r\n    var exit_flow_reduction_block = extractReductionBlockParams('exit_flow/reduction_block');\r\n    var exit_flow_separable_conv = extractSeparableConvParams('exit_flow/separable_conv');\r\n    var exit_flow = {\r\n        reduction_block: exit_flow_reduction_block,\r\n        separable_conv: exit_flow_separable_conv\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: { entry_flow: entry_flow, middle_flow: middle_flow, exit_flow: exit_flow }, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { depthwiseSeparableConv } from '../common';\r\nimport { toNetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { normalize } from '../ops';\r\nimport { range } from '../utils';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nfunction conv(x, params, stride) {\r\n    return tf.add(tf.conv2d(x, params.filters, stride, 'same'), params.bias);\r\n}\r\nfunction reductionBlock(x, params, isActivateInput) {\r\n    if (isActivateInput === void 0) { isActivateInput = true; }\r\n    var out = isActivateInput ? tf.relu(x) : x;\r\n    out = depthwiseSeparableConv(out, params.separable_conv0, [1, 1]);\r\n    out = depthwiseSeparableConv(tf.relu(out), params.separable_conv1, [1, 1]);\r\n    out = tf.maxPool(out, [3, 3], [2, 2], 'same');\r\n    out = tf.add(out, conv(x, params.expansion_conv, [2, 2]));\r\n    return out;\r\n}\r\nfunction mainBlock(x, params) {\r\n    var out = depthwiseSeparableConv(tf.relu(x), params.separable_conv0, [1, 1]);\r\n    out = depthwiseSeparableConv(tf.relu(out), params.separable_conv1, [1, 1]);\r\n    out = depthwiseSeparableConv(tf.relu(out), params.separable_conv2, [1, 1]);\r\n    out = tf.add(out, x);\r\n    return out;\r\n}\r\nvar TinyXception = /** @class */ (function (_super) {\r\n    __extends(TinyXception, _super);\r\n    function TinyXception(numMainBlocks) {\r\n        var _this = _super.call(this, 'TinyXception') || this;\r\n        _this._numMainBlocks = numMainBlocks;\r\n        return _this;\r\n    }\r\n    TinyXception.prototype.forwardInput = function (input) {\r\n        var _this = this;\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error('TinyXception - load model before inference');\r\n        }\r\n        return tf.tidy(function () {\r\n            var batchTensor = input.toBatchTensor(112, true);\r\n            var meanRgb = [122.782, 117.001, 104.298];\r\n            var normalized = normalize(batchTensor, meanRgb).div(tf.scalar(256));\r\n            var out = tf.relu(conv(normalized, params.entry_flow.conv_in, [2, 2]));\r\n            out = reductionBlock(out, params.entry_flow.reduction_block_0, false);\r\n            out = reductionBlock(out, params.entry_flow.reduction_block_1);\r\n            range(_this._numMainBlocks, 0, 1).forEach(function (idx) {\r\n                out = mainBlock(out, params.middle_flow[\"main_block_\" + idx]);\r\n            });\r\n            out = reductionBlock(out, params.exit_flow.reduction_block);\r\n            out = tf.relu(depthwiseSeparableConv(out, params.exit_flow.separable_conv, [1, 1]));\r\n            return out;\r\n        });\r\n    };\r\n    TinyXception.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyXception.prototype.getDefaultModelName = function () {\r\n        return 'tiny_xception_model';\r\n    };\r\n    TinyXception.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMap(weightMap, this._numMainBlocks);\r\n    };\r\n    TinyXception.prototype.extractParams = function (weights) {\r\n        return extractParams(weights, this._numMainBlocks);\r\n    };\r\n    return TinyXception;\r\n}(NeuralNetwork));\r\nexport { TinyXception };\r\n//# sourceMappingURL=TinyXception.js.map","import { extractFCParamsFactory, extractWeightsFactory } from '../common';\r\nexport function extractParams(weights) {\r\n    var paramMappings = [];\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var extractFCParams = extractFCParamsFactory(extractWeights, paramMappings);\r\n    var age = extractFCParams(512, 1, 'fc/age');\r\n    var gender = extractFCParams(512, 2, 'fc/gender');\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return {\r\n        paramMappings: paramMappings,\r\n        params: { fc: { age: age, gender: gender } }\r\n    };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { disposeUnusedWeightTensors, extractWeightEntryFactory } from '../common';\r\nexport function extractParamsFromWeigthMap(weightMap) {\r\n    var paramMappings = [];\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    function extractFcParams(prefix) {\r\n        var weights = extractWeightEntry(prefix + \"/weights\", 2);\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return { weights: weights, bias: bias };\r\n    }\r\n    var params = {\r\n        fc: {\r\n            age: extractFcParams('fc/age'),\r\n            gender: extractFcParams('fc/gender')\r\n        }\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","export var Gender;\r\n(function (Gender) {\r\n    Gender[\"FEMALE\"] = \"female\";\r\n    Gender[\"MALE\"] = \"male\";\r\n})(Gender || (Gender = {}));\r\n//# sourceMappingURL=types.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\r\nimport { seperateWeightMaps } from '../faceProcessor/util';\r\nimport { TinyXception } from '../xception/TinyXception';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nimport { Gender } from './types';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { NetInput, toNetInput } from '../dom';\r\nvar AgeGenderNet = /** @class */ (function (_super) {\r\n    __extends(AgeGenderNet, _super);\r\n    function AgeGenderNet(faceFeatureExtractor) {\r\n        if (faceFeatureExtractor === void 0) { faceFeatureExtractor = new TinyXception(2); }\r\n        var _this = _super.call(this, 'AgeGenderNet') || this;\r\n        _this._faceFeatureExtractor = faceFeatureExtractor;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(AgeGenderNet.prototype, \"faceFeatureExtractor\", {\r\n        get: function () {\r\n            return this._faceFeatureExtractor;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AgeGenderNet.prototype.runNet = function (input) {\r\n        var _this = this;\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error(this._name + \" - load model before inference\");\r\n        }\r\n        return tf.tidy(function () {\r\n            var bottleneckFeatures = input instanceof NetInput\r\n                ? _this.faceFeatureExtractor.forwardInput(input)\r\n                : input;\r\n            var pooled = tf.avgPool(bottleneckFeatures, [7, 7], [2, 2], 'valid').as2D(bottleneckFeatures.shape[0], -1);\r\n            var age = fullyConnectedLayer(pooled, params.fc.age).as1D();\r\n            var gender = fullyConnectedLayer(pooled, params.fc.gender);\r\n            return { age: age, gender: gender };\r\n        });\r\n    };\r\n    AgeGenderNet.prototype.forwardInput = function (input) {\r\n        var _this = this;\r\n        return tf.tidy(function () {\r\n            var _a = _this.runNet(input), age = _a.age, gender = _a.gender;\r\n            return { age: age, gender: tf.softmax(gender) };\r\n        });\r\n    };\r\n    AgeGenderNet.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AgeGenderNet.prototype.predictAgeAndGender = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var netInput, out, ages, genders, ageAndGenderTensors, predictionsByBatch;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, toNetInput(input)];\r\n                    case 1:\r\n                        netInput = _a.sent();\r\n                        return [4 /*yield*/, this.forwardInput(netInput)];\r\n                    case 2:\r\n                        out = _a.sent();\r\n                        ages = tf.unstack(out.age);\r\n                        genders = tf.unstack(out.gender);\r\n                        ageAndGenderTensors = ages.map(function (ageTensor, i) { return ({\r\n                            ageTensor: ageTensor,\r\n                            genderTensor: genders[i]\r\n                        }); });\r\n                        return [4 /*yield*/, Promise.all(ageAndGenderTensors.map(function (_a) {\r\n                                var ageTensor = _a.ageTensor, genderTensor = _a.genderTensor;\r\n                                return __awaiter(_this, void 0, void 0, function () {\r\n                                    var age, probMale, isMale, gender, genderProbability;\r\n                                    return __generator(this, function (_b) {\r\n                                        switch (_b.label) {\r\n                                            case 0: return [4 /*yield*/, ageTensor.data()];\r\n                                            case 1:\r\n                                                age = (_b.sent())[0];\r\n                                                return [4 /*yield*/, genderTensor.data()];\r\n                                            case 2:\r\n                                                probMale = (_b.sent())[0];\r\n                                                isMale = probMale > 0.5;\r\n                                                gender = isMale ? Gender.MALE : Gender.FEMALE;\r\n                                                genderProbability = isMale ? probMale : (1 - probMale);\r\n                                                ageTensor.dispose();\r\n                                                genderTensor.dispose();\r\n                                                return [2 /*return*/, { age: age, gender: gender, genderProbability: genderProbability }];\r\n                                        }\r\n                                    });\r\n                                });\r\n                            }))];\r\n                    case 3:\r\n                        predictionsByBatch = _a.sent();\r\n                        out.age.dispose();\r\n                        out.gender.dispose();\r\n                        return [2 /*return*/, netInput.isBatchInput\r\n                                ? predictionsByBatch\r\n                                : predictionsByBatch[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AgeGenderNet.prototype.getDefaultModelName = function () {\r\n        return 'age_gender_model';\r\n    };\r\n    AgeGenderNet.prototype.dispose = function (throwOnRedispose) {\r\n        if (throwOnRedispose === void 0) { throwOnRedispose = true; }\r\n        this.faceFeatureExtractor.dispose(throwOnRedispose);\r\n        _super.prototype.dispose.call(this, throwOnRedispose);\r\n    };\r\n    AgeGenderNet.prototype.loadClassifierParams = function (weights) {\r\n        var _a = this.extractClassifierParams(weights), params = _a.params, paramMappings = _a.paramMappings;\r\n        this._params = params;\r\n        this._paramMappings = paramMappings;\r\n    };\r\n    AgeGenderNet.prototype.extractClassifierParams = function (weights) {\r\n        return extractParams(weights);\r\n    };\r\n    AgeGenderNet.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        var _a = seperateWeightMaps(weightMap), featureExtractorMap = _a.featureExtractorMap, classifierMap = _a.classifierMap;\r\n        this.faceFeatureExtractor.loadFromWeightMap(featureExtractorMap);\r\n        return extractParamsFromWeigthMap(classifierMap);\r\n    };\r\n    AgeGenderNet.prototype.extractParams = function (weights) {\r\n        var classifierWeightSize = (512 * 1 + 1) + (512 * 2 + 2);\r\n        var featureExtractorWeights = weights.slice(0, weights.length - classifierWeightSize);\r\n        var classifierWeights = weights.slice(weights.length - classifierWeightSize);\r\n        this.faceFeatureExtractor.extractWeights(featureExtractorWeights);\r\n        return this.extractClassifierParams(classifierWeights);\r\n    };\r\n    return AgeGenderNet;\r\n}(NeuralNetwork));\r\nexport { AgeGenderNet };\r\n//# sourceMappingURL=AgeGenderNet.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { Point } from '../classes';\r\nimport { FaceLandmarks68 } from '../classes/FaceLandmarks68';\r\nimport { toNetInput } from '../dom';\r\nimport { FaceProcessor } from '../faceProcessor/FaceProcessor';\r\nimport { isEven } from '../utils';\r\nvar FaceLandmark68NetBase = /** @class */ (function (_super) {\r\n    __extends(FaceLandmark68NetBase, _super);\r\n    function FaceLandmark68NetBase() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FaceLandmark68NetBase.prototype.postProcess = function (output, inputSize, originalDimensions) {\r\n        var inputDimensions = originalDimensions.map(function (_a) {\r\n            var width = _a.width, height = _a.height;\r\n            var scale = inputSize / Math.max(height, width);\r\n            return {\r\n                width: width * scale,\r\n                height: height * scale\r\n            };\r\n        });\r\n        var batchSize = inputDimensions.length;\r\n        return tf.tidy(function () {\r\n            var createInterleavedTensor = function (fillX, fillY) {\r\n                return tf.stack([\r\n                    tf.fill([68], fillX),\r\n                    tf.fill([68], fillY)\r\n                ], 1).as2D(1, 136).as1D();\r\n            };\r\n            var getPadding = function (batchIdx, cond) {\r\n                var _a = inputDimensions[batchIdx], width = _a.width, height = _a.height;\r\n                return cond(width, height) ? Math.abs(width - height) / 2 : 0;\r\n            };\r\n            var getPaddingX = function (batchIdx) { return getPadding(batchIdx, function (w, h) { return w < h; }); };\r\n            var getPaddingY = function (batchIdx) { return getPadding(batchIdx, function (w, h) { return h < w; }); };\r\n            var landmarkTensors = output\r\n                .mul(tf.fill([batchSize, 136], inputSize))\r\n                .sub(tf.stack(Array.from(Array(batchSize), function (_, batchIdx) {\r\n                return createInterleavedTensor(getPaddingX(batchIdx), getPaddingY(batchIdx));\r\n            })))\r\n                .div(tf.stack(Array.from(Array(batchSize), function (_, batchIdx) {\r\n                return createInterleavedTensor(inputDimensions[batchIdx].width, inputDimensions[batchIdx].height);\r\n            })));\r\n            return landmarkTensors;\r\n        });\r\n    };\r\n    FaceLandmark68NetBase.prototype.forwardInput = function (input) {\r\n        var _this = this;\r\n        return tf.tidy(function () {\r\n            var out = _this.runNet(input);\r\n            return _this.postProcess(out, input.inputSize, input.inputDimensions.map(function (_a) {\r\n                var height = _a[0], width = _a[1];\r\n                return ({ height: height, width: width });\r\n            }));\r\n        });\r\n    };\r\n    FaceLandmark68NetBase.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceLandmark68NetBase.prototype.detectLandmarks = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var netInput, landmarkTensors, landmarksForBatch;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, toNetInput(input)];\r\n                    case 1:\r\n                        netInput = _a.sent();\r\n                        landmarkTensors = tf.tidy(function () { return tf.unstack(_this.forwardInput(netInput)); });\r\n                        return [4 /*yield*/, Promise.all(landmarkTensors.map(function (landmarkTensor, batchIdx) { return __awaiter(_this, void 0, void 0, function () {\r\n                                var landmarksArray, _a, _b, xCoords, yCoords;\r\n                                return __generator(this, function (_c) {\r\n                                    switch (_c.label) {\r\n                                        case 0:\r\n                                            _b = (_a = Array).from;\r\n                                            return [4 /*yield*/, landmarkTensor.data()];\r\n                                        case 1:\r\n                                            landmarksArray = _b.apply(_a, [_c.sent()]);\r\n                                            xCoords = landmarksArray.filter(function (_, i) { return isEven(i); });\r\n                                            yCoords = landmarksArray.filter(function (_, i) { return !isEven(i); });\r\n                                            return [2 /*return*/, new FaceLandmarks68(Array(68).fill(0).map(function (_, i) { return new Point(xCoords[i], yCoords[i]); }), {\r\n                                                    height: netInput.getInputHeight(batchIdx),\r\n                                                    width: netInput.getInputWidth(batchIdx),\r\n                                                })];\r\n                                    }\r\n                                });\r\n                            }); }))];\r\n                    case 2:\r\n                        landmarksForBatch = _a.sent();\r\n                        landmarkTensors.forEach(function (t) { return t.dispose(); });\r\n                        return [2 /*return*/, netInput.isBatchInput\r\n                                ? landmarksForBatch\r\n                                : landmarksForBatch[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceLandmark68NetBase.prototype.getClassifierChannelsOut = function () {\r\n        return 136;\r\n    };\r\n    return FaceLandmark68NetBase;\r\n}(FaceProcessor));\r\nexport { FaceLandmark68NetBase };\r\n//# sourceMappingURL=FaceLandmark68NetBase.js.map","import { __extends } from \"tslib\";\r\nimport { FaceFeatureExtractor } from '../faceFeatureExtractor/FaceFeatureExtractor';\r\nimport { FaceLandmark68NetBase } from './FaceLandmark68NetBase';\r\nvar FaceLandmark68Net = /** @class */ (function (_super) {\r\n    __extends(FaceLandmark68Net, _super);\r\n    function FaceLandmark68Net(faceFeatureExtractor) {\r\n        if (faceFeatureExtractor === void 0) { faceFeatureExtractor = new FaceFeatureExtractor(); }\r\n        return _super.call(this, 'FaceLandmark68Net', faceFeatureExtractor) || this;\r\n    }\r\n    FaceLandmark68Net.prototype.getDefaultModelName = function () {\r\n        return 'face_landmark_68_model';\r\n    };\r\n    FaceLandmark68Net.prototype.getClassifierChannelsIn = function () {\r\n        return 256;\r\n    };\r\n    return FaceLandmark68Net;\r\n}(FaceLandmark68NetBase));\r\nexport { FaceLandmark68Net };\r\n//# sourceMappingURL=FaceLandmark68Net.js.map","import { disposeUnusedWeightTensors } from '../common';\r\nimport { loadParamsFactory } from './loadParamsFactory';\r\nexport function extractParamsFromWeigthMapTiny(weightMap) {\r\n    var paramMappings = [];\r\n    var extractDenseBlock3Params = loadParamsFactory(weightMap, paramMappings).extractDenseBlock3Params;\r\n    var params = {\r\n        dense0: extractDenseBlock3Params('dense0', true),\r\n        dense1: extractDenseBlock3Params('dense1'),\r\n        dense2: extractDenseBlock3Params('dense2')\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMapTiny.js.map","import { extractWeightsFactory } from '../common';\r\nimport { extractorsFactory } from './extractorsFactory';\r\nexport function extractParamsTiny(weights) {\r\n    var paramMappings = [];\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var extractDenseBlock3Params = extractorsFactory(extractWeights, paramMappings).extractDenseBlock3Params;\r\n    var dense0 = extractDenseBlock3Params(3, 32, 'dense0', true);\r\n    var dense1 = extractDenseBlock3Params(32, 64, 'dense1');\r\n    var dense2 = extractDenseBlock3Params(64, 128, 'dense2');\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return {\r\n        paramMappings: paramMappings,\r\n        params: { dense0: dense0, dense1: dense1, dense2: dense2 }\r\n    };\r\n}\r\n//# sourceMappingURL=extractParamsTiny.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { toNetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { normalize } from '../ops';\r\nimport { denseBlock3 } from './denseBlock';\r\nimport { extractParamsFromWeigthMapTiny } from './extractParamsFromWeigthMapTiny';\r\nimport { extractParamsTiny } from './extractParamsTiny';\r\nvar TinyFaceFeatureExtractor = /** @class */ (function (_super) {\r\n    __extends(TinyFaceFeatureExtractor, _super);\r\n    function TinyFaceFeatureExtractor() {\r\n        return _super.call(this, 'TinyFaceFeatureExtractor') || this;\r\n    }\r\n    TinyFaceFeatureExtractor.prototype.forwardInput = function (input) {\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error('TinyFaceFeatureExtractor - load model before inference');\r\n        }\r\n        return tf.tidy(function () {\r\n            var batchTensor = input.toBatchTensor(112, true);\r\n            var meanRgb = [122.782, 117.001, 104.298];\r\n            var normalized = normalize(batchTensor, meanRgb).div(tf.scalar(255));\r\n            var out = denseBlock3(normalized, params.dense0, true);\r\n            out = denseBlock3(out, params.dense1);\r\n            out = denseBlock3(out, params.dense2);\r\n            out = tf.avgPool(out, [14, 14], [2, 2], 'valid');\r\n            return out;\r\n        });\r\n    };\r\n    TinyFaceFeatureExtractor.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyFaceFeatureExtractor.prototype.getDefaultModelName = function () {\r\n        return 'face_feature_extractor_tiny_model';\r\n    };\r\n    TinyFaceFeatureExtractor.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMapTiny(weightMap);\r\n    };\r\n    TinyFaceFeatureExtractor.prototype.extractParams = function (weights) {\r\n        return extractParamsTiny(weights);\r\n    };\r\n    return TinyFaceFeatureExtractor;\r\n}(NeuralNetwork));\r\nexport { TinyFaceFeatureExtractor };\r\n//# sourceMappingURL=TinyFaceFeatureExtractor.js.map","import { __extends } from \"tslib\";\r\nimport { TinyFaceFeatureExtractor } from '../faceFeatureExtractor/TinyFaceFeatureExtractor';\r\nimport { FaceLandmark68NetBase } from './FaceLandmark68NetBase';\r\nvar FaceLandmark68TinyNet = /** @class */ (function (_super) {\r\n    __extends(FaceLandmark68TinyNet, _super);\r\n    function FaceLandmark68TinyNet(faceFeatureExtractor) {\r\n        if (faceFeatureExtractor === void 0) { faceFeatureExtractor = new TinyFaceFeatureExtractor(); }\r\n        return _super.call(this, 'FaceLandmark68TinyNet', faceFeatureExtractor) || this;\r\n    }\r\n    FaceLandmark68TinyNet.prototype.getDefaultModelName = function () {\r\n        return 'face_landmark_68_tiny_model';\r\n    };\r\n    FaceLandmark68TinyNet.prototype.getClassifierChannelsIn = function () {\r\n        return 128;\r\n    };\r\n    return FaceLandmark68TinyNet;\r\n}(FaceLandmark68NetBase));\r\nexport { FaceLandmark68TinyNet };\r\n//# sourceMappingURL=FaceLandmark68TinyNet.js.map","import { __extends } from \"tslib\";\r\nimport { FaceLandmark68Net } from './FaceLandmark68Net';\r\nexport * from './FaceLandmark68Net';\r\nexport * from './FaceLandmark68TinyNet';\r\nvar FaceLandmarkNet = /** @class */ (function (_super) {\r\n    __extends(FaceLandmarkNet, _super);\r\n    function FaceLandmarkNet() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return FaceLandmarkNet;\r\n}(FaceLandmark68Net));\r\nexport { FaceLandmarkNet };\r\n//# sourceMappingURL=index.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function scale(x, params) {\r\n    return tf.add(tf.mul(x, params.weights), params.biases);\r\n}\r\n//# sourceMappingURL=scaleLayer.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { scale } from './scaleLayer';\r\nfunction convLayer(x, params, strides, withRelu, padding) {\r\n    if (padding === void 0) { padding = 'same'; }\r\n    var _a = params.conv, filters = _a.filters, bias = _a.bias;\r\n    var out = tf.conv2d(x, filters, strides, padding);\r\n    out = tf.add(out, bias);\r\n    out = scale(out, params.scale);\r\n    return withRelu ? tf.relu(out) : out;\r\n}\r\nexport function conv(x, params) {\r\n    return convLayer(x, params, [1, 1], true);\r\n}\r\nexport function convNoRelu(x, params) {\r\n    return convLayer(x, params, [1, 1], false);\r\n}\r\nexport function convDown(x, params) {\r\n    return convLayer(x, params, [2, 2], true, 'valid');\r\n}\r\n//# sourceMappingURL=convLayer.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { extractWeightsFactory } from '../common';\r\nimport { isFloat } from '../utils';\r\nfunction extractorsFactory(extractWeights, paramMappings) {\r\n    function extractFilterValues(numFilterValues, numFilters, filterSize) {\r\n        var weights = extractWeights(numFilterValues);\r\n        var depth = weights.length / (numFilters * filterSize * filterSize);\r\n        if (isFloat(depth)) {\r\n            throw new Error(\"depth has to be an integer: \" + depth + \", weights.length: \" + weights.length + \", numFilters: \" + numFilters + \", filterSize: \" + filterSize);\r\n        }\r\n        return tf.tidy(function () { return tf.transpose(tf.tensor4d(weights, [numFilters, depth, filterSize, filterSize]), [2, 3, 1, 0]); });\r\n    }\r\n    function extractConvParams(numFilterValues, numFilters, filterSize, mappedPrefix) {\r\n        var filters = extractFilterValues(numFilterValues, numFilters, filterSize);\r\n        var bias = tf.tensor1d(extractWeights(numFilters));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/filters\" }, { paramPath: mappedPrefix + \"/bias\" });\r\n        return { filters: filters, bias: bias };\r\n    }\r\n    function extractScaleLayerParams(numWeights, mappedPrefix) {\r\n        var weights = tf.tensor1d(extractWeights(numWeights));\r\n        var biases = tf.tensor1d(extractWeights(numWeights));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/weights\" }, { paramPath: mappedPrefix + \"/biases\" });\r\n        return {\r\n            weights: weights,\r\n            biases: biases\r\n        };\r\n    }\r\n    function extractConvLayerParams(numFilterValues, numFilters, filterSize, mappedPrefix) {\r\n        var conv = extractConvParams(numFilterValues, numFilters, filterSize, mappedPrefix + \"/conv\");\r\n        var scale = extractScaleLayerParams(numFilters, mappedPrefix + \"/scale\");\r\n        return { conv: conv, scale: scale };\r\n    }\r\n    function extractResidualLayerParams(numFilterValues, numFilters, filterSize, mappedPrefix, isDown) {\r\n        if (isDown === void 0) { isDown = false; }\r\n        var conv1 = extractConvLayerParams((isDown ? 0.5 : 1) * numFilterValues, numFilters, filterSize, mappedPrefix + \"/conv1\");\r\n        var conv2 = extractConvLayerParams(numFilterValues, numFilters, filterSize, mappedPrefix + \"/conv2\");\r\n        return { conv1: conv1, conv2: conv2 };\r\n    }\r\n    return {\r\n        extractConvLayerParams: extractConvLayerParams,\r\n        extractResidualLayerParams: extractResidualLayerParams\r\n    };\r\n}\r\nexport function extractParams(weights) {\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var paramMappings = [];\r\n    var _b = extractorsFactory(extractWeights, paramMappings), extractConvLayerParams = _b.extractConvLayerParams, extractResidualLayerParams = _b.extractResidualLayerParams;\r\n    var conv32_down = extractConvLayerParams(4704, 32, 7, 'conv32_down');\r\n    var conv32_1 = extractResidualLayerParams(9216, 32, 3, 'conv32_1');\r\n    var conv32_2 = extractResidualLayerParams(9216, 32, 3, 'conv32_2');\r\n    var conv32_3 = extractResidualLayerParams(9216, 32, 3, 'conv32_3');\r\n    var conv64_down = extractResidualLayerParams(36864, 64, 3, 'conv64_down', true);\r\n    var conv64_1 = extractResidualLayerParams(36864, 64, 3, 'conv64_1');\r\n    var conv64_2 = extractResidualLayerParams(36864, 64, 3, 'conv64_2');\r\n    var conv64_3 = extractResidualLayerParams(36864, 64, 3, 'conv64_3');\r\n    var conv128_down = extractResidualLayerParams(147456, 128, 3, 'conv128_down', true);\r\n    var conv128_1 = extractResidualLayerParams(147456, 128, 3, 'conv128_1');\r\n    var conv128_2 = extractResidualLayerParams(147456, 128, 3, 'conv128_2');\r\n    var conv256_down = extractResidualLayerParams(589824, 256, 3, 'conv256_down', true);\r\n    var conv256_1 = extractResidualLayerParams(589824, 256, 3, 'conv256_1');\r\n    var conv256_2 = extractResidualLayerParams(589824, 256, 3, 'conv256_2');\r\n    var conv256_down_out = extractResidualLayerParams(589824, 256, 3, 'conv256_down_out');\r\n    var fc = tf.tidy(function () { return tf.transpose(tf.tensor2d(extractWeights(256 * 128), [128, 256]), [1, 0]); });\r\n    paramMappings.push({ paramPath: \"fc\" });\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    var params = {\r\n        conv32_down: conv32_down,\r\n        conv32_1: conv32_1,\r\n        conv32_2: conv32_2,\r\n        conv32_3: conv32_3,\r\n        conv64_down: conv64_down,\r\n        conv64_1: conv64_1,\r\n        conv64_2: conv64_2,\r\n        conv64_3: conv64_3,\r\n        conv128_down: conv128_down,\r\n        conv128_1: conv128_1,\r\n        conv128_2: conv128_2,\r\n        conv256_down: conv256_down,\r\n        conv256_1: conv256_1,\r\n        conv256_2: conv256_2,\r\n        conv256_down_out: conv256_down_out,\r\n        fc: fc\r\n    };\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { disposeUnusedWeightTensors, extractWeightEntryFactory } from '../common';\r\nimport { isTensor2D } from '../utils';\r\nfunction extractorsFactory(weightMap, paramMappings) {\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    function extractScaleLayerParams(prefix) {\r\n        var weights = extractWeightEntry(prefix + \"/scale/weights\", 1);\r\n        var biases = extractWeightEntry(prefix + \"/scale/biases\", 1);\r\n        return { weights: weights, biases: biases };\r\n    }\r\n    function extractConvLayerParams(prefix) {\r\n        var filters = extractWeightEntry(prefix + \"/conv/filters\", 4);\r\n        var bias = extractWeightEntry(prefix + \"/conv/bias\", 1);\r\n        var scale = extractScaleLayerParams(prefix);\r\n        return { conv: { filters: filters, bias: bias }, scale: scale };\r\n    }\r\n    function extractResidualLayerParams(prefix) {\r\n        return {\r\n            conv1: extractConvLayerParams(prefix + \"/conv1\"),\r\n            conv2: extractConvLayerParams(prefix + \"/conv2\")\r\n        };\r\n    }\r\n    return {\r\n        extractConvLayerParams: extractConvLayerParams,\r\n        extractResidualLayerParams: extractResidualLayerParams\r\n    };\r\n}\r\nexport function extractParamsFromWeigthMap(weightMap) {\r\n    var paramMappings = [];\r\n    var _a = extractorsFactory(weightMap, paramMappings), extractConvLayerParams = _a.extractConvLayerParams, extractResidualLayerParams = _a.extractResidualLayerParams;\r\n    var conv32_down = extractConvLayerParams('conv32_down');\r\n    var conv32_1 = extractResidualLayerParams('conv32_1');\r\n    var conv32_2 = extractResidualLayerParams('conv32_2');\r\n    var conv32_3 = extractResidualLayerParams('conv32_3');\r\n    var conv64_down = extractResidualLayerParams('conv64_down');\r\n    var conv64_1 = extractResidualLayerParams('conv64_1');\r\n    var conv64_2 = extractResidualLayerParams('conv64_2');\r\n    var conv64_3 = extractResidualLayerParams('conv64_3');\r\n    var conv128_down = extractResidualLayerParams('conv128_down');\r\n    var conv128_1 = extractResidualLayerParams('conv128_1');\r\n    var conv128_2 = extractResidualLayerParams('conv128_2');\r\n    var conv256_down = extractResidualLayerParams('conv256_down');\r\n    var conv256_1 = extractResidualLayerParams('conv256_1');\r\n    var conv256_2 = extractResidualLayerParams('conv256_2');\r\n    var conv256_down_out = extractResidualLayerParams('conv256_down_out');\r\n    var fc = weightMap['fc'];\r\n    paramMappings.push({ originalPath: 'fc', paramPath: 'fc' });\r\n    if (!isTensor2D(fc)) {\r\n        throw new Error(\"expected weightMap[fc] to be a Tensor2D, instead have \" + fc);\r\n    }\r\n    var params = {\r\n        conv32_down: conv32_down,\r\n        conv32_1: conv32_1,\r\n        conv32_2: conv32_2,\r\n        conv32_3: conv32_3,\r\n        conv64_down: conv64_down,\r\n        conv64_1: conv64_1,\r\n        conv64_2: conv64_2,\r\n        conv64_3: conv64_3,\r\n        conv128_down: conv128_down,\r\n        conv128_1: conv128_1,\r\n        conv128_2: conv128_2,\r\n        conv256_down: conv256_down,\r\n        conv256_1: conv256_1,\r\n        conv256_2: conv256_2,\r\n        conv256_down_out: conv256_down_out,\r\n        fc: fc\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","import { __spreadArrays } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { conv, convDown, convNoRelu } from './convLayer';\r\nexport function residual(x, params) {\r\n    var out = conv(x, params.conv1);\r\n    out = convNoRelu(out, params.conv2);\r\n    out = tf.add(out, x);\r\n    out = tf.relu(out);\r\n    return out;\r\n}\r\nexport function residualDown(x, params) {\r\n    var out = convDown(x, params.conv1);\r\n    out = convNoRelu(out, params.conv2);\r\n    var pooled = tf.avgPool(x, 2, 2, 'valid');\r\n    var zeros = tf.zeros(pooled.shape);\r\n    var isPad = pooled.shape[3] !== out.shape[3];\r\n    var isAdjustShape = pooled.shape[1] !== out.shape[1] || pooled.shape[2] !== out.shape[2];\r\n    if (isAdjustShape) {\r\n        var padShapeX = __spreadArrays(out.shape);\r\n        padShapeX[1] = 1;\r\n        var zerosW = tf.zeros(padShapeX);\r\n        out = tf.concat([out, zerosW], 1);\r\n        var padShapeY = __spreadArrays(out.shape);\r\n        padShapeY[2] = 1;\r\n        var zerosH = tf.zeros(padShapeY);\r\n        out = tf.concat([out, zerosH], 2);\r\n    }\r\n    pooled = isPad ? tf.concat([pooled, zeros], 3) : pooled;\r\n    out = tf.add(pooled, out);\r\n    out = tf.relu(out);\r\n    return out;\r\n}\r\n//# sourceMappingURL=residualLayer.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { toNetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { normalize } from '../ops';\r\nimport { convDown } from './convLayer';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nimport { residual, residualDown } from './residualLayer';\r\nvar FaceRecognitionNet = /** @class */ (function (_super) {\r\n    __extends(FaceRecognitionNet, _super);\r\n    function FaceRecognitionNet() {\r\n        return _super.call(this, 'FaceRecognitionNet') || this;\r\n    }\r\n    FaceRecognitionNet.prototype.forwardInput = function (input) {\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error('FaceRecognitionNet - load model before inference');\r\n        }\r\n        return tf.tidy(function () {\r\n            var batchTensor = input.toBatchTensor(150, true).toFloat();\r\n            var meanRgb = [122.782, 117.001, 104.298];\r\n            var normalized = normalize(batchTensor, meanRgb).div(tf.scalar(256));\r\n            var out = convDown(normalized, params.conv32_down);\r\n            out = tf.maxPool(out, 3, 2, 'valid');\r\n            out = residual(out, params.conv32_1);\r\n            out = residual(out, params.conv32_2);\r\n            out = residual(out, params.conv32_3);\r\n            out = residualDown(out, params.conv64_down);\r\n            out = residual(out, params.conv64_1);\r\n            out = residual(out, params.conv64_2);\r\n            out = residual(out, params.conv64_3);\r\n            out = residualDown(out, params.conv128_down);\r\n            out = residual(out, params.conv128_1);\r\n            out = residual(out, params.conv128_2);\r\n            out = residualDown(out, params.conv256_down);\r\n            out = residual(out, params.conv256_1);\r\n            out = residual(out, params.conv256_2);\r\n            out = residualDown(out, params.conv256_down_out);\r\n            var globalAvg = out.mean([1, 2]);\r\n            var fullyConnected = tf.matMul(globalAvg, params.fc);\r\n            return fullyConnected;\r\n        });\r\n    };\r\n    FaceRecognitionNet.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceRecognitionNet.prototype.computeFaceDescriptor = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var netInput, faceDescriptorTensors, faceDescriptorsForBatch;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, toNetInput(input)];\r\n                    case 1:\r\n                        netInput = _a.sent();\r\n                        faceDescriptorTensors = tf.tidy(function () { return tf.unstack(_this.forwardInput(netInput)); });\r\n                        return [4 /*yield*/, Promise.all(faceDescriptorTensors.map(function (t) { return t.data(); }))];\r\n                    case 2:\r\n                        faceDescriptorsForBatch = _a.sent();\r\n                        faceDescriptorTensors.forEach(function (t) { return t.dispose(); });\r\n                        return [2 /*return*/, netInput.isBatchInput\r\n                                ? faceDescriptorsForBatch\r\n                                : faceDescriptorsForBatch[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FaceRecognitionNet.prototype.getDefaultModelName = function () {\r\n        return 'face_recognition_model';\r\n    };\r\n    FaceRecognitionNet.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMap(weightMap);\r\n    };\r\n    FaceRecognitionNet.prototype.extractParams = function (weights) {\r\n        return extractParams(weights);\r\n    };\r\n    return FaceRecognitionNet;\r\n}(NeuralNetwork));\r\nexport { FaceRecognitionNet };\r\n//# sourceMappingURL=FaceRecognitionNet.js.map","export function extendWithFaceDescriptor(sourceObj, descriptor) {\r\n    var extension = { descriptor: descriptor };\r\n    return Object.assign({}, sourceObj, extension);\r\n}\r\n//# sourceMappingURL=WithFaceDescriptor.js.map","export function isWithAge(obj) {\r\n    return typeof obj['age'] === 'number';\r\n}\r\nexport function extendWithAge(sourceObj, age) {\r\n    var extension = { age: age };\r\n    return Object.assign({}, sourceObj, extension);\r\n}\r\n//# sourceMappingURL=WithAge.js.map","import { Gender } from '../ageGenderNet/types';\r\nimport { isValidProbablitiy } from '../utils';\r\nexport function isWithGender(obj) {\r\n    return (obj['gender'] === Gender.MALE || obj['gender'] === Gender.FEMALE)\r\n        && isValidProbablitiy(obj['genderProbability']);\r\n}\r\nexport function extendWithGender(sourceObj, gender, genderProbability) {\r\n    var extension = { gender: gender, genderProbability: genderProbability };\r\n    return Object.assign({}, sourceObj, extension);\r\n}\r\n//# sourceMappingURL=WithGender.js.map","var MtcnnOptions = /** @class */ (function () {\r\n    function MtcnnOptions(_a) {\r\n        var _b = _a === void 0 ? {} : _a, minFaceSize = _b.minFaceSize, scaleFactor = _b.scaleFactor, maxNumScales = _b.maxNumScales, scoreThresholds = _b.scoreThresholds, scaleSteps = _b.scaleSteps;\r\n        this._name = 'MtcnnOptions';\r\n        this._minFaceSize = minFaceSize || 20;\r\n        this._scaleFactor = scaleFactor || 0.709;\r\n        this._maxNumScales = maxNumScales || 10;\r\n        this._scoreThresholds = scoreThresholds || [0.6, 0.7, 0.7];\r\n        this._scaleSteps = scaleSteps;\r\n        if (typeof this._minFaceSize !== 'number' || this._minFaceSize < 0) {\r\n            throw new Error(this._name + \" - expected minFaceSize to be a number > 0\");\r\n        }\r\n        if (typeof this._scaleFactor !== 'number' || this._scaleFactor <= 0 || this._scaleFactor >= 1) {\r\n            throw new Error(this._name + \" - expected scaleFactor to be a number between 0 and 1\");\r\n        }\r\n        if (typeof this._maxNumScales !== 'number' || this._maxNumScales < 0) {\r\n            throw new Error(this._name + \" - expected maxNumScales to be a number > 0\");\r\n        }\r\n        if (!Array.isArray(this._scoreThresholds)\r\n            || this._scoreThresholds.length !== 3\r\n            || this._scoreThresholds.some(function (th) { return typeof th !== 'number'; })) {\r\n            throw new Error(this._name + \" - expected scoreThresholds to be an array of numbers of length 3\");\r\n        }\r\n        if (this._scaleSteps\r\n            && (!Array.isArray(this._scaleSteps) || this._scaleSteps.some(function (th) { return typeof th !== 'number'; }))) {\r\n            throw new Error(this._name + \" - expected scaleSteps to be an array of numbers\");\r\n        }\r\n    }\r\n    Object.defineProperty(MtcnnOptions.prototype, \"minFaceSize\", {\r\n        get: function () { return this._minFaceSize; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MtcnnOptions.prototype, \"scaleFactor\", {\r\n        get: function () { return this._scaleFactor; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MtcnnOptions.prototype, \"maxNumScales\", {\r\n        get: function () { return this._maxNumScales; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MtcnnOptions.prototype, \"scoreThresholds\", {\r\n        get: function () { return this._scoreThresholds; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MtcnnOptions.prototype, \"scaleSteps\", {\r\n        get: function () { return this._scaleSteps; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MtcnnOptions;\r\n}());\r\nexport { MtcnnOptions };\r\n//# sourceMappingURL=MtcnnOptions.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { extractWeightsFactory } from '../common';\r\nfunction extractorsFactory(extractWeights, paramMappings) {\r\n    function extractDepthwiseConvParams(numChannels, mappedPrefix) {\r\n        var filters = tf.tensor4d(extractWeights(3 * 3 * numChannels), [3, 3, numChannels, 1]);\r\n        var batch_norm_scale = tf.tensor1d(extractWeights(numChannels));\r\n        var batch_norm_offset = tf.tensor1d(extractWeights(numChannels));\r\n        var batch_norm_mean = tf.tensor1d(extractWeights(numChannels));\r\n        var batch_norm_variance = tf.tensor1d(extractWeights(numChannels));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/filters\" }, { paramPath: mappedPrefix + \"/batch_norm_scale\" }, { paramPath: mappedPrefix + \"/batch_norm_offset\" }, { paramPath: mappedPrefix + \"/batch_norm_mean\" }, { paramPath: mappedPrefix + \"/batch_norm_variance\" });\r\n        return {\r\n            filters: filters,\r\n            batch_norm_scale: batch_norm_scale,\r\n            batch_norm_offset: batch_norm_offset,\r\n            batch_norm_mean: batch_norm_mean,\r\n            batch_norm_variance: batch_norm_variance\r\n        };\r\n    }\r\n    function extractConvParams(channelsIn, channelsOut, filterSize, mappedPrefix, isPointwiseConv) {\r\n        var filters = tf.tensor4d(extractWeights(channelsIn * channelsOut * filterSize * filterSize), [filterSize, filterSize, channelsIn, channelsOut]);\r\n        var bias = tf.tensor1d(extractWeights(channelsOut));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/filters\" }, { paramPath: mappedPrefix + \"/\" + (isPointwiseConv ? 'batch_norm_offset' : 'bias') });\r\n        return { filters: filters, bias: bias };\r\n    }\r\n    function extractPointwiseConvParams(channelsIn, channelsOut, filterSize, mappedPrefix) {\r\n        var _a = extractConvParams(channelsIn, channelsOut, filterSize, mappedPrefix, true), filters = _a.filters, bias = _a.bias;\r\n        return {\r\n            filters: filters,\r\n            batch_norm_offset: bias\r\n        };\r\n    }\r\n    function extractConvPairParams(channelsIn, channelsOut, mappedPrefix) {\r\n        var depthwise_conv = extractDepthwiseConvParams(channelsIn, mappedPrefix + \"/depthwise_conv\");\r\n        var pointwise_conv = extractPointwiseConvParams(channelsIn, channelsOut, 1, mappedPrefix + \"/pointwise_conv\");\r\n        return { depthwise_conv: depthwise_conv, pointwise_conv: pointwise_conv };\r\n    }\r\n    function extractMobilenetV1Params() {\r\n        var conv_0 = extractPointwiseConvParams(3, 32, 3, 'mobilenetv1/conv_0');\r\n        var conv_1 = extractConvPairParams(32, 64, 'mobilenetv1/conv_1');\r\n        var conv_2 = extractConvPairParams(64, 128, 'mobilenetv1/conv_2');\r\n        var conv_3 = extractConvPairParams(128, 128, 'mobilenetv1/conv_3');\r\n        var conv_4 = extractConvPairParams(128, 256, 'mobilenetv1/conv_4');\r\n        var conv_5 = extractConvPairParams(256, 256, 'mobilenetv1/conv_5');\r\n        var conv_6 = extractConvPairParams(256, 512, 'mobilenetv1/conv_6');\r\n        var conv_7 = extractConvPairParams(512, 512, 'mobilenetv1/conv_7');\r\n        var conv_8 = extractConvPairParams(512, 512, 'mobilenetv1/conv_8');\r\n        var conv_9 = extractConvPairParams(512, 512, 'mobilenetv1/conv_9');\r\n        var conv_10 = extractConvPairParams(512, 512, 'mobilenetv1/conv_10');\r\n        var conv_11 = extractConvPairParams(512, 512, 'mobilenetv1/conv_11');\r\n        var conv_12 = extractConvPairParams(512, 1024, 'mobilenetv1/conv_12');\r\n        var conv_13 = extractConvPairParams(1024, 1024, 'mobilenetv1/conv_13');\r\n        return {\r\n            conv_0: conv_0,\r\n            conv_1: conv_1,\r\n            conv_2: conv_2,\r\n            conv_3: conv_3,\r\n            conv_4: conv_4,\r\n            conv_5: conv_5,\r\n            conv_6: conv_6,\r\n            conv_7: conv_7,\r\n            conv_8: conv_8,\r\n            conv_9: conv_9,\r\n            conv_10: conv_10,\r\n            conv_11: conv_11,\r\n            conv_12: conv_12,\r\n            conv_13: conv_13\r\n        };\r\n    }\r\n    function extractPredictionLayerParams() {\r\n        var conv_0 = extractPointwiseConvParams(1024, 256, 1, 'prediction_layer/conv_0');\r\n        var conv_1 = extractPointwiseConvParams(256, 512, 3, 'prediction_layer/conv_1');\r\n        var conv_2 = extractPointwiseConvParams(512, 128, 1, 'prediction_layer/conv_2');\r\n        var conv_3 = extractPointwiseConvParams(128, 256, 3, 'prediction_layer/conv_3');\r\n        var conv_4 = extractPointwiseConvParams(256, 128, 1, 'prediction_layer/conv_4');\r\n        var conv_5 = extractPointwiseConvParams(128, 256, 3, 'prediction_layer/conv_5');\r\n        var conv_6 = extractPointwiseConvParams(256, 64, 1, 'prediction_layer/conv_6');\r\n        var conv_7 = extractPointwiseConvParams(64, 128, 3, 'prediction_layer/conv_7');\r\n        var box_encoding_0_predictor = extractConvParams(512, 12, 1, 'prediction_layer/box_predictor_0/box_encoding_predictor');\r\n        var class_predictor_0 = extractConvParams(512, 9, 1, 'prediction_layer/box_predictor_0/class_predictor');\r\n        var box_encoding_1_predictor = extractConvParams(1024, 24, 1, 'prediction_layer/box_predictor_1/box_encoding_predictor');\r\n        var class_predictor_1 = extractConvParams(1024, 18, 1, 'prediction_layer/box_predictor_1/class_predictor');\r\n        var box_encoding_2_predictor = extractConvParams(512, 24, 1, 'prediction_layer/box_predictor_2/box_encoding_predictor');\r\n        var class_predictor_2 = extractConvParams(512, 18, 1, 'prediction_layer/box_predictor_2/class_predictor');\r\n        var box_encoding_3_predictor = extractConvParams(256, 24, 1, 'prediction_layer/box_predictor_3/box_encoding_predictor');\r\n        var class_predictor_3 = extractConvParams(256, 18, 1, 'prediction_layer/box_predictor_3/class_predictor');\r\n        var box_encoding_4_predictor = extractConvParams(256, 24, 1, 'prediction_layer/box_predictor_4/box_encoding_predictor');\r\n        var class_predictor_4 = extractConvParams(256, 18, 1, 'prediction_layer/box_predictor_4/class_predictor');\r\n        var box_encoding_5_predictor = extractConvParams(128, 24, 1, 'prediction_layer/box_predictor_5/box_encoding_predictor');\r\n        var class_predictor_5 = extractConvParams(128, 18, 1, 'prediction_layer/box_predictor_5/class_predictor');\r\n        var box_predictor_0 = {\r\n            box_encoding_predictor: box_encoding_0_predictor,\r\n            class_predictor: class_predictor_0\r\n        };\r\n        var box_predictor_1 = {\r\n            box_encoding_predictor: box_encoding_1_predictor,\r\n            class_predictor: class_predictor_1\r\n        };\r\n        var box_predictor_2 = {\r\n            box_encoding_predictor: box_encoding_2_predictor,\r\n            class_predictor: class_predictor_2\r\n        };\r\n        var box_predictor_3 = {\r\n            box_encoding_predictor: box_encoding_3_predictor,\r\n            class_predictor: class_predictor_3\r\n        };\r\n        var box_predictor_4 = {\r\n            box_encoding_predictor: box_encoding_4_predictor,\r\n            class_predictor: class_predictor_4\r\n        };\r\n        var box_predictor_5 = {\r\n            box_encoding_predictor: box_encoding_5_predictor,\r\n            class_predictor: class_predictor_5\r\n        };\r\n        return {\r\n            conv_0: conv_0,\r\n            conv_1: conv_1,\r\n            conv_2: conv_2,\r\n            conv_3: conv_3,\r\n            conv_4: conv_4,\r\n            conv_5: conv_5,\r\n            conv_6: conv_6,\r\n            conv_7: conv_7,\r\n            box_predictor_0: box_predictor_0,\r\n            box_predictor_1: box_predictor_1,\r\n            box_predictor_2: box_predictor_2,\r\n            box_predictor_3: box_predictor_3,\r\n            box_predictor_4: box_predictor_4,\r\n            box_predictor_5: box_predictor_5\r\n        };\r\n    }\r\n    return {\r\n        extractMobilenetV1Params: extractMobilenetV1Params,\r\n        extractPredictionLayerParams: extractPredictionLayerParams\r\n    };\r\n}\r\nexport function extractParams(weights) {\r\n    var paramMappings = [];\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var _b = extractorsFactory(extractWeights, paramMappings), extractMobilenetV1Params = _b.extractMobilenetV1Params, extractPredictionLayerParams = _b.extractPredictionLayerParams;\r\n    var mobilenetv1 = extractMobilenetV1Params();\r\n    var prediction_layer = extractPredictionLayerParams();\r\n    var extra_dim = tf.tensor3d(extractWeights(5118 * 4), [1, 5118, 4]);\r\n    var output_layer = {\r\n        extra_dim: extra_dim\r\n    };\r\n    paramMappings.push({ paramPath: 'output_layer/extra_dim' });\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return {\r\n        params: {\r\n            mobilenetv1: mobilenetv1,\r\n            prediction_layer: prediction_layer,\r\n            output_layer: output_layer\r\n        },\r\n        paramMappings: paramMappings\r\n    };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { disposeUnusedWeightTensors, extractWeightEntryFactory } from '../common';\r\nimport { isTensor3D } from '../utils';\r\nfunction extractorsFactory(weightMap, paramMappings) {\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    function extractPointwiseConvParams(prefix, idx, mappedPrefix) {\r\n        var filters = extractWeightEntry(prefix + \"/Conv2d_\" + idx + \"_pointwise/weights\", 4, mappedPrefix + \"/filters\");\r\n        var batch_norm_offset = extractWeightEntry(prefix + \"/Conv2d_\" + idx + \"_pointwise/convolution_bn_offset\", 1, mappedPrefix + \"/batch_norm_offset\");\r\n        return { filters: filters, batch_norm_offset: batch_norm_offset };\r\n    }\r\n    function extractConvPairParams(idx) {\r\n        var mappedPrefix = \"mobilenetv1/conv_\" + idx;\r\n        var prefixDepthwiseConv = \"MobilenetV1/Conv2d_\" + idx + \"_depthwise\";\r\n        var mappedPrefixDepthwiseConv = mappedPrefix + \"/depthwise_conv\";\r\n        var mappedPrefixPointwiseConv = mappedPrefix + \"/pointwise_conv\";\r\n        var filters = extractWeightEntry(prefixDepthwiseConv + \"/depthwise_weights\", 4, mappedPrefixDepthwiseConv + \"/filters\");\r\n        var batch_norm_scale = extractWeightEntry(prefixDepthwiseConv + \"/BatchNorm/gamma\", 1, mappedPrefixDepthwiseConv + \"/batch_norm_scale\");\r\n        var batch_norm_offset = extractWeightEntry(prefixDepthwiseConv + \"/BatchNorm/beta\", 1, mappedPrefixDepthwiseConv + \"/batch_norm_offset\");\r\n        var batch_norm_mean = extractWeightEntry(prefixDepthwiseConv + \"/BatchNorm/moving_mean\", 1, mappedPrefixDepthwiseConv + \"/batch_norm_mean\");\r\n        var batch_norm_variance = extractWeightEntry(prefixDepthwiseConv + \"/BatchNorm/moving_variance\", 1, mappedPrefixDepthwiseConv + \"/batch_norm_variance\");\r\n        return {\r\n            depthwise_conv: {\r\n                filters: filters,\r\n                batch_norm_scale: batch_norm_scale,\r\n                batch_norm_offset: batch_norm_offset,\r\n                batch_norm_mean: batch_norm_mean,\r\n                batch_norm_variance: batch_norm_variance\r\n            },\r\n            pointwise_conv: extractPointwiseConvParams('MobilenetV1', idx, mappedPrefixPointwiseConv)\r\n        };\r\n    }\r\n    function extractMobilenetV1Params() {\r\n        return {\r\n            conv_0: extractPointwiseConvParams('MobilenetV1', 0, 'mobilenetv1/conv_0'),\r\n            conv_1: extractConvPairParams(1),\r\n            conv_2: extractConvPairParams(2),\r\n            conv_3: extractConvPairParams(3),\r\n            conv_4: extractConvPairParams(4),\r\n            conv_5: extractConvPairParams(5),\r\n            conv_6: extractConvPairParams(6),\r\n            conv_7: extractConvPairParams(7),\r\n            conv_8: extractConvPairParams(8),\r\n            conv_9: extractConvPairParams(9),\r\n            conv_10: extractConvPairParams(10),\r\n            conv_11: extractConvPairParams(11),\r\n            conv_12: extractConvPairParams(12),\r\n            conv_13: extractConvPairParams(13)\r\n        };\r\n    }\r\n    function extractConvParams(prefix, mappedPrefix) {\r\n        var filters = extractWeightEntry(prefix + \"/weights\", 4, mappedPrefix + \"/filters\");\r\n        var bias = extractWeightEntry(prefix + \"/biases\", 1, mappedPrefix + \"/bias\");\r\n        return { filters: filters, bias: bias };\r\n    }\r\n    function extractBoxPredictorParams(idx) {\r\n        var box_encoding_predictor = extractConvParams(\"Prediction/BoxPredictor_\" + idx + \"/BoxEncodingPredictor\", \"prediction_layer/box_predictor_\" + idx + \"/box_encoding_predictor\");\r\n        var class_predictor = extractConvParams(\"Prediction/BoxPredictor_\" + idx + \"/ClassPredictor\", \"prediction_layer/box_predictor_\" + idx + \"/class_predictor\");\r\n        return { box_encoding_predictor: box_encoding_predictor, class_predictor: class_predictor };\r\n    }\r\n    function extractPredictionLayerParams() {\r\n        return {\r\n            conv_0: extractPointwiseConvParams('Prediction', 0, 'prediction_layer/conv_0'),\r\n            conv_1: extractPointwiseConvParams('Prediction', 1, 'prediction_layer/conv_1'),\r\n            conv_2: extractPointwiseConvParams('Prediction', 2, 'prediction_layer/conv_2'),\r\n            conv_3: extractPointwiseConvParams('Prediction', 3, 'prediction_layer/conv_3'),\r\n            conv_4: extractPointwiseConvParams('Prediction', 4, 'prediction_layer/conv_4'),\r\n            conv_5: extractPointwiseConvParams('Prediction', 5, 'prediction_layer/conv_5'),\r\n            conv_6: extractPointwiseConvParams('Prediction', 6, 'prediction_layer/conv_6'),\r\n            conv_7: extractPointwiseConvParams('Prediction', 7, 'prediction_layer/conv_7'),\r\n            box_predictor_0: extractBoxPredictorParams(0),\r\n            box_predictor_1: extractBoxPredictorParams(1),\r\n            box_predictor_2: extractBoxPredictorParams(2),\r\n            box_predictor_3: extractBoxPredictorParams(3),\r\n            box_predictor_4: extractBoxPredictorParams(4),\r\n            box_predictor_5: extractBoxPredictorParams(5)\r\n        };\r\n    }\r\n    return {\r\n        extractMobilenetV1Params: extractMobilenetV1Params,\r\n        extractPredictionLayerParams: extractPredictionLayerParams\r\n    };\r\n}\r\nexport function extractParamsFromWeigthMap(weightMap) {\r\n    var paramMappings = [];\r\n    var _a = extractorsFactory(weightMap, paramMappings), extractMobilenetV1Params = _a.extractMobilenetV1Params, extractPredictionLayerParams = _a.extractPredictionLayerParams;\r\n    var extra_dim = weightMap['Output/extra_dim'];\r\n    paramMappings.push({ originalPath: 'Output/extra_dim', paramPath: 'output_layer/extra_dim' });\r\n    if (!isTensor3D(extra_dim)) {\r\n        throw new Error(\"expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have \" + extra_dim);\r\n    }\r\n    var params = {\r\n        mobilenetv1: extractMobilenetV1Params(),\r\n        prediction_layer: extractPredictionLayerParams(),\r\n        output_layer: {\r\n            extra_dim: extra_dim\r\n        }\r\n    };\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function pointwiseConvLayer(x, params, strides) {\r\n    return tf.tidy(function () {\r\n        var out = tf.conv2d(x, params.filters, strides, 'same');\r\n        out = tf.add(out, params.batch_norm_offset);\r\n        return tf.clipByValue(out, 0, 6);\r\n    });\r\n}\r\n//# sourceMappingURL=pointwiseConvLayer.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { pointwiseConvLayer } from './pointwiseConvLayer';\r\nvar epsilon = 0.0010000000474974513;\r\nfunction depthwiseConvLayer(x, params, strides) {\r\n    return tf.tidy(function () {\r\n        var out = tf.depthwiseConv2d(x, params.filters, strides, 'same');\r\n        out = tf.batchNorm(out, params.batch_norm_mean, params.batch_norm_variance, params.batch_norm_offset, params.batch_norm_scale, epsilon);\r\n        return tf.clipByValue(out, 0, 6);\r\n    });\r\n}\r\nfunction getStridesForLayerIdx(layerIdx) {\r\n    return [2, 4, 6, 12].some(function (idx) { return idx === layerIdx; }) ? [2, 2] : [1, 1];\r\n}\r\nexport function mobileNetV1(x, params) {\r\n    return tf.tidy(function () {\r\n        var conv11 = null;\r\n        var out = pointwiseConvLayer(x, params.conv_0, [2, 2]);\r\n        var convPairParams = [\r\n            params.conv_1,\r\n            params.conv_2,\r\n            params.conv_3,\r\n            params.conv_4,\r\n            params.conv_5,\r\n            params.conv_6,\r\n            params.conv_7,\r\n            params.conv_8,\r\n            params.conv_9,\r\n            params.conv_10,\r\n            params.conv_11,\r\n            params.conv_12,\r\n            params.conv_13\r\n        ];\r\n        convPairParams.forEach(function (param, i) {\r\n            var layerIdx = i + 1;\r\n            var depthwiseConvStrides = getStridesForLayerIdx(layerIdx);\r\n            out = depthwiseConvLayer(out, param.depthwise_conv, depthwiseConvStrides);\r\n            out = pointwiseConvLayer(out, param.pointwise_conv, [1, 1]);\r\n            if (layerIdx === 11) {\r\n                conv11 = out;\r\n            }\r\n        });\r\n        if (conv11 === null) {\r\n            throw new Error('mobileNetV1 - output of conv layer 11 is null');\r\n        }\r\n        return {\r\n            out: out,\r\n            conv11: conv11\r\n        };\r\n    });\r\n}\r\n//# sourceMappingURL=mobileNetV1.js.map","export function nonMaxSuppression(boxes, scores, maxOutputSize, iouThreshold, scoreThreshold) {\r\n    var numBoxes = boxes.shape[0];\r\n    var outputSize = Math.min(maxOutputSize, numBoxes);\r\n    var candidates = scores\r\n        .map(function (score, boxIndex) { return ({ score: score, boxIndex: boxIndex }); })\r\n        .filter(function (c) { return c.score > scoreThreshold; })\r\n        .sort(function (c1, c2) { return c2.score - c1.score; });\r\n    var suppressFunc = function (x) { return x <= iouThreshold ? 1 : 0; };\r\n    var selected = [];\r\n    candidates.forEach(function (c) {\r\n        if (selected.length >= outputSize) {\r\n            return;\r\n        }\r\n        var originalScore = c.score;\r\n        for (var j = selected.length - 1; j >= 0; --j) {\r\n            var iou = IOU(boxes, c.boxIndex, selected[j]);\r\n            if (iou === 0.0) {\r\n                continue;\r\n            }\r\n            c.score *= suppressFunc(iou);\r\n            if (c.score <= scoreThreshold) {\r\n                break;\r\n            }\r\n        }\r\n        if (originalScore === c.score) {\r\n            selected.push(c.boxIndex);\r\n        }\r\n    });\r\n    return selected;\r\n}\r\nfunction IOU(boxes, i, j) {\r\n    var boxesData = boxes.arraySync();\r\n    var yminI = Math.min(boxesData[i][0], boxesData[i][2]);\r\n    var xminI = Math.min(boxesData[i][1], boxesData[i][3]);\r\n    var ymaxI = Math.max(boxesData[i][0], boxesData[i][2]);\r\n    var xmaxI = Math.max(boxesData[i][1], boxesData[i][3]);\r\n    var yminJ = Math.min(boxesData[j][0], boxesData[j][2]);\r\n    var xminJ = Math.min(boxesData[j][1], boxesData[j][3]);\r\n    var ymaxJ = Math.max(boxesData[j][0], boxesData[j][2]);\r\n    var xmaxJ = Math.max(boxesData[j][1], boxesData[j][3]);\r\n    var areaI = (ymaxI - yminI) * (xmaxI - xminI);\r\n    var areaJ = (ymaxJ - yminJ) * (xmaxJ - xminJ);\r\n    if (areaI <= 0 || areaJ <= 0) {\r\n        return 0.0;\r\n    }\r\n    var intersectionYmin = Math.max(yminI, yminJ);\r\n    var intersectionXmin = Math.max(xminI, xminJ);\r\n    var intersectionYmax = Math.min(ymaxI, ymaxJ);\r\n    var intersectionXmax = Math.min(xmaxI, xmaxJ);\r\n    var intersectionArea = Math.max(intersectionYmax - intersectionYmin, 0.0) *\r\n        Math.max(intersectionXmax - intersectionXmin, 0.0);\r\n    return intersectionArea / (areaI + areaJ - intersectionArea);\r\n}\r\n//# sourceMappingURL=nonMaxSuppression.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nfunction getCenterCoordinatesAndSizesLayer(x) {\r\n    var vec = tf.unstack(tf.transpose(x, [1, 0]));\r\n    var sizes = [\r\n        tf.sub(vec[2], vec[0]),\r\n        tf.sub(vec[3], vec[1])\r\n    ];\r\n    var centers = [\r\n        tf.add(vec[0], tf.div(sizes[0], tf.scalar(2))),\r\n        tf.add(vec[1], tf.div(sizes[1], tf.scalar(2)))\r\n    ];\r\n    return {\r\n        sizes: sizes,\r\n        centers: centers\r\n    };\r\n}\r\nfunction decodeBoxesLayer(x0, x1) {\r\n    var _a = getCenterCoordinatesAndSizesLayer(x0), sizes = _a.sizes, centers = _a.centers;\r\n    var vec = tf.unstack(tf.transpose(x1, [1, 0]));\r\n    var div0_out = tf.div(tf.mul(tf.exp(tf.div(vec[2], tf.scalar(5))), sizes[0]), tf.scalar(2));\r\n    var add0_out = tf.add(tf.mul(tf.div(vec[0], tf.scalar(10)), sizes[0]), centers[0]);\r\n    var div1_out = tf.div(tf.mul(tf.exp(tf.div(vec[3], tf.scalar(5))), sizes[1]), tf.scalar(2));\r\n    var add1_out = tf.add(tf.mul(tf.div(vec[1], tf.scalar(10)), sizes[1]), centers[1]);\r\n    return tf.transpose(tf.stack([\r\n        tf.sub(add0_out, div0_out),\r\n        tf.sub(add1_out, div1_out),\r\n        tf.add(add0_out, div0_out),\r\n        tf.add(add1_out, div1_out)\r\n    ]), [1, 0]);\r\n}\r\nexport function outputLayer(boxPredictions, classPredictions, params) {\r\n    return tf.tidy(function () {\r\n        var batchSize = boxPredictions.shape[0];\r\n        var boxes = decodeBoxesLayer(tf.reshape(tf.tile(params.extra_dim, [batchSize, 1, 1]), [-1, 4]), tf.reshape(boxPredictions, [-1, 4]));\r\n        boxes = tf.reshape(boxes, [batchSize, (boxes.shape[0] / batchSize), 4]);\r\n        var scoresAndClasses = tf.sigmoid(tf.slice(classPredictions, [0, 0, 1], [-1, -1, -1]));\r\n        var scores = tf.slice(scoresAndClasses, [0, 0, 0], [-1, -1, 1]);\r\n        scores = tf.reshape(scores, [batchSize, scores.shape[1]]);\r\n        var boxesByBatch = tf.unstack(boxes);\r\n        var scoresByBatch = tf.unstack(scores);\r\n        return {\r\n            boxes: boxesByBatch,\r\n            scores: scoresByBatch\r\n        };\r\n    });\r\n}\r\n//# sourceMappingURL=outputLayer.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { convLayer } from '../common';\r\nexport function boxPredictionLayer(x, params) {\r\n    return tf.tidy(function () {\r\n        var batchSize = x.shape[0];\r\n        var boxPredictionEncoding = tf.reshape(convLayer(x, params.box_encoding_predictor), [batchSize, -1, 1, 4]);\r\n        var classPrediction = tf.reshape(convLayer(x, params.class_predictor), [batchSize, -1, 3]);\r\n        return {\r\n            boxPredictionEncoding: boxPredictionEncoding,\r\n            classPrediction: classPrediction\r\n        };\r\n    });\r\n}\r\n//# sourceMappingURL=boxPredictionLayer.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { boxPredictionLayer } from './boxPredictionLayer';\r\nimport { pointwiseConvLayer } from './pointwiseConvLayer';\r\nexport function predictionLayer(x, conv11, params) {\r\n    return tf.tidy(function () {\r\n        var conv0 = pointwiseConvLayer(x, params.conv_0, [1, 1]);\r\n        var conv1 = pointwiseConvLayer(conv0, params.conv_1, [2, 2]);\r\n        var conv2 = pointwiseConvLayer(conv1, params.conv_2, [1, 1]);\r\n        var conv3 = pointwiseConvLayer(conv2, params.conv_3, [2, 2]);\r\n        var conv4 = pointwiseConvLayer(conv3, params.conv_4, [1, 1]);\r\n        var conv5 = pointwiseConvLayer(conv4, params.conv_5, [2, 2]);\r\n        var conv6 = pointwiseConvLayer(conv5, params.conv_6, [1, 1]);\r\n        var conv7 = pointwiseConvLayer(conv6, params.conv_7, [2, 2]);\r\n        var boxPrediction0 = boxPredictionLayer(conv11, params.box_predictor_0);\r\n        var boxPrediction1 = boxPredictionLayer(x, params.box_predictor_1);\r\n        var boxPrediction2 = boxPredictionLayer(conv1, params.box_predictor_2);\r\n        var boxPrediction3 = boxPredictionLayer(conv3, params.box_predictor_3);\r\n        var boxPrediction4 = boxPredictionLayer(conv5, params.box_predictor_4);\r\n        var boxPrediction5 = boxPredictionLayer(conv7, params.box_predictor_5);\r\n        var boxPredictions = tf.concat([\r\n            boxPrediction0.boxPredictionEncoding,\r\n            boxPrediction1.boxPredictionEncoding,\r\n            boxPrediction2.boxPredictionEncoding,\r\n            boxPrediction3.boxPredictionEncoding,\r\n            boxPrediction4.boxPredictionEncoding,\r\n            boxPrediction5.boxPredictionEncoding\r\n        ], 1);\r\n        var classPredictions = tf.concat([\r\n            boxPrediction0.classPrediction,\r\n            boxPrediction1.classPrediction,\r\n            boxPrediction2.classPrediction,\r\n            boxPrediction3.classPrediction,\r\n            boxPrediction4.classPrediction,\r\n            boxPrediction5.classPrediction\r\n        ], 1);\r\n        return {\r\n            boxPredictions: boxPredictions,\r\n            classPredictions: classPredictions\r\n        };\r\n    });\r\n}\r\n//# sourceMappingURL=predictionLayer.js.map","var SsdMobilenetv1Options = /** @class */ (function () {\r\n    function SsdMobilenetv1Options(_a) {\r\n        var _b = _a === void 0 ? {} : _a, minConfidence = _b.minConfidence, maxResults = _b.maxResults;\r\n        this._name = 'SsdMobilenetv1Options';\r\n        this._minConfidence = minConfidence || 0.5;\r\n        this._maxResults = maxResults || 100;\r\n        if (typeof this._minConfidence !== 'number' || this._minConfidence <= 0 || this._minConfidence >= 1) {\r\n            throw new Error(this._name + \" - expected minConfidence to be a number between 0 and 1\");\r\n        }\r\n        if (typeof this._maxResults !== 'number') {\r\n            throw new Error(this._name + \" - expected maxResults to be a number\");\r\n        }\r\n    }\r\n    Object.defineProperty(SsdMobilenetv1Options.prototype, \"minConfidence\", {\r\n        get: function () { return this._minConfidence; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SsdMobilenetv1Options.prototype, \"maxResults\", {\r\n        get: function () { return this._maxResults; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return SsdMobilenetv1Options;\r\n}());\r\nexport { SsdMobilenetv1Options };\r\n//# sourceMappingURL=SsdMobilenetv1Options.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { Rect } from '../classes';\r\nimport { FaceDetection } from '../classes/FaceDetection';\r\nimport { toNetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nimport { mobileNetV1 } from './mobileNetV1';\r\nimport { nonMaxSuppression } from './nonMaxSuppression';\r\nimport { outputLayer } from './outputLayer';\r\nimport { predictionLayer } from './predictionLayer';\r\nimport { SsdMobilenetv1Options } from './SsdMobilenetv1Options';\r\nvar SsdMobilenetv1 = /** @class */ (function (_super) {\r\n    __extends(SsdMobilenetv1, _super);\r\n    function SsdMobilenetv1() {\r\n        return _super.call(this, 'SsdMobilenetv1') || this;\r\n    }\r\n    SsdMobilenetv1.prototype.forwardInput = function (input) {\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error('SsdMobilenetv1 - load model before inference');\r\n        }\r\n        return tf.tidy(function () {\r\n            var batchTensor = input.toBatchTensor(512, false).toFloat();\r\n            var x = tf.sub(tf.mul(batchTensor, tf.scalar(0.007843137718737125)), tf.scalar(1));\r\n            var features = mobileNetV1(x, params.mobilenetv1);\r\n            var _a = predictionLayer(features.out, features.conv11, params.prediction_layer), boxPredictions = _a.boxPredictions, classPredictions = _a.classPredictions;\r\n            return outputLayer(boxPredictions, classPredictions, params.output_layer);\r\n        });\r\n    };\r\n    SsdMobilenetv1.prototype.forward = function (input) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SsdMobilenetv1.prototype.locateFaces = function (input, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, maxResults, minConfidence, netInput, _b, _boxes, _scores, boxes, scores, i, scoresData, _c, _d, iouThreshold, indices, reshapedDims, inputSize, padX, padY, boxesData, results;\r\n            return __generator(this, function (_e) {\r\n                switch (_e.label) {\r\n                    case 0:\r\n                        _a = new SsdMobilenetv1Options(options), maxResults = _a.maxResults, minConfidence = _a.minConfidence;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1:\r\n                        netInput = _e.sent();\r\n                        _b = this.forwardInput(netInput), _boxes = _b.boxes, _scores = _b.scores;\r\n                        boxes = _boxes[0];\r\n                        scores = _scores[0];\r\n                        for (i = 1; i < _boxes.length; i++) {\r\n                            _boxes[i].dispose();\r\n                            _scores[i].dispose();\r\n                        }\r\n                        _d = (_c = Array).from;\r\n                        return [4 /*yield*/, scores.data()];\r\n                    case 2:\r\n                        scoresData = _d.apply(_c, [_e.sent()]);\r\n                        iouThreshold = 0.5;\r\n                        indices = nonMaxSuppression(boxes, scoresData, maxResults, iouThreshold, minConfidence);\r\n                        reshapedDims = netInput.getReshapedInputDimensions(0);\r\n                        inputSize = netInput.inputSize;\r\n                        padX = inputSize / reshapedDims.width;\r\n                        padY = inputSize / reshapedDims.height;\r\n                        boxesData = boxes.arraySync();\r\n                        results = indices\r\n                            .map(function (idx) {\r\n                            var _a = [\r\n                                Math.max(0, boxesData[idx][0]),\r\n                                Math.min(1.0, boxesData[idx][2])\r\n                            ].map(function (val) { return val * padY; }), top = _a[0], bottom = _a[1];\r\n                            var _b = [\r\n                                Math.max(0, boxesData[idx][1]),\r\n                                Math.min(1.0, boxesData[idx][3])\r\n                            ].map(function (val) { return val * padX; }), left = _b[0], right = _b[1];\r\n                            return new FaceDetection(scoresData[idx], new Rect(left, top, right - left, bottom - top), {\r\n                                height: netInput.getInputHeight(0),\r\n                                width: netInput.getInputWidth(0)\r\n                            });\r\n                        });\r\n                        boxes.dispose();\r\n                        scores.dispose();\r\n                        return [2 /*return*/, results];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SsdMobilenetv1.prototype.getDefaultModelName = function () {\r\n        return 'ssd_mobilenetv1_model';\r\n    };\r\n    SsdMobilenetv1.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMap(weightMap);\r\n    };\r\n    SsdMobilenetv1.prototype.extractParams = function (weights) {\r\n        return extractParams(weights);\r\n    };\r\n    return SsdMobilenetv1;\r\n}(NeuralNetwork));\r\nexport { SsdMobilenetv1 };\r\n//# sourceMappingURL=SsdMobilenetv1.js.map","import { __extends } from \"tslib\";\r\nimport { SsdMobilenetv1 } from './SsdMobilenetv1';\r\nexport * from './SsdMobilenetv1';\r\nexport * from './SsdMobilenetv1Options';\r\nexport function createSsdMobilenetv1(weights) {\r\n    var net = new SsdMobilenetv1();\r\n    net.extractWeights(weights);\r\n    return net;\r\n}\r\nexport function createFaceDetectionNet(weights) {\r\n    return createSsdMobilenetv1(weights);\r\n}\r\n// alias for backward compatibily\r\nvar FaceDetectionNet = /** @class */ (function (_super) {\r\n    __extends(FaceDetectionNet, _super);\r\n    function FaceDetectionNet() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return FaceDetectionNet;\r\n}(SsdMobilenetv1));\r\nexport { FaceDetectionNet };\r\n//# sourceMappingURL=index.js.map","import { Point } from '../classes';\r\nexport var IOU_THRESHOLD = 0.4;\r\nexport var BOX_ANCHORS = [\r\n    new Point(0.738768, 0.874946),\r\n    new Point(2.42204, 2.65704),\r\n    new Point(4.30971, 7.04493),\r\n    new Point(10.246, 4.59428),\r\n    new Point(12.6868, 11.8741)\r\n];\r\nexport var BOX_ANCHORS_SEPARABLE = [\r\n    new Point(1.603231, 2.094468),\r\n    new Point(6.041143, 7.080126),\r\n    new Point(2.882459, 3.518061),\r\n    new Point(4.266906, 5.178857),\r\n    new Point(9.041765, 10.66308)\r\n];\r\nexport var MEAN_RGB_SEPARABLE = [117.001, 114.697, 97.404];\r\nexport var DEFAULT_MODEL_NAME = 'tiny_yolov2_model';\r\nexport var DEFAULT_MODEL_NAME_SEPARABLE_CONV = 'tiny_yolov2_separable_conv_model';\r\n//# sourceMappingURL=const.js.map","var isNumber = function (arg) { return typeof arg === 'number'; };\r\nexport function validateConfig(config) {\r\n    if (!config) {\r\n        throw new Error(\"invalid config: \" + config);\r\n    }\r\n    if (typeof config.withSeparableConvs !== 'boolean') {\r\n        throw new Error(\"config.withSeparableConvs has to be a boolean, have: \" + config.withSeparableConvs);\r\n    }\r\n    if (!isNumber(config.iouThreshold) || config.iouThreshold < 0 || config.iouThreshold > 1.0) {\r\n        throw new Error(\"config.iouThreshold has to be a number between [0, 1], have: \" + config.iouThreshold);\r\n    }\r\n    if (!Array.isArray(config.classes)\r\n        || !config.classes.length\r\n        || !config.classes.every(function (c) { return typeof c === 'string'; })) {\r\n        throw new Error(\"config.classes has to be an array class names: string[], have: \" + JSON.stringify(config.classes));\r\n    }\r\n    if (!Array.isArray(config.anchors)\r\n        || !config.anchors.length\r\n        || !config.anchors.map(function (a) { return a || {}; }).every(function (a) { return isNumber(a.x) && isNumber(a.y); })) {\r\n        throw new Error(\"config.anchors has to be an array of { x: number, y: number }, have: \" + JSON.stringify(config.anchors));\r\n    }\r\n    if (config.meanRgb && (!Array.isArray(config.meanRgb)\r\n        || config.meanRgb.length !== 3\r\n        || !config.meanRgb.every(isNumber))) {\r\n        throw new Error(\"config.meanRgb has to be an array of shape [number, number, number], have: \" + JSON.stringify(config.meanRgb));\r\n    }\r\n}\r\n//# sourceMappingURL=config.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function leaky(x) {\r\n    return tf.tidy(function () {\r\n        var min = tf.mul(x, tf.scalar(0.10000000149011612));\r\n        return tf.add(tf.relu(tf.sub(x, min)), min);\r\n        //return tf.maximum(x, min)\r\n    });\r\n}\r\n//# sourceMappingURL=leaky.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { leaky } from './leaky';\r\nexport function convWithBatchNorm(x, params) {\r\n    return tf.tidy(function () {\r\n        var out = tf.pad(x, [[0, 0], [1, 1], [1, 1], [0, 0]]);\r\n        out = tf.conv2d(out, params.conv.filters, [1, 1], 'valid');\r\n        out = tf.sub(out, params.bn.sub);\r\n        out = tf.mul(out, params.bn.truediv);\r\n        out = tf.add(out, params.conv.bias);\r\n        return leaky(out);\r\n    });\r\n}\r\n//# sourceMappingURL=convWithBatchNorm.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { leaky } from './leaky';\r\nexport function depthwiseSeparableConv(x, params) {\r\n    return tf.tidy(function () {\r\n        var out = tf.pad(x, [[0, 0], [1, 1], [1, 1], [0, 0]]);\r\n        out = tf.separableConv2d(out, params.depthwise_filter, params.pointwise_filter, [1, 1], 'valid');\r\n        out = tf.add(out, params.bias);\r\n        return leaky(out);\r\n    });\r\n}\r\n//# sourceMappingURL=depthwiseSeparableConv.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { extractConvParamsFactory } from '../common';\r\nimport { extractSeparableConvParamsFactory } from '../common/extractSeparableConvParamsFactory';\r\nimport { extractWeightsFactory } from '../common/extractWeightsFactory';\r\nfunction extractorsFactory(extractWeights, paramMappings) {\r\n    var extractConvParams = extractConvParamsFactory(extractWeights, paramMappings);\r\n    function extractBatchNormParams(size, mappedPrefix) {\r\n        var sub = tf.tensor1d(extractWeights(size));\r\n        var truediv = tf.tensor1d(extractWeights(size));\r\n        paramMappings.push({ paramPath: mappedPrefix + \"/sub\" }, { paramPath: mappedPrefix + \"/truediv\" });\r\n        return { sub: sub, truediv: truediv };\r\n    }\r\n    function extractConvWithBatchNormParams(channelsIn, channelsOut, mappedPrefix) {\r\n        var conv = extractConvParams(channelsIn, channelsOut, 3, mappedPrefix + \"/conv\");\r\n        var bn = extractBatchNormParams(channelsOut, mappedPrefix + \"/bn\");\r\n        return { conv: conv, bn: bn };\r\n    }\r\n    var extractSeparableConvParams = extractSeparableConvParamsFactory(extractWeights, paramMappings);\r\n    return {\r\n        extractConvParams: extractConvParams,\r\n        extractConvWithBatchNormParams: extractConvWithBatchNormParams,\r\n        extractSeparableConvParams: extractSeparableConvParams\r\n    };\r\n}\r\nexport function extractParams(weights, config, boxEncodingSize, filterSizes) {\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var paramMappings = [];\r\n    var _b = extractorsFactory(extractWeights, paramMappings), extractConvParams = _b.extractConvParams, extractConvWithBatchNormParams = _b.extractConvWithBatchNormParams, extractSeparableConvParams = _b.extractSeparableConvParams;\r\n    var params;\r\n    if (config.withSeparableConvs) {\r\n        var s0 = filterSizes[0], s1 = filterSizes[1], s2 = filterSizes[2], s3 = filterSizes[3], s4 = filterSizes[4], s5 = filterSizes[5], s6 = filterSizes[6], s7 = filterSizes[7], s8 = filterSizes[8];\r\n        var conv0 = config.isFirstLayerConv2d\r\n            ? extractConvParams(s0, s1, 3, 'conv0')\r\n            : extractSeparableConvParams(s0, s1, 'conv0');\r\n        var conv1 = extractSeparableConvParams(s1, s2, 'conv1');\r\n        var conv2 = extractSeparableConvParams(s2, s3, 'conv2');\r\n        var conv3 = extractSeparableConvParams(s3, s4, 'conv3');\r\n        var conv4 = extractSeparableConvParams(s4, s5, 'conv4');\r\n        var conv5 = extractSeparableConvParams(s5, s6, 'conv5');\r\n        var conv6 = s7 ? extractSeparableConvParams(s6, s7, 'conv6') : undefined;\r\n        var conv7 = s8 ? extractSeparableConvParams(s7, s8, 'conv7') : undefined;\r\n        var conv8 = extractConvParams(s8 || s7 || s6, 5 * boxEncodingSize, 1, 'conv8');\r\n        params = { conv0: conv0, conv1: conv1, conv2: conv2, conv3: conv3, conv4: conv4, conv5: conv5, conv6: conv6, conv7: conv7, conv8: conv8 };\r\n    }\r\n    else {\r\n        var s0 = filterSizes[0], s1 = filterSizes[1], s2 = filterSizes[2], s3 = filterSizes[3], s4 = filterSizes[4], s5 = filterSizes[5], s6 = filterSizes[6], s7 = filterSizes[7], s8 = filterSizes[8];\r\n        var conv0 = extractConvWithBatchNormParams(s0, s1, 'conv0');\r\n        var conv1 = extractConvWithBatchNormParams(s1, s2, 'conv1');\r\n        var conv2 = extractConvWithBatchNormParams(s2, s3, 'conv2');\r\n        var conv3 = extractConvWithBatchNormParams(s3, s4, 'conv3');\r\n        var conv4 = extractConvWithBatchNormParams(s4, s5, 'conv4');\r\n        var conv5 = extractConvWithBatchNormParams(s5, s6, 'conv5');\r\n        var conv6 = extractConvWithBatchNormParams(s6, s7, 'conv6');\r\n        var conv7 = extractConvWithBatchNormParams(s7, s8, 'conv7');\r\n        var conv8 = extractConvParams(s8, 5 * boxEncodingSize, 1, 'conv8');\r\n        params = { conv0: conv0, conv1: conv1, conv2: conv2, conv3: conv3, conv4: conv4, conv5: conv5, conv6: conv6, conv7: conv7, conv8: conv8 };\r\n    }\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { disposeUnusedWeightTensors } from '../common/disposeUnusedWeightTensors';\r\nimport { loadSeparableConvParamsFactory } from '../common/extractSeparableConvParamsFactory';\r\nimport { extractWeightEntryFactory } from '../common/extractWeightEntryFactory';\r\nfunction extractorsFactory(weightMap, paramMappings) {\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    function extractBatchNormParams(prefix) {\r\n        var sub = extractWeightEntry(prefix + \"/sub\", 1);\r\n        var truediv = extractWeightEntry(prefix + \"/truediv\", 1);\r\n        return { sub: sub, truediv: truediv };\r\n    }\r\n    function extractConvParams(prefix) {\r\n        var filters = extractWeightEntry(prefix + \"/filters\", 4);\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return { filters: filters, bias: bias };\r\n    }\r\n    function extractConvWithBatchNormParams(prefix) {\r\n        var conv = extractConvParams(prefix + \"/conv\");\r\n        var bn = extractBatchNormParams(prefix + \"/bn\");\r\n        return { conv: conv, bn: bn };\r\n    }\r\n    var extractSeparableConvParams = loadSeparableConvParamsFactory(extractWeightEntry);\r\n    return {\r\n        extractConvParams: extractConvParams,\r\n        extractConvWithBatchNormParams: extractConvWithBatchNormParams,\r\n        extractSeparableConvParams: extractSeparableConvParams\r\n    };\r\n}\r\nexport function extractParamsFromWeigthMap(weightMap, config) {\r\n    var paramMappings = [];\r\n    var _a = extractorsFactory(weightMap, paramMappings), extractConvParams = _a.extractConvParams, extractConvWithBatchNormParams = _a.extractConvWithBatchNormParams, extractSeparableConvParams = _a.extractSeparableConvParams;\r\n    var params;\r\n    if (config.withSeparableConvs) {\r\n        var numFilters = (config.filterSizes && config.filterSizes.length || 9);\r\n        params = {\r\n            conv0: config.isFirstLayerConv2d ? extractConvParams('conv0') : extractSeparableConvParams('conv0'),\r\n            conv1: extractSeparableConvParams('conv1'),\r\n            conv2: extractSeparableConvParams('conv2'),\r\n            conv3: extractSeparableConvParams('conv3'),\r\n            conv4: extractSeparableConvParams('conv4'),\r\n            conv5: extractSeparableConvParams('conv5'),\r\n            conv6: numFilters > 7 ? extractSeparableConvParams('conv6') : undefined,\r\n            conv7: numFilters > 8 ? extractSeparableConvParams('conv7') : undefined,\r\n            conv8: extractConvParams('conv8')\r\n        };\r\n    }\r\n    else {\r\n        params = {\r\n            conv0: extractConvWithBatchNormParams('conv0'),\r\n            conv1: extractConvWithBatchNormParams('conv1'),\r\n            conv2: extractConvWithBatchNormParams('conv2'),\r\n            conv3: extractConvWithBatchNormParams('conv3'),\r\n            conv4: extractConvWithBatchNormParams('conv4'),\r\n            conv5: extractConvWithBatchNormParams('conv5'),\r\n            conv6: extractConvWithBatchNormParams('conv6'),\r\n            conv7: extractConvWithBatchNormParams('conv7'),\r\n            conv8: extractConvParams('conv8')\r\n        };\r\n    }\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: params, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","export var TinyYolov2SizeType;\r\n(function (TinyYolov2SizeType) {\r\n    TinyYolov2SizeType[TinyYolov2SizeType[\"XS\"] = 224] = \"XS\";\r\n    TinyYolov2SizeType[TinyYolov2SizeType[\"SM\"] = 320] = \"SM\";\r\n    TinyYolov2SizeType[TinyYolov2SizeType[\"MD\"] = 416] = \"MD\";\r\n    TinyYolov2SizeType[TinyYolov2SizeType[\"LG\"] = 608] = \"LG\";\r\n})(TinyYolov2SizeType || (TinyYolov2SizeType = {}));\r\nvar TinyYolov2Options = /** @class */ (function () {\r\n    function TinyYolov2Options(_a) {\r\n        var _b = _a === void 0 ? {} : _a, inputSize = _b.inputSize, scoreThreshold = _b.scoreThreshold;\r\n        this._name = 'TinyYolov2Options';\r\n        this._inputSize = inputSize || 416;\r\n        this._scoreThreshold = scoreThreshold || 0.5;\r\n        if (typeof this._inputSize !== 'number' || this._inputSize % 32 !== 0) {\r\n            throw new Error(this._name + \" - expected inputSize to be a number divisible by 32\");\r\n        }\r\n        if (typeof this._scoreThreshold !== 'number' || this._scoreThreshold <= 0 || this._scoreThreshold >= 1) {\r\n            throw new Error(this._name + \" - expected scoreThreshold to be a number between 0 and 1\");\r\n        }\r\n    }\r\n    Object.defineProperty(TinyYolov2Options.prototype, \"inputSize\", {\r\n        get: function () { return this._inputSize; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TinyYolov2Options.prototype, \"scoreThreshold\", {\r\n        get: function () { return this._scoreThreshold; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return TinyYolov2Options;\r\n}());\r\nexport { TinyYolov2Options };\r\n//# sourceMappingURL=TinyYolov2Options.js.map","import { __assign, __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { BoundingBox } from '../classes/BoundingBox';\r\nimport { ObjectDetection } from '../classes/ObjectDetection';\r\nimport { convLayer } from '../common';\r\nimport { toNetInput } from '../dom';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { sigmoid } from '../ops';\r\nimport { nonMaxSuppression } from '../ops/nonMaxSuppression';\r\nimport { normalize } from '../ops/normalize';\r\nimport { validateConfig } from './config';\r\nimport { convWithBatchNorm } from './convWithBatchNorm';\r\nimport { depthwiseSeparableConv } from './depthwiseSeparableConv';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nimport { leaky } from './leaky';\r\nimport { TinyYolov2Options } from './TinyYolov2Options';\r\nvar TinyYolov2Base = /** @class */ (function (_super) {\r\n    __extends(TinyYolov2Base, _super);\r\n    function TinyYolov2Base(config) {\r\n        var _this = _super.call(this, 'TinyYolov2') || this;\r\n        validateConfig(config);\r\n        _this._config = config;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TinyYolov2Base.prototype, \"config\", {\r\n        get: function () {\r\n            return this._config;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TinyYolov2Base.prototype, \"withClassScores\", {\r\n        get: function () {\r\n            return this.config.withClassScores || this.config.classes.length > 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TinyYolov2Base.prototype, \"boxEncodingSize\", {\r\n        get: function () {\r\n            return 5 + (this.withClassScores ? this.config.classes.length : 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TinyYolov2Base.prototype.runTinyYolov2 = function (x, params) {\r\n        var out = convWithBatchNorm(x, params.conv0);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convWithBatchNorm(out, params.conv1);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convWithBatchNorm(out, params.conv2);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convWithBatchNorm(out, params.conv3);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convWithBatchNorm(out, params.conv4);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convWithBatchNorm(out, params.conv5);\r\n        out = tf.maxPool(out, [2, 2], [1, 1], 'same');\r\n        out = convWithBatchNorm(out, params.conv6);\r\n        out = convWithBatchNorm(out, params.conv7);\r\n        return convLayer(out, params.conv8, 'valid', false);\r\n    };\r\n    TinyYolov2Base.prototype.runMobilenet = function (x, params) {\r\n        var out = this.config.isFirstLayerConv2d\r\n            ? leaky(convLayer(x, params.conv0, 'valid', false))\r\n            : depthwiseSeparableConv(x, params.conv0);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = depthwiseSeparableConv(out, params.conv1);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = depthwiseSeparableConv(out, params.conv2);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = depthwiseSeparableConv(out, params.conv3);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = depthwiseSeparableConv(out, params.conv4);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = depthwiseSeparableConv(out, params.conv5);\r\n        out = tf.maxPool(out, [2, 2], [1, 1], 'same');\r\n        out = params.conv6 ? depthwiseSeparableConv(out, params.conv6) : out;\r\n        out = params.conv7 ? depthwiseSeparableConv(out, params.conv7) : out;\r\n        return convLayer(out, params.conv8, 'valid', false);\r\n    };\r\n    TinyYolov2Base.prototype.forwardInput = function (input, inputSize) {\r\n        var _this = this;\r\n        var params = this.params;\r\n        if (!params) {\r\n            throw new Error('TinyYolov2 - load model before inference');\r\n        }\r\n        return tf.tidy(function () {\r\n            var batchTensor = input.toBatchTensor(inputSize, false).toFloat();\r\n            batchTensor = _this.config.meanRgb\r\n                ? normalize(batchTensor, _this.config.meanRgb)\r\n                : batchTensor;\r\n            batchTensor = batchTensor.div(tf.scalar(256));\r\n            return _this.config.withSeparableConvs\r\n                ? _this.runMobilenet(batchTensor, params)\r\n                : _this.runTinyYolov2(batchTensor, params);\r\n        });\r\n    };\r\n    TinyYolov2Base.prototype.forward = function (input, inputSize) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [4 /*yield*/, _a.apply(this, [_b.sent(), inputSize])];\r\n                    case 2: return [2 /*return*/, _b.sent()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyYolov2Base.prototype.detect = function (input, forwardParams) {\r\n        if (forwardParams === void 0) { forwardParams = {}; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, inputSize, scoreThreshold, netInput, out, out0, inputDimensions, results, boxes, scores, classScores, classNames, indices, detections;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = new TinyYolov2Options(forwardParams), inputSize = _a.inputSize, scoreThreshold = _a.scoreThreshold;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1:\r\n                        netInput = _b.sent();\r\n                        return [4 /*yield*/, this.forwardInput(netInput, inputSize)];\r\n                    case 2:\r\n                        out = _b.sent();\r\n                        out0 = tf.tidy(function () { return tf.unstack(out)[0].expandDims(); });\r\n                        inputDimensions = {\r\n                            width: netInput.getInputWidth(0),\r\n                            height: netInput.getInputHeight(0)\r\n                        };\r\n                        return [4 /*yield*/, this.extractBoxes(out0, netInput.getReshapedInputDimensions(0), scoreThreshold)];\r\n                    case 3:\r\n                        results = _b.sent();\r\n                        out.dispose();\r\n                        out0.dispose();\r\n                        boxes = results.map(function (res) { return res.box; });\r\n                        scores = results.map(function (res) { return res.score; });\r\n                        classScores = results.map(function (res) { return res.classScore; });\r\n                        classNames = results.map(function (res) { return _this.config.classes[res.label]; });\r\n                        indices = nonMaxSuppression(boxes.map(function (box) { return box.rescale(inputSize); }), scores, this.config.iouThreshold, true);\r\n                        detections = indices.map(function (idx) {\r\n                            return new ObjectDetection(scores[idx], classScores[idx], classNames[idx], boxes[idx], inputDimensions);\r\n                        });\r\n                        return [2 /*return*/, detections];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyYolov2Base.prototype.getDefaultModelName = function () {\r\n        return '';\r\n    };\r\n    TinyYolov2Base.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMap(weightMap, this.config);\r\n    };\r\n    TinyYolov2Base.prototype.extractParams = function (weights) {\r\n        var filterSizes = this.config.filterSizes || TinyYolov2Base.DEFAULT_FILTER_SIZES;\r\n        var numFilters = filterSizes ? filterSizes.length : undefined;\r\n        if (numFilters !== 7 && numFilters !== 8 && numFilters !== 9) {\r\n            throw new Error(\"TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found \" + numFilters + \" filterSizes in config\");\r\n        }\r\n        return extractParams(weights, this.config, this.boxEncodingSize, filterSizes);\r\n    };\r\n    TinyYolov2Base.prototype.extractBoxes = function (outputTensor, inputBlobDimensions, scoreThreshold) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var width, height, inputSize, correctionFactorX, correctionFactorY, numCells, numBoxes, _a, boxesTensor, scoresTensor, classScoresTensor, results, scoresData, boxesData, row, col, anchor, score, ctX, ctY, width_1, height_1, x, y, pos, _b, classScore, label, _c;\r\n            var _this = this;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        width = inputBlobDimensions.width, height = inputBlobDimensions.height;\r\n                        inputSize = Math.max(width, height);\r\n                        correctionFactorX = inputSize / width;\r\n                        correctionFactorY = inputSize / height;\r\n                        numCells = outputTensor.shape[1];\r\n                        numBoxes = this.config.anchors.length;\r\n                        _a = tf.tidy(function () {\r\n                            var reshaped = outputTensor.reshape([numCells, numCells, numBoxes, _this.boxEncodingSize]);\r\n                            var boxes = reshaped.slice([0, 0, 0, 0], [numCells, numCells, numBoxes, 4]);\r\n                            var scores = reshaped.slice([0, 0, 0, 4], [numCells, numCells, numBoxes, 1]);\r\n                            var classScores = _this.withClassScores\r\n                                ? tf.softmax(reshaped.slice([0, 0, 0, 5], [numCells, numCells, numBoxes, _this.config.classes.length]), 3)\r\n                                : tf.scalar(0);\r\n                            return [boxes, scores, classScores];\r\n                        }), boxesTensor = _a[0], scoresTensor = _a[1], classScoresTensor = _a[2];\r\n                        results = [];\r\n                        return [4 /*yield*/, scoresTensor.array()];\r\n                    case 1:\r\n                        scoresData = _d.sent();\r\n                        return [4 /*yield*/, boxesTensor.array()];\r\n                    case 2:\r\n                        boxesData = _d.sent();\r\n                        row = 0;\r\n                        _d.label = 3;\r\n                    case 3:\r\n                        if (!(row < numCells)) return [3 /*break*/, 12];\r\n                        col = 0;\r\n                        _d.label = 4;\r\n                    case 4:\r\n                        if (!(col < numCells)) return [3 /*break*/, 11];\r\n                        anchor = 0;\r\n                        _d.label = 5;\r\n                    case 5:\r\n                        if (!(anchor < numBoxes)) return [3 /*break*/, 10];\r\n                        score = sigmoid(scoresData[row][col][anchor][0]);\r\n                        if (!(!scoreThreshold || score > scoreThreshold)) return [3 /*break*/, 9];\r\n                        ctX = ((col + sigmoid(boxesData[row][col][anchor][0])) / numCells) * correctionFactorX;\r\n                        ctY = ((row + sigmoid(boxesData[row][col][anchor][1])) / numCells) * correctionFactorY;\r\n                        width_1 = ((Math.exp(boxesData[row][col][anchor][2]) * this.config.anchors[anchor].x) / numCells) * correctionFactorX;\r\n                        height_1 = ((Math.exp(boxesData[row][col][anchor][3]) * this.config.anchors[anchor].y) / numCells) * correctionFactorY;\r\n                        x = (ctX - (width_1 / 2));\r\n                        y = (ctY - (height_1 / 2));\r\n                        pos = { row: row, col: col, anchor: anchor };\r\n                        if (!this.withClassScores) return [3 /*break*/, 7];\r\n                        return [4 /*yield*/, this.extractPredictedClass(classScoresTensor, pos)];\r\n                    case 6:\r\n                        _c = _d.sent();\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        _c = { classScore: 1, label: 0 };\r\n                        _d.label = 8;\r\n                    case 8:\r\n                        _b = _c, classScore = _b.classScore, label = _b.label;\r\n                        results.push(__assign({ box: new BoundingBox(x, y, x + width_1, y + height_1), score: score, classScore: score * classScore, label: label }, pos));\r\n                        _d.label = 9;\r\n                    case 9:\r\n                        anchor++;\r\n                        return [3 /*break*/, 5];\r\n                    case 10:\r\n                        col++;\r\n                        return [3 /*break*/, 4];\r\n                    case 11:\r\n                        row++;\r\n                        return [3 /*break*/, 3];\r\n                    case 12:\r\n                        boxesTensor.dispose();\r\n                        scoresTensor.dispose();\r\n                        classScoresTensor.dispose();\r\n                        return [2 /*return*/, results];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyYolov2Base.prototype.extractPredictedClass = function (classesTensor, pos) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var row, col, anchor, classesData;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        row = pos.row, col = pos.col, anchor = pos.anchor;\r\n                        return [4 /*yield*/, classesTensor.array()];\r\n                    case 1:\r\n                        classesData = _a.sent();\r\n                        return [2 /*return*/, Array(this.config.classes.length).fill(0)\r\n                                .map(function (_, i) { return classesData[row][col][anchor][i]; })\r\n                                .map(function (classScore, label) { return ({\r\n                                classScore: classScore,\r\n                                label: label\r\n                            }); })\r\n                                .reduce(function (max, curr) { return max.classScore > curr.classScore ? max : curr; })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyYolov2Base.DEFAULT_FILTER_SIZES = [\r\n        3, 16, 32, 64, 128, 256, 512, 1024, 1024\r\n    ];\r\n    return TinyYolov2Base;\r\n}(NeuralNetwork));\r\nexport { TinyYolov2Base };\r\n//# sourceMappingURL=TinyYolov2Base.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport { FaceDetection } from '../classes';\r\nimport { BOX_ANCHORS, BOX_ANCHORS_SEPARABLE, DEFAULT_MODEL_NAME, DEFAULT_MODEL_NAME_SEPARABLE_CONV, IOU_THRESHOLD, MEAN_RGB_SEPARABLE, } from './const';\r\nimport { TinyYolov2Base } from './TinyYolov2Base';\r\nvar TinyYolov2 = /** @class */ (function (_super) {\r\n    __extends(TinyYolov2, _super);\r\n    function TinyYolov2(withSeparableConvs) {\r\n        if (withSeparableConvs === void 0) { withSeparableConvs = true; }\r\n        var _this = this;\r\n        var config = Object.assign({}, {\r\n            withSeparableConvs: withSeparableConvs,\r\n            iouThreshold: IOU_THRESHOLD,\r\n            classes: ['face']\r\n        }, withSeparableConvs\r\n            ? {\r\n                anchors: BOX_ANCHORS_SEPARABLE,\r\n                meanRgb: MEAN_RGB_SEPARABLE\r\n            }\r\n            : {\r\n                anchors: BOX_ANCHORS,\r\n                withClassScores: true\r\n            });\r\n        _this = _super.call(this, config) || this;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TinyYolov2.prototype, \"withSeparableConvs\", {\r\n        get: function () {\r\n            return this.config.withSeparableConvs;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TinyYolov2.prototype, \"anchors\", {\r\n        get: function () {\r\n            return this.config.anchors;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TinyYolov2.prototype.locateFaces = function (input, forwardParams) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var objectDetections;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.detect(input, forwardParams)];\r\n                    case 1:\r\n                        objectDetections = _a.sent();\r\n                        return [2 /*return*/, objectDetections.map(function (det) { return new FaceDetection(det.score, det.relativeBox, { width: det.imageWidth, height: det.imageHeight }); })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyYolov2.prototype.getDefaultModelName = function () {\r\n        return this.withSeparableConvs ? DEFAULT_MODEL_NAME_SEPARABLE_CONV : DEFAULT_MODEL_NAME;\r\n    };\r\n    TinyYolov2.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return _super.prototype.extractParamsFromWeigthMap.call(this, weightMap);\r\n    };\r\n    return TinyYolov2;\r\n}(TinyYolov2Base));\r\nexport { TinyYolov2 };\r\n//# sourceMappingURL=TinyYolov2.js.map","import { __extends } from \"tslib\";\r\nimport { TinyYolov2Options } from '../tinyYolov2';\r\nvar TinyFaceDetectorOptions = /** @class */ (function (_super) {\r\n    __extends(TinyFaceDetectorOptions, _super);\r\n    function TinyFaceDetectorOptions() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._name = 'TinyFaceDetectorOptions';\r\n        return _this;\r\n    }\r\n    return TinyFaceDetectorOptions;\r\n}(TinyYolov2Options));\r\nexport { TinyFaceDetectorOptions };\r\n//# sourceMappingURL=TinyFaceDetectorOptions.js.map","import { __awaiter, __generator } from \"tslib\";\r\nvar ComposableTask = /** @class */ (function () {\r\n    function ComposableTask() {\r\n    }\r\n    ComposableTask.prototype.then = function (onfulfilled) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = onfulfilled;\r\n                        return [4 /*yield*/, this.run()];\r\n                    case 1: return [2 /*return*/, _a.apply(void 0, [_b.sent()])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ComposableTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                throw new Error('ComposableTask - run is not implemented');\r\n            });\r\n        });\r\n    };\r\n    return ComposableTask;\r\n}());\r\nexport { ComposableTask };\r\n//# sourceMappingURL=ComposableTask.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { extractFaces, extractFaceTensors } from '../dom';\r\nimport { isWithFaceLandmarks } from '../factories/WithFaceLandmarks';\r\nexport function extractAllFacesAndComputeResults(parentResults, input, computeResults, extractedFaces, getRectForAlignment) {\r\n    if (getRectForAlignment === void 0) { getRectForAlignment = function (_a) {\r\n        var alignedRect = _a.alignedRect;\r\n        return alignedRect;\r\n    }; }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var faceBoxes, faces, _a, _b, results;\r\n        return __generator(this, function (_c) {\r\n            switch (_c.label) {\r\n                case 0:\r\n                    faceBoxes = parentResults.map(function (parentResult) {\r\n                        return isWithFaceLandmarks(parentResult)\r\n                            ? getRectForAlignment(parentResult)\r\n                            : parentResult.detection;\r\n                    });\r\n                    _a = extractedFaces;\r\n                    if (_a) return [3 /*break*/, 5];\r\n                    if (!(input instanceof tf.Tensor)) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, extractFaceTensors(input, faceBoxes)];\r\n                case 1:\r\n                    _b = _c.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 2: return [4 /*yield*/, extractFaces(input, faceBoxes)];\r\n                case 3:\r\n                    _b = _c.sent();\r\n                    _c.label = 4;\r\n                case 4:\r\n                    _a = (_b);\r\n                    _c.label = 5;\r\n                case 5:\r\n                    faces = _a;\r\n                    return [4 /*yield*/, computeResults(faces)];\r\n                case 6:\r\n                    results = _c.sent();\r\n                    faces.forEach(function (f) { return f instanceof tf.Tensor && f.dispose(); });\r\n                    return [2 /*return*/, results];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function extractSingleFaceAndComputeResult(parentResult, input, computeResult, extractedFaces, getRectForAlignment) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _this = this;\r\n        return __generator(this, function (_a) {\r\n            return [2 /*return*/, extractAllFacesAndComputeResults([parentResult], input, function (faces) { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                    return [2 /*return*/, computeResult(faces[0])];\r\n                }); }); }, extractedFaces, getRectForAlignment)];\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=extractFacesAndComputeResults.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function bgrToRgbTensor(tensor) {\r\n    return tf.tidy(function () { return tf.stack(tf.unstack(tensor, 3).reverse(), 3); });\r\n}\r\n//# sourceMappingURL=bgrToRgbTensor.js.map","export var CELL_STRIDE = 2;\r\nexport var CELL_SIZE = 12;\r\n//# sourceMappingURL=config.js.map","import { __assign } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { extractConvParamsFactory, extractFCParamsFactory, extractWeightsFactory, } from '../common';\r\nfunction extractorsFactory(extractWeights, paramMappings) {\r\n    var extractConvParams = extractConvParamsFactory(extractWeights, paramMappings);\r\n    var extractFCParams = extractFCParamsFactory(extractWeights, paramMappings);\r\n    function extractPReluParams(size, paramPath) {\r\n        var alpha = tf.tensor1d(extractWeights(size));\r\n        paramMappings.push({ paramPath: paramPath });\r\n        return alpha;\r\n    }\r\n    function extractSharedParams(numFilters, mappedPrefix, isRnet) {\r\n        if (isRnet === void 0) { isRnet = false; }\r\n        var conv1 = extractConvParams(numFilters[0], numFilters[1], 3, mappedPrefix + \"/conv1\");\r\n        var prelu1_alpha = extractPReluParams(numFilters[1], mappedPrefix + \"/prelu1_alpha\");\r\n        var conv2 = extractConvParams(numFilters[1], numFilters[2], 3, mappedPrefix + \"/conv2\");\r\n        var prelu2_alpha = extractPReluParams(numFilters[2], mappedPrefix + \"/prelu2_alpha\");\r\n        var conv3 = extractConvParams(numFilters[2], numFilters[3], isRnet ? 2 : 3, mappedPrefix + \"/conv3\");\r\n        var prelu3_alpha = extractPReluParams(numFilters[3], mappedPrefix + \"/prelu3_alpha\");\r\n        return { conv1: conv1, prelu1_alpha: prelu1_alpha, conv2: conv2, prelu2_alpha: prelu2_alpha, conv3: conv3, prelu3_alpha: prelu3_alpha };\r\n    }\r\n    function extractPNetParams() {\r\n        var sharedParams = extractSharedParams([3, 10, 16, 32], 'pnet');\r\n        var conv4_1 = extractConvParams(32, 2, 1, 'pnet/conv4_1');\r\n        var conv4_2 = extractConvParams(32, 4, 1, 'pnet/conv4_2');\r\n        return __assign(__assign({}, sharedParams), { conv4_1: conv4_1, conv4_2: conv4_2 });\r\n    }\r\n    function extractRNetParams() {\r\n        var sharedParams = extractSharedParams([3, 28, 48, 64], 'rnet', true);\r\n        var fc1 = extractFCParams(576, 128, 'rnet/fc1');\r\n        var prelu4_alpha = extractPReluParams(128, 'rnet/prelu4_alpha');\r\n        var fc2_1 = extractFCParams(128, 2, 'rnet/fc2_1');\r\n        var fc2_2 = extractFCParams(128, 4, 'rnet/fc2_2');\r\n        return __assign(__assign({}, sharedParams), { fc1: fc1, prelu4_alpha: prelu4_alpha, fc2_1: fc2_1, fc2_2: fc2_2 });\r\n    }\r\n    function extractONetParams() {\r\n        var sharedParams = extractSharedParams([3, 32, 64, 64], 'onet');\r\n        var conv4 = extractConvParams(64, 128, 2, 'onet/conv4');\r\n        var prelu4_alpha = extractPReluParams(128, 'onet/prelu4_alpha');\r\n        var fc1 = extractFCParams(1152, 256, 'onet/fc1');\r\n        var prelu5_alpha = extractPReluParams(256, 'onet/prelu5_alpha');\r\n        var fc2_1 = extractFCParams(256, 2, 'onet/fc2_1');\r\n        var fc2_2 = extractFCParams(256, 4, 'onet/fc2_2');\r\n        var fc2_3 = extractFCParams(256, 10, 'onet/fc2_3');\r\n        return __assign(__assign({}, sharedParams), { conv4: conv4, prelu4_alpha: prelu4_alpha, fc1: fc1, prelu5_alpha: prelu5_alpha, fc2_1: fc2_1, fc2_2: fc2_2, fc2_3: fc2_3 });\r\n    }\r\n    return {\r\n        extractPNetParams: extractPNetParams,\r\n        extractRNetParams: extractRNetParams,\r\n        extractONetParams: extractONetParams\r\n    };\r\n}\r\nexport function extractParams(weights) {\r\n    var _a = extractWeightsFactory(weights), extractWeights = _a.extractWeights, getRemainingWeights = _a.getRemainingWeights;\r\n    var paramMappings = [];\r\n    var _b = extractorsFactory(extractWeights, paramMappings), extractPNetParams = _b.extractPNetParams, extractRNetParams = _b.extractRNetParams, extractONetParams = _b.extractONetParams;\r\n    var pnet = extractPNetParams();\r\n    var rnet = extractRNetParams();\r\n    var onet = extractONetParams();\r\n    if (getRemainingWeights().length !== 0) {\r\n        throw new Error(\"weights remaing after extract: \" + getRemainingWeights().length);\r\n    }\r\n    return { params: { pnet: pnet, rnet: rnet, onet: onet }, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParams.js.map","import { __assign } from \"tslib\";\r\nimport { disposeUnusedWeightTensors, extractWeightEntryFactory } from '../common';\r\nfunction extractorsFactory(weightMap, paramMappings) {\r\n    var extractWeightEntry = extractWeightEntryFactory(weightMap, paramMappings);\r\n    function extractConvParams(prefix) {\r\n        var filters = extractWeightEntry(prefix + \"/weights\", 4, prefix + \"/filters\");\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return { filters: filters, bias: bias };\r\n    }\r\n    function extractFCParams(prefix) {\r\n        var weights = extractWeightEntry(prefix + \"/weights\", 2);\r\n        var bias = extractWeightEntry(prefix + \"/bias\", 1);\r\n        return { weights: weights, bias: bias };\r\n    }\r\n    function extractPReluParams(paramPath) {\r\n        return extractWeightEntry(paramPath, 1);\r\n    }\r\n    function extractSharedParams(prefix) {\r\n        var conv1 = extractConvParams(prefix + \"/conv1\");\r\n        var prelu1_alpha = extractPReluParams(prefix + \"/prelu1_alpha\");\r\n        var conv2 = extractConvParams(prefix + \"/conv2\");\r\n        var prelu2_alpha = extractPReluParams(prefix + \"/prelu2_alpha\");\r\n        var conv3 = extractConvParams(prefix + \"/conv3\");\r\n        var prelu3_alpha = extractPReluParams(prefix + \"/prelu3_alpha\");\r\n        return { conv1: conv1, prelu1_alpha: prelu1_alpha, conv2: conv2, prelu2_alpha: prelu2_alpha, conv3: conv3, prelu3_alpha: prelu3_alpha };\r\n    }\r\n    function extractPNetParams() {\r\n        var sharedParams = extractSharedParams('pnet');\r\n        var conv4_1 = extractConvParams('pnet/conv4_1');\r\n        var conv4_2 = extractConvParams('pnet/conv4_2');\r\n        return __assign(__assign({}, sharedParams), { conv4_1: conv4_1, conv4_2: conv4_2 });\r\n    }\r\n    function extractRNetParams() {\r\n        var sharedParams = extractSharedParams('rnet');\r\n        var fc1 = extractFCParams('rnet/fc1');\r\n        var prelu4_alpha = extractPReluParams('rnet/prelu4_alpha');\r\n        var fc2_1 = extractFCParams('rnet/fc2_1');\r\n        var fc2_2 = extractFCParams('rnet/fc2_2');\r\n        return __assign(__assign({}, sharedParams), { fc1: fc1, prelu4_alpha: prelu4_alpha, fc2_1: fc2_1, fc2_2: fc2_2 });\r\n    }\r\n    function extractONetParams() {\r\n        var sharedParams = extractSharedParams('onet');\r\n        var conv4 = extractConvParams('onet/conv4');\r\n        var prelu4_alpha = extractPReluParams('onet/prelu4_alpha');\r\n        var fc1 = extractFCParams('onet/fc1');\r\n        var prelu5_alpha = extractPReluParams('onet/prelu5_alpha');\r\n        var fc2_1 = extractFCParams('onet/fc2_1');\r\n        var fc2_2 = extractFCParams('onet/fc2_2');\r\n        var fc2_3 = extractFCParams('onet/fc2_3');\r\n        return __assign(__assign({}, sharedParams), { conv4: conv4, prelu4_alpha: prelu4_alpha, fc1: fc1, prelu5_alpha: prelu5_alpha, fc2_1: fc2_1, fc2_2: fc2_2, fc2_3: fc2_3 });\r\n    }\r\n    return {\r\n        extractPNetParams: extractPNetParams,\r\n        extractRNetParams: extractRNetParams,\r\n        extractONetParams: extractONetParams\r\n    };\r\n}\r\nexport function extractParamsFromWeigthMap(weightMap) {\r\n    var paramMappings = [];\r\n    var _a = extractorsFactory(weightMap, paramMappings), extractPNetParams = _a.extractPNetParams, extractRNetParams = _a.extractRNetParams, extractONetParams = _a.extractONetParams;\r\n    var pnet = extractPNetParams();\r\n    var rnet = extractRNetParams();\r\n    var onet = extractONetParams();\r\n    disposeUnusedWeightTensors(weightMap, paramMappings);\r\n    return { params: { pnet: pnet, rnet: rnet, onet: onet }, paramMappings: paramMappings };\r\n}\r\n//# sourceMappingURL=extractParamsFromWeigthMap.js.map","export function getSizesForScale(scale, _a) {\r\n    var height = _a[0], width = _a[1];\r\n    return {\r\n        height: Math.floor(height * scale),\r\n        width: Math.floor(width * scale)\r\n    };\r\n}\r\n//# sourceMappingURL=getSizesForScale.js.map","import { CELL_SIZE } from './config';\r\nexport function pyramidDown(minFaceSize, scaleFactor, dims) {\r\n    var height = dims[0], width = dims[1];\r\n    var m = CELL_SIZE / minFaceSize;\r\n    var scales = [];\r\n    var minLayer = Math.min(height, width) * m;\r\n    var exp = 0;\r\n    while (minLayer >= 12) {\r\n        scales.push(m * Math.pow(scaleFactor, exp));\r\n        minLayer = minLayer * scaleFactor;\r\n        exp += 1;\r\n    }\r\n    return scales;\r\n}\r\n//# sourceMappingURL=pyramidDown.js.map","import { __extends } from \"tslib\";\r\nimport { Box } from '../classes';\r\nvar MtcnnBox = /** @class */ (function (_super) {\r\n    __extends(MtcnnBox, _super);\r\n    function MtcnnBox(left, top, right, bottom) {\r\n        return _super.call(this, { left: left, top: top, right: right, bottom: bottom }, true) || this;\r\n    }\r\n    return MtcnnBox;\r\n}(Box));\r\nexport { MtcnnBox };\r\n//# sourceMappingURL=MtcnnBox.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function normalize(x) {\r\n    return tf.tidy(function () { return tf.mul(tf.sub(x, tf.scalar(127.5)), tf.scalar(0.0078125)); });\r\n}\r\n//# sourceMappingURL=normalize.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nexport function prelu(x, alpha) {\r\n    return tf.tidy(function () {\r\n        return tf.add(tf.relu(x), tf.mul(alpha, tf.neg(tf.relu(tf.neg(x)))));\r\n    });\r\n}\r\n//# sourceMappingURL=prelu.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { convLayer } from '../common';\r\nimport { prelu } from './prelu';\r\nexport function sharedLayer(x, params, isPnet) {\r\n    if (isPnet === void 0) { isPnet = false; }\r\n    return tf.tidy(function () {\r\n        var out = convLayer(x, params.conv1, 'valid');\r\n        out = prelu(out, params.prelu1_alpha);\r\n        out = tf.maxPool(out, isPnet ? [2, 2] : [3, 3], [2, 2], 'same');\r\n        out = convLayer(out, params.conv2, 'valid');\r\n        out = prelu(out, params.prelu2_alpha);\r\n        out = isPnet ? out : tf.maxPool(out, [3, 3], [2, 2], 'valid');\r\n        out = convLayer(out, params.conv3, 'valid');\r\n        out = prelu(out, params.prelu3_alpha);\r\n        return out;\r\n    });\r\n}\r\n//# sourceMappingURL=sharedLayers.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { convLayer } from '../common';\r\nimport { sharedLayer } from './sharedLayers';\r\nexport function PNet(x, params) {\r\n    return tf.tidy(function () {\r\n        var out = sharedLayer(x, params, true);\r\n        var conv = convLayer(out, params.conv4_1, 'valid');\r\n        var max = tf.expandDims(tf.max(conv, 3), 3);\r\n        var prob = tf.softmax(tf.sub(conv, max), 3);\r\n        var regions = convLayer(out, params.conv4_2, 'valid');\r\n        return { prob: prob, regions: regions };\r\n    });\r\n}\r\n//# sourceMappingURL=PNet.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { BoundingBox, Point } from '../classes';\r\nimport { nonMaxSuppression } from '../ops';\r\nimport { CELL_SIZE, CELL_STRIDE } from './config';\r\nimport { getSizesForScale } from './getSizesForScale';\r\nimport { MtcnnBox } from './MtcnnBox';\r\nimport { normalize } from './normalize';\r\nimport { PNet } from './PNet';\r\nfunction rescaleAndNormalize(x, scale) {\r\n    return tf.tidy(function () {\r\n        var _a = getSizesForScale(scale, x.shape.slice(1)), height = _a.height, width = _a.width;\r\n        var resized = tf.image.resizeBilinear(x, [height, width]);\r\n        var normalized = normalize(resized);\r\n        return tf.transpose(normalized, [0, 2, 1, 3]);\r\n    });\r\n}\r\nfunction extractBoundingBoxes(scoresTensor, regionsTensor, scale, scoreThreshold) {\r\n    // TODO: fix this!, maybe better to use tf.gather here\r\n    var indices = [];\r\n    var scoresData = scoresTensor.arraySync();\r\n    for (var y = 0; y < scoresTensor.shape[0]; y++) {\r\n        for (var x = 0; x < scoresTensor.shape[1]; x++) {\r\n            if (scoresData[y][x] >= scoreThreshold) {\r\n                indices.push(new Point(x, y));\r\n            }\r\n        }\r\n    }\r\n    var boundingBoxes = indices.map(function (idx) {\r\n        var cell = new BoundingBox(Math.round((idx.y * CELL_STRIDE + 1) / scale), Math.round((idx.x * CELL_STRIDE + 1) / scale), Math.round((idx.y * CELL_STRIDE + CELL_SIZE) / scale), Math.round((idx.x * CELL_STRIDE + CELL_SIZE) / scale));\r\n        var score = scoresData[idx.y][idx.x];\r\n        var regionsData = regionsTensor.arraySync();\r\n        var region = new MtcnnBox(regionsData[idx.y][idx.x][0], regionsData[idx.y][idx.x][1], regionsData[idx.y][idx.x][2], regionsData[idx.y][idx.x][3]);\r\n        return {\r\n            cell: cell,\r\n            score: score,\r\n            region: region\r\n        };\r\n    });\r\n    return boundingBoxes;\r\n}\r\nexport function stage1(imgTensor, scales, scoreThreshold, params, stats) {\r\n    stats.stage1 = [];\r\n    var pnetOutputs = scales.map(function (scale) { return tf.tidy(function () {\r\n        var statsForScale = { scale: scale };\r\n        var resized = rescaleAndNormalize(imgTensor, scale);\r\n        var ts = Date.now();\r\n        var _a = PNet(resized, params), prob = _a.prob, regions = _a.regions;\r\n        statsForScale.pnet = Date.now() - ts;\r\n        var scoresTensor = tf.unstack(tf.unstack(prob, 3)[1])[0];\r\n        var regionsTensor = tf.unstack(regions)[0];\r\n        return {\r\n            scoresTensor: scoresTensor,\r\n            regionsTensor: regionsTensor,\r\n            scale: scale,\r\n            statsForScale: statsForScale\r\n        };\r\n    }); });\r\n    var boxesForScale = pnetOutputs.map(function (_a) {\r\n        var scoresTensor = _a.scoresTensor, regionsTensor = _a.regionsTensor, scale = _a.scale, statsForScale = _a.statsForScale;\r\n        var boundingBoxes = extractBoundingBoxes(scoresTensor, regionsTensor, scale, scoreThreshold);\r\n        scoresTensor.dispose();\r\n        regionsTensor.dispose();\r\n        if (!boundingBoxes.length) {\r\n            stats.stage1.push(statsForScale);\r\n            return [];\r\n        }\r\n        var ts = Date.now();\r\n        var indices = nonMaxSuppression(boundingBoxes.map(function (bbox) { return bbox.cell; }), boundingBoxes.map(function (bbox) { return bbox.score; }), 0.5);\r\n        statsForScale.nms = Date.now() - ts;\r\n        statsForScale.numBoxes = indices.length;\r\n        stats.stage1.push(statsForScale);\r\n        return indices.map(function (boxIdx) { return boundingBoxes[boxIdx]; });\r\n    });\r\n    var allBoxes = boxesForScale.reduce(function (all, boxes) { return all.concat(boxes); }, []);\r\n    var finalBoxes = [];\r\n    var finalScores = [];\r\n    if (allBoxes.length > 0) {\r\n        var ts = Date.now();\r\n        var indices = nonMaxSuppression(allBoxes.map(function (bbox) { return bbox.cell; }), allBoxes.map(function (bbox) { return bbox.score; }), 0.7);\r\n        stats.stage1_nms = Date.now() - ts;\r\n        finalScores = indices.map(function (idx) { return allBoxes[idx].score; });\r\n        finalBoxes = indices\r\n            .map(function (idx) { return allBoxes[idx]; })\r\n            .map(function (_a) {\r\n            var cell = _a.cell, region = _a.region;\r\n            return new BoundingBox(cell.left + (region.left * cell.width), cell.top + (region.top * cell.height), cell.right + (region.right * cell.width), cell.bottom + (region.bottom * cell.height)).toSquare().round();\r\n        });\r\n    }\r\n    return {\r\n        boxes: finalBoxes,\r\n        scores: finalScores\r\n    };\r\n}\r\n//# sourceMappingURL=stage1.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { createCanvas, createCanvasFromMedia, getContext2dOrThrow } from '../dom';\r\nimport { env } from '../env';\r\nimport { normalize } from './normalize';\r\nexport function extractImagePatches(img, boxes, _a) {\r\n    var width = _a.width, height = _a.height;\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var imgCtx, bitmaps, imagePatchesDatas;\r\n        var _this = this;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    imgCtx = getContext2dOrThrow(img);\r\n                    return [4 /*yield*/, Promise.all(boxes.map(function (box) { return __awaiter(_this, void 0, void 0, function () {\r\n                            var _a, y, ey, x, ex, fromX, fromY, imgData;\r\n                            return __generator(this, function (_b) {\r\n                                _a = box.padAtBorders(img.height, img.width), y = _a.y, ey = _a.ey, x = _a.x, ex = _a.ex;\r\n                                fromX = x - 1;\r\n                                fromY = y - 1;\r\n                                imgData = imgCtx.getImageData(fromX, fromY, (ex - fromX), (ey - fromY));\r\n                                return [2 /*return*/, env.isNodejs() ? createCanvasFromMedia(imgData) : createImageBitmap(imgData)];\r\n                            });\r\n                        }); }))];\r\n                case 1:\r\n                    bitmaps = _b.sent();\r\n                    imagePatchesDatas = [];\r\n                    bitmaps.forEach(function (bmp) {\r\n                        var patch = createCanvas({ width: width, height: height });\r\n                        var patchCtx = getContext2dOrThrow(patch);\r\n                        patchCtx.drawImage(bmp, 0, 0, width, height);\r\n                        var data = patchCtx.getImageData(0, 0, width, height).data;\r\n                        var currData = [];\r\n                        // RGBA -> BGR\r\n                        for (var i = 0; i < data.length; i += 4) {\r\n                            currData.push(data[i + 2]);\r\n                            currData.push(data[i + 1]);\r\n                            currData.push(data[i]);\r\n                        }\r\n                        imagePatchesDatas.push(currData);\r\n                    });\r\n                    return [2 /*return*/, imagePatchesDatas.map(function (data) {\r\n                            var t = tf.tidy(function () {\r\n                                var imagePatchTensor = tf.transpose(tf.tensor4d(data, [1, width, height, 3]), [0, 2, 1, 3]).toFloat();\r\n                                return normalize(imagePatchTensor);\r\n                            });\r\n                            return t;\r\n                        })];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=extractImagePatches.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\r\nimport { prelu } from './prelu';\r\nimport { sharedLayer } from './sharedLayers';\r\nexport function RNet(x, params) {\r\n    return tf.tidy(function () {\r\n        var convOut = sharedLayer(x, params);\r\n        var vectorized = tf.reshape(convOut, [convOut.shape[0], params.fc1.weights.shape[0]]);\r\n        var fc1 = fullyConnectedLayer(vectorized, params.fc1);\r\n        var prelu4 = prelu(fc1, params.prelu4_alpha);\r\n        var fc2_1 = fullyConnectedLayer(prelu4, params.fc2_1);\r\n        var max = tf.expandDims(tf.max(fc2_1, 1), 1);\r\n        var prob = tf.softmax(tf.sub(fc2_1, max), 1);\r\n        var regions = fullyConnectedLayer(prelu4, params.fc2_2);\r\n        var scores = tf.unstack(prob, 1)[1];\r\n        return { scores: scores, regions: regions };\r\n    });\r\n}\r\n//# sourceMappingURL=RNet.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { nonMaxSuppression } from '../ops';\r\nimport { extractImagePatches } from './extractImagePatches';\r\nimport { MtcnnBox } from './MtcnnBox';\r\nimport { RNet } from './RNet';\r\nexport function stage2(img, inputBoxes, scoreThreshold, params, stats) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var ts, rnetInputs, rnetOuts, scoresTensor, scores, _a, _b, indices, filteredBoxes, filteredScores, finalBoxes, finalScores, indicesNms, regions_1;\r\n        return __generator(this, function (_c) {\r\n            switch (_c.label) {\r\n                case 0:\r\n                    ts = Date.now();\r\n                    return [4 /*yield*/, extractImagePatches(img, inputBoxes, { width: 24, height: 24 })];\r\n                case 1:\r\n                    rnetInputs = _c.sent();\r\n                    stats.stage2_extractImagePatches = Date.now() - ts;\r\n                    ts = Date.now();\r\n                    rnetOuts = rnetInputs.map(function (rnetInput) {\r\n                        var out = RNet(rnetInput, params);\r\n                        rnetInput.dispose();\r\n                        return out;\r\n                    });\r\n                    stats.stage2_rnet = Date.now() - ts;\r\n                    scoresTensor = rnetOuts.length > 1\r\n                        ? tf.concat(rnetOuts.map(function (out) { return out.scores; }))\r\n                        : rnetOuts[0].scores;\r\n                    _b = (_a = Array).from;\r\n                    return [4 /*yield*/, scoresTensor.data()];\r\n                case 2:\r\n                    scores = _b.apply(_a, [_c.sent()]);\r\n                    scoresTensor.dispose();\r\n                    indices = scores\r\n                        .map(function (score, idx) { return ({ score: score, idx: idx }); })\r\n                        .filter(function (c) { return c.score > scoreThreshold; })\r\n                        .map(function (_a) {\r\n                        var idx = _a.idx;\r\n                        return idx;\r\n                    });\r\n                    filteredBoxes = indices.map(function (idx) { return inputBoxes[idx]; });\r\n                    filteredScores = indices.map(function (idx) { return scores[idx]; });\r\n                    finalBoxes = [];\r\n                    finalScores = [];\r\n                    if (filteredBoxes.length > 0) {\r\n                        ts = Date.now();\r\n                        indicesNms = nonMaxSuppression(filteredBoxes, filteredScores, 0.7);\r\n                        stats.stage2_nms = Date.now() - ts;\r\n                        regions_1 = indicesNms.map(function (idx) {\r\n                            var regionsData = rnetOuts[indices[idx]].regions.arraySync();\r\n                            return new MtcnnBox(regionsData[0][0], regionsData[0][1], regionsData[0][2], regionsData[0][3]);\r\n                        });\r\n                        finalScores = indicesNms.map(function (idx) { return filteredScores[idx]; });\r\n                        finalBoxes = indicesNms.map(function (idx, i) { return filteredBoxes[idx].calibrate(regions_1[i]); });\r\n                    }\r\n                    rnetOuts.forEach(function (t) {\r\n                        t.regions.dispose();\r\n                        t.scores.dispose();\r\n                    });\r\n                    return [2 /*return*/, {\r\n                            boxes: finalBoxes,\r\n                            scores: finalScores\r\n                        }];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=stage2.js.map","import * as tf from '@tensorflow/tfjs-core';\r\nimport { convLayer } from '../common';\r\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\r\nimport { prelu } from './prelu';\r\nimport { sharedLayer } from './sharedLayers';\r\nexport function ONet(x, params) {\r\n    return tf.tidy(function () {\r\n        var out = sharedLayer(x, params);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convLayer(out, params.conv4, 'valid');\r\n        out = prelu(out, params.prelu4_alpha);\r\n        var vectorized = tf.reshape(out, [out.shape[0], params.fc1.weights.shape[0]]);\r\n        var fc1 = fullyConnectedLayer(vectorized, params.fc1);\r\n        var prelu5 = prelu(fc1, params.prelu5_alpha);\r\n        var fc2_1 = fullyConnectedLayer(prelu5, params.fc2_1);\r\n        var max = tf.expandDims(tf.max(fc2_1, 1), 1);\r\n        var prob = tf.softmax(tf.sub(fc2_1, max), 1);\r\n        var regions = fullyConnectedLayer(prelu5, params.fc2_2);\r\n        var points = fullyConnectedLayer(prelu5, params.fc2_3);\r\n        var scores = tf.unstack(prob, 1)[1];\r\n        return { scores: scores, regions: regions, points: points };\r\n    });\r\n}\r\n//# sourceMappingURL=ONet.js.map","import { __awaiter, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { Point } from '../classes';\r\nimport { nonMaxSuppression } from '../ops';\r\nimport { extractImagePatches } from './extractImagePatches';\r\nimport { MtcnnBox } from './MtcnnBox';\r\nimport { ONet } from './ONet';\r\nexport function stage3(img, inputBoxes, scoreThreshold, params, stats) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var ts, onetInputs, onetOuts, scoresTensor, scores, _a, _b, indices, filteredRegions, filteredBoxes, filteredScores, finalBoxes, finalScores, points, indicesNms;\r\n        return __generator(this, function (_c) {\r\n            switch (_c.label) {\r\n                case 0:\r\n                    ts = Date.now();\r\n                    return [4 /*yield*/, extractImagePatches(img, inputBoxes, { width: 48, height: 48 })];\r\n                case 1:\r\n                    onetInputs = _c.sent();\r\n                    stats.stage3_extractImagePatches = Date.now() - ts;\r\n                    ts = Date.now();\r\n                    onetOuts = onetInputs.map(function (onetInput) {\r\n                        var out = ONet(onetInput, params);\r\n                        onetInput.dispose();\r\n                        return out;\r\n                    });\r\n                    stats.stage3_onet = Date.now() - ts;\r\n                    scoresTensor = onetOuts.length > 1\r\n                        ? tf.concat(onetOuts.map(function (out) { return out.scores; }))\r\n                        : onetOuts[0].scores;\r\n                    _b = (_a = Array).from;\r\n                    return [4 /*yield*/, scoresTensor.data()];\r\n                case 2:\r\n                    scores = _b.apply(_a, [_c.sent()]);\r\n                    scoresTensor.dispose();\r\n                    indices = scores\r\n                        .map(function (score, idx) { return ({ score: score, idx: idx }); })\r\n                        .filter(function (c) { return c.score > scoreThreshold; })\r\n                        .map(function (_a) {\r\n                        var idx = _a.idx;\r\n                        return idx;\r\n                    });\r\n                    filteredRegions = indices.map(function (idx) {\r\n                        var regionsData = onetOuts[idx].regions.arraySync();\r\n                        return new MtcnnBox(regionsData[0][0], regionsData[0][1], regionsData[0][2], regionsData[0][3]);\r\n                    });\r\n                    filteredBoxes = indices\r\n                        .map(function (idx, i) { return inputBoxes[idx].calibrate(filteredRegions[i]); });\r\n                    filteredScores = indices.map(function (idx) { return scores[idx]; });\r\n                    finalBoxes = [];\r\n                    finalScores = [];\r\n                    points = [];\r\n                    if (filteredBoxes.length > 0) {\r\n                        ts = Date.now();\r\n                        indicesNms = nonMaxSuppression(filteredBoxes, filteredScores, 0.7, false);\r\n                        stats.stage3_nms = Date.now() - ts;\r\n                        finalBoxes = indicesNms.map(function (idx) { return filteredBoxes[idx]; });\r\n                        finalScores = indicesNms.map(function (idx) { return filteredScores[idx]; });\r\n                        points = indicesNms.map(function (idx, i) {\r\n                            return Array(5).fill(0).map(function (_, ptIdx) {\r\n                                var pointsData = onetOuts[idx].points.arraySync();\r\n                                return new Point(((pointsData[0][ptIdx] * (finalBoxes[i].width + 1)) + finalBoxes[i].left), ((pointsData[0][ptIdx + 5] * (finalBoxes[i].height + 1)) + finalBoxes[i].top));\r\n                            });\r\n                        });\r\n                    }\r\n                    onetOuts.forEach(function (t) {\r\n                        t.regions.dispose();\r\n                        t.scores.dispose();\r\n                        t.points.dispose();\r\n                    });\r\n                    return [2 /*return*/, {\r\n                            boxes: finalBoxes,\r\n                            scores: finalScores,\r\n                            points: points\r\n                        }];\r\n            }\r\n        });\r\n    });\r\n}\r\n//# sourceMappingURL=stage3.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { Point, Rect } from '../classes';\r\nimport { FaceDetection } from '../classes/FaceDetection';\r\nimport { FaceLandmarks5 } from '../classes/FaceLandmarks5';\r\nimport { toNetInput } from '../dom';\r\nimport { extendWithFaceDetection, extendWithFaceLandmarks } from '../factories';\r\nimport { NeuralNetwork } from '../NeuralNetwork';\r\nimport { bgrToRgbTensor } from './bgrToRgbTensor';\r\nimport { CELL_SIZE } from './config';\r\nimport { extractParams } from './extractParams';\r\nimport { extractParamsFromWeigthMap } from './extractParamsFromWeigthMap';\r\nimport { getSizesForScale } from './getSizesForScale';\r\nimport { MtcnnOptions } from './MtcnnOptions';\r\nimport { pyramidDown } from './pyramidDown';\r\nimport { stage1 } from './stage1';\r\nimport { stage2 } from './stage2';\r\nimport { stage3 } from './stage3';\r\nvar Mtcnn = /** @class */ (function (_super) {\r\n    __extends(Mtcnn, _super);\r\n    function Mtcnn() {\r\n        return _super.call(this, 'Mtcnn') || this;\r\n    }\r\n    Mtcnn.prototype.load = function (weightsOrUrl) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                console.warn('mtcnn is deprecated and will be removed soon');\r\n                return [2 /*return*/, _super.prototype.load.call(this, weightsOrUrl)];\r\n            });\r\n        });\r\n    };\r\n    Mtcnn.prototype.loadFromDisk = function (filePath) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                console.warn('mtcnn is deprecated and will be removed soon');\r\n                return [2 /*return*/, _super.prototype.loadFromDisk.call(this, filePath)];\r\n            });\r\n        });\r\n    };\r\n    Mtcnn.prototype.forwardInput = function (input, forwardParams) {\r\n        if (forwardParams === void 0) { forwardParams = {}; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var params, inputCanvas, stats, tsTotal, imgTensor, onReturn, _a, height, width, _b, minFaceSize, scaleFactor, maxNumScales, scoreThresholds, scaleSteps, scales, ts, out1, out2, out3, results;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        params = this.params;\r\n                        if (!params) {\r\n                            throw new Error('Mtcnn - load model before inference');\r\n                        }\r\n                        inputCanvas = input.canvases[0];\r\n                        if (!inputCanvas) {\r\n                            throw new Error('Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.');\r\n                        }\r\n                        stats = {};\r\n                        tsTotal = Date.now();\r\n                        imgTensor = tf.tidy(function () {\r\n                            return bgrToRgbTensor(tf.expandDims(tf.browser.fromPixels(inputCanvas)).toFloat());\r\n                        });\r\n                        onReturn = function (results) {\r\n                            // dispose tensors on return\r\n                            imgTensor.dispose();\r\n                            stats.total = Date.now() - tsTotal;\r\n                            return results;\r\n                        };\r\n                        _a = imgTensor.shape.slice(1), height = _a[0], width = _a[1];\r\n                        _b = new MtcnnOptions(forwardParams), minFaceSize = _b.minFaceSize, scaleFactor = _b.scaleFactor, maxNumScales = _b.maxNumScales, scoreThresholds = _b.scoreThresholds, scaleSteps = _b.scaleSteps;\r\n                        scales = (scaleSteps || pyramidDown(minFaceSize, scaleFactor, [height, width]))\r\n                            .filter(function (scale) {\r\n                            var sizes = getSizesForScale(scale, [height, width]);\r\n                            return Math.min(sizes.width, sizes.height) > CELL_SIZE;\r\n                        })\r\n                            .slice(0, maxNumScales);\r\n                        stats.scales = scales;\r\n                        stats.pyramid = scales.map(function (scale) { return getSizesForScale(scale, [height, width]); });\r\n                        ts = Date.now();\r\n                        return [4 /*yield*/, stage1(imgTensor, scales, scoreThresholds[0], params.pnet, stats)];\r\n                    case 1:\r\n                        out1 = _c.sent();\r\n                        stats.total_stage1 = Date.now() - ts;\r\n                        if (!out1.boxes.length) {\r\n                            return [2 /*return*/, onReturn({ results: [], stats: stats })];\r\n                        }\r\n                        stats.stage2_numInputBoxes = out1.boxes.length;\r\n                        // using the inputCanvas to extract and resize the image patches, since it is faster\r\n                        // than doing this on the gpu\r\n                        ts = Date.now();\r\n                        return [4 /*yield*/, stage2(inputCanvas, out1.boxes, scoreThresholds[1], params.rnet, stats)];\r\n                    case 2:\r\n                        out2 = _c.sent();\r\n                        stats.total_stage2 = Date.now() - ts;\r\n                        if (!out2.boxes.length) {\r\n                            return [2 /*return*/, onReturn({ results: [], stats: stats })];\r\n                        }\r\n                        stats.stage3_numInputBoxes = out2.boxes.length;\r\n                        ts = Date.now();\r\n                        return [4 /*yield*/, stage3(inputCanvas, out2.boxes, scoreThresholds[2], params.onet, stats)];\r\n                    case 3:\r\n                        out3 = _c.sent();\r\n                        stats.total_stage3 = Date.now() - ts;\r\n                        results = out3.boxes.map(function (box, idx) { return extendWithFaceLandmarks(extendWithFaceDetection({}, new FaceDetection(out3.scores[idx], new Rect(box.left / width, box.top / height, box.width / width, box.height / height), {\r\n                            height: height,\r\n                            width: width\r\n                        })), new FaceLandmarks5(out3.points[idx].map(function (pt) { return pt.sub(new Point(box.left, box.top)).div(new Point(box.width, box.height)); }), { width: box.width, height: box.height })); });\r\n                        return [2 /*return*/, onReturn({ results: results, stats: stats })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Mtcnn.prototype.forward = function (input, forwardParams) {\r\n        if (forwardParams === void 0) { forwardParams = {}; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [4 /*yield*/, _a.apply(this, [_b.sent(),\r\n                            forwardParams])];\r\n                    case 2: return [2 /*return*/, (_b.sent()).results];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Mtcnn.prototype.forwardWithStats = function (input, forwardParams) {\r\n        if (forwardParams === void 0) { forwardParams = {}; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this.forwardInput;\r\n                        return [4 /*yield*/, toNetInput(input)];\r\n                    case 1: return [2 /*return*/, _a.apply(this, [_b.sent(),\r\n                            forwardParams])];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Mtcnn.prototype.getDefaultModelName = function () {\r\n        return 'mtcnn_model';\r\n    };\r\n    Mtcnn.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return extractParamsFromWeigthMap(weightMap);\r\n    };\r\n    Mtcnn.prototype.extractParams = function (weights) {\r\n        return extractParams(weights);\r\n    };\r\n    return Mtcnn;\r\n}(NeuralNetwork));\r\nexport { Mtcnn };\r\n//# sourceMappingURL=Mtcnn.js.map","import { Point } from '../classes';\r\nexport var IOU_THRESHOLD = 0.4;\r\nexport var BOX_ANCHORS = [\r\n    new Point(1.603231, 2.094468),\r\n    new Point(6.041143, 7.080126),\r\n    new Point(2.882459, 3.518061),\r\n    new Point(4.266906, 5.178857),\r\n    new Point(9.041765, 10.66308)\r\n];\r\nexport var MEAN_RGB = [117.001, 114.697, 97.404];\r\n//# sourceMappingURL=const.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport { FaceDetection } from '../classes';\r\nimport { TinyYolov2Base } from '../tinyYolov2/TinyYolov2Base';\r\nimport { BOX_ANCHORS, IOU_THRESHOLD, MEAN_RGB } from './const';\r\nvar TinyFaceDetector = /** @class */ (function (_super) {\r\n    __extends(TinyFaceDetector, _super);\r\n    function TinyFaceDetector() {\r\n        var _this = this;\r\n        var config = {\r\n            withSeparableConvs: true,\r\n            iouThreshold: IOU_THRESHOLD,\r\n            classes: ['face'],\r\n            anchors: BOX_ANCHORS,\r\n            meanRgb: MEAN_RGB,\r\n            isFirstLayerConv2d: true,\r\n            filterSizes: [3, 16, 32, 64, 128, 256, 512]\r\n        };\r\n        _this = _super.call(this, config) || this;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TinyFaceDetector.prototype, \"anchors\", {\r\n        get: function () {\r\n            return this.config.anchors;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TinyFaceDetector.prototype.locateFaces = function (input, forwardParams) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var objectDetections;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.detect(input, forwardParams)];\r\n                    case 1:\r\n                        objectDetections = _a.sent();\r\n                        return [2 /*return*/, objectDetections.map(function (det) { return new FaceDetection(det.score, det.relativeBox, { width: det.imageWidth, height: det.imageHeight }); })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TinyFaceDetector.prototype.getDefaultModelName = function () {\r\n        return 'tiny_face_detector_model';\r\n    };\r\n    TinyFaceDetector.prototype.extractParamsFromWeigthMap = function (weightMap) {\r\n        return _super.prototype.extractParamsFromWeigthMap.call(this, weightMap);\r\n    };\r\n    return TinyFaceDetector;\r\n}(TinyYolov2Base));\r\nexport { TinyFaceDetector };\r\n//# sourceMappingURL=TinyFaceDetector.js.map","import { AgeGenderNet } from '../ageGenderNet/AgeGenderNet';\r\nimport { FaceExpressionNet } from '../faceExpressionNet/FaceExpressionNet';\r\nimport { FaceLandmark68Net } from '../faceLandmarkNet/FaceLandmark68Net';\r\nimport { FaceLandmark68TinyNet } from '../faceLandmarkNet/FaceLandmark68TinyNet';\r\nimport { FaceRecognitionNet } from '../faceRecognitionNet/FaceRecognitionNet';\r\nimport { Mtcnn } from '../mtcnn/Mtcnn';\r\nimport { SsdMobilenetv1 } from '../ssdMobilenetv1/SsdMobilenetv1';\r\nimport { TinyFaceDetector } from '../tinyFaceDetector/TinyFaceDetector';\r\nimport { TinyYolov2 } from '../tinyYolov2';\r\nexport var nets = {\r\n    ssdMobilenetv1: new SsdMobilenetv1(),\r\n    tinyFaceDetector: new TinyFaceDetector(),\r\n    tinyYolov2: new TinyYolov2(),\r\n    mtcnn: new Mtcnn(),\r\n    faceLandmark68Net: new FaceLandmark68Net(),\r\n    faceLandmark68TinyNet: new FaceLandmark68TinyNet(),\r\n    faceRecognitionNet: new FaceRecognitionNet(),\r\n    faceExpressionNet: new FaceExpressionNet(),\r\n    ageGenderNet: new AgeGenderNet()\r\n};\r\n/**\r\n * Attempts to detect all faces in an image using SSD Mobilenetv1 Network.\r\n *\r\n * @param input The input image.\r\n * @param options (optional, default: see SsdMobilenetv1Options constructor for default parameters).\r\n * @returns Bounding box of each face with score.\r\n */\r\nexport var ssdMobilenetv1 = function (input, options) {\r\n    return nets.ssdMobilenetv1.locateFaces(input, options);\r\n};\r\n/**\r\n * Attempts to detect all faces in an image using the Tiny Face Detector.\r\n *\r\n * @param input The input image.\r\n * @param options (optional, default: see TinyFaceDetectorOptions constructor for default parameters).\r\n * @returns Bounding box of each face with score.\r\n */\r\nexport var tinyFaceDetector = function (input, options) {\r\n    return nets.tinyFaceDetector.locateFaces(input, options);\r\n};\r\n/**\r\n * Attempts to detect all faces in an image using the Tiny Yolov2 Network.\r\n *\r\n * @param input The input image.\r\n * @param options (optional, default: see TinyYolov2Options constructor for default parameters).\r\n * @returns Bounding box of each face with score.\r\n */\r\nexport var tinyYolov2 = function (input, options) {\r\n    return nets.tinyYolov2.locateFaces(input, options);\r\n};\r\n/**\r\n * Attempts to detect all faces in an image and the 5 point face landmarks\r\n * of each detected face using the MTCNN Network.\r\n *\r\n * @param input The input image.\r\n * @param options (optional, default: see MtcnnOptions constructor for default parameters).\r\n * @returns Bounding box of each face with score and 5 point face landmarks.\r\n */\r\nexport var mtcnn = function (input, options) {\r\n    return nets.mtcnn.forward(input, options);\r\n};\r\n/**\r\n * Detects the 68 point face landmark positions of the face shown in an image.\r\n *\r\n * @param inputs The face image extracted from the bounding box of a face. Can\r\n * also be an array of input images, which will be batch processed.\r\n * @returns 68 point face landmarks or array thereof in case of batch input.\r\n */\r\nexport var detectFaceLandmarks = function (input) {\r\n    return nets.faceLandmark68Net.detectLandmarks(input);\r\n};\r\n/**\r\n * Detects the 68 point face landmark positions of the face shown in an image\r\n * using a tinier version of the 68 point face landmark model, which is slightly\r\n * faster at inference, but also slightly less accurate.\r\n *\r\n * @param inputs The face image extracted from the bounding box of a face. Can\r\n * also be an array of input images, which will be batch processed.\r\n * @returns 68 point face landmarks or array thereof in case of batch input.\r\n */\r\nexport var detectFaceLandmarksTiny = function (input) {\r\n    return nets.faceLandmark68TinyNet.detectLandmarks(input);\r\n};\r\n/**\r\n * Computes a 128 entry vector (face descriptor / face embeddings) from the face shown in an image,\r\n * which uniquely represents the features of that persons face. The computed face descriptor can\r\n * be used to measure the similarity between faces, by computing the euclidean distance of two\r\n * face descriptors.\r\n *\r\n * @param inputs The face image extracted from the aligned bounding box of a face. Can\r\n * also be an array of input images, which will be batch processed.\r\n * @returns Face descriptor with 128 entries or array thereof in case of batch input.\r\n */\r\nexport var computeFaceDescriptor = function (input) {\r\n    return nets.faceRecognitionNet.computeFaceDescriptor(input);\r\n};\r\n/**\r\n * Recognizes the facial expressions from a face image.\r\n *\r\n * @param inputs The face image extracted from the bounding box of a face. Can\r\n * also be an array of input images, which will be batch processed.\r\n * @returns Facial expressions with corresponding probabilities or array thereof in case of batch input.\r\n */\r\nexport var recognizeFaceExpressions = function (input) {\r\n    return nets.faceExpressionNet.predictExpressions(input);\r\n};\r\n/**\r\n * Predicts age and gender from a face image.\r\n *\r\n * @param inputs The face image extracted from the bounding box of a face. Can\r\n * also be an array of input images, which will be batch processed.\r\n * @returns Predictions with age, gender and gender probability or array thereof in case of batch input.\r\n */\r\nexport var predictAgeAndGender = function (input) {\r\n    return nets.ageGenderNet.predictAgeAndGender(input);\r\n};\r\nexport var loadSsdMobilenetv1Model = function (url) { return nets.ssdMobilenetv1.load(url); };\r\nexport var loadTinyFaceDetectorModel = function (url) { return nets.tinyFaceDetector.load(url); };\r\nexport var loadMtcnnModel = function (url) { return nets.mtcnn.load(url); };\r\nexport var loadTinyYolov2Model = function (url) { return nets.tinyYolov2.load(url); };\r\nexport var loadFaceLandmarkModel = function (url) { return nets.faceLandmark68Net.load(url); };\r\nexport var loadFaceLandmarkTinyModel = function (url) { return nets.faceLandmark68TinyNet.load(url); };\r\nexport var loadFaceRecognitionModel = function (url) { return nets.faceRecognitionNet.load(url); };\r\nexport var loadFaceExpressionModel = function (url) { return nets.faceExpressionNet.load(url); };\r\nexport var loadAgeGenderModel = function (url) { return nets.ageGenderNet.load(url); };\r\n// backward compatibility\r\nexport var loadFaceDetectionModel = loadSsdMobilenetv1Model;\r\nexport var locateFaces = ssdMobilenetv1;\r\nexport var detectLandmarks = detectFaceLandmarks;\r\n//# sourceMappingURL=nets.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport { extendWithFaceExpressions } from '../factories/WithFaceExpressions';\r\nimport { ComposableTask } from './ComposableTask';\r\nimport { ComputeAllFaceDescriptorsTask, ComputeSingleFaceDescriptorTask } from './ComputeFaceDescriptorsTasks';\r\nimport { extractAllFacesAndComputeResults, extractSingleFaceAndComputeResult } from './extractFacesAndComputeResults';\r\nimport { nets } from './nets';\r\nimport { PredictAllAgeAndGenderTask, PredictAllAgeAndGenderWithFaceAlignmentTask, PredictSingleAgeAndGenderTask, PredictSingleAgeAndGenderWithFaceAlignmentTask, } from './PredictAgeAndGenderTask';\r\nvar PredictFaceExpressionsTaskBase = /** @class */ (function (_super) {\r\n    __extends(PredictFaceExpressionsTaskBase, _super);\r\n    function PredictFaceExpressionsTaskBase(parentTask, input, extractedFaces) {\r\n        var _this = _super.call(this) || this;\r\n        _this.parentTask = parentTask;\r\n        _this.input = input;\r\n        _this.extractedFaces = extractedFaces;\r\n        return _this;\r\n    }\r\n    return PredictFaceExpressionsTaskBase;\r\n}(ComposableTask));\r\nexport { PredictFaceExpressionsTaskBase };\r\nvar PredictAllFaceExpressionsTask = /** @class */ (function (_super) {\r\n    __extends(PredictAllFaceExpressionsTask, _super);\r\n    function PredictAllFaceExpressionsTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictAllFaceExpressionsTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResults, faceExpressionsByFace;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResults = _a.sent();\r\n                        return [4 /*yield*/, extractAllFacesAndComputeResults(parentResults, this.input, function (faces) { return __awaiter(_this, void 0, void 0, function () {\r\n                                return __generator(this, function (_a) {\r\n                                    switch (_a.label) {\r\n                                        case 0: return [4 /*yield*/, Promise.all(faces.map(function (face) { return nets.faceExpressionNet.predictExpressions(face); }))];\r\n                                        case 1: return [2 /*return*/, _a.sent()];\r\n                                    }\r\n                                });\r\n                            }); }, this.extractedFaces)];\r\n                    case 2:\r\n                        faceExpressionsByFace = _a.sent();\r\n                        return [2 /*return*/, parentResults.map(function (parentResult, i) { return extendWithFaceExpressions(parentResult, faceExpressionsByFace[i]); })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    PredictAllFaceExpressionsTask.prototype.withAgeAndGender = function () {\r\n        return new PredictAllAgeAndGenderTask(this, this.input);\r\n    };\r\n    return PredictAllFaceExpressionsTask;\r\n}(PredictFaceExpressionsTaskBase));\r\nexport { PredictAllFaceExpressionsTask };\r\nvar PredictSingleFaceExpressionsTask = /** @class */ (function (_super) {\r\n    __extends(PredictSingleFaceExpressionsTask, _super);\r\n    function PredictSingleFaceExpressionsTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictSingleFaceExpressionsTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResult, faceExpressions;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResult = _a.sent();\r\n                        if (!parentResult) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        return [4 /*yield*/, extractSingleFaceAndComputeResult(parentResult, this.input, function (face) { return nets.faceExpressionNet.predictExpressions(face); }, this.extractedFaces)];\r\n                    case 2:\r\n                        faceExpressions = _a.sent();\r\n                        return [2 /*return*/, extendWithFaceExpressions(parentResult, faceExpressions)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    PredictSingleFaceExpressionsTask.prototype.withAgeAndGender = function () {\r\n        return new PredictSingleAgeAndGenderTask(this, this.input);\r\n    };\r\n    return PredictSingleFaceExpressionsTask;\r\n}(PredictFaceExpressionsTaskBase));\r\nexport { PredictSingleFaceExpressionsTask };\r\nvar PredictAllFaceExpressionsWithFaceAlignmentTask = /** @class */ (function (_super) {\r\n    __extends(PredictAllFaceExpressionsWithFaceAlignmentTask, _super);\r\n    function PredictAllFaceExpressionsWithFaceAlignmentTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictAllFaceExpressionsWithFaceAlignmentTask.prototype.withAgeAndGender = function () {\r\n        return new PredictAllAgeAndGenderWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    PredictAllFaceExpressionsWithFaceAlignmentTask.prototype.withFaceDescriptors = function () {\r\n        return new ComputeAllFaceDescriptorsTask(this, this.input);\r\n    };\r\n    return PredictAllFaceExpressionsWithFaceAlignmentTask;\r\n}(PredictAllFaceExpressionsTask));\r\nexport { PredictAllFaceExpressionsWithFaceAlignmentTask };\r\nvar PredictSingleFaceExpressionsWithFaceAlignmentTask = /** @class */ (function (_super) {\r\n    __extends(PredictSingleFaceExpressionsWithFaceAlignmentTask, _super);\r\n    function PredictSingleFaceExpressionsWithFaceAlignmentTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictSingleFaceExpressionsWithFaceAlignmentTask.prototype.withAgeAndGender = function () {\r\n        return new PredictSingleAgeAndGenderWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    PredictSingleFaceExpressionsWithFaceAlignmentTask.prototype.withFaceDescriptor = function () {\r\n        return new ComputeSingleFaceDescriptorTask(this, this.input);\r\n    };\r\n    return PredictSingleFaceExpressionsWithFaceAlignmentTask;\r\n}(PredictSingleFaceExpressionsTask));\r\nexport { PredictSingleFaceExpressionsWithFaceAlignmentTask };\r\n//# sourceMappingURL=PredictFaceExpressionsTask.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport { extendWithAge } from '../factories/WithAge';\r\nimport { extendWithGender } from '../factories/WithGender';\r\nimport { ComposableTask } from './ComposableTask';\r\nimport { ComputeAllFaceDescriptorsTask, ComputeSingleFaceDescriptorTask } from './ComputeFaceDescriptorsTasks';\r\nimport { extractAllFacesAndComputeResults, extractSingleFaceAndComputeResult } from './extractFacesAndComputeResults';\r\nimport { nets } from './nets';\r\nimport { PredictAllFaceExpressionsTask, PredictAllFaceExpressionsWithFaceAlignmentTask, PredictSingleFaceExpressionsTask, PredictSingleFaceExpressionsWithFaceAlignmentTask, } from './PredictFaceExpressionsTask';\r\nvar PredictAgeAndGenderTaskBase = /** @class */ (function (_super) {\r\n    __extends(PredictAgeAndGenderTaskBase, _super);\r\n    function PredictAgeAndGenderTaskBase(parentTask, input, extractedFaces) {\r\n        var _this = _super.call(this) || this;\r\n        _this.parentTask = parentTask;\r\n        _this.input = input;\r\n        _this.extractedFaces = extractedFaces;\r\n        return _this;\r\n    }\r\n    return PredictAgeAndGenderTaskBase;\r\n}(ComposableTask));\r\nexport { PredictAgeAndGenderTaskBase };\r\nvar PredictAllAgeAndGenderTask = /** @class */ (function (_super) {\r\n    __extends(PredictAllAgeAndGenderTask, _super);\r\n    function PredictAllAgeAndGenderTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictAllAgeAndGenderTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResults, ageAndGenderByFace;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResults = _a.sent();\r\n                        return [4 /*yield*/, extractAllFacesAndComputeResults(parentResults, this.input, function (faces) { return __awaiter(_this, void 0, void 0, function () {\r\n                                return __generator(this, function (_a) {\r\n                                    switch (_a.label) {\r\n                                        case 0: return [4 /*yield*/, Promise.all(faces.map(function (face) { return nets.ageGenderNet.predictAgeAndGender(face); }))];\r\n                                        case 1: return [2 /*return*/, _a.sent()];\r\n                                    }\r\n                                });\r\n                            }); }, this.extractedFaces)];\r\n                    case 2:\r\n                        ageAndGenderByFace = _a.sent();\r\n                        return [2 /*return*/, parentResults.map(function (parentResult, i) {\r\n                                var _a = ageAndGenderByFace[i], age = _a.age, gender = _a.gender, genderProbability = _a.genderProbability;\r\n                                return extendWithAge(extendWithGender(parentResult, gender, genderProbability), age);\r\n                            })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    PredictAllAgeAndGenderTask.prototype.withFaceExpressions = function () {\r\n        return new PredictAllFaceExpressionsTask(this, this.input);\r\n    };\r\n    return PredictAllAgeAndGenderTask;\r\n}(PredictAgeAndGenderTaskBase));\r\nexport { PredictAllAgeAndGenderTask };\r\nvar PredictSingleAgeAndGenderTask = /** @class */ (function (_super) {\r\n    __extends(PredictSingleAgeAndGenderTask, _super);\r\n    function PredictSingleAgeAndGenderTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictSingleAgeAndGenderTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResult, _a, age, gender, genderProbability;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResult = _b.sent();\r\n                        if (!parentResult) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        return [4 /*yield*/, extractSingleFaceAndComputeResult(parentResult, this.input, function (face) { return nets.ageGenderNet.predictAgeAndGender(face); }, this.extractedFaces)];\r\n                    case 2:\r\n                        _a = _b.sent(), age = _a.age, gender = _a.gender, genderProbability = _a.genderProbability;\r\n                        return [2 /*return*/, extendWithAge(extendWithGender(parentResult, gender, genderProbability), age)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    PredictSingleAgeAndGenderTask.prototype.withFaceExpressions = function () {\r\n        return new PredictSingleFaceExpressionsTask(this, this.input);\r\n    };\r\n    return PredictSingleAgeAndGenderTask;\r\n}(PredictAgeAndGenderTaskBase));\r\nexport { PredictSingleAgeAndGenderTask };\r\nvar PredictAllAgeAndGenderWithFaceAlignmentTask = /** @class */ (function (_super) {\r\n    __extends(PredictAllAgeAndGenderWithFaceAlignmentTask, _super);\r\n    function PredictAllAgeAndGenderWithFaceAlignmentTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictAllAgeAndGenderWithFaceAlignmentTask.prototype.withFaceExpressions = function () {\r\n        return new PredictAllFaceExpressionsWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    PredictAllAgeAndGenderWithFaceAlignmentTask.prototype.withFaceDescriptors = function () {\r\n        return new ComputeAllFaceDescriptorsTask(this, this.input);\r\n    };\r\n    return PredictAllAgeAndGenderWithFaceAlignmentTask;\r\n}(PredictAllAgeAndGenderTask));\r\nexport { PredictAllAgeAndGenderWithFaceAlignmentTask };\r\nvar PredictSingleAgeAndGenderWithFaceAlignmentTask = /** @class */ (function (_super) {\r\n    __extends(PredictSingleAgeAndGenderWithFaceAlignmentTask, _super);\r\n    function PredictSingleAgeAndGenderWithFaceAlignmentTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PredictSingleAgeAndGenderWithFaceAlignmentTask.prototype.withFaceExpressions = function () {\r\n        return new PredictSingleFaceExpressionsWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    PredictSingleAgeAndGenderWithFaceAlignmentTask.prototype.withFaceDescriptor = function () {\r\n        return new ComputeSingleFaceDescriptorTask(this, this.input);\r\n    };\r\n    return PredictSingleAgeAndGenderWithFaceAlignmentTask;\r\n}(PredictSingleAgeAndGenderTask));\r\nexport { PredictSingleAgeAndGenderWithFaceAlignmentTask };\r\n//# sourceMappingURL=PredictAgeAndGenderTask.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport { extendWithFaceDescriptor } from '../factories/WithFaceDescriptor';\r\nimport { ComposableTask } from './ComposableTask';\r\nimport { extractAllFacesAndComputeResults, extractSingleFaceAndComputeResult } from './extractFacesAndComputeResults';\r\nimport { nets } from './nets';\r\nimport { PredictAllAgeAndGenderWithFaceAlignmentTask, PredictSingleAgeAndGenderWithFaceAlignmentTask, } from './PredictAgeAndGenderTask';\r\nimport { PredictAllFaceExpressionsWithFaceAlignmentTask, PredictSingleFaceExpressionsWithFaceAlignmentTask, } from './PredictFaceExpressionsTask';\r\nvar ComputeFaceDescriptorsTaskBase = /** @class */ (function (_super) {\r\n    __extends(ComputeFaceDescriptorsTaskBase, _super);\r\n    function ComputeFaceDescriptorsTaskBase(parentTask, input) {\r\n        var _this = _super.call(this) || this;\r\n        _this.parentTask = parentTask;\r\n        _this.input = input;\r\n        return _this;\r\n    }\r\n    return ComputeFaceDescriptorsTaskBase;\r\n}(ComposableTask));\r\nexport { ComputeFaceDescriptorsTaskBase };\r\nvar ComputeAllFaceDescriptorsTask = /** @class */ (function (_super) {\r\n    __extends(ComputeAllFaceDescriptorsTask, _super);\r\n    function ComputeAllFaceDescriptorsTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ComputeAllFaceDescriptorsTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResults, descriptors;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResults = _a.sent();\r\n                        return [4 /*yield*/, extractAllFacesAndComputeResults(parentResults, this.input, function (faces) { return Promise.all(faces.map(function (face) {\r\n                                return nets.faceRecognitionNet.computeFaceDescriptor(face);\r\n                            })); }, null, function (parentResult) { return parentResult.landmarks.align(null, { useDlibAlignment: true }); })];\r\n                    case 2:\r\n                        descriptors = _a.sent();\r\n                        return [2 /*return*/, descriptors.map(function (descriptor, i) { return extendWithFaceDescriptor(parentResults[i], descriptor); })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ComputeAllFaceDescriptorsTask.prototype.withFaceExpressions = function () {\r\n        return new PredictAllFaceExpressionsWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    ComputeAllFaceDescriptorsTask.prototype.withAgeAndGender = function () {\r\n        return new PredictAllAgeAndGenderWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    return ComputeAllFaceDescriptorsTask;\r\n}(ComputeFaceDescriptorsTaskBase));\r\nexport { ComputeAllFaceDescriptorsTask };\r\nvar ComputeSingleFaceDescriptorTask = /** @class */ (function (_super) {\r\n    __extends(ComputeSingleFaceDescriptorTask, _super);\r\n    function ComputeSingleFaceDescriptorTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ComputeSingleFaceDescriptorTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResult, descriptor;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResult = _a.sent();\r\n                        if (!parentResult) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        return [4 /*yield*/, extractSingleFaceAndComputeResult(parentResult, this.input, function (face) { return nets.faceRecognitionNet.computeFaceDescriptor(face); }, null, function (parentResult) { return parentResult.landmarks.align(null, { useDlibAlignment: true }); })];\r\n                    case 2:\r\n                        descriptor = _a.sent();\r\n                        return [2 /*return*/, extendWithFaceDescriptor(parentResult, descriptor)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ComputeSingleFaceDescriptorTask.prototype.withFaceExpressions = function () {\r\n        return new PredictSingleFaceExpressionsWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    ComputeSingleFaceDescriptorTask.prototype.withAgeAndGender = function () {\r\n        return new PredictSingleAgeAndGenderWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    return ComputeSingleFaceDescriptorTask;\r\n}(ComputeFaceDescriptorsTaskBase));\r\nexport { ComputeSingleFaceDescriptorTask };\r\n//# sourceMappingURL=ComputeFaceDescriptorsTasks.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport { extractFaces, extractFaceTensors } from '../dom';\r\nimport { extendWithFaceLandmarks } from '../factories/WithFaceLandmarks';\r\nimport { ComposableTask } from './ComposableTask';\r\nimport { ComputeAllFaceDescriptorsTask, ComputeSingleFaceDescriptorTask } from './ComputeFaceDescriptorsTasks';\r\nimport { nets } from './nets';\r\nimport { PredictAllAgeAndGenderWithFaceAlignmentTask, PredictSingleAgeAndGenderWithFaceAlignmentTask, } from './PredictAgeAndGenderTask';\r\nimport { PredictAllFaceExpressionsWithFaceAlignmentTask, PredictSingleFaceExpressionsWithFaceAlignmentTask, } from './PredictFaceExpressionsTask';\r\nvar DetectFaceLandmarksTaskBase = /** @class */ (function (_super) {\r\n    __extends(DetectFaceLandmarksTaskBase, _super);\r\n    function DetectFaceLandmarksTaskBase(parentTask, input, useTinyLandmarkNet) {\r\n        var _this = _super.call(this) || this;\r\n        _this.parentTask = parentTask;\r\n        _this.input = input;\r\n        _this.useTinyLandmarkNet = useTinyLandmarkNet;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(DetectFaceLandmarksTaskBase.prototype, \"landmarkNet\", {\r\n        get: function () {\r\n            return this.useTinyLandmarkNet\r\n                ? nets.faceLandmark68TinyNet\r\n                : nets.faceLandmark68Net;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DetectFaceLandmarksTaskBase;\r\n}(ComposableTask));\r\nexport { DetectFaceLandmarksTaskBase };\r\nvar DetectAllFaceLandmarksTask = /** @class */ (function (_super) {\r\n    __extends(DetectAllFaceLandmarksTask, _super);\r\n    function DetectAllFaceLandmarksTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DetectAllFaceLandmarksTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResults, detections, faces, _a, faceLandmarksByFace;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResults = _b.sent();\r\n                        detections = parentResults.map(function (res) { return res.detection; });\r\n                        if (!(this.input instanceof tf.Tensor)) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, extractFaceTensors(this.input, detections)];\r\n                    case 2:\r\n                        _a = _b.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 3: return [4 /*yield*/, extractFaces(this.input, detections)];\r\n                    case 4:\r\n                        _a = _b.sent();\r\n                        _b.label = 5;\r\n                    case 5:\r\n                        faces = _a;\r\n                        return [4 /*yield*/, Promise.all(faces.map(function (face) { return _this.landmarkNet.detectLandmarks(face); }))];\r\n                    case 6:\r\n                        faceLandmarksByFace = _b.sent();\r\n                        faces.forEach(function (f) { return f instanceof tf.Tensor && f.dispose(); });\r\n                        return [2 /*return*/, parentResults.map(function (parentResult, i) {\r\n                                return extendWithFaceLandmarks(parentResult, faceLandmarksByFace[i]);\r\n                            })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DetectAllFaceLandmarksTask.prototype.withFaceExpressions = function () {\r\n        return new PredictAllFaceExpressionsWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    DetectAllFaceLandmarksTask.prototype.withAgeAndGender = function () {\r\n        return new PredictAllAgeAndGenderWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    DetectAllFaceLandmarksTask.prototype.withFaceDescriptors = function () {\r\n        return new ComputeAllFaceDescriptorsTask(this, this.input);\r\n    };\r\n    return DetectAllFaceLandmarksTask;\r\n}(DetectFaceLandmarksTaskBase));\r\nexport { DetectAllFaceLandmarksTask };\r\nvar DetectSingleFaceLandmarksTask = /** @class */ (function (_super) {\r\n    __extends(DetectSingleFaceLandmarksTask, _super);\r\n    function DetectSingleFaceLandmarksTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DetectSingleFaceLandmarksTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parentResult, detection, faces, _a, landmarks;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.parentTask];\r\n                    case 1:\r\n                        parentResult = _b.sent();\r\n                        if (!parentResult) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        detection = parentResult.detection;\r\n                        if (!(this.input instanceof tf.Tensor)) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, extractFaceTensors(this.input, [detection])];\r\n                    case 2:\r\n                        _a = _b.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 3: return [4 /*yield*/, extractFaces(this.input, [detection])];\r\n                    case 4:\r\n                        _a = _b.sent();\r\n                        _b.label = 5;\r\n                    case 5:\r\n                        faces = _a;\r\n                        return [4 /*yield*/, this.landmarkNet.detectLandmarks(faces[0])];\r\n                    case 6:\r\n                        landmarks = _b.sent();\r\n                        faces.forEach(function (f) { return f instanceof tf.Tensor && f.dispose(); });\r\n                        return [2 /*return*/, extendWithFaceLandmarks(parentResult, landmarks)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DetectSingleFaceLandmarksTask.prototype.withFaceExpressions = function () {\r\n        return new PredictSingleFaceExpressionsWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    DetectSingleFaceLandmarksTask.prototype.withAgeAndGender = function () {\r\n        return new PredictSingleAgeAndGenderWithFaceAlignmentTask(this, this.input);\r\n    };\r\n    DetectSingleFaceLandmarksTask.prototype.withFaceDescriptor = function () {\r\n        return new ComputeSingleFaceDescriptorTask(this, this.input);\r\n    };\r\n    return DetectSingleFaceLandmarksTask;\r\n}(DetectFaceLandmarksTaskBase));\r\nexport { DetectSingleFaceLandmarksTask };\r\n//# sourceMappingURL=DetectFaceLandmarksTasks.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\r\nimport { extendWithFaceDetection } from '../factories/WithFaceDetection';\r\nimport { MtcnnOptions } from '../mtcnn/MtcnnOptions';\r\nimport { SsdMobilenetv1Options } from '../ssdMobilenetv1/SsdMobilenetv1Options';\r\nimport { TinyFaceDetectorOptions } from '../tinyFaceDetector/TinyFaceDetectorOptions';\r\nimport { TinyYolov2Options } from '../tinyYolov2';\r\nimport { ComposableTask } from './ComposableTask';\r\nimport { DetectAllFaceLandmarksTask, DetectSingleFaceLandmarksTask } from './DetectFaceLandmarksTasks';\r\nimport { nets } from './nets';\r\nimport { PredictAllAgeAndGenderTask, PredictSingleAgeAndGenderTask } from './PredictAgeAndGenderTask';\r\nimport { PredictAllFaceExpressionsTask, PredictSingleFaceExpressionsTask } from './PredictFaceExpressionsTask';\r\nvar DetectFacesTaskBase = /** @class */ (function (_super) {\r\n    __extends(DetectFacesTaskBase, _super);\r\n    function DetectFacesTaskBase(input, options) {\r\n        if (options === void 0) { options = new SsdMobilenetv1Options(); }\r\n        var _this = _super.call(this) || this;\r\n        _this.input = input;\r\n        _this.options = options;\r\n        return _this;\r\n    }\r\n    return DetectFacesTaskBase;\r\n}(ComposableTask));\r\nexport { DetectFacesTaskBase };\r\nvar DetectAllFacesTask = /** @class */ (function (_super) {\r\n    __extends(DetectAllFacesTask, _super);\r\n    function DetectAllFacesTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DetectAllFacesTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, input, options, faceDetectionFunction;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = this, input = _a.input, options = _a.options;\r\n                        if (!(options instanceof MtcnnOptions)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, nets.mtcnn.forward(input, options)];\r\n                    case 1: return [2 /*return*/, (_b.sent())\r\n                            .map(function (result) { return result.detection; })];\r\n                    case 2:\r\n                        faceDetectionFunction = options instanceof TinyFaceDetectorOptions\r\n                            ? function (input) { return nets.tinyFaceDetector.locateFaces(input, options); }\r\n                            : (options instanceof SsdMobilenetv1Options\r\n                                ? function (input) { return nets.ssdMobilenetv1.locateFaces(input, options); }\r\n                                : (options instanceof TinyYolov2Options\r\n                                    ? function (input) { return nets.tinyYolov2.locateFaces(input, options); }\r\n                                    : null));\r\n                        if (!faceDetectionFunction) {\r\n                            throw new Error('detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options');\r\n                        }\r\n                        return [2 /*return*/, faceDetectionFunction(input)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DetectAllFacesTask.prototype.runAndExtendWithFaceDetections = function () {\r\n        var _this = this;\r\n        return new Promise(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            var detections;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.run()];\r\n                    case 1:\r\n                        detections = _a.sent();\r\n                        return [2 /*return*/, res(detections.map(function (detection) { return extendWithFaceDetection({}, detection); }))];\r\n                }\r\n            });\r\n        }); });\r\n    };\r\n    DetectAllFacesTask.prototype.withFaceLandmarks = function (useTinyLandmarkNet) {\r\n        if (useTinyLandmarkNet === void 0) { useTinyLandmarkNet = false; }\r\n        return new DetectAllFaceLandmarksTask(this.runAndExtendWithFaceDetections(), this.input, useTinyLandmarkNet);\r\n    };\r\n    DetectAllFacesTask.prototype.withFaceExpressions = function () {\r\n        return new PredictAllFaceExpressionsTask(this.runAndExtendWithFaceDetections(), this.input);\r\n    };\r\n    DetectAllFacesTask.prototype.withAgeAndGender = function () {\r\n        return new PredictAllAgeAndGenderTask(this.runAndExtendWithFaceDetections(), this.input);\r\n    };\r\n    return DetectAllFacesTask;\r\n}(DetectFacesTaskBase));\r\nexport { DetectAllFacesTask };\r\nvar DetectSingleFaceTask = /** @class */ (function (_super) {\r\n    __extends(DetectSingleFaceTask, _super);\r\n    function DetectSingleFaceTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DetectSingleFaceTask.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var faceDetections, faceDetectionWithHighestScore;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, new DetectAllFacesTask(this.input, this.options)];\r\n                    case 1:\r\n                        faceDetections = _a.sent();\r\n                        faceDetectionWithHighestScore = faceDetections[0];\r\n                        faceDetections.forEach(function (faceDetection) {\r\n                            if (faceDetection.score > faceDetectionWithHighestScore.score) {\r\n                                faceDetectionWithHighestScore = faceDetection;\r\n                            }\r\n                        });\r\n                        return [2 /*return*/, faceDetectionWithHighestScore];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DetectSingleFaceTask.prototype.runAndExtendWithFaceDetection = function () {\r\n        var _this = this;\r\n        return new Promise(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            var detection;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.run()];\r\n                    case 1:\r\n                        detection = _a.sent();\r\n                        return [2 /*return*/, res(detection ? extendWithFaceDetection({}, detection) : undefined)];\r\n                }\r\n            });\r\n        }); });\r\n    };\r\n    DetectSingleFaceTask.prototype.withFaceLandmarks = function (useTinyLandmarkNet) {\r\n        if (useTinyLandmarkNet === void 0) { useTinyLandmarkNet = false; }\r\n        return new DetectSingleFaceLandmarksTask(this.runAndExtendWithFaceDetection(), this.input, useTinyLandmarkNet);\r\n    };\r\n    DetectSingleFaceTask.prototype.withFaceExpressions = function () {\r\n        return new PredictSingleFaceExpressionsTask(this.runAndExtendWithFaceDetection(), this.input);\r\n    };\r\n    DetectSingleFaceTask.prototype.withAgeAndGender = function () {\r\n        return new PredictSingleAgeAndGenderTask(this.runAndExtendWithFaceDetection(), this.input);\r\n    };\r\n    return DetectSingleFaceTask;\r\n}(DetectFacesTaskBase));\r\nexport { DetectSingleFaceTask };\r\n//# sourceMappingURL=DetectFacesTasks.js.map","import { SsdMobilenetv1Options } from '../ssdMobilenetv1/SsdMobilenetv1Options';\r\nimport { DetectAllFacesTask, DetectSingleFaceTask } from './DetectFacesTasks';\r\nexport function detectSingleFace(input, options) {\r\n    if (options === void 0) { options = new SsdMobilenetv1Options(); }\r\n    return new DetectSingleFaceTask(input, options);\r\n}\r\nexport function detectAllFaces(input, options) {\r\n    if (options === void 0) { options = new SsdMobilenetv1Options(); }\r\n    return new DetectAllFacesTask(input, options);\r\n}\r\n//# sourceMappingURL=detectFaces.js.map","export function euclideanDistance(arr1, arr2) {\r\n    if (arr1.length !== arr2.length)\r\n        throw new Error('euclideanDistance: arr1.length !== arr2.length');\r\n    var desc1 = Array.from(arr1);\r\n    var desc2 = Array.from(arr2);\r\n    return Math.sqrt(desc1\r\n        .map(function (val, i) { return val - desc2[i]; })\r\n        .reduce(function (res, diff) { return res + Math.pow(diff, 2); }, 0));\r\n}\r\n//# sourceMappingURL=euclideanDistance.js.map","import { FaceMatch } from '../classes/FaceMatch';\r\nimport { LabeledFaceDescriptors } from '../classes/LabeledFaceDescriptors';\r\nimport { euclideanDistance } from '../euclideanDistance';\r\nvar FaceMatcher = /** @class */ (function () {\r\n    function FaceMatcher(inputs, distanceThreshold) {\r\n        if (distanceThreshold === void 0) { distanceThreshold = 0.6; }\r\n        this._distanceThreshold = distanceThreshold;\r\n        var inputArray = Array.isArray(inputs) ? inputs : [inputs];\r\n        if (!inputArray.length) {\r\n            throw new Error(\"FaceRecognizer.constructor - expected atleast one input\");\r\n        }\r\n        var count = 1;\r\n        var createUniqueLabel = function () { return \"person \" + count++; };\r\n        this._labeledDescriptors = inputArray.map(function (desc) {\r\n            if (desc instanceof LabeledFaceDescriptors) {\r\n                return desc;\r\n            }\r\n            if (desc instanceof Float32Array) {\r\n                return new LabeledFaceDescriptors(createUniqueLabel(), [desc]);\r\n            }\r\n            if (desc.descriptor && desc.descriptor instanceof Float32Array) {\r\n                return new LabeledFaceDescriptors(createUniqueLabel(), [desc.descriptor]);\r\n            }\r\n            throw new Error(\"FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>\");\r\n        });\r\n    }\r\n    Object.defineProperty(FaceMatcher.prototype, \"labeledDescriptors\", {\r\n        get: function () { return this._labeledDescriptors; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FaceMatcher.prototype, \"distanceThreshold\", {\r\n        get: function () { return this._distanceThreshold; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FaceMatcher.prototype.computeMeanDistance = function (queryDescriptor, descriptors) {\r\n        return descriptors\r\n            .map(function (d) { return euclideanDistance(d, queryDescriptor); })\r\n            .reduce(function (d1, d2) { return d1 + d2; }, 0)\r\n            / (descriptors.length || 1);\r\n    };\r\n    FaceMatcher.prototype.matchDescriptor = function (queryDescriptor) {\r\n        var _this = this;\r\n        return this.labeledDescriptors\r\n            .map(function (_a) {\r\n            var descriptors = _a.descriptors, label = _a.label;\r\n            return new FaceMatch(label, _this.computeMeanDistance(queryDescriptor, descriptors));\r\n        })\r\n            .reduce(function (best, curr) { return best.distance < curr.distance ? best : curr; });\r\n    };\r\n    FaceMatcher.prototype.findBestMatch = function (queryDescriptor) {\r\n        var bestMatch = this.matchDescriptor(queryDescriptor);\r\n        return bestMatch.distance < this.distanceThreshold\r\n            ? bestMatch\r\n            : new FaceMatch('unknown', bestMatch.distance);\r\n    };\r\n    FaceMatcher.prototype.toJSON = function () {\r\n        return {\r\n            distanceThreshold: this.distanceThreshold,\r\n            labeledDescriptors: this.labeledDescriptors.map(function (ld) { return ld.toJSON(); })\r\n        };\r\n    };\r\n    FaceMatcher.fromJSON = function (json) {\r\n        var labeledDescriptors = json.labeledDescriptors\r\n            .map(function (ld) { return LabeledFaceDescriptors.fromJSON(ld); });\r\n        return new FaceMatcher(labeledDescriptors, json.distanceThreshold);\r\n    };\r\n    return FaceMatcher;\r\n}());\r\nexport { FaceMatcher };\r\n//# sourceMappingURL=FaceMatcher.js.map","'use strict';\n\nimport { Point } from \"./types\";\n\n/**\n * @category ID capture\n * @internal\n */\nexport class LandmarkStandardization {\n\n    private eyeCenter: Point\n    eyeVec: Point\n    eyeDist: number\n    right: Point\n    down: Point\n\n    constructor(leftEye: Point, rightEye: Point) {\n        this.eyeCenter = new Point()\n        this.eyeCenter.x = 0.5 * (leftEye.x + rightEye.x)\n        this.eyeCenter.y = 0.5 * (leftEye.y + rightEye.y)\n        this.eyeVec =  new Point(rightEye.x - leftEye.x, rightEye.y - leftEye.y)\n        this.eyeDist = Math.sqrt(this.dot(this.eyeVec, this.eyeVec))\n        this.right = new Point(this.eyeVec.x/this.eyeDist, this.eyeVec.y/this.eyeDist)\n        this.down = this.rotateClockwise90(this.right)\n    }\n\n    private dot(a: Point, b: Point): number {\n        return a.x * b.x + a.y * b.y\n    }\n\n    private rotateClockwise90(p: Point): Point {\n        return new Point(0-p.y, p.x)\n    }\n    \n    standardize(pt: Point): Point {\n        const p = new Point(pt.x, pt.y)\n        p.x -= this.eyeCenter.x\n        p.y -= this.eyeCenter.y\n        p.x /= this.eyeDist\n        p.y /= this.eyeDist\n        return new Point(this.dot(p, this.right), this.dot(p, this.down))\n    }\n}","'use strict';\n\nimport { LandmarkStandardization } from \"./landmarkStandardization\"\nimport { Point } from \"./types\";\nimport { Angle } from \"./types\";\n\nfunction getMidPointBetweenPoints(p1: Point, p2: Point): Point {\n    return new Point(p1.x + (p2.x - p1.x) / 2, p1.y + (p2.y - p1.y) /2)\n}\n\nfunction getLeftEye(landmarks: Point[]): Point {\n    if (landmarks.length != 68) {\n        throw new Error()\n    }\n    return getMidPointBetweenPoints(landmarks[37], landmarks[40])\n}\n\nfunction getRightEye(landmarks: Point[]): Point {\n    if (landmarks.length != 68) {\n        throw new Error()\n    }\n    return getMidPointBetweenPoints(landmarks[43], landmarks[46])\n}\n\n/**\n * Estimate an angle of a face from its landmarks\n * @param landmarks Face landmarks\n * @param estimateFn Estimation function\n * @returns Angle\n * @category Face detection\n * @internal\n */\nexport function estimateFaceAngle(landmarks: Point[], estimateFn: (landmarks: Point[]) => Angle): Angle {\n    const ls: LandmarkStandardization = new LandmarkStandardization(getLeftEye(landmarks), getRightEye(landmarks))\n    const pts: Point[] = landmarks.map(pt => ls.standardize(pt))\n    const angle: Angle = estimateFn(pts)\n    angle.roll = Math.atan2(ls.eyeVec.y, ls.eyeVec.x) * Math.PI / 180\n    return angle\n}","'use strict';\n\nimport { clamp } from \"./utils\"\nimport { Point } from \"./types\";\nimport { Angle } from \"./types\";\n\n/**\n * @param landmarks Face landmarks\n * @returns Angle\n * @category Face detection\n * @internal\n */\nexport function estimateFaceAngle(landmarks: Point[]): Angle {\n    if (landmarks.length != 68) {\n        throw new Error(\"Face angle calculation requires 68 face landmarks\")\n    }\n    const noseTip: Point = new Point(landmarks[30].x, landmarks[30].y)\n    noseTip.y -= 0.3125\n    const dest: Angle = new Angle()\n    dest.yaw = clamp(45 * noseTip.x, 90) * 2\n    dest.pitch = clamp(45 * (noseTip.y - 0.3), 90) * 2\n    return dest\n}","'use strict';\n\nimport { Face } from \"./types\";\nimport { FaceCapture } from \"./types\";\nimport * as faceapi from \"face-api.js/build/es6\"\nimport { estimateFaceAngle } from \"./faceAngle\"\nimport { estimateFaceAngle as estimateFaceAngleNoseTip } from \"./faceAngleNoseTip\"\nimport { canvasFromImageSource, sizeOfImageSource, blobFromImageSource } from \"./utils\"\nimport { Rect } from \"./types\";\nimport { Point } from \"./types\";\nimport { Angle } from \"./types\";\nimport { ImageSource, Size } from \"./types\"\n\n/**\n * @category Face detection\n */\nexport type FaceDetectionSource = {\n    element: ImageSource\n    mirrored: boolean\n}\n/**\n * @category Face detection\n */\nexport interface FaceDetector {\n    detectFace(source: FaceDetectionSource): Promise<FaceCapture>\n}\n/**\n * @category Face detection\n */\nexport interface FaceDetectorFactory {\n    createFaceDetector(): Promise<FaceDetector>\n}\n\ninterface FaceApiFace {\n    landmarks: {\n        positions: {x:number,y:number}[]\n        getLeftEye(): Point[]\n        getRightEye(): Point[]\n    }\n}\n\n/**\n * @category Face detection\n */\nexport class VerIDFaceDetector implements FaceDetector {\n\n    detectFace = async (source: FaceDetectionSource): Promise<FaceCapture> => {\n        const src = source.element instanceof HTMLVideoElement || source.element instanceof HTMLImageElement || source.element instanceof HTMLCanvasElement ? source.element : await canvasFromImageSource(source.element)\n        const faceApiFace = await faceapi.detectSingleFace(src, new faceapi.TinyFaceDetectorOptions({\"inputSize\": 128})).withFaceLandmarks()\n        let face: Face|null\n        if (faceApiFace) {\n            face = this.faceApiFaceToVerIDFace(faceApiFace, (await sizeOfImageSource(source.element)).width, source.mirrored)\n        } else {\n            face = null\n        }\n        const image: Blob = await blobFromImageSource(source.element)\n        return FaceCapture.create(image, face)\n    }\n\n    private calculateFaceAngle(face: FaceApiFace): Angle {\n        const landmarks: Point[] = face.landmarks.positions.map((pt: {x:number,y:number}) => new Point(pt.x, pt.y))\n        return estimateFaceAngle(landmarks, estimateFaceAngleNoseTip)\n    }\n\n    private faceApiFaceToVerIDFace(face: FaceApiFace, imageWidth: number, mirrorOutput = false): Face {\n        const angle: Angle = this.calculateFaceAngle(face)\n        const leftEye: Point[] = face.landmarks.getLeftEye()\n        const rightEye: Point[] = face.landmarks.getRightEye()\n        const leftEyeCentre: Point = {\n            \"x\": leftEye[0].x + (leftEye[3].x - leftEye[0].x) / 2,\n            \"y\": leftEye[0].y + (leftEye[3].y - leftEye[0].y) / 2\n        }\n        const rightEyeCentre: Point = {\n            \"x\": rightEye[0].x + (rightEye[3].x - rightEye[0].x) / 2,\n            \"y\": rightEye[0].y + (rightEye[3].y - rightEye[0].y) / 2\n        }\n        const distanceBetweenEyes: number = Math.sqrt(Math.pow(rightEyeCentre.x - leftEyeCentre.x, 2) + Math.pow(rightEyeCentre.y - leftEyeCentre.y, 2))\n        const ovalCentre: Point = {\n            \"x\": leftEyeCentre.x + (rightEyeCentre.x - leftEyeCentre.x) / 2,\n            \"y\": leftEyeCentre.y + (rightEyeCentre.y - leftEyeCentre.y) / 2\n        }\n        const ovalSize: Size = {\n            \"width\": distanceBetweenEyes * 3,\n            \"height\": 0\n        }\n        ovalSize.height = ovalSize.width / 4 * 5\n        if (mirrorOutput) {\n            ovalCentre.x = imageWidth - ovalCentre.x\n            angle.yaw = 0-angle.yaw\n        }\n        ovalCentre.y += ovalSize.height * 0.04\n        const veridFace: Face = new Face(new Rect(ovalCentre.x - ovalSize.width / 2, ovalCentre.y - ovalSize.height / 2, ovalSize.width, ovalSize.height), angle)\n        if (mirrorOutput) {\n            veridFace.bounds = veridFace.bounds.mirrored(imageWidth)\n        }\n        return veridFace\n    }\n}\n\n/**\n * @category Face detection testing\n */\nexport class VerIDFaceDetectorFactory implements FaceDetectorFactory {\n\n    createFaceDetector = async(): Promise<FaceDetector> => {\n        await Promise.all([\n            faceapi.nets.tinyFaceDetector.loadFromUri(\"/node_modules/@appliedrecognition/ver-id-browser/models\"),\n            faceapi.nets.faceLandmark68Net.loadFromUri(\"/node_modules/@appliedrecognition/ver-id-browser/models\")\n        ])\n        return new VerIDFaceDetector()\n    }\n}","'use strict';\n/**\n * Ver-ID face detection\n * @packageDocumentation\n */\n\nimport { Observable, throwError, Subscription, Subscriber } from \"rxjs\"\nimport { map, filter, take, tap, mergeMap, toArray } from \"rxjs/operators\"\nimport { emitRxEvent } from \"./utils\"\nimport { FaceRecognition } from \"./faceRecognition\"\nimport { FaceRequirementListener, FaceAlignmentStatus, FaceCaptureCallback, ImageSource } from \"./types\"\nimport { LivenessDetectionSessionEventType } from \"./faceDetectionUI\"\nimport { LivenessDetectionSession } from \"./livenessDetectionSession\"\nimport { FaceDetector, FaceDetectorFactory, VerIDFaceDetectorFactory } from \"./faceDetector\"\nimport { LivenessDetectionSessionSettings } from \"./livenessDetectionSession\";\nimport { FaceCapture } from \"./types\";\nimport { Face } from \"./types\";\n\n/**\n * Face detection\n * @category Face detection\n */\nexport class FaceDetection {\n    /**\n     * Base URL of the server that accepts the face detection calls\n     */\n    public readonly serviceURL: string\n    private readonly faceRecognition: FaceRecognition\n    private readonly createFaceDetectorPromise: Promise<FaceDetector>\n\n    /**\n     * Constructor\n     * @param serviceURL Base URL of the server that accepts the face detection and comparison calls\n     */\n    public constructor(serviceURL?: string, faceDetectorFactory?: FaceDetectorFactory) {\n        this.serviceURL = serviceURL ? serviceURL.replace(/[\\/\\s]+$/, \"\") : \"\"\n        this.faceRecognition = new FaceRecognition(this.serviceURL)\n        if (!faceDetectorFactory) {\n            faceDetectorFactory = new VerIDFaceDetectorFactory()\n        }\n        this.createFaceDetectorPromise = faceDetectorFactory.createFaceDetector()\n    }\n\n    public async detectFaceInImage(image: ImageSource): Promise<Face> {\n        const faceDetector: FaceDetector = await this.createFaceDetectorPromise\n        const faceCapture = await faceDetector.detectFace({element: image, mirrored: false})\n        if (faceCapture.face) {\n            return faceCapture.face\n        } else {\n            throw new Error(\"Face not found\")\n        }\n    }\n\n    /**\n     * @returns `true` if liveness detection is supported by the client\n     */\n    public static isLivenessDetectionSupported(): boolean {\n        return \"Promise\" in window && \"fetch\" in window\n    }\n\n    /**\n     * Start a liveness detection session. Subscribe to the returned Observable to start the session and to receive results.\n     * @param session Session to use for for liveness detection\n     * @returns Observable\n     */\n    public captureFaces(session: LivenessDetectionSession): Observable<LivenessDetectionSessionResult> {\n        try {\n            this.checkLivenessSessionAvailability()\n        } catch (error) {\n            session.close()\n            return throwError(() => error)\n        }\n        if (session.isClosed) {\n            return throwError(() => new Error(\"Attempting to run a closed session\"))\n        }\n        if (!session.faceRecognition) {\n            session.faceRecognition = this.faceRecognition\n        }\n\n        return <Observable<LivenessDetectionSessionResult>>(this.liveFaceCapture(session).pipe(\n            map((capture: FaceCapture): FaceCapture => {\n                capture.requestedBearing = session.requestedBearing\n                return capture\n            }),\n            map(session.detectFacePresence),\n            map(session.detectFaceAlignment),\n            //map(session.detectSpoofAttempt),\n            tap((capture: FaceCapture) => {\n                this.onFaceCapture(session, capture)\n            }),\n            filter((capture: FaceCapture, index: number) => {\n                return capture.face != null && capture.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED\n            }),\n            mergeMap(session.createFaceCapture),\n            tap((faceCapture: FaceCapture) => {\n                Promise.resolve().then(() => {\n                    if (session.faceCaptureCallback) {\n                        session.faceCaptureCallback(faceCapture)\n                    }\n                })\n                if (new Date().getTime() - session.startTime > session.settings.maxDuration * 1000) {\n                    throw new Error(\"Session timed out\")\n                }\n            }),\n            take(session.settings.faceCaptureCount),\n            toArray(),\n            tap(() => {\n                Promise.resolve().then(() => {\n                    session.ui.trigger({\"type\":LivenessDetectionSessionEventType.CAPTURE_FINISHED})\n                })\n            }),\n            mergeMap(session.resultFromCaptures),\n            mergeMap(session.checkLiveness),\n            (observable: Observable<LivenessDetectionSessionResult>) => this.livenessDetectionSessionResultObservable(observable, session)\n        ))\n    }\n\n    /**\n     * Create a liveness detection session. Subscribe to the returned Observable to start the session and to receive results.\n     * @param settings Session settings\n     * @param faceDetectionCallback Optional callback to invoke each time a frame is ran by face detection\n     * @param faceCaptureCallback Optional callback to invoke when a face aligned to the requested bearing is captured\n     * @deprecated Use {@linkcode captureFaces}\n     * @hidden\n     */\n    public livenessDetectionSession(settings?: LivenessDetectionSessionSettings, faceDetectionCallback?: FaceCaptureCallback, faceCaptureCallback?: FaceCaptureCallback, faceRequirementListener?: FaceRequirementListener): Observable<LivenessDetectionSessionResult> {\n        const session = new LivenessDetectionSession(settings, this.faceRecognition)\n        session.faceDetectionCallback = faceDetectionCallback\n        session.faceCaptureCallback = faceCaptureCallback\n        if (faceRequirementListener) {\n            session.registerFaceRequirementListener(faceRequirementListener)\n        }\n        return this.captureFaces(session)\n    }\n\n    private onFaceCapture = (session: LivenessDetectionSession, capture: FaceCapture): void => {\n        if (capture.face) {\n            const now = new Date().getTime()\n            if (session.lastCaptureTime == null && capture.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED) {\n                session.lastCaptureTime = now\n            } else if (session.lastCaptureTime != null && (capture.faceAlignmentStatus == FaceAlignmentStatus.ALIGNED || now - session.lastCaptureTime >= session.settings.controlFaceCaptureInterval)) {\n                session.lastCaptureTime = now\n                session.controlFaceCaptures.push(capture)\n                if (session.controlFaceCaptures.length > session.settings.maxControlFaceCount) {\n                    session.controlFaceCaptures.shift()\n                }\n            }\n        }\n        Promise.resolve().then(() => {\n            session.ui.trigger({\"type\": LivenessDetectionSessionEventType.FACE_CAPTURED, \"capture\": capture})\n            if (session.faceDetectionCallback) {\n                session.faceDetectionCallback(capture)\n            }\n        })\n    }\n\n    private onVideoPlay(session: LivenessDetectionSession, subscriber: Subscriber<FaceCapture>): () => void {\n        return async () => {\n            session.ui.trigger({\"type\": LivenessDetectionSessionEventType.LOADED})\n            let frameCount = 0\n            let fps: number | null = null\n            const detectFace = async (): Promise<FaceCapture> => {\n                const startTime = new Date().getTime()\n                const faceCapture = await session.faceDetector.detectFace({element: session.ui.video, mirrored: session.settings.useFrontCamera})\n                if (frameCount > 2 && frameCount < 10) {\n                    const detectionDuration = new Date().getTime() - startTime\n                    const currentFPS = 1000 / detectionDuration\n                    if (fps === null) {\n                        fps = currentFPS\n                    } else {\n                        fps += currentFPS\n                        fps /= 2\n                    }\n                    if (fps < session.settings.minFPS) {\n                        throw new Error(\"Device too slow: \"+fps.toFixed(1)+\" FPS (required \"+session.settings.minFPS+\" FPS)\")\n                    }\n                } else {\n                    fps = null\n                }\n                frameCount ++\n                return faceCapture\n            }\n\n            async function* detectSingleFace() {\n                while (!subscriber.closed && !session.ui.video.paused && !session.ui.video.ended) {\n                    yield await detectFace()\n                }\n            }\n\n            try {\n                for await (const faceCapture of detectSingleFace()) {\n                    if (subscriber.closed) {\n                        break\n                    }\n                    emitRxEvent(subscriber, {\"type\": \"next\", \"value\": faceCapture})\n                }\n            } catch (error) {\n                if (!subscriber.closed) {\n                    emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error})\n                }\n            }\n        }\n    }\n\n    private liveFaceCapture(session: LivenessDetectionSession): Observable<FaceCapture> {\n        return new Observable<FaceCapture>((subscriber: Subscriber<FaceCapture>) => {\n            this.createFaceDetectorPromise.then(faceDetector => {\n                session.faceDetector = faceDetector\n                session.ui.video.onplay = this.onVideoPlay(session, subscriber)\n                return session.setupVideo()\n            }).catch((error) => {\n                emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error})\n            })\n        })\n    }\n\n    private checkLivenessSessionAvailability() {\n        if (location.protocol != \"https:\") {\n            throw new Error(\"Liveness detection is only supported on secure connections (https)\")\n        }\n        if (!FaceDetection.isLivenessDetectionSupported()) {\n            throw new Error(\"Liveness detection is not supported by your browser\")\n        }\n    }\n\n    private livenessDetectionSessionResultObservable = (observable: Observable<LivenessDetectionSessionResult>, session: LivenessDetectionSession): Observable<LivenessDetectionSessionResult> => {\n        return new Observable<LivenessDetectionSessionResult>((subscriber: Subscriber<LivenessDetectionSessionResult>) => {\n            const subcription: Subscription = observable.subscribe({\n                next: (val: LivenessDetectionSessionResult) => {\n                    emitRxEvent(subscriber, {\"type\": \"next\", \"value\": val})\n                },\n                error: (err: any) => {\n                    session.close()\n                    emitRxEvent(subscriber, {\"type\": \"error\", \"error\": err})\n                },\n                complete: () => {\n                    session.close()\n                    emitRxEvent(subscriber, {\"type\": \"complete\"})\n                }\n            })\n            session.ui.on(LivenessDetectionSessionEventType.CANCEL, () => {\n                emitRxEvent(subscriber, {\"type\": \"complete\"})\n            })\n            return () => {\n                subcription.unsubscribe()\n                session.close()\n            }\n        })\n    }\n}\n\n/**\n * Result of a liveness detection session\n * @category Face detection\n */\nexport class LivenessDetectionSessionResult {\n    /**\n     * Date that represents the time the session was started\n     */\n    readonly startTime: Date\n    /**\n     * Session duration in seconds\n     */\n    duration: number\n    /**\n     * Array of face captures collected during the session\n     */\n    readonly faceCaptures: Array<FaceCapture>\n\n    readonly videoURL: string|undefined\n\n    livenessScore?: number\n\n    /**\n     * Constructor\n     * @param startTime Date that represents the time the session was started\n     * @internal\n     */\n    constructor(startTime: Date, faceCaptures?: FaceCapture[], videoURL?: string | undefined) {\n        this.startTime = startTime\n        this.faceCaptures = faceCaptures ? faceCaptures : []\n        this.duration = (new Date().getTime() - startTime.getTime())/1000\n        this.videoURL = videoURL\n    }\n}\n\n\n\n","/*! ****************************************************************************\nCopyright (c) Microblink. All rights reserved.\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n***************************************************************************** */\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\nlet nextMessageID = 0;\nfunction getNextMessageID() {\n    const msgId = nextMessageID;\n    nextMessageID = nextMessageID + 1;\n    return msgId;\n}\nclass BaseRequestMessage {\n    constructor(action) {\n        this.action = action;\n        this.messageID = getNextMessageID();\n    }\n}\nclass InitMessage extends BaseRequestMessage {\n    constructor(wasmLoadSettings, userId) {\n        super(InitMessage.action);\n        this.wasmModuleName = wasmLoadSettings.wasmModuleName;\n        this.licenseKey = wasmLoadSettings.licenseKey;\n        this.userId = userId;\n        this.registerLoadCallback = wasmLoadSettings.loadProgressCallback !== null;\n        this.allowHelloMessage = wasmLoadSettings.allowHelloMessage;\n        this.engineLocation = wasmLoadSettings.engineLocation;\n        this.wasmType = wasmLoadSettings.wasmType;\n        this.numberOfWorkers = wasmLoadSettings.numberOfWorkers;\n    }\n}\nInitMessage.action = \"init\";\nvar ParameterType;\n(function (ParameterType) {\n    ParameterType[ParameterType[\"Any\"] = 0] = \"Any\";\n    ParameterType[ParameterType[\"Recognizer\"] = 1] = \"Recognizer\";\n    ParameterType[ParameterType[\"RecognizerSettings\"] = 2] = \"RecognizerSettings\";\n    ParameterType[ParameterType[\"Callback\"] = 3] = \"Callback\";\n})(ParameterType || (ParameterType = {}));\nclass CreateNewRecognizer extends BaseRequestMessage {\n    constructor(className, params) {\n        super(CreateNewRecognizer.action);\n        this.className = className;\n        this.params = params;\n    }\n}\nCreateNewRecognizer.action = \"createNewNativeObject\";\nclass CreateRecognizerRunner extends BaseRequestMessage {\n    constructor(recognizerHandles, allowMultipleResults, registeredMetadataCallbacks) {\n        super(CreateRecognizerRunner.action);\n        this.recognizerHandles = recognizerHandles;\n        this.allowMultipleResults = allowMultipleResults;\n        this.registeredMetadataCallbacks = registeredMetadataCallbacks;\n    }\n}\nCreateRecognizerRunner.action = \"createRecognizerRunner\";\nclass ReconfigureRecognizerRunner extends BaseRequestMessage {\n    constructor(recognizerHandles, allowMultipleResults) {\n        super(ReconfigureRecognizerRunner.action);\n        this.recognizerHandles = recognizerHandles;\n        this.allowMultipleResults = allowMultipleResults;\n    }\n}\nReconfigureRecognizerRunner.action = \"reconfigureRecognizerRunner\";\nclass DeleteRecognizerRunner extends BaseRequestMessage {\n    constructor() {\n        super(DeleteRecognizerRunner.action);\n    }\n}\nDeleteRecognizerRunner.action = \"deleteRecognizerRunner\";\nclass InvokeObjectMethod extends BaseRequestMessage {\n    constructor(objectHandle, methodName, params) {\n        super(InvokeObjectMethod.action);\n        this.objectHandle = objectHandle;\n        this.methodName = methodName;\n        this.params = params;\n    }\n}\nInvokeObjectMethod.action = \"invokeObject\";\nclass ProcessImage extends BaseRequestMessage {\n    constructor(image) {\n        super(ProcessImage.action);\n        this.frame = image;\n    }\n    getTransferrables() {\n        return [this.frame.imageData.data.buffer];\n    }\n}\nProcessImage.action = \"processImage\";\nclass ResetRecognizers extends BaseRequestMessage {\n    constructor(hardReset) {\n        super(ResetRecognizers.action);\n        this.hardReset = hardReset;\n    }\n}\nResetRecognizers.action = \"resetRecognizers\";\nclass RegisteredMetadataCallbacks {\n    constructor() {\n        this.onDebugText = false;\n        this.onDetectionFailed = false;\n        this.onQuadDetection = false;\n        this.onPointsDetection = false;\n        this.onFirstSideResult = false;\n        this.onGlare = false;\n    }\n}\nclass RegisterMetadataCallbacks extends BaseRequestMessage {\n    constructor(registeredMetadataCallbacks) {\n        super(RegisterMetadataCallbacks.action);\n        this.registeredMetadataCallbacks = registeredMetadataCallbacks;\n    }\n}\nRegisterMetadataCallbacks.action = \"registerMetadataCallbacks\";\nclass SetDetectionOnly extends BaseRequestMessage {\n    constructor(detectionOnlyMode) {\n        super(SetDetectionOnly.action);\n        this.detectionOnlyMode = detectionOnlyMode;\n    }\n}\nSetDetectionOnly.action = \"setDetectionOnly\";\nclass SetClearTimeoutCallback extends BaseRequestMessage {\n    constructor(callbackNonEmpty) {\n        super(SetClearTimeoutCallback.action);\n        this.callbackNonEmpty = callbackNonEmpty;\n    }\n}\nSetClearTimeoutCallback.action = \"setClearTimeoutCallback\";\nclass SetCameraPreviewMirrored extends BaseRequestMessage {\n    constructor(cameraPreviewMirrored) {\n        super(SetCameraPreviewMirrored.action);\n        this.cameraPreviewMirrored = cameraPreviewMirrored;\n    }\n}\nSetCameraPreviewMirrored.action = \"setCameraPreviewMirrored\";\nclass GetProductIntegrationInfo extends BaseRequestMessage {\n    constructor(userId) {\n        super(GetProductIntegrationInfo.action);\n        this.userId = userId;\n    }\n}\nGetProductIntegrationInfo.action = \"getProductIntegrationInfo\";\n// ===================================== /\n// Metadata callback messages\n// ===================================== /\nvar MetadataCallback;\n(function (MetadataCallback) {\n    MetadataCallback[MetadataCallback[\"onDebugText\"] = 0] = \"onDebugText\";\n    MetadataCallback[MetadataCallback[\"onDetectionFailed\"] = 1] = \"onDetectionFailed\";\n    MetadataCallback[MetadataCallback[\"onQuadDetection\"] = 2] = \"onQuadDetection\";\n    MetadataCallback[MetadataCallback[\"onPointsDetection\"] = 3] = \"onPointsDetection\";\n    MetadataCallback[MetadataCallback[\"onFirstSideResult\"] = 4] = \"onFirstSideResult\";\n    MetadataCallback[MetadataCallback[\"clearTimeoutCallback\"] = 5] = \"clearTimeoutCallback\";\n    MetadataCallback[MetadataCallback[\"onGlare\"] = 6] = \"onGlare\";\n    MetadataCallback[MetadataCallback[\"recognizerCallback\"] = 7] = \"recognizerCallback\";\n})(MetadataCallback || (MetadataCallback = {}));\n/* eslint-enable @typescript-eslint/no-explicit-any */\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Defines the type of the WASM that will be loaded.\n */\nvar WasmType;\n(function (WasmType) {\n    /**\n     * The WASM that will be loaded will be most compatible with all browsers that\n     * support the WASM, but will lack features that could be used to improve performance.\n     */\n    WasmType[\"Basic\"] = \"BASIC\";\n    /**\n     * The WASM that will be loaded will be built with advanced WASM features, such as\n     * bulk memory, SIMD, non-trapping floating point and sign extension. Such WASM can only\n     * be executed in browsers that support those features. Attempting to run this\n     * WASM in a non-compatible browser will crash your app.\n     */\n    WasmType[\"Advanced\"] = \"ADVANCED\";\n    /**\n     * The WASM that will be loaded will be build with advanced WASM features, just\n     * like above. Additionally, it will be also built with support for multi-threaded\n     * processing. This feature requires a browser with support for both advanced WASM\n     * features and `SharedArrayBuffer`\n     */\n    WasmType[\"AdvancedWithThreads\"] = \"ADVANCED_WITH_THREADS\";\n})(WasmType || (WasmType = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\nconst defaultWasmModuleName = \"BlinkIDWasmSDK\";\n\n/* eslint-disable @typescript-eslint/no-unsafe-argument */\nfunction defaultEventHandler(resolve, reject) {\n    return (msg) => {\n        const resultMsg = msg;\n        if (resultMsg.success) {\n            resolve();\n        }\n        else {\n            reject(resultMsg.error);\n        }\n    };\n}\nfunction defaultResultEventHandler(successResolver, reject) {\n    return (msg) => {\n        const resultMsg = msg;\n        if (resultMsg.success) {\n            successResolver(msg);\n        }\n        else {\n            reject(resultMsg.error);\n        }\n    };\n}\n/* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-assignment */\nfunction wrapParameters(params) {\n    // convert params\n    const wrappedPrameters = [];\n    for (let param of params) {\n        let paramType = ParameterType.Any;\n        if (param instanceof RemoteRecognizer) {\n            paramType = ParameterType.Recognizer;\n            param = param.getRemoteObjectHandle();\n        }\n        wrappedPrameters.push({\n            parameter: param,\n            type: paramType\n        });\n    }\n    return wrappedPrameters;\n}\n/* eslint-enable @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-assignment */\nclass RemoteRecognizer {\n    /* eslint-enable lines-between-class-members */\n    constructor(wasmWorker, recognizerName, remoteObjHandle) {\n        this.wasmSDKWorker = wasmWorker;\n        this.objectHandle = remoteObjHandle;\n        this.recognizerName = recognizerName;\n        this.callbacks = new Map();\n    }\n    /* eslint-enable @typescript-eslint/ban-types */\n    getRemoteObjectHandle() {\n        return this.objectHandle;\n    }\n    currentSettings() {\n        return new Promise((resolve, reject) => {\n            if (this.objectHandle < 0) {\n                reject(\"Invalid object handle: \" + this.objectHandle.toString());\n                return;\n            }\n            const msg = new InvokeObjectMethod(this.objectHandle, \"currentSettings\", []);\n            const handler = defaultResultEventHandler((msg) => {\n                resolve(msg.result);\n            }, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    toSignedJSON() {\n        {\n            return new Promise((resolve, reject) => {\n                if (this.objectHandle < 0) {\n                    reject(\"Invalid object handle: \" + this.objectHandle.toString());\n                    return;\n                }\n                const msg = new InvokeObjectMethod(this.objectHandle, \"toSignedJSON\", []);\n                const handler = defaultResultEventHandler((msg) => {\n                    resolve(msg.result);\n                }, reject);\n                this.wasmSDKWorker.postMessage(msg, handler);\n            });\n        }\n    }\n    clearAllCallbacks() {\n        this.callbacks.clear();\n        this.wasmSDKWorker.unregisterRecognizerCallbacks(this.objectHandle);\n    }\n    /* eslint-disable @typescript-eslint/no-explicit-any,\n                      @typescript-eslint/no-unsafe-assignment,\n                      @typescript-eslint/no-unsafe-member-access,\n                      @typescript-eslint/no-unsafe-return\n    */\n    // convert each function member into wrapped parameter, containing address where callback needs to be delivered\n    removeFunctions(settings) {\n        // clear any existing callbacks\n        this.clearAllCallbacks();\n        const keys = Object.keys(settings);\n        let needsRegistering = false;\n        for (const key of keys) {\n            const data = settings[key];\n            if (typeof data === \"function\") {\n                this.callbacks.set(key, data);\n                const wrappedFunction = {\n                    parameter: {\n                        recognizerHandle: this.objectHandle,\n                        callbackName: key\n                    },\n                    type: ParameterType.Callback\n                };\n                settings[key] = wrappedFunction;\n                needsRegistering = true;\n            }\n        }\n        if (needsRegistering) {\n            this.wasmSDKWorker.registerRecognizerCallbacks(this.objectHandle, this);\n        }\n        return settings;\n    }\n    /* eslint-enable @typescript-eslint/no-explicit-any,\n                     @typescript-eslint/no-unsafe-assignment,\n                     @typescript-eslint/no-unsafe-member-access,\n                     @typescript-eslint/no-unsafe-return\n    */\n    updateSettings(newSettings) {\n        return new Promise((resolve, reject) => {\n            if (this.objectHandle < 0) {\n                reject(\"Invalid object handle: \" + this.objectHandle.toString());\n                return;\n            }\n            /* eslint-disable @typescript-eslint/no-unsafe-assignment */\n            const msg = new InvokeObjectMethod(this.objectHandle, \"updateSettings\", [\n                {\n                    parameter: this.removeFunctions(newSettings),\n                    type: ParameterType.RecognizerSettings\n                }\n            ]);\n            /* eslint-enable @typescript-eslint/no-unsafe-assignment */\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    invokeCallback(callbackName, args) {\n        const callback = this.callbacks.get(callbackName);\n        if (callback !== undefined) {\n            callback(...args);\n        }\n        else {\n            console.warn(\"Cannot find callback\", callbackName);\n        }\n    }\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n    getResult() {\n        return new Promise((resolve, reject) => {\n            if (this.objectHandle < 0) {\n                reject(\"Invalid object handle: \" + this.objectHandle.toString());\n                return;\n            }\n            const msg = new InvokeObjectMethod(this.objectHandle, \"getResult\", []);\n            const handler = defaultResultEventHandler((msg) => {\n                resolve(msg.result);\n            }, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    delete() {\n        return new Promise((resolve, reject) => {\n            if (this.objectHandle < 0) {\n                reject(\"Invalid object handle: \" + this.objectHandle.toString());\n                return;\n            }\n            this.clearAllCallbacks();\n            const msg = new InvokeObjectMethod(this.objectHandle, \"delete\", []);\n            const handler = defaultEventHandler(() => {\n                this.objectHandle = -1;\n                resolve();\n            }, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n}\nfunction createRegisteredCallbacks(metadataCallbacks) {\n    const msg = new RegisteredMetadataCallbacks();\n    // https://stackoverflow.com/a/20093686/213057\n    msg.onDebugText = !!metadataCallbacks.onDebugText;\n    msg.onDetectionFailed = !!metadataCallbacks.onDetectionFailed;\n    msg.onPointsDetection = !!metadataCallbacks.onPointsDetection;\n    msg.onQuadDetection = !!metadataCallbacks.onQuadDetection;\n    msg.onFirstSideResult = !!metadataCallbacks.onFirstSideResult;\n    msg.onGlare = !!metadataCallbacks.onGlare;\n    return msg;\n}\nclass RemoteRecognizerRunner {\n    constructor(wasmWorker) {\n        this.deleted = false;\n        this.wasmSDKWorker = wasmWorker;\n    }\n    processImage(image) {\n        return new Promise((resolve, reject) => {\n            if (this.deleted) {\n                reject(\"Recognizer runner is deleted. It cannot be used anymore!\");\n                return;\n            }\n            const msg = new ProcessImage(image);\n            const handler = defaultResultEventHandler((response) => {\n                const state = response.recognitionState;\n                resolve(state);\n            }, reject);\n            this.wasmSDKWorker.postTransferrableMessage(msg, handler);\n        });\n    }\n    reconfigureRecognizers(recognizers, allowMultipleResults) {\n        return new Promise((resolve, reject) => {\n            if (this.deleted) {\n                reject(\"Recognizer runner is deleted. It cannot be used anymore!\");\n                return;\n            }\n            const recognizerHandles = getRecognizerHandles(recognizers);\n            const msg = new ReconfigureRecognizerRunner(recognizerHandles, allowMultipleResults);\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    setMetadataCallbacks(metadataCallbacks) {\n        return new Promise((resolve, reject) => {\n            const msg = new RegisterMetadataCallbacks(createRegisteredCallbacks(metadataCallbacks));\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.postMessageAndRegisterCallbacks(msg, metadataCallbacks, handler);\n        });\n    }\n    resetRecognizers(hardReset) {\n        return new Promise((resolve, reject) => {\n            const msg = new ResetRecognizers(hardReset);\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    setDetectionOnlyMode(detectionOnly) {\n        return new Promise((resolve, reject) => {\n            const msg = new SetDetectionOnly(detectionOnly);\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    setClearTimeoutCallback(clearTimeoutCallback) {\n        return new Promise((resolve, reject) => {\n            const msg = new SetClearTimeoutCallback(clearTimeoutCallback !== null);\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.registerClearTimeoutCallback(clearTimeoutCallback);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    setCameraPreviewMirrored(mirrored) {\n        return new Promise((resolve, reject) => {\n            const msg = new SetCameraPreviewMirrored(mirrored);\n            const handler = defaultEventHandler(resolve, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n    delete() {\n        if (this.deleted) {\n            return Promise.reject(\"Recognizer runner is already deleted.\");\n        }\n        return new Promise((resolve, reject) => {\n            const msg = new DeleteRecognizerRunner();\n            const handler = defaultEventHandler(() => {\n                this.deleted = true;\n                resolve();\n            }, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n}\nfunction getRecognizerHandles(remoteRecognizers) {\n    const recognizerHandles = [];\n    for (const remoteRecognizer of remoteRecognizers) {\n        recognizerHandles.push(remoteRecognizer.getRemoteObjectHandle());\n    }\n    return recognizerHandles;\n}\nclass WasmModuleWorkerProxy {\n    constructor(wasmSDKWorker) {\n        this.wasmSDKWorker = wasmSDKWorker;\n    }\n    createRecognizerRunner(recognizers, allowMultipleResults = false, metadataCallbacks = {}) {\n        return new Promise((resolve, reject) => {\n            const recognizerHandles = getRecognizerHandles(recognizers);\n            const msg = new CreateRecognizerRunner(recognizerHandles, allowMultipleResults, createRegisteredCallbacks(metadataCallbacks));\n            const handler = defaultEventHandler(() => {\n                resolve(new RemoteRecognizerRunner(this.wasmSDKWorker));\n            }, reject);\n            this.wasmSDKWorker.postMessageAndRegisterCallbacks(msg, metadataCallbacks, handler);\n        });\n    }\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    newRecognizer(className, ...constructorArgs) {\n        return new Promise((resolve, reject) => {\n            const msg = new CreateNewRecognizer(className, wrapParameters(constructorArgs));\n            const handler = defaultResultEventHandler((msg) => {\n                const remoteRecognizer = new RemoteRecognizer(this.wasmSDKWorker, className, msg.objectHandle);\n                resolve(remoteRecognizer);\n            }, reject);\n            this.wasmSDKWorker.postMessage(msg, handler);\n        });\n    }\n}\nclass WasmSDKWorker {\n    /* eslint-enable lines-between-class-members */\n    constructor(worker, loadProgressCallback, userId, rejectHandler) {\n        this.eventHandlers = {};\n        this.metadataCallbacks = {};\n        this.clearTimeoutCallback = null;\n        this.loadedWasmType = WasmType.Basic; // will be updated after WASM gets loaded\n        this.mbWasmWorker = worker;\n        this.mbWasmWorker.onmessage = (event) => { this.handleWorkerEvent(event); };\n        this.mbWasmWorker.onerror = () => {\n            rejectHandler(\"Problem during initialization of worker file!\");\n            return;\n        };\n        this.mbWasmModule = new WasmModuleWorkerProxy(this);\n        this.loadCallback = loadProgressCallback;\n        this.recognizersWithCallbacks = new Map();\n        this.userId = userId;\n        this.showOverlay = false;\n    }\n    postMessage(message, eventHandler) {\n        this.eventHandlers[message.messageID] = eventHandler;\n        this.mbWasmWorker.postMessage(message);\n    }\n    postTransferrableMessage(message, eventHandler) {\n        this.eventHandlers[message.messageID] = eventHandler;\n        this.mbWasmWorker.postMessage(message, message.getTransferrables());\n    }\n    postMessageAndRegisterCallbacks(message, metadataCallbacks, eventHandler) {\n        this.eventHandlers[message.messageID] = eventHandler;\n        this.metadataCallbacks = metadataCallbacks;\n        this.mbWasmWorker.postMessage(message);\n    }\n    registerClearTimeoutCallback(callback) {\n        this.clearTimeoutCallback = callback;\n    }\n    registerRecognizerCallbacks(remoteRecognizerHandle, recognizer) {\n        this.recognizersWithCallbacks.set(remoteRecognizerHandle, recognizer);\n    }\n    unregisterRecognizerCallbacks(remoteRecognizerHandle) {\n        this.recognizersWithCallbacks.delete(remoteRecognizerHandle);\n    }\n    /**\n     * Clean up the active instance of the SDK.\n     *\n     * It's not possible to use the SDK after this method is called.\n     */\n    delete() {\n        this.mbWasmWorker.terminate();\n    }\n    getProductIntegrationInfo() {\n        return new Promise((resolve, reject) => {\n            const msg = new GetProductIntegrationInfo(this.userId);\n            const handler = defaultResultEventHandler((msg) => {\n                resolve(msg.result);\n            }, reject);\n            this.postMessage(msg, handler);\n        });\n    }\n    handleWorkerEvent(event) {\n        if (\"isCallbackMessage\" in event.data) {\n            const msg = event.data;\n            switch (msg.callbackType) {\n                case MetadataCallback.onDebugText:\n                    if (typeof this.metadataCallbacks.onDebugText === \"function\") {\n                        this.metadataCallbacks.onDebugText(msg.callbackParameters[0]);\n                    }\n                    break;\n                case MetadataCallback.onDetectionFailed:\n                    if (typeof this.metadataCallbacks.onDetectionFailed === \"function\") {\n                        this.metadataCallbacks.onDetectionFailed();\n                    }\n                    break;\n                case MetadataCallback.onPointsDetection:\n                    if (typeof this.metadataCallbacks.onPointsDetection === \"function\") {\n                        this.metadataCallbacks.onPointsDetection(msg.callbackParameters[0]);\n                    }\n                    break;\n                case MetadataCallback.onQuadDetection:\n                    if (typeof this.metadataCallbacks.onQuadDetection === \"function\") {\n                        this.metadataCallbacks.onQuadDetection(msg.callbackParameters[0]);\n                    }\n                    break;\n                case MetadataCallback.onFirstSideResult:\n                    if (typeof this.metadataCallbacks.onFirstSideResult === \"function\") {\n                        this.metadataCallbacks.onFirstSideResult();\n                    }\n                    break;\n                case MetadataCallback.clearTimeoutCallback:\n                    if (this.clearTimeoutCallback && typeof this.clearTimeoutCallback.onClearTimeout === \"function\") {\n                        this.clearTimeoutCallback.onClearTimeout();\n                    }\n                    break;\n                case MetadataCallback.onGlare:\n                    if (typeof this.metadataCallbacks.onGlare === \"function\") {\n                        this.metadataCallbacks.onGlare(msg.callbackParameters[0]);\n                    }\n                    break;\n                case MetadataCallback.recognizerCallback:\n                    {\n                        // first parameter is address, other parameters are callback parameters\n                        const address = msg.callbackParameters.shift();\n                        const recognizer = this.recognizersWithCallbacks.get(address.recognizerHandle);\n                        if (recognizer !== undefined) {\n                            recognizer.invokeCallback(address.callbackName, msg.callbackParameters);\n                        }\n                        else {\n                            console.warn(\"Cannot find recognizer to deliver callback message. Maybe it's destroyed?\", address);\n                        }\n                        break;\n                    }\n                default:\n                    throw new Error(`Unknown callback type: ${MetadataCallback[msg.callbackType]}`);\n            }\n        }\n        else if (\"isLoadProgressMessage\" in event.data) {\n            const msg = event.data;\n            if (typeof this.loadCallback === \"function\") {\n                this.loadCallback(msg.progress);\n            }\n        }\n        else {\n            const msg = event.data;\n            const eventHandler = this.eventHandlers[msg.messageID];\n            delete this.eventHandlers[msg.messageID];\n            eventHandler(msg);\n        }\n    }\n    static async createWasmWorker(worker, wasmLoadSettings, userId) {\n        return new Promise((resolve, reject) => {\n            const wasmWorker = new WasmSDKWorker(worker, wasmLoadSettings.loadProgressCallback, userId, reject);\n            const initMessage = new InitMessage(wasmLoadSettings, userId);\n            const initEventHandler = defaultResultEventHandler((msg) => {\n                const successMsg = msg;\n                wasmWorker.showOverlay = successMsg.showOverlay;\n                wasmWorker.loadedWasmType = successMsg.wasmType;\n                resolve(wasmWorker);\n            }, \n            /* eslint-disable @typescript-eslint/no-explicit-any */\n            (error) => {\n                if (wasmWorker && typeof wasmWorker.delete === \"function\") {\n                    wasmWorker.delete();\n                }\n                reject(error);\n            }\n            /* eslint-enable @typescript-eslint/no-explicit-any */\n            );\n            wasmWorker.postMessage(initMessage, initEventHandler);\n        });\n    }\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any,\n                  @typescript-eslint/no-unsafe-assignment */\nclass SDKError extends Error {\n    constructor(error, details) {\n        super();\n        if (!error.code || !error.message) {\n            throw new Error(\"Instance of SDKError is required to have code and message.\");\n        }\n        this.message = error.message;\n        this.code = error.code;\n        this.details = details;\n    }\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/* eslint-disable max-len */\n/**\n * Structures of Error Codes, Error Messages, and CustomError compatible objects for the Error Generator utility.\n * Error Code convention: SECTION_OBJECT_(ACTION)_PROBLEM\n */\nvar ErrorCodes;\n(function (ErrorCodes) {\n    ErrorCodes[\"WORKER_WASM_LOAD_FAILURE\"] = \"WORKER_WASM_LOAD_FAILURE\";\n    ErrorCodes[\"WORKER_WASM_INIT_MISSING\"] = \"WORKER_WASM_INIT_MISSING\";\n    ErrorCodes[\"WORKER_FUNCTION_INVOKE_FAILURE\"] = \"WORKER_FUNCTION_INVOKE_FAILURE\";\n    ErrorCodes[\"WORKER_RECOGNIZER_CREATION_FAILURE\"] = \"WORKER_RECOGNIZER_CREATION_FAILURE\";\n    ErrorCodes[\"WORKER_RUNNER_EXISTS\"] = \"WORKER_RUNNER_EXISTS\";\n    ErrorCodes[\"WORKER_RUNNER_CREATION_FAILURE\"] = \"WORKER_RUNNER_CREATION_FAILURE\";\n    ErrorCodes[\"WORKER_RUNNER_MISSING\"] = \"WORKER_RUNNER_MISSING\";\n    ErrorCodes[\"WORKER_RUNNER_RECONFIGURE_FAILURE\"] = \"WORKER_RUNNER_RECONFIGURE_FAILURE\";\n    ErrorCodes[\"WORKER_RUNNER_DELETED\"] = \"WORKER_RUNNER_DELETED\";\n    ErrorCodes[\"WORKER_RUNNER_DELETE_FAILURE\"] = \"WORKER_RUNNER_DELETE_FAILURE\";\n    ErrorCodes[\"WORKER_OBJECT_INVOKE_FAILURE\"] = \"WORKER_OBJECT_INVOKE_FAILURE\";\n    ErrorCodes[\"WORKER_IMAGE_PROCESS_FAILURE\"] = \"WORKER_IMAGE_PROCESS_FAILURE\";\n    ErrorCodes[\"WORKER_HANDLE_UNDEFINED\"] = \"WORKER_HANDLE_UNDEFINED\";\n    ErrorCodes[\"WORKER_MESSAGE_ACTION_UNKNOWN\"] = \"WORKER_MESSAGE_ACTION_UNKNOWN\";\n    ErrorCodes[\"WORKER_LICENSE_UNLOCK_ERROR\"] = \"WORKER_LICENSE_UNLOCK_ERROR\";\n    ErrorCodes[\"WORKER_INTEGRATION_INFO_FAILURE\"] = \"WORKER_INTEGRATION_INFO_FAILURE\";\n    ErrorCodes[\"LOCAL_SDK_RUNNER_MISSING\"] = \"LOCAL_SDK_RUNNER_MISSING\";\n    ErrorCodes[\"LOCAL_SDK_RUNNER_EMPTY\"] = \"LOCAL_SDK_RUNNER_EMPTY\";\n    ErrorCodes[\"LICENSE_UNLOCK_ERROR\"] = \"LICENSE_UNLOCK_ERROR\";\n    ErrorCodes[\"FRAME_CAPTURE_SVG_UNSUPPORTED\"] = \"FRAME_CAPTURE_SVG_UNSUPPORTED\";\n    ErrorCodes[\"FRAME_CAPTURE_CANVAS_MISSING\"] = \"FRAME_CAPTURE_CANVAS_MISSING\";\n    ErrorCodes[\"SDK_WASM_SETTINGS_MISSING\"] = \"SDK_WASM_SETTINGS_MISSING\";\n    ErrorCodes[\"SDK_LICENSE_KEY_MISSING\"] = \"SDK_LICENSE_KEY_MISSING\";\n    ErrorCodes[\"SDK_WASM_MODULE_NAME_MISSING\"] = \"SDK_WASM_MODULE_NAME_MISSING\";\n    ErrorCodes[\"SDK_ENGINE_LOCATION_INVALID\"] = \"SDK_ENGINE_LOCATION_INVALID\";\n    ErrorCodes[\"SDK_WORKER_LOCATION_INVALID\"] = \"SDK_WORKER_LOCATION_INVALID\";\n    ErrorCodes[\"SDK_MISSING\"] = \"SDK_MISSING\";\n    ErrorCodes[\"SDK_RECOGNIZERS_MISSING\"] = \"SDK_RECOGNIZERS_MISSING\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_ELEMENT_MISSING\"] = \"VIDEO_RECOGNIZER_ELEMENT_MISSING\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_CAMERA_MISSING\"] = \"VIDEO_RECOGNIZER_CAMERA_MISSING\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED\"] = \"VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE\"] = \"VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_CAMERA_IN_USE\"] = \"VIDEO_RECOGNIZER_CAMERA_IN_USE\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED\"] = \"VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_FEED_RELEASED\"] = \"VIDEO_RECOGNIZER_FEED_RELEASED\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_FEED_NOT_PAUSED\"] = \"VIDEO_RECOGNIZER_FEED_NOT_PAUSED\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED\"] = \"VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_FEED_PAUSED\"] = \"VIDEO_RECOGNIZER_FEED_PAUSED\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE\"] = \"VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE\";\n    ErrorCodes[\"VIDEO_RECOGNIZER_FEED_MISSING\"] = \"VIDEO_RECOGNIZER_FEED_MISSING\";\n})(ErrorCodes || (ErrorCodes = {}));\nvar ErrorMessages;\n(function (ErrorMessages) {\n    ErrorMessages[\"WORKER_HANDLE_UNDEFINED\"] = \"Cannot find object with handle: undefined\";\n    ErrorMessages[\"WORKER_WASM_LOAD_FAILURE\"] = \"Failed to load WASM in web worker!\";\n    ErrorMessages[\"WORKER_WASM_INIT_MISSING\"] = \"WASM module is not initialized!\";\n    ErrorMessages[\"WORKER_FUNCTION_INVOKE_FAILURE\"] = \"Failed to invoke function!\";\n    ErrorMessages[\"WORKER_RECOGNIZER_CREATION_FAILURE\"] = \"Failed to create new recognizer!\";\n    ErrorMessages[\"WORKER_RUNNER_EXISTS\"] = \"Recognizer runner is already created! Multiple instances are not allowed!\";\n    ErrorMessages[\"WORKER_RUNNER_CREATION_FAILURE\"] = \"Failed to create new recognizer runner!\";\n    ErrorMessages[\"WORKER_RUNNER_MISSING\"] = \"Recognizer runner is not created! There is nothing to reconfigure!\";\n    ErrorMessages[\"WORKER_RUNNER_RECONFIGURE_FAILURE\"] = \"Failed to reconfigure recognizer runner!\";\n    ErrorMessages[\"WORKER_RUNNER_DELETED\"] = \"Recognizer runner is already deleted!\";\n    ErrorMessages[\"WORKER_RUNNER_DELETE_FAILURE\"] = \"Failed to delete recognizer runner!\";\n    ErrorMessages[\"WORKER_OBJECT_INVOKE_FAILURE\"] = \"Failed to invoke object!\";\n    ErrorMessages[\"WORKER_IMAGE_PROCESS_FAILURE\"] = \"Recognizer runner is not initialized! Cannot process image!\";\n    ErrorMessages[\"WORKER_INTEGRATION_INFO_FAILURE\"] = \"Failed to get product integration info!\";\n    ErrorMessages[\"LOCAL_SDK_RUNNER_MISSING\"] = \"Property nativeRecognizerRunner is not available!\";\n    ErrorMessages[\"LOCAL_SDK_RUNNER_EMPTY\"] = \"Native RecognizerRunner cannot be empty!\";\n    ErrorMessages[\"LICENSE_TOKEN_STATE_INCORRECT\"] = \"Internal error (Incorrect token state)\";\n    ErrorMessages[\"LICENSE_PAYLOAD_VERIFICATION_FAILED\"] = \"Failed to verify server permission's digital signature!\";\n    ErrorMessages[\"LICENSE_PAYLOAD_CORRUPTED\"] = \"Server permission payload is corrupted!\";\n    ErrorMessages[\"LICENSE_PERMISSION_EXPIRED\"] = \"Internal error (server permission expired)\";\n    ErrorMessages[\"LICENSE_REMOTE_LOCKED\"] = \"Provided license key has been remotely locked. Please contact support for more information!\";\n    ErrorMessages[\"FRAME_CAPTURE_SVG_UNSUPPORTED\"] = \"Recognition of SVG elements not supported!\";\n    ErrorMessages[\"FRAME_CAPTURE_CANVAS_MISSING\"] = \"Could not get canvas 2d context!\";\n    ErrorMessages[\"SDK_WASM_SETTINGS_MISSING\"] = \"Missing WASM load settings!\";\n    ErrorMessages[\"SDK_LICENSE_KEY_MISSING\"] = \"Missing license key!\";\n    ErrorMessages[\"SDK_WASM_MODULE_NAME_MISSING\"] = \"Missing WASM module name!\";\n    ErrorMessages[\"SDK_ENGINE_LOCATION_INVALID\"] = \"Setting property 'engineLocation' must be a string!\";\n    ErrorMessages[\"SDK_WORKER_LOCATION_INVALID\"] = \"Setting property 'workerLocation' must be a string!\";\n    ErrorMessages[\"SDK_MISSING\"] = \"SDK is not provided!\";\n    ErrorMessages[\"SDK_RECOGNIZERS_MISSING\"] = \"To create RecognizerRunner at least 1 recognizer is required.\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_ELEMENT_MISSING\"] = \"Video element, i.e. camera feed is not provided!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_CAMERA_MISSING\"] = \"Camera not found!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED\"] = \"Camera not allowed!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE\"] = \"Camera not available!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_CAMERA_IN_USE\"] = \"Camera in use!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED\"] = \"Media devices not supported by browser.\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_FEED_RELEASED\"] = \"The associated video feed has been released!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_FEED_NOT_PAUSED\"] = \"The associated video feed is not paused. Use resumeRecognition instead!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED\"] = \"The play() request was interrupted or prevented by browser security rules!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_FEED_PAUSED\"] = \"Cannot resume recognition while video feed is paused! Use recognize or startRecognition\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE\"] = \"Could not reset recognizers!\";\n    ErrorMessages[\"VIDEO_RECOGNIZER_FEED_MISSING\"] = \"Missing video feed!\";\n})(ErrorMessages || (ErrorMessages = {}));\nconst videoRecognizerErrors = {\n    feedMissing: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_FEED_MISSING,\n        code: ErrorCodes.VIDEO_RECOGNIZER_FEED_MISSING,\n    },\n    recognizersResetFailure: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE,\n        code: ErrorCodes.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE,\n    },\n    feedPaused: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_FEED_PAUSED,\n        code: ErrorCodes.VIDEO_RECOGNIZER_FEED_PAUSED,\n    },\n    playRequestInterrupted: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED,\n        code: ErrorCodes.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED,\n    },\n    videoFeedNotPaused: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_FEED_NOT_PAUSED,\n        code: ErrorCodes.VIDEO_RECOGNIZER_FEED_NOT_PAUSED,\n    },\n    videoFeedReleased: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_FEED_RELEASED,\n        code: ErrorCodes.VIDEO_RECOGNIZER_FEED_RELEASED,\n    },\n    mediaDevicesUnsupported: {\n        code: ErrorCodes.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED,\n        message: ErrorMessages.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED,\n    },\n    cameraMissing: {\n        code: ErrorCodes.VIDEO_RECOGNIZER_CAMERA_MISSING,\n        message: ErrorMessages.VIDEO_RECOGNIZER_CAMERA_MISSING,\n    },\n    cameraNotAllowed: {\n        code: ErrorCodes.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED,\n        message: ErrorMessages.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED,\n    },\n    elementMissing: {\n        message: ErrorMessages.VIDEO_RECOGNIZER_ELEMENT_MISSING,\n        code: ErrorCodes.VIDEO_RECOGNIZER_ELEMENT_MISSING,\n    },\n};\nconst sdkErrors = {\n    wasmSettingsMissing: {\n        message: ErrorMessages.SDK_WASM_SETTINGS_MISSING,\n        code: ErrorCodes.SDK_WASM_SETTINGS_MISSING,\n    },\n    licenseKeyMissing: {\n        message: ErrorMessages.SDK_LICENSE_KEY_MISSING,\n        code: ErrorCodes.SDK_LICENSE_KEY_MISSING,\n    },\n    wasmModuleNameMissing: {\n        message: ErrorMessages.SDK_WASM_MODULE_NAME_MISSING,\n        code: ErrorCodes.SDK_WASM_MODULE_NAME_MISSING,\n    },\n    engineLocationInvalid: {\n        message: ErrorMessages.SDK_ENGINE_LOCATION_INVALID,\n        code: ErrorCodes.SDK_ENGINE_LOCATION_INVALID,\n    },\n    workerLocationInvalid: {\n        message: ErrorMessages.SDK_WORKER_LOCATION_INVALID,\n        code: ErrorCodes.SDK_WORKER_LOCATION_INVALID,\n    },\n    missing: {\n        message: ErrorMessages.SDK_MISSING,\n        code: ErrorCodes.SDK_MISSING,\n    },\n    recognizersMissing: {\n        message: ErrorMessages.SDK_RECOGNIZERS_MISSING,\n        code: ErrorCodes.SDK_RECOGNIZERS_MISSING,\n    },\n};\nconst frameCaptureErrors = {\n    svgUnsupported: {\n        message: ErrorMessages.FRAME_CAPTURE_SVG_UNSUPPORTED,\n        code: ErrorCodes.FRAME_CAPTURE_SVG_UNSUPPORTED,\n    },\n    canvasMissing: {\n        message: ErrorMessages.FRAME_CAPTURE_CANVAS_MISSING,\n        code: ErrorCodes.FRAME_CAPTURE_CANVAS_MISSING,\n    },\n};\nconst licenseErrors = {\n    licenseTokenStateIncorrect: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n        message: ErrorMessages.LICENSE_TOKEN_STATE_INCORRECT,\n    },\n    licensePayloadVerificationFailed: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n        message: ErrorMessages.LICENSE_PAYLOAD_VERIFICATION_FAILED,\n    },\n    licensePayloadCorrupted: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n        message: ErrorMessages.LICENSE_PAYLOAD_CORRUPTED,\n    },\n    licensePermissionExpired: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n        message: ErrorMessages.LICENSE_PERMISSION_EXPIRED,\n    },\n    licenseRemoteLocked: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n        message: ErrorMessages.LICENSE_REMOTE_LOCKED,\n    },\n    licenseNetworkError: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n    },\n    licenseInvalid: {\n        code: ErrorCodes.LICENSE_UNLOCK_ERROR,\n    },\n};\nconst localSdkErrors = {\n    runnerMissing: {\n        message: ErrorMessages.LOCAL_SDK_RUNNER_MISSING,\n        code: ErrorCodes.LOCAL_SDK_RUNNER_MISSING,\n    },\n    runnerEmpty: {\n        message: ErrorMessages.LOCAL_SDK_RUNNER_EMPTY,\n        code: ErrorCodes.LOCAL_SDK_RUNNER_EMPTY,\n    },\n};\nconst workerErrors = {\n    imageProcessFailure: {\n        message: ErrorMessages.WORKER_IMAGE_PROCESS_FAILURE,\n        code: ErrorCodes.WORKER_IMAGE_PROCESS_FAILURE,\n    },\n    objectInvokeFailure: {\n        message: ErrorMessages.WORKER_OBJECT_INVOKE_FAILURE,\n        code: ErrorCodes.WORKER_OBJECT_INVOKE_FAILURE,\n    },\n    runnerDeleteFailure: {\n        message: ErrorMessages.WORKER_RUNNER_DELETE_FAILURE,\n        code: ErrorCodes.WORKER_RUNNER_DELETE_FAILURE,\n    },\n    runnerDeleted: {\n        message: ErrorMessages.WORKER_RUNNER_DELETED,\n        code: ErrorCodes.WORKER_RUNNER_DELETED,\n    },\n    runnerReconfigureFailure: {\n        message: ErrorMessages.WORKER_RUNNER_RECONFIGURE_FAILURE,\n        code: ErrorCodes.WORKER_RUNNER_RECONFIGURE_FAILURE,\n    },\n    runnerMissing: {\n        message: ErrorMessages.WORKER_RUNNER_MISSING,\n        code: ErrorCodes.WORKER_RUNNER_MISSING,\n    },\n    runnerCreationFailure: {\n        message: ErrorMessages.WORKER_RUNNER_CREATION_FAILURE,\n        code: ErrorCodes.WORKER_RUNNER_CREATION_FAILURE,\n    },\n    runnerExists: {\n        message: ErrorMessages.WORKER_RUNNER_EXISTS,\n        code: ErrorCodes.WORKER_RUNNER_EXISTS,\n    },\n    recognizerCreationFailure: {\n        message: ErrorMessages.WORKER_RECOGNIZER_CREATION_FAILURE,\n        code: ErrorCodes.WORKER_RECOGNIZER_CREATION_FAILURE,\n    },\n    functionInvokeFailure: {\n        message: ErrorMessages.WORKER_FUNCTION_INVOKE_FAILURE,\n        code: ErrorCodes.WORKER_FUNCTION_INVOKE_FAILURE,\n    },\n    wasmInitMissing: {\n        message: ErrorMessages.WORKER_WASM_INIT_MISSING,\n        code: ErrorCodes.WORKER_WASM_INIT_MISSING,\n    },\n    wasmLoadFailure: {\n        message: ErrorMessages.WORKER_WASM_LOAD_FAILURE,\n        code: ErrorCodes.WORKER_WASM_LOAD_FAILURE,\n    },\n    handleUndefined: {\n        message: ErrorMessages.WORKER_HANDLE_UNDEFINED,\n        code: ErrorCodes.WORKER_HANDLE_UNDEFINED,\n    },\n    integrationInfoFailure: {\n        message: ErrorMessages.WORKER_INTEGRATION_INFO_FAILURE,\n        code: ErrorCodes.WORKER_INTEGRATION_INFO_FAILURE,\n    },\n};\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Preferred type of camera to be used when opening the camera feed.\n */\nvar PreferredCameraType;\n(function (PreferredCameraType) {\n    /** Prefer back facing camera */\n    PreferredCameraType[PreferredCameraType[\"BackFacingCamera\"] = 0] = \"BackFacingCamera\";\n    /** Prefer front facing camera */\n    PreferredCameraType[PreferredCameraType[\"FrontFacingCamera\"] = 1] = \"FrontFacingCamera\";\n})(PreferredCameraType || (PreferredCameraType = {}));\n// inspired by https://unpkg.com/browse/scandit-sdk@4.6.1/src/lib/cameraAccess.ts\nconst backCameraKeywords = [\n    \"rear\",\n    \"back\",\n    \"rck\",\n    \"arrire\",\n    \"trasera\",\n    \"trs\",\n    \"traseira\",\n    \"posteriore\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"arka\",\n    \"achterzijde\",\n    \"\",\n    \"baksidan\",\n    \"bagside\",\n    \"sau\",\n    \"bak\",\n    \"tylny\",\n    \"takakamera\",\n    \"belakang\",\n    \"\",\n    \"\",\n    \"spate\",\n    \"hts\",\n    \"zadn\",\n    \"darrere\",\n    \"zadn\",\n    \"\",\n    \"stranja\",\n    \"belakang\",\n    \"\"\n];\nconst isAndroidDevice = () => {\n    const u = navigator.userAgent;\n    return !!u.match(/Android/i);\n};\nfunction isBackCameraLabel(label) {\n    const lowercaseLabel = label.toLowerCase();\n    return backCameraKeywords.some(keyword => lowercaseLabel.includes(keyword));\n}\nclass SelectedCamera {\n    constructor(mdi, facing, label) {\n        this.deviceId = mdi.deviceId;\n        this.facing = facing;\n        this.groupId = mdi.groupId;\n        // apply custom label\n        if (label) {\n            this.label = label;\n        }\n        else {\n            this.label = mdi.label;\n        }\n    }\n}\nasync function getCameraDevices() {\n    const frontCameras = [];\n    const backCameras = [];\n    let devices = await navigator.mediaDevices.enumerateDevices();\n    // if permission is not given, label of video devices will be empty string\n    if (devices.filter(device => device.kind === \"videoinput\").every(device => device.label === \"\")) {\n        const stream = await navigator.mediaDevices.getUserMedia({\n            video: {\n                facingMode: { ideal: \"environment\" }\n            },\n            audio: false\n        });\n        // enumerate devices again - now the label field should be non-empty, as we have a stream active\n        // (even if we didn't get persistent permission for camera)\n        devices = await navigator.mediaDevices.enumerateDevices();\n        // close the stream, as we don't need it anymore\n        stream.getTracks().forEach(track => track.stop());\n    }\n    const cameras = devices.filter(device => device.kind === \"videoinput\");\n    let backCameraIterator = 0;\n    let frontCameraIterator = 0;\n    for (const camera of cameras) {\n        // phone back camera\n        if (isBackCameraLabel(camera.label)) {\n            backCameraIterator++;\n            let backLabel = undefined;\n            // we apply a custom label on Android devices\n            if (isAndroidDevice()) {\n                backLabel = `Back camera ${backCameraIterator}`;\n            }\n            backCameras.push(new SelectedCamera(camera, PreferredCameraType.BackFacingCamera, backLabel));\n        }\n        else \n        // front camera or non-phone camera\n        {\n            frontCameraIterator++;\n            let frontLabel = undefined;\n            if (isAndroidDevice()) {\n                // we apply a custom label on Android devices\n                frontLabel = `Front camera ${frontCameraIterator}`;\n            }\n            frontCameras.push(new SelectedCamera(camera, PreferredCameraType.FrontFacingCamera, frontLabel));\n        }\n    }\n    return {\n        frontCameras,\n        backCameras\n    };\n}\nasync function selectCamera(cameraId, preferredCameraType) {\n    const { frontCameras, backCameras } = await getCameraDevices();\n    if (!frontCameras.length && !backCameras.length) {\n        return null;\n    }\n    // decide from which array the camera will be selected\n    let cameraPool = (backCameras.length > 0 ? backCameras : frontCameras);\n    // if there is at least one back facing camera and user prefers back facing camera, use that as a selection pool\n    if (preferredCameraType === PreferredCameraType.BackFacingCamera && backCameras.length > 0) {\n        cameraPool = backCameras;\n    }\n    // if there is at least one front facing camera and is preferred by user, use that as a selection pool\n    if (preferredCameraType === PreferredCameraType.FrontFacingCamera && frontCameras.length > 0) {\n        cameraPool = frontCameras;\n    }\n    // otherwise use whichever pool is non-empty\n    // sort camera pool by label\n    cameraPool = cameraPool.sort((camera1, camera2) => camera1.label.localeCompare(camera2.label));\n    // Check if cameras are labeled with resolution information, take the higher-resolution one in that case\n    // Otherwise pick the last camera (Samsung wide on most Android devices)\n    let selectedCameraIndex = cameraPool.length - 1;\n    // on iOS 16.3+, select the virtual dual or triple cameras\n    const iosTripleCameraIndex = cameraPool.findIndex(camera => camera.label === \"Back Triple Camera\");\n    const iosDualCameraIndex = cameraPool.findIndex(camera => camera.label === \"Back Dual Wide Camera\");\n    if (iosDualCameraIndex >= 0) {\n        selectedCameraIndex = iosDualCameraIndex;\n    }\n    if (iosTripleCameraIndex >= 0) {\n        selectedCameraIndex = iosTripleCameraIndex;\n    }\n    // gets camera resolutions from the device name, if exists\n    const cameraResolutions = cameraPool.map(camera => {\n        const regExp = RegExp(/\\b([0-9]+)MP?\\b/, \"i\");\n        const match = regExp.exec(camera.label);\n        if (match !== null) {\n            return parseInt(match[1], 10);\n        }\n        else {\n            return NaN;\n        }\n    });\n    // picks camera  based on highest resolution in the name\n    if (!cameraResolutions.some(cameraResolution => isNaN(cameraResolution))) {\n        selectedCameraIndex = cameraResolutions.lastIndexOf(Math.max(...cameraResolutions));\n    }\n    // picks camera based on the provided device id\n    if (cameraId) {\n        let cameraDevice;\n        cameraDevice = frontCameras.filter(device => device.deviceId === cameraId)[0];\n        if (!cameraDevice) {\n            cameraDevice = backCameras.filter(device => device.deviceId === cameraId)[0];\n        }\n        return cameraDevice || null;\n    }\n    return cameraPool[selectedCameraIndex];\n}\n/**\n * Bind camera device to video feed (HTMLVideoElement).\n *\n * This function will return `true` in case that video feed of camera device has been flipped,\n * and `false` otherwise.\n *\n * @param camera                Camera device which should be binded with the video element.\n * @param videoFeed             HTMLVideoElement to which camera device should be binded.\n * @param preferredCameraType   Enum representing whether to use front facing or back facing camera.\n * @param shouldMaxResolution   Mitigation for iOS\n */\nasync function bindCameraToVideoFeed(camera, videoFeed, preferredCameraType = PreferredCameraType.BackFacingCamera, shouldMaxResolution = false) {\n    const constraints = {\n        audio: false,\n        video: {\n            width: {\n                min: 640,\n                ideal: 1920,\n                max: 1920,\n            },\n            height: {\n                min: 480,\n                ideal: 1080,\n                max: 1080\n            }\n        }\n    };\n    if (camera.deviceId === \"\") {\n        const isPreferredBackFacing = preferredCameraType === PreferredCameraType.BackFacingCamera;\n        constraints.video.facingMode =\n            {\n                ideal: isPreferredBackFacing ? \"environment\" : \"user\"\n            };\n    }\n    else {\n        constraints.video.deviceId =\n            {\n                exact: camera.deviceId\n            };\n    }\n    const stream = await navigator.mediaDevices.getUserMedia(constraints);\n    videoFeed.controls = false;\n    videoFeed.srcObject = stream;\n    let cameraFlipped = false;\n    if (camera.facing === PreferredCameraType.FrontFacingCamera) {\n        cameraFlipped = true;\n    }\n    if (shouldMaxResolution) {\n        const tracks = stream.getVideoTracks();\n        const track = tracks[0];\n        const capabilities = track.getCapabilities();\n        void track.applyConstraints({\n            width: capabilities.width?.max,\n            height: capabilities.height?.max\n        });\n    }\n    return cameraFlipped;\n}\nfunction getiOSVersion() {\n    const match = navigator.userAgent.match(/OS (\\d+)_(\\d+)_?(\\d+)?/);\n    if (match) {\n        const majorVersion = parseInt(match[1], 10);\n        const minorVersion = parseInt(match[2], 10);\n        return [majorVersion, minorVersion];\n    }\n    return null;\n}\n// iOS versions 16.3 and higher allow access to all cameras\nfunction isCameraFocusProblematic() {\n    const iosVersion = getiOSVersion();\n    // iOS version equal or higher to 16.3\n    if (iosVersion && iosVersion[0] >= 16 && iosVersion[1] >= 3) {\n        return true;\n    }\n    // not iOS, devices with iOS version 16.2 or lower\n    return false;\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n// ============================================ /\n// DATA STRUCTURES                              /\n// ============================================ /\n/**\n * Specifies the orientation of the contents of the image.\n * This is important for some recognizers, especially when\n * performing recognition on the mobile device.\n */\nvar ImageOrientation;\n(function (ImageOrientation) {\n    /**\n     * Image contents are rotated 90 degrees left.\n     * This usually happens on mobile devices when capturing image while\n     * device is held in \"portrait\" orientation, while device camera sensor\n     * is mounted horizontally (i.e. produced image is in \"landscape\" orienation).\n     */\n    ImageOrientation[ImageOrientation[\"RotatedLeft90\"] = 0] = \"RotatedLeft90\";\n    /**\n     * Image contents are not rotated in any manner.\n     * This is the default for images captured using HTML canvas, as\n     * used in FrameCapture class.\n     * This orientation also usually happens on mobile devices when capturing\n     * image while device is held in \"landscape\" orientation, while device\n     * camera sensor is mounted horizontally (i.e. also in same orientation).\n     */\n    ImageOrientation[ImageOrientation[\"NoRotation\"] = 1] = \"NoRotation\";\n    /**\n     * Image contents are rotated 90 degrees right.\n     * This usually happens on mobile devices when capturing image while\n     * device is held in \"reverse-portrait\" orientation, while device camera sensor\n     * is mounted horizontally (i.e. produced image is in \"landscape\" orienation).\n     */\n    ImageOrientation[ImageOrientation[\"RotatedRight90\"] = 2] = \"RotatedRight90\";\n    /**\n     * Image contents are rotated 180 degrees, i.e. image contents are \"upside down\".\n     * This usually happens on mobile devices when capturing image while\n     * device is held in \"reverse-landscape\" orientation, while device camera sensor\n     * is mounted horizontally (i.e. produced image is in \"landscape\" orienation).\n     */\n    ImageOrientation[ImageOrientation[\"Rotated180\"] = 3] = \"Rotated180\";\n})(ImageOrientation || (ImageOrientation = {}));\n/**\n * Specifies the state of the recognition result.\n */\nvar RecognizerResultState;\n(function (RecognizerResultState) {\n    /** Nothing has been recognized. */\n    RecognizerResultState[RecognizerResultState[\"Empty\"] = 0] = \"Empty\";\n    /** Something has been recognized, but some mandatory data is still missing. */\n    RecognizerResultState[RecognizerResultState[\"Uncertain\"] = 1] = \"Uncertain\";\n    /** All required data has been recognized. */\n    RecognizerResultState[RecognizerResultState[\"Valid\"] = 2] = \"Valid\";\n    /** Single stage of a multi-stage recognition is finished. */\n    RecognizerResultState[RecognizerResultState[\"StageValid\"] = 3] = \"StageValid\";\n})(RecognizerResultState || (RecognizerResultState = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * The side of the document.\n */\nvar DocumentSide;\n(function (DocumentSide) {\n    DocumentSide[DocumentSide[\"Front\"] = 0] = \"Front\";\n    DocumentSide[DocumentSide[\"Back\"] = 1] = \"Back\";\n})(DocumentSide || (DocumentSide = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Checks if browser is supported by the SDK. The minimum requirements for the browser is\n * the support for WebAssembly. If your browser does not support executing WebAssembly,\n * this function will return `false`.\n */\nfunction isBrowserSupported() {\n    // based on https://stackoverflow.com/a/47880734\n    try {\n        if (typeof WebAssembly === \"object\" && typeof WebAssembly.instantiate === \"function\") {\n            const module = new WebAssembly.Module(Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00));\n            if (module instanceof WebAssembly.Module)\n                return new WebAssembly.Instance(module) instanceof WebAssembly.Instance;\n        }\n    }\n    catch (ignored) {\n        return false;\n    }\n    return false;\n}\n/**\n * Check if current browser is in-app / embedded.\n * Detects Instagram, Facebook, LinkedIn, Twitter, WeChat, Whatsapp, and Tiktok.\n * @returns Boolean whether the browser is in-app or not\n */\nfunction isInAppBrowser() {\n    const inAppRegex = /(instagram|fbav|linkedinapp|twitter|micromessenger|whatsapp|tiktok)[/\\s]?([\\w.]*)/i;\n    const userAgent = navigator.userAgent || navigator.vendor;\n    return !!inAppRegex.exec(userAgent);\n}\n/**\n * Check if browser supports ES6, which is prerequisite for this SDK to execute.\n *\n * IMPORTANT: it's not possible to run this function from MicroblinkSDK if browser doesn't support\n * ES6 since this file won't be able to load.\n *\n * This function is here as a placeholder so it can be copied to standalone JS file or directly into 'index.html'.\n */\n// export function isES6Supported(): boolean\n// {\n//     if ( typeof Symbol === \"undefined\" )\n//     {\n//         return false;\n//     }\n//     try\n//     {\n//         eval( \"class Foo {}\" );\n//         eval( \"var bar = (x) => x+1\" );\n//     }\n//     catch ( e )\n//     {\n//         return false;\n//     }\n//     return true;\n// }\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n// ============================================ /\n// Frame capture and camera management support. /\n// ============================================ /\nlet canvas;\nlet ctx;\n/**\n * Represents a captured frame from HTMLVideoElement.\n */\nclass CapturedFrame {\n    constructor(imageData, orientation, videoFrame) {\n        // workaround for memory leak: https://github.com/ivancuric/memory-leak-repro\n        const fakeImageData = {\n            data: imageData.data,\n            width: imageData.width,\n            height: imageData.height,\n            colorSpace: imageData.colorSpace,\n        };\n        this.imageData = fakeImageData;\n        this.orientation = orientation;\n        this.videoFrame = videoFrame;\n    }\n}\n/**\n * Captures a frame from any CanvasImageSource, such as HTMLVideoElement or HTMLImageElement.\n * @param imageSource image source from which frame should be captured\n * @returns instance of CapturedFrame\n */\nfunction captureFrame(imageSource, shouldCrop = false) {\n    let imageWidth;\n    let imageHeight;\n    let videoFrame = false;\n    if (imageSource instanceof HTMLVideoElement) {\n        imageWidth = imageSource.videoWidth;\n        imageHeight = imageSource.videoHeight;\n        videoFrame = true;\n    }\n    else if (imageSource instanceof HTMLImageElement) {\n        imageWidth = imageSource.naturalWidth;\n        imageHeight = imageSource.naturalHeight;\n    }\n    else if (imageSource instanceof SVGImageElement) {\n        throw new SDKError(frameCaptureErrors.svgUnsupported);\n    }\n    else {\n        imageWidth = imageSource.width;\n        imageHeight = imageSource.height;\n    }\n    canvas = canvas || document.createElement(\"canvas\");\n    if (canvas.width !== imageWidth && canvas.height !== imageHeight) {\n        canvas.width = imageWidth;\n        canvas.height = imageHeight;\n    }\n    ctx = ctx || canvas.getContext(\"2d\", { willReadFrequently: true,\n        alpha: false });\n    if (!ctx) {\n        throw new SDKError(frameCaptureErrors.canvasMissing);\n    }\n    ctx.drawImage(imageSource, 0, 0, canvas.width, canvas.height);\n    /**\n     * Take full image or cropped image based on focus problems.\n     *\n     * iPhone 14 Pro has focus problems, i.e. user should place a document somehow\n     * far away from the camera to get the proper focus.\n     *\n     * In that case we're getting much bigger images (4K), and we're cropping the center\n     * of the image which is then sent to processing - rectangle that is 66% size of the\n     * original image is cropped from the image center.\n     */\n    const cropFactor = shouldCrop ? 0.66 : 1;\n    const targetWidth = canvas.width * cropFactor;\n    const targetHeight = canvas.height * cropFactor;\n    const targetX = (canvas.width - targetWidth) / 2;\n    const targetY = (canvas.height - targetHeight) / 2;\n    const pixelData = ctx.getImageData(targetX, targetY, targetWidth, targetHeight);\n    return new CapturedFrame(pixelData, \n    // TODO: https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation\n    // or https://developer.mozilla.org/en-US/docs/Web/API/Window/orientation\n    ImageOrientation.NoRotation, videoFrame);\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\nvar LicenseTokenState;\n(function (LicenseTokenState) {\n    LicenseTokenState[LicenseTokenState[\"Invalid\"] = 0] = \"Invalid\";\n    LicenseTokenState[LicenseTokenState[\"RequiresServerPermission\"] = 1] = \"RequiresServerPermission\";\n    LicenseTokenState[LicenseTokenState[\"Valid\"] = 2] = \"Valid\";\n})(LicenseTokenState || (LicenseTokenState = {}));\nvar LicenseErrorType;\n(function (LicenseErrorType) {\n    LicenseErrorType[\"LicenseTokenStateInvalid\"] = \"LICENSE_TOKEN_STATE_INVALID\";\n    LicenseErrorType[\"NetworkError\"] = \"NETWORK_ERROR\";\n    LicenseErrorType[\"RemoteLock\"] = \"REMOTE_LOCK\";\n    LicenseErrorType[\"PermissionExpired\"] = \"PERMISSION_EXPIRED\";\n    LicenseErrorType[\"PayloadCorrupted\"] = \"PAYLOAD_CORRUPTED\";\n    LicenseErrorType[\"PayloadSignatureVerificationFailed\"] = \"PAYLOAD_SIGNATURE_VERIFICATION_FAILED\";\n    LicenseErrorType[\"IncorrectTokenState\"] = \"INCORRECT_TOKEN_STATE\";\n})(LicenseErrorType || (LicenseErrorType = {}));\nconst baltazar = \"https://baltazar.microblink.com/api/v1/status/check\";\nfunction toBaltazarRequest(unlockResult) {\n    return {\n        licenseId: unlockResult.licenseId,\n        licensee: unlockResult.applicationId,\n        packageName: unlockResult.packageName,\n        platform: \"Browser\",\n        sdkName: unlockResult.sdkName,\n        sdkVersion: unlockResult.sdkVersion\n    };\n}\nfunction shouldShowOverlay(isTrial, allowRemoveDemoOverlay, allowRemoveProductionOverlay) {\n    if (isTrial && allowRemoveDemoOverlay) {\n        return false;\n    }\n    if (!isTrial && allowRemoveProductionOverlay) {\n        return false;\n    }\n    return true;\n}\nvar ServerPermissionSubmitResultStatus;\n(function (ServerPermissionSubmitResultStatus) {\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"Ok\"] = 0] = \"Ok\";\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"NetworkError\"] = 1] = \"NetworkError\";\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"RemoteLock\"] = 2] = \"RemoteLock\";\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"PermissionExpired\"] = 3] = \"PermissionExpired\";\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"PayloadCorrupted\"] = 4] = \"PayloadCorrupted\";\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"PayloadSignatureVerificationFailed\"] = 5] = \"PayloadSignatureVerificationFailed\";\n    ServerPermissionSubmitResultStatus[ServerPermissionSubmitResultStatus[\"IncorrectTokenState\"] = 6] = \"IncorrectTokenState\";\n})(ServerPermissionSubmitResultStatus || (ServerPermissionSubmitResultStatus = {}));\n/* eslint-disable @typescript-eslint/no-explicit-any,\n                  @typescript-eslint/explicit-module-boundary-types,\n                  @typescript-eslint/no-unsafe-member-access,\n                  @typescript-eslint/no-unsafe-call\n*/\nasync function obtainNewServerPermission(unlockResult, wasmModule) {\n    // request permission from Baltazar service\n    try {\n        const response = await fetch(baltazar, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            cache: \"no-cache\",\n            body: JSON.stringify(toBaltazarRequest(unlockResult))\n        });\n        if (response.ok) {\n            const serverPermission = (await response.text()).toString();\n            const result = wasmModule.submitServerPermission(serverPermission);\n            return result;\n        }\n        else {\n            return {\n                status: ServerPermissionSubmitResultStatus.NetworkError,\n                lease: 0,\n                networkErrorDescription: `Server responded with status ${response.status}`\n            };\n        }\n    }\n    catch (error) {\n        return {\n            status: ServerPermissionSubmitResultStatus.NetworkError,\n            lease: 0,\n            networkErrorDescription: `Unexpected error: ${JSON.stringify(error)}`\n        };\n    }\n}\nasync function unlockWasmSDK(licenseKey, allowHelloMessage, userId, wasmModule) {\n    const unlockResult = wasmModule.initializeWithLicenseKey(licenseKey, userId, allowHelloMessage);\n    switch (unlockResult.unlockResult) {\n        case LicenseTokenState.Invalid:\n            return {\n                error: new SDKError({\n                    ...licenseErrors.licenseInvalid,\n                    message: unlockResult.licenseError\n                }, {\n                    type: LicenseErrorType.LicenseTokenStateInvalid,\n                }),\n            };\n        case LicenseTokenState.Valid:\n            return {\n                error: null,\n                showOverlay: shouldShowOverlay(unlockResult.isTrial, unlockResult.allowRemoveDemoOverlay, unlockResult.allowRemoveProductionOverlay)\n            };\n        case LicenseTokenState.RequiresServerPermission:\n            {\n                const serverPermission = await obtainNewServerPermission(unlockResult, wasmModule);\n                switch (serverPermission.status) {\n                    case ServerPermissionSubmitResultStatus.Ok:\n                        return {\n                            error: null,\n                            lease: serverPermission.lease\n                        };\n                    case ServerPermissionSubmitResultStatus.NetworkError:\n                        {\n                            let additionalInfo = \"\";\n                            if (serverPermission.networkErrorDescription) {\n                                additionalInfo = \" \" + serverPermission.networkErrorDescription;\n                            }\n                            return {\n                                error: new SDKError({\n                                    ...licenseErrors.licenseNetworkError,\n                                    message: \"There has been a network error while obtaining the server permission!\"\n                                        + additionalInfo\n                                }, {\n                                    type: LicenseErrorType.NetworkError,\n                                })\n                            };\n                        }\n                    case ServerPermissionSubmitResultStatus.RemoteLock:\n                        return {\n                            error: new SDKError(licenseErrors.licenseRemoteLocked, {\n                                type: LicenseErrorType.RemoteLock,\n                            }),\n                            lease: serverPermission.lease\n                        };\n                    case ServerPermissionSubmitResultStatus.PermissionExpired:\n                        return {\n                            error: new SDKError(licenseErrors.licensePermissionExpired, {\n                                type: LicenseErrorType.PermissionExpired\n                            }),\n                            lease: serverPermission.lease\n                        };\n                    case ServerPermissionSubmitResultStatus.PayloadCorrupted:\n                        return {\n                            error: new SDKError(licenseErrors.licensePayloadCorrupted, {\n                                type: LicenseErrorType.PayloadCorrupted\n                            }),\n                            lease: serverPermission.lease\n                        };\n                    case ServerPermissionSubmitResultStatus.PayloadSignatureVerificationFailed:\n                        return {\n                            error: new SDKError(licenseErrors.licensePayloadVerificationFailed, {\n                                type: LicenseErrorType.PayloadSignatureVerificationFailed\n                            }),\n                            lease: serverPermission.lease\n                        };\n                    case ServerPermissionSubmitResultStatus.IncorrectTokenState:\n                        return {\n                            error: new SDKError(licenseErrors.licenseTokenStateIncorrect, {\n                                type: LicenseErrorType.IncorrectTokenState\n                            }),\n                            lease: serverPermission.lease\n                        };\n                }\n            }\n    }\n}\n/* eslint-enable @typescript-eslint/no-explicit-any,\n                 @typescript-eslint/explicit-module-boundary-types,\n                 @typescript-eslint/no-unsafe-member-access,\n                 @typescript-eslint/no-unsafe-call\n*/\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Detection status of the specific detected object.\n */\nvar DetectionStatus;\n(function (DetectionStatus) {\n    /** Detection has failed. */\n    DetectionStatus[DetectionStatus[\"Failed\"] = 0] = \"Failed\";\n    /** Document has been detected. */\n    DetectionStatus[DetectionStatus[\"Success\"] = 1] = \"Success\";\n    /** Document has been detected but the camera is too far from the document. */\n    DetectionStatus[DetectionStatus[\"CameraTooFar\"] = 2] = \"CameraTooFar\";\n    /** Document has been detected but the camera is too close to the document. */\n    DetectionStatus[DetectionStatus[\"CameraTooClose\"] = 3] = \"CameraTooClose\";\n    /** Document has been detected but the cameras angle is too steep. */\n    DetectionStatus[DetectionStatus[\"CameraAngleTooSteep\"] = 4] = \"CameraAngleTooSteep\";\n    /** Document has been detected but the document is too close to the camera edge. */\n    DetectionStatus[DetectionStatus[\"DocumentTooCloseToCameraEdge\"] = 5] = \"DocumentTooCloseToCameraEdge\";\n    /** Only part of the document is visible. */\n    DetectionStatus[DetectionStatus[\"DocumentPartiallyVisible\"] = 6] = \"DocumentPartiallyVisible\";\n    /** Fallback detection was successful (PhotoPay specific). */\n    DetectionStatus[DetectionStatus[\"FallbackSuccess\"] = 7] = \"FallbackSuccess\";\n})(DetectionStatus || (DetectionStatus = {}));\n\nclass AbortError extends Error {\n  constructor() {\n    super('Throttled function aborted');\n    this.name = 'AbortError';\n  }\n}\nfunction pThrottle({\n  limit,\n  interval,\n  strict\n}) {\n  if (!Number.isFinite(limit)) {\n    throw new TypeError('Expected `limit` to be a finite number');\n  }\n  if (!Number.isFinite(interval)) {\n    throw new TypeError('Expected `interval` to be a finite number');\n  }\n  const queue = new Map();\n  let currentTick = 0;\n  let activeCount = 0;\n  function windowedDelay() {\n    const now = Date.now();\n    if (now - currentTick > interval) {\n      activeCount = 1;\n      currentTick = now;\n      return 0;\n    }\n    if (activeCount < limit) {\n      activeCount++;\n    } else {\n      currentTick += interval;\n      activeCount = 1;\n    }\n    return currentTick - now;\n  }\n  const strictTicks = [];\n  function strictDelay() {\n    const now = Date.now();\n    if (strictTicks.length < limit) {\n      strictTicks.push(now);\n      return 0;\n    }\n    const earliestTime = strictTicks.shift() + interval;\n    if (now >= earliestTime) {\n      strictTicks.push(now);\n      return 0;\n    }\n    strictTicks.push(earliestTime);\n    return earliestTime - now;\n  }\n  const getDelay = strict ? strictDelay : windowedDelay;\n  return function_ => {\n    const throttled = function (...args) {\n      if (!throttled.isEnabled) {\n        return (async () => function_.apply(this, args))();\n      }\n      let timeout;\n      return new Promise((resolve, reject) => {\n        const execute = () => {\n          resolve(function_.apply(this, args));\n          queue.delete(timeout);\n        };\n        timeout = setTimeout(execute, getDelay());\n        queue.set(timeout, reject);\n      });\n    };\n    throttled.abort = () => {\n      for (const timeout of queue.keys()) {\n        clearTimeout(timeout);\n        queue.get(timeout)(new AbortError());\n      }\n      queue.clear();\n      strictTicks.splice(0, strictTicks.length);\n    };\n    throttled.isEnabled = true;\n    Object.defineProperty(throttled, 'queueSize', {\n      get() {\n        return queue.size;\n      }\n    });\n    return throttled;\n  };\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\nconst TARGET_FPS = 15;\nconst throttle = pThrottle({\n    limit: 1,\n    interval: Math.round(1 / TARGET_FPS * 1000),\n    strict: true\n});\n/**\n * Indicates mode of recognition in `VideoRecognizer`.\n */\nvar VideoRecognitionMode;\n(function (VideoRecognitionMode) {\n    /** Normal recognition */\n    VideoRecognitionMode[VideoRecognitionMode[\"Recognition\"] = 0] = \"Recognition\";\n    /** Indefinite scan. Useful for profiling the performance of scan (using `onDebugText` metadata callback) */\n    VideoRecognitionMode[VideoRecognitionMode[\"RecognitionTest\"] = 1] = \"RecognitionTest\";\n    /** Only detection. Useful for profiling the performance of detection (using `onDebugText` metadata callback) */\n    VideoRecognitionMode[VideoRecognitionMode[\"DetectionTest\"] = 2] = \"DetectionTest\";\n})(VideoRecognitionMode || (VideoRecognitionMode = {}));\n/**\n * A wrapper around `RecognizerRunner` that can use it to perform recognition of\n * video feeds - either from live camera or from predefined video file.\n */\nclass VideoRecognizer {\n    /**\n     * **Use only if provided factory functions are not well-suited for your use\n     * case.**\n     *\n     * Creates a new `VideoRecognizer` with provided `HTMLVideoElement`.\n     *\n     * Keep in mind that `HTMLVideoElement` **must have** a video feed which is\n     * ready to use.\n     *\n     * - If you want to take advantage of provided camera management, use\n     *   `createVideoRecognizerFromCameraStream`\n     * - In case that static video file should be processed, use\n     *   `createVideoRecognizerFromVideoPath`\n     *\n     * @param videoElement HTMLVideoElement with video feed which is going to be\n     * processed\n     * @param recognizerRunner RecognizerRunner that should be used for video\n     * stream recognition\n     * @param cameraFlipped Whether the camera is flipped, e.g. if front-facing\n     * camera is used\n     * @param deviceId\n     */\n    constructor(videoElement, recognizerRunner, cameraFlipped = false, deviceId = null) {\n        this.deviceId = null;\n        this.recognitionCancelRequested = false;\n        this.recognitionPauseRequested = false;\n        this.recognitionTimeoutMs = 20000;\n        this.timeoutStartedAt = 0;\n        this.currentTimeoutCount = 0;\n        this.videoRecognitionMode = VideoRecognitionMode.Recognition;\n        this.onScanningDone = null;\n        this.cameraFlipped = false;\n        this.isProblematicFocus = false;\n        this.handleFlippingVideo = async () => {\n            let scaleX = 1;\n            let scaleY = 1;\n            if (this.isProblematicFocus) {\n                scaleY = 1.5;\n                scaleX = 1.5;\n            }\n            else {\n                scaleY = 1;\n                scaleX = 1;\n            }\n            if (this.cameraFlipped) {\n                scaleX = -scaleX;\n            }\n            this.videoElement.style.transform = `scale(${scaleX}, ${scaleY})`;\n            // evaluate negative scale as true, positive as false\n            await this.recognizerRunner.setCameraPreviewMirrored(scaleX < 0);\n        };\n        this.flipCamera = async () => {\n            this.cameraFlipped = !this.cameraFlipped;\n            await this.handleFlippingVideo();\n        };\n        this.isCameraFlipped = () => {\n            return this.cameraFlipped;\n        };\n        /**\n         * Sets the video recognition mode to be used.\n         */\n        this.setVideoRecognitionMode = async (videoRecognitionMode) => {\n            this.videoRecognitionMode = videoRecognitionMode;\n            const isDetectionMode = this.videoRecognitionMode === VideoRecognitionMode.DetectionTest;\n            await this.recognizerRunner.setDetectionOnlyMode(isDetectionMode);\n        };\n        /**\n         * Starts the recognition of the video stream associated with this\n         * `VideoRecognizer`. The stream will be unpaused and recognition loop will\n         * start. After recognition completes, an `onScanningDone` callback will be\n         * invoked with state of the recognition.\n         *\n         * NOTE: As soon as the execution of the callback completes, the recognition\n         *       loop will continue and recognition state will be retained. To clear\n         *       the recognition state, use {@linkcode resetRecognizers} (within your\n         *       callback). To pause the recognition loop, use\n         *       {@linkcode pauseRecognition} (within your callback) - to resume it\n         *       later use {@linkcode resumeRecognition}. To completely stop the\n         *       recognition and video feed, while keeping the ability to use this\n         *       `VideoRecognizer` later, use {@linkcode pauseVideoFeed}. To\n         *       completely stop the recognition and video feed and release all the\n         *       resources involved with the video stream, use\n         *       {@linkcode releaseVideoFeed}.\n         *\n         * @param onScanningDone Callback that will be invoked when recognition\n         * completes.\n         * @param recognitionTimeoutMs Amount of time in ms that the recognizer will\n         * stay in the `Uncertain` state before resolving.\n         */\n        this.startRecognition = async (onScanningDone, recognitionTimeoutMs = 20000) => {\n            try {\n                await this.videoElement.play();\n            }\n            catch (error) {\n                throw new Error(ErrorMessages.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED);\n            }\n            // Following 2 lines might not be needed. Just in case left here.\n            this.recognitionPauseRequested = false;\n            this.recognitionCancelRequested = false;\n            this.clearTimeout();\n            this.recognitionTimeoutMs = recognitionTimeoutMs;\n            this.onScanningDone = onScanningDone;\n            await this.throttledQueueFrame();\n        };\n        /**\n         * Resumes the recognition and video playback\n         * @param resetRecognizers Indicates whether resetRecognizers should be\n         * invoked while resuming the recognition\n         */\n        this.resumeRecognition = async (resetRecognizers) => {\n            if (resetRecognizers) {\n                try {\n                    await this.resetRecognizers(true);\n                }\n                catch (error) {\n                    throw new SDKError(videoRecognizerErrors.recognizersResetFailure);\n                }\n            }\n            try {\n                await this.videoElement.play();\n            }\n            catch (error) {\n                throw new Error(ErrorMessages.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED);\n            }\n            try {\n                this.recognitionPauseRequested = false;\n                await this.throttledQueueFrame();\n            }\n            catch (error) {\n                this.recognitionPauseRequested = true;\n                console.error(error);\n            }\n        };\n        /**\n         * Performs the recognition of the video stream associated with this\n         * `VideoRecognizer`. The stream will be unpaused, recognition will be\n         * performed and promise will be resolved with recognition status. After the\n         * resolution of returned promise, the video stream will be paused, but not\n         * released. To release the stream, use function `releaseVideoFeed`.\n         *\n         * This is a simple version of {@linkcode startRecognition} that should be\n         * used for most cases, like when you only need to perform one scan per video\n         * session.\n         *\n         * @param recognitionTimeoutMs Amount of time in ms that the recognizer will\n         * stay in the `Uncertain` state before resolving.\n         */\n        this.recognize = (recognitionTimeoutMs = 20000) => {\n            return new Promise((resolve) => {\n                const onScanningDone = (recognitionState) => {\n                    this.pauseVideoFeed();\n                    resolve(recognitionState);\n                };\n                void this.startRecognition(onScanningDone, recognitionTimeoutMs);\n            });\n        };\n        /**\n         * Pauses the video feed. You can resume the feed by calling recognize or\n         * `startRecognition`. Note that this pauses both the camera feed and\n         * recognition. If you just want to pause recognition, while keeping the\n         * camera feed active, call method `pauseRecognition`.\n         */\n        this.pauseVideoFeed = () => {\n            // fix for https://developer.chrome.com/blog/play-request-was-interrupted/\n            if (this.videoElement.readyState > this.videoElement.HAVE_CURRENT_DATA && !this.videoElement.paused) {\n                this.videoElement.pause();\n                this.pauseRecognition();\n            }\n        };\n        /**\n         * Pauses the recognition. This means that video frames that arrive from given\n         * video source will not be recognized. To resume recognition, call\n         * {@linkcode resumeRecognition}.\n         */\n        this.pauseRecognition = () => {\n            this.recognitionPauseRequested = true;\n        };\n        /**\n         * Cancels current ongoing recognition. Unlike {@linkcode pauseRecognition} this will reset everything\n         */\n        this.cancelRecognition = () => {\n            this.recognitionCancelRequested = true;\n        };\n        /**\n         * Convenience method for invoking\n         * {@linkcode RecognizerRunner.resetRecognizers} on associated\n         * `RecognizerRunner`.\n         */\n        this.resetRecognizers = async (hardReset) => {\n            await this.recognizerRunner.resetRecognizers(hardReset);\n        };\n        /**\n         * Convenience method for accessing `RecognizerRunner` associated with this\n         * `VideoRecognizer`. Sometimes it's useful to reconfigure `RecognizerRunner`\n         * while handling `onScanningDone` callback and this method makes that much\n         * more convenient.\n         */\n        this.getRecognizerRunner = () => {\n            return this.recognizerRunner;\n        };\n        /**\n         * Getter for {@linkcode videoElement}\n         */\n        this.getVideoElement = () => {\n            return this.videoElement;\n        };\n        /**\n         * Change currently used camera device for recognition. To get list of\n         * available camera devices use `getCameraDevices` method.\n         *\n         * Keep in mind that this method will reset recognizers.\n         *\n         * @param camera Desired camera device which should be used for recognition.\n         */\n        this.changeCameraDevice = async (camera) => {\n            this.pauseRecognition();\n            this.releaseVideoFeed();\n            await bindCameraToVideoFeed(camera, this.videoElement, PreferredCameraType.BackFacingCamera, this.isProblematicFocus);\n            await this.resumeRecognition(true);\n        };\n        /**\n         * Shorthand for queuing the next frame for processing. Wrapper around\n         * {@linkcode recognitionLoop}. Resolves when the frame is done processing.\n         */\n        this.queueFrame = () => {\n            // promisify `requestVideoFrameCallback` so that we know when it triggers\n            return new Promise((resolve) => {\n                this.frameCallback(() => {\n                    void this.recognitionLoop().then(() => resolve());\n                });\n            });\n        };\n        this.throttledQueueFrame = throttle(this.queueFrame);\n        /**\n         * The main loop. Takes camera frames from {@linkcode videoElement} and\n         * processes them on the `recognizerRunner`.\n         */\n        this.recognitionLoop = async () => {\n            // exit without side-effects when paused\n            if (this.recognitionPauseRequested) {\n                return;\n            }\n            // if cancelled exit and reset `VideoRecognizer` state\n            if (this.recognitionCancelRequested) {\n                this.clearTimeout();\n                await this.resetRecognizers(true);\n                this.onScanningDone = null;\n                this.recognitionCancelRequested = false;\n                return;\n            }\n            /*\n            Start processing.\n    \n            At this point we draw the canvas frames, extract the ImageData` and send it\n            to the `RecognizerRunner`. The main thread and the worker thread should be\n            treated as blocked.\n            */\n            const cameraFrame = captureFrame(this.videoElement, this.isProblematicFocus);\n            // queue everything below in a macrotask\n            await new Promise(f => setTimeout(f, 0));\n            const processResult = await this.recognizerRunner.processImage(cameraFrame);\n            // End processing\n            // Test mode resets recognizers on every tick and never times out\n            if (this.videoRecognitionMode === VideoRecognitionMode.DetectionTest ||\n                this.videoRecognitionMode === VideoRecognitionMode.RecognitionTest) {\n                await this.recognizerRunner.resetRecognizers(true);\n                this.clearTimeout();\n                void this.throttledQueueFrame();\n                return;\n            }\n            // regular flow\n            switch (processResult) {\n                // `Valid` stops loop and calls `onScanningDone`\n                case RecognizerResultState.Valid: {\n                    this.clearTimeout();\n                    if (typeof this.onScanningDone === \"function\") {\n                        this.onScanningDone(processResult);\n                    }\n                    return;\n                }\n                // `Uncertain` resolves after a timeout, loops otherwise\n                case RecognizerResultState.Uncertain: {\n                    // increment timeout\n                    const now = performance.now();\n                    if (this.timeoutStartedAt === 0) {\n                        this.timeoutStartedAt = now;\n                    }\n                    this.currentTimeoutCount = now - this.timeoutStartedAt;\n                    // if under timeout continue looping\n                    if (this.currentTimeoutCount < this.recognitionTimeoutMs) {\n                        void this.throttledQueueFrame();\n                        return;\n                    }\n                    // otherwise stop as `Uncertain`\n                    this.clearTimeout();\n                    if (typeof this.onScanningDone === \"function\") {\n                        this.onScanningDone(processResult);\n                    }\n                    return;\n                }\n                // `StageValid` and `Empty` loop forever\n                case RecognizerResultState.StageValid:\n                case RecognizerResultState.Empty: {\n                    this.clearTimeout();\n                    void this.throttledQueueFrame();\n                    return;\n                }\n            }\n        };\n        /**\n         * Clear timeout on every loop which didn't result in `RecognizerResultState.Uncertain`\n         */\n        this.clearTimeout = () => {\n            this.currentTimeoutCount = 0;\n            this.timeoutStartedAt = 0;\n        };\n        /**\n         * Stops all media stream tracks associated with {@linkcode videoElement}.\n         */\n        this.releaseVideoFeed = () => {\n            if (this.videoElement &&\n                this.videoElement.srcObject !== null &&\n                this.videoElement.srcObject instanceof MediaStream) {\n                this.videoElement.srcObject.getTracks().forEach((track) => track.stop());\n                this.videoElement.srcObject = null;\n            }\n        };\n        this.videoElement = videoElement;\n        this.recognizerRunner = recognizerRunner;\n        this.cameraFlipped = cameraFlipped;\n        this.deviceId = deviceId;\n        this.isProblematicFocus = isCameraFocusProblematic();\n        if (\"requestVideoFrameCallback\" in HTMLVideoElement.prototype) {\n            this.frameCallback = this.videoElement.requestVideoFrameCallback.bind(this.videoElement);\n        }\n        else {\n            this.frameCallback = window.requestAnimationFrame.bind(window);\n        }\n        void this.handleFlippingVideo();\n        // Prepare the `video` element so that it can autoplay on iOS\n        // https://webkit.org/blog/7734/auto-play-policy-changes-for-macos/\n        // https://developer.mozilla.org/en-US/docs/Web/Media/Autoplay_guide#autoplay_availability\n        this.videoElement.setAttribute(\"playsinline\", \"\");\n        this.videoElement.setAttribute(\"mute\", \"\");\n    }\n    /**\n     * Creates a new VideoRecognizer by opening a camera stream and attaching it\n     * to given `HTMLVideoElement`. If camera cannot be accessed, the returned\n     * promise will be rejected.\n     *\n     * @param cameraFeed `HTMLVideoElement` to which camera stream should be\n     * attached\n     * @param recognizerRunner `RecognizerRunner` that should be used for video\n     * stream recognition\n     * @param cameraId User can provide specific camera ID to be selected and used\n     * @param preferredCameraType Whether back facing or front facing camera is\n     *        preferred. Obeyed only if there is a choice (i.e. if device has only\n     *        front-facing camera, the opened camera will be a front-facing\n     *        camera, regardless of preference)\n     */\n    static async createVideoRecognizerFromCameraStream(cameraFeed, recognizerRunner, cameraId = null, preferredCameraType = PreferredCameraType.BackFacingCamera) {\n        if (!cameraFeed || !(cameraFeed instanceof HTMLVideoElement)) {\n            throw new SDKError(videoRecognizerErrors.elementMissing);\n        }\n        if (!navigator.mediaDevices.getUserMedia) {\n            throw new SDKError(videoRecognizerErrors.mediaDevicesUnsupported);\n        }\n        const selectedCamera = await selectCamera(cameraId, preferredCameraType);\n        if (!selectedCamera) {\n            throw new SDKError(videoRecognizerErrors.cameraMissing);\n        }\n        const shouldMaxResolution = isCameraFocusProblematic();\n        const cameraFlipped = await bindCameraToVideoFeed(selectedCamera, cameraFeed, preferredCameraType, shouldMaxResolution);\n        return new VideoRecognizer(cameraFeed, recognizerRunner, cameraFlipped, selectedCamera.deviceId);\n    }\n    /**\n     * Creates a new `VideoRecognizer` by attaching the given URL to video to\n     * given `HTMLVideoElement` and using it to display video frames while\n     * processing them.\n     *\n     * @param videoPath URL of the video file that should be recognized.\n     * @param videoElement `HTMLVideoElement` to which video file will be attached\n     * @param recognizerRunner `RecognizerRunner` that should be used for video\n     * stream recognition.\n     */\n    static createVideoRecognizerFromVideoPath(videoPath, videoElement, recognizerRunner) {\n        const videoRecognizer = new VideoRecognizer(videoElement, recognizerRunner);\n        videoElement.src = videoPath;\n        videoElement.currentTime = 0;\n        videoElement.onended = () => {\n            videoRecognizer.cancelRecognition();\n        };\n        return videoRecognizer;\n    }\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Settings object for function loadWasmModule.\n */\nclass WasmSDKLoadSettings {\n    /**\n     * @param licenseKey License key for unlocking the WebAssembly module.\n     */\n    constructor(licenseKey) {\n        /**\n         * Write a hello message to the browser console when license check is successfully performed.\n         *\n         * Hello message will contain the name and version of the SDK, which are required information for all support\n         * tickets.\n         *\n         * The default value is true.\n         */\n        this.allowHelloMessage = true;\n        /**\n         * Absolute location of WASM and related JS/data files. Useful when resource files should be loaded over CDN, or\n         * when web frameworks/libraries are used which store resources in specific locations, e.g. inside \"assets\" folder.\n         *\n         * Important: if the engine is hosted on another origin, CORS must be enabled between two hosts. That is, server\n         * where engine is hosted must have 'Access-Control-Allow-Origin' header for the location of the web app.\n         *\n         * Important: SDK and WASM resources must be from the same version of a package.\n         *\n         * Default value is empty string, i.e. \"\". In case of empty string, value of \"window.location.origin\" property is\n         * going to be used.\n         */\n        this.engineLocation = \"\";\n        /**\n         * The absolute location of the Web Worker script file that loads the WebAssembly module.\n         *\n         * Important: the worker script must be served via HTTPS and must be of the same origin as the initiator.\n         * See https://github.com/w3c/ServiceWorker/issues/940 (same applies for Web Workers).\n         *\n         * Important: SDK, worker script and WebAssembly resources must be from the same version of the package.\n         *\n         * The default value is an empty string, i.e. \"\", and in that case, the worker script is loaded from the default\n         * location in resources folder.\n         */\n        this.workerLocation = \"\";\n        /**\n         * Type of the WASM that will be loaded. By default, if not set, the SDK will automatically determine the best WASM\n         * to load.\n         */\n        this.wasmType = null;\n        /**\n         * Defines the number of workers that will be used for multi-threaded processing of the images. If not set, the\n         * number of worker used will match the number of detected CPU cores on a device.\n         *\n         * If the browser does not support multi-threaded processing or it was deliberately disabled using the `wasmType`\n         * property, then this property will be ignored.\n         */\n        this.numberOfWorkers = null;\n        /**\n         * Optional callback function that will report the SDK loading progress.\n         *\n         * This can be useful for displaying progress bar to users with slow connections.\n         *\n         * The default value is null.\n         */\n        this.loadProgressCallback = null;\n        /**\n         * Name of the file containing the WebAssembly module.\n         *\n         * Change this only if you have renamed the original WASM and its support JS file for your purposes.\n         */\n        this.wasmModuleName = defaultWasmModuleName;\n        if (!licenseKey) {\n            throw new SDKError(sdkErrors.licenseKeyMissing);\n        }\n        this.licenseKey = licenseKey;\n    }\n}\n\nconst simd = async () => WebAssembly.validate(new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 5, 1, 96, 0, 1, 123, 3, 2, 1, 0, 10, 10, 1, 8, 0, 65, 0, 253, 15, 253, 98, 11])),\n  threads = () => (async e => {\n    try {\n      return \"undefined\" != typeof MessageChannel && new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)), WebAssembly.validate(e);\n    } catch (e) {\n      return !1;\n    }\n  })(new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 4, 1, 96, 0, 0, 3, 2, 1, 0, 5, 4, 1, 3, 1, 1, 10, 11, 1, 9, 0, 65, 0, 254, 16, 2, 0, 26, 11]));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/* eslint-disable max-len */\n/**\n * Safari 16 shipped with WASM threads support, but it didn't ship with nested\n * workers support, so an extra check is needed\n * https://github.com/GoogleChromeLabs/squoosh/pull/1325/files#diff-904900db64cd3f48b0e765dbbdc6a218a7ea74a199671bde82a8944a904db86f\n */\n/* eslint-enable max-len */\nasync function checkThreadsSupport() {\n    const supportsWasmThreads = await threads();\n    if (!supportsWasmThreads)\n        return false;\n    if (!(\"importScripts\" in self)) {\n        throw Error(\"Not implemented\");\n    }\n    return \"Worker\" in self;\n}\nasync function detectWasmType() {\n    // determine if all features required for advanced WASM are available\n    // currently, advanced wasm requires SIMD\n    const haveSIMD = await simd();\n    const threadsSupported = await checkThreadsSupport();\n    if (haveSIMD) {\n        if (threadsSupported) {\n            return WasmType.AdvancedWithThreads;\n        }\n        else {\n            return WasmType.Advanced;\n        }\n    }\n    else {\n        return WasmType.Basic;\n    }\n}\nfunction wasmFolder(wasmType) {\n    switch (wasmType) {\n        case WasmType.AdvancedWithThreads:\n            return \"advanced-threads\";\n        case WasmType.Advanced:\n            return \"advanced\";\n        case WasmType.Basic:\n            return \"basic\";\n    }\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n// taken from https://stackoverflow.com/a/2117523/213057\n/* eslint-disable */\nfunction uuidv4() {\n    return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));\n}\n/* eslint-enable */\nfunction getUserID() {\n    try {\n        let userId = localStorage.getItem(\"mb-user-id\");\n        if (userId === null) {\n            userId = uuidv4();\n            localStorage.setItem(\"mb-user-id\", userId);\n        }\n        return userId;\n    }\n    catch (error) {\n        // local storage is disabled, generate new user ID every time\n        return uuidv4();\n    }\n}\n/**\n * Asynchronously loads and compiles the WebAssembly module.\n * @param loadSettings Object defining the settings for loading the WebAssembly module.\n * @returns Promise that resolves if WebAssembly module was successfully loaded and rejects if not.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any,\n                  @typescript-eslint/no-unsafe-assignment,\n                  @typescript-eslint/no-unsafe-member-access,\n                  @typescript-eslint/no-unsafe-call */\nasync function loadWasmModule(loadSettings) {\n    return new Promise((resolve, reject) => {\n        if (!loadSettings || typeof loadSettings !== \"object\") {\n            reject(new SDKError(sdkErrors.wasmSettingsMissing));\n            return;\n        }\n        if (typeof loadSettings.licenseKey !== \"string\") {\n            reject(new SDKError(sdkErrors.licenseKeyMissing));\n            return;\n        }\n        if (!loadSettings.wasmModuleName) {\n            reject(new SDKError(sdkErrors.wasmModuleNameMissing));\n            return;\n        }\n        if (typeof loadSettings.engineLocation !== \"string\") {\n            reject(new SDKError(sdkErrors.engineLocationInvalid));\n            return;\n        }\n        if (typeof loadSettings.workerLocation !== \"string\") {\n            reject(new SDKError(sdkErrors.workerLocationInvalid));\n            return;\n        }\n        // obtain user ID from local storage\n        const userId = getUserID();\n        try {\n            const workerPath = `/resources/${loadSettings.wasmModuleName}.worker.min.js`;\n            const defaultWorkerLocation = window.location.origin + workerPath;\n            const workerLocation = loadSettings.workerLocation || defaultWorkerLocation;\n            if (loadSettings.allowHelloMessage) {\n                console.log(\"Worker location is:\", workerLocation);\n            }\n            const worker = new Worker(workerLocation);\n            WasmSDKWorker.createWasmWorker(worker, loadSettings, userId).then(wasmSDK => {\n                resolve(wasmSDK);\n            }, reject);\n        }\n        catch (initError) {\n            reject(initError);\n        }\n    });\n}\n/* eslint-enable @typescript-eslint/no-explicit-any,\n                 @typescript-eslint/no-unsafe-assignment,\n                 @typescript-eslint/no-unsafe-member-access,\n                 @typescript-eslint/no-unsafe-call */\n/**\n * Function for creating a new RecognizerRunner.\n * Note that it is currently not possible to have multiple instances of RecognizerRunner per instance of WasmSDK.\n * Attempt to create new instance of RecognizerRunner prior deleting the previous one will fail.\n * @param wasmSDK Instance of WasmSDK which will be used to communicate with the WebAssembly module.\n * @param recognizers Array of recognizers that will be used by RecognizerRunner.\n * @param allowMultipleResults Whether or not it is allowed to return multiple results from single recognition session.\n *        See README.md for more information.\n * @param metadataCallbacks\n */\nasync function createRecognizerRunner(wasmSDK, recognizers, allowMultipleResults = false, metadataCallbacks = {}) {\n    if (typeof wasmSDK !== \"object\") {\n        throw new SDKError(sdkErrors.missing);\n    }\n    if (typeof recognizers !== \"object\" || recognizers.length < 1) {\n        throw new SDKError(sdkErrors.recognizersMissing);\n    }\n    return wasmSDK.mbWasmModule.createRecognizerRunner(recognizers, allowMultipleResults, metadataCallbacks);\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Possible formats of barcodes that can be detected. This enum will be returned\n * as part of BarcodeRecognizerResult interface.\n */\nvar BarcodeFormat;\n(function (BarcodeFormat) {\n    /** Indicates that no barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"NONE\"] = 0] = \"NONE\";\n    /** Indicates that QR code has been detected. */\n    BarcodeFormat[BarcodeFormat[\"QR_CODE\"] = 1] = \"QR_CODE\";\n    /** Indicates that Data Matrix 2D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"DATA_MATRIX\"] = 2] = \"DATA_MATRIX\";\n    /** Indicates that UPC E 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"UPC_E\"] = 3] = \"UPC_E\";\n    /** Indicates that UPC A 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"UPC_A\"] = 4] = \"UPC_A\";\n    /** Indicates that EAN 8 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"EAN_8\"] = 5] = \"EAN_8\";\n    /** Indicates that EAN 13 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"EAN_13\"] = 6] = \"EAN_13\";\n    /** Indicates that Code 128 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"CODE_128\"] = 7] = \"CODE_128\";\n    /** Indicates that Code 39 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"CODE_39\"] = 8] = \"CODE_39\";\n    /** Indicates that ITF 1D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"ITF\"] = 9] = \"ITF\";\n    /** Indicates that Aztec 2D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"AZTEC_BARCODE\"] = 10] = \"AZTEC_BARCODE\";\n    /** Indicates that PDF417 2D barcode has been detected. */\n    BarcodeFormat[BarcodeFormat[\"PDF417_BARCODE\"] = 11] = \"PDF417_BARCODE\";\n})(BarcodeFormat || (BarcodeFormat = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * AnonymizationMode is used to define level of anonymization\n * performed on recognizer result.\n */\nvar AnonymizationMode;\n(function (AnonymizationMode) {\n    /**\n     * Anonymization will not be performed.\n     */\n    AnonymizationMode[AnonymizationMode[\"None\"] = 0] = \"None\";\n    /**\n     * FullDocumentImage is anonymized with black boxes\n     * covering sensitive data.\n     */\n    AnonymizationMode[AnonymizationMode[\"ImageOnly\"] = 1] = \"ImageOnly\";\n    /**\n     * Result fields containing sensitive data are removed from result.\n     */\n    AnonymizationMode[AnonymizationMode[\"ResultFieldsOnly\"] = 2] = \"ResultFieldsOnly\";\n    /**\n     * This mode is combination of ImageOnly and ResultFieldsOnly modes.\n     */\n    AnonymizationMode[AnonymizationMode[\"FullResult\"] = 3] = \"FullResult\";\n})(AnonymizationMode || (AnonymizationMode = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n *\n * RecognitionModeFilter is used to enable/disable recognition of specific document groups.\n * Setting is taken into account only if the right for that document is purchased.\n */\nclass RecognitionModeFilter {\n    constructor() {\n        /** Enable scanning of MRZ IDs. Setting is taken into account only if the mrz_id right is purchased. */\n        this.enableMrzId = true;\n        /** Enable scanning of Passport MRZ. Setting is taken into account only if the passport right is purchased. */\n        this.enableMrzPassport = true;\n        /** Enable scanning of visa MRZ. Setting is taken into account only if the visa right is purchased. */\n        this.enableMrzVisa = true;\n        /** Enable scanning of Photo ID. Setting is taken into account only if the photo_id right is purchased. */\n        this.enablePhotoId = true;\n        /**\n         * Enable scanning of barcode IDs. Setting is taken into account only if the barcode right to\n         * scan that barcode is purchased.\n         */\n        this.enableBarcodeId = true;\n        /**\n         * Enable full document recognition. Setting is taken into account only if the document right to\n         * scan that document is purchased.\n         */\n        this.enableFullDocumentRecognition = true;\n    }\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * Extension factors relative to corresponding dimension of the full image. For example,\n * {@code upFactor} and {@code downFactor} define extensions relative to image height, e.g.\n * when {@code upFactor} is 0.5, upper image boundary will be extended for half of image's full\n * height.\n *\n *                      ._______________________________________.\n *                      |                                      |\n *                      |                upFactor               |\n *   .________.         |              .________.               |\n *   |        |   -->   |   leftFactor |        | rightFactor   |\n *   |________|         |              |________|               |\n *                      |                                      |\n *                      |               downFactor              |\n *                      |_______________________________________|\n *\n */\nclass ExtensionFactors {\n    /**\n     * Constructor which accepts image extension factors which must be in range [-1.0f, 1.0f].\n     * @param upFactor image extension factor relative to full image height in UP direction\n     * @param downFactor image extension factor relative to full image height in DOWN direction\n     * @param leftFactor image extension factor relative to full image width in LEFT direction\n     * @param rightFactor image extension factor relative to full image width in RIGHT direction\n     */\n    constructor(upFactor = 0.0, downFactor = 0.0, leftFactor = 0.0, rightFactor = 0.0) {\n        /**\n         * Currently used image extension factor relative to full image height in UP direction.\n         */\n        this.upFactor = 0.0;\n        /**\n         * Currently used image extension factor relative to full image height in DOWN direction.\n         */\n        this.downFactor = 0.0;\n        /**\n         * Currently used image extension factor relative to full image height in LEFT direction.\n         */\n        this.leftFactor = 0.0;\n        /**\n         * Currently used image extension factor relative to full image height in RIGHT direction.\n         */\n        this.rightFactor = 0.0;\n        this.checkExtensionFactor(upFactor);\n        this.checkExtensionFactor(downFactor);\n        this.checkExtensionFactor(leftFactor);\n        this.checkExtensionFactor(rightFactor);\n        this.upFactor = upFactor;\n        this.downFactor = downFactor;\n        this.leftFactor = leftFactor;\n        this.rightFactor = rightFactor;\n    }\n    checkExtensionFactor(factor) {\n        if (factor > 1.0 || factor < -1.0) {\n            throw new Error(\"Extension factor must be in range [-1.0, 1.0]\");\n        }\n    }\n}\nfunction validateDpi(dpi) {\n    if (dpi < 100 || dpi > 400) {\n        throw new Error(\"DPI must be from interval [100, 400]\");\n    }\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n* Enum defining additional fields present in the barcode.\n* Currently this is only used for AAMVACompliant documents.\n*/\nvar BarcodeElementKey;\n(function (BarcodeElementKey) {\n    // ==============================================================/\n    // ============== 1. DETERMINING BARCODE VERSION ================/\n    // ==============================================================/\n    /**\n     Mandatory on all driver's licenses. All barcodes which are using 3-track magnetic\n     stripe encoding used in the interest of smoothing a transition from legacy documents\n     shall be designated as \"Magnetic\". All barcodes which are using compact encoding\n     compliant with ISO/IEC 18013-2 shall be designated as \"Compact\". All barcodes (majority)\n     compliant with Mandatory PDF417 Bar Code of the American Association of Motor Vehicle\n     Administrators (AAMVA) Card Design Standard from AAMVA DL/ID-2000 standard to DL/ID-2013\n     shall be designated as \"AAMVA\".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DocumentType\"] = 0] = \"DocumentType\";\n    /**\n     Mandatory on all driver's licenses.\n\n     AAMVA Version Number: This is a decimal value between 0 and 99 that\n     specifies the version level of the PDF417 bar code format. Version \"0\" and \"00\"\n     is reserved for bar codes printed to the specification of the American Association\n     of Motor Vehicle Administrators (AAMVA) prior to the adoption of the AAMVA DL/ID-2000\n     standard.\n\n     - All barcodes compliant with AAMVA DL/ID-2000 standard shall be designated Version \"01.\"\n     - All barcodes compliant with AAMVA Card Design Specification version 1.0, dated 09-2003\n       shall be designated Version \"02.\"\n     - All barcodes compliant with AAMVA Card Design Specification version 2.0, dated 03-2005\n       shall be designated Version \"03.\"\n     - All barcodes compliant with AAMVA Card Design Standard version 1.0, dated 07-2009\n       shall be designated Version \"04.\"\n     - All barcodes compliant with AAMVA Card Design Standard version 1.0, dated 07-2010\n       shall be designated Version \"05.\"\n     - All barcodes compliant with AAMVA Card Design Standard version 1.0, dated 07-2011\n       shall be designated Version \"06\".\n     - All barcodes compliant with AAMVA Card Design Standard version 1.0, dated 06-2012\n       shall be designated Version \"07\".\n     - All barcodes compliant with this current AAMVA standard shall be designated \"08\".\n\n     Should a need arise requiring major revision to the format, this field provides the\n     means to accommodate additional revision.\n\n     If the document type is not \"AAMVA\", this field defines the version number of the\n     given document type's standard.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"StandardVersionNumber\"] = 1] = \"StandardVersionNumber\";\n    // ==============================================================/\n    // ==========          2. PERSONAL DATA KEYS          ===========/\n    // ==============================================================/\n    /**\n     Mandatory on all AAMVA, Magnetic and Compact barcodes.\n\n     Family name of the cardholder. (Family name is sometimes also called \"last name\" or \"surname.\")\n     Collect full name for record, print as many characters as possible on portrait side of DL/ID.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CustomerFamilyName\"] = 2] = \"CustomerFamilyName\";\n    /**\n     Mandatory on all AAMVA, Magnetic and Compact barcodes.\n\n     First name of the cardholder.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CustomerFirstName\"] = 3] = \"CustomerFirstName\";\n    /**\n     Mandatory on all AAMVA, Magnetic and Compact barcodes.\n\n     Full name of the individual holding the Driver's License or ID.\n\n     The Name field contains up to four portions, separated with the \",\" delimiter:\n     Last Name (required)\n     , (required)\n     First Name (required)\n     , (required if other name portions follow, otherwise optional)\n     Middle Name(s) (optional)\n     , (required if other name portions follow, otherwise optional)\n     Suffix (optional)\n     , (optional)\n\n     If the individual has more than one middle name they are separated with space.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CustomerFullName\"] = 4] = \"CustomerFullName\";\n    /**\n     Mandatory on all AAMVA, Magnetic and Compact barcodes.\n\n     Date on which the cardholder was born. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DateOfBirth\"] = 5] = \"DateOfBirth\";\n    /**\n     Mandatory on all AAMVA, Magnetic barcodes.\n     Optional on Compact barcodes.\n\n     Gender of the cardholder. 1 = male, 2 = female.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"Sex\"] = 6] = \"Sex\";\n    /**\n     Mandatory on AAMVA 02, 03, 04, 05, 06, 07, 08 barcodes.\n     Optional on AAMVA 01, Magnetic and Compact barcodes.\n\n     Color of cardholder's eyes. (ANSI D-20 codes)\n\n     Code   Description\n     BLK    Black\n     BLU    Blue\n     BRO    Brown\n     GRY    Gray\n     GRN    Green\n     HAZ    Hazel\n     MAR    Maroon\n     PNK    Pink\n     DIC    Dichromatic\n     UNK    Unknown\n     */\n    BarcodeElementKey[BarcodeElementKey[\"EyeColor\"] = 7] = \"EyeColor\";\n    /**\n     Mandatory on all AAMVA and Magnetic barcodes.\n\n     On compact barcodes, use kFullAddress.\n\n     Street portion of the cardholder address.\n     The place where the registered driver of a vehicle (individual or corporation)\n     may be contacted such as a house number, street address, etc.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AddressStreet\"] = 8] = \"AddressStreet\";\n    /**\n     Mandatory on all AAMVA and Magnetic barcodes.\n\n     On compact barcodes, use kFullAddress.\n\n     City portion of the cardholder address.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AddressCity\"] = 9] = \"AddressCity\";\n    /**\n     Mandatory on all AAMVA and Magnetic barcodes.\n\n     On compact barcodes, use kFullAddress.\n\n     State portion of the cardholder address.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AddressJurisdictionCode\"] = 10] = \"AddressJurisdictionCode\";\n    /**\n     Mandatory on all AAMVA and Magnetic barcodes.\n\n     On compact barcodes, use FullAddress.\n\n     Postal code portion of the cardholder address in the U.S. and Canada. If the\n     trailing portion of the postal code in the U.S. is not known, zeros can be used\n     to fill the trailing set of numbers up to nine (9) digits.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AddressPostalCode\"] = 11] = \"AddressPostalCode\";\n    /**\n     Mandatory on all AAMVA and Magnetic barcodes.\n     Optional on Compact barcodes.\n\n     Full address of the individual holding the Driver's License or ID.\n\n     The full address field contains up to four portions, separated with the \",\" delimiter:\n     Street Address (required)\n     , (required if other address portions follow, otherwise optional)\n     City (optional)\n     , (required if other address portions follow, otherwise optional)\n     Jurisdiction Code (optional)\n     , (required if other address portions follow, otherwise optional)\n     ZIP - Postal Code (optional)\n\n     */\n    BarcodeElementKey[BarcodeElementKey[\"FullAddress\"] = 12] = \"FullAddress\";\n    /**\n     Mandatory on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n     Optional on AAMVA 01 and Magnetic barcodes.\n\n     Height of cardholder, either in Inches or in Centimeters.\n\n     Inches (in): number of inches followed by \" in\"\n     example: 6'1'' = \"73 in\"\n\n     Centimeters (cm): number of centimeters followed by \" cm\"\n     example: 181 centimeters = \"181 cm\"\n     */\n    BarcodeElementKey[BarcodeElementKey[\"Height\"] = 13] = \"Height\";\n    /**\n     Mandatory on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n     Optional on AAMVA 01 and Magnetic barcodes.\n\n     Height of cardholder in Inches.\n     Example: 5'9'' = \"69\".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"HeightIn\"] = 14] = \"HeightIn\";\n    /**\n     Mandatory on AAMVA 02, 03, 04, 05, 06, 07, 08 Compact barcodes.\n     Optional on AAMVA 01 and Magnetic barcodes.\n\n     Height of cardholder in Centimeters.\n     Example: 180 Centimeters = \"180\".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"HeightCm\"] = 15] = \"HeightCm\";\n    /**\n     Mandatory on AAMVA 04, 05, 06, 07, 08 barcodes.\n     Optional on AAMVA 01, 02, 03, Magnetic and Compcat barcodes.\n\n     Middle name(s) of the cardholder. In the case of multiple middle names they\n     shall be separated by space \" \".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CustomerMiddleName\"] = 16] = \"CustomerMiddleName\";\n    /**\n     Optional on all AAMVA, Magnetic and Compact barcodes.\n\n     Bald, black, blonde, brown, gray, red/auburn, sandy, white, unknown. If the issuing\n     jurisdiction wishes to abbreviate colors, the three-character codes provided in ANSI D20 must be\n     used.\n\n     Code   Description\n     BAL    Bald\n     BLK    Black\n     BLN    Blond\n     BRO    Brown\n     GRY    Grey\n     RED    Red/Auburn\n     SDY    Sandy\n     WHI    White\n     UNK    Unknown\n     */\n    BarcodeElementKey[BarcodeElementKey[\"HairColor\"] = 17] = \"HairColor\";\n    /**\n     Mandatory on AAMVA 02 barcodes.\n     Optional on AAMVA 01, 03, 04, 05, 06, 07, 08, Magnetic and Compact barcodes.\n\n     Name Suffix (If jurisdiction participates in systems requiring name suffix (PDPS, CDLIS, etc.),\n     the suffix must be collected and displayed on the DL/ID and in the MRT).\n     - JR (Junior)\n     - SR (Senior)\n     - 1ST or I (First)\n     - 2ND or II (Second)\n     - 3RD or III (Third)\n     - 4TH or IV (Fourth)\n     - 5TH or V (Fifth)\n     - 6TH or VI (Sixth)\n     - 7TH or VII (Seventh)\n     - 8TH or VIII (Eighth)\n     - 9TH or IX (Ninth)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"NameSuffix\"] = 18] = \"NameSuffix\";\n    /**\n     Optional on all AAMVA and Compact barcodes.\n\n     Other name by which the cardholder is known. ALTERNATIVE NAME(S) of the individual\n     holding the Driver License or ID.\n\n     The Name field contains up to four portions, separated with the \",\" delimiter:\n     AKA Last Name (required)\n     , (required)\n     AKA First Name (required)\n     , (required if other name portions follow, otherwise optional)\n     AKA Middle Name(s) (optional)\n     , (required if other name portions follow, otherwise optional)\n     AKA Suffix (optional)\n     , (optional)\n\n     If the individual has more than one AKA middle name they are separated with space.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKAFullName\"] = 19] = \"AKAFullName\";\n    /**\n     Optional on all AAMVA and Compact barcodes.\n\n     Other family name by which the cardholder is known.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKAFamilyName\"] = 20] = \"AKAFamilyName\";\n    /**\n     Optional on all AAMVA and Compact barcodes.\n\n     Other given name by which the cardholder is known\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKAGivenName\"] = 21] = \"AKAGivenName\";\n    /**\n     Optional on all AAMVA and Compact barcodes.\n\n     Other suffix by which the cardholder is known.\n\n     The Suffix Code Portion, if submitted, can contain only the Suffix Codes shown in the following\n     table (e.g., Andrew Johnson, III = JOHNSON@ANDREW@@3RD):\n\n     Suffix     Meaning or Synonym\n     JR         Junior\n     SR         Senior or Esquire 1ST First\n     2ND        Second\n     3RD        Third\n     4TH        Fourth\n     5TH        Fifth\n     6TH        Sixth\n     7TH        Seventh\n     8TH        Eighth\n     9TH        Ninth\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKASuffixName\"] = 22] = \"AKASuffixName\";\n    /**\n     Mandatory on AAMVA 02 barcodes.\n     Optional on AAMVA 01, 03, 04, 05, 06, 07, 08, Magnetic and Compact barcodes.\n\n     Indicates the approximate weight range of the cardholder:\n     0 = up to 31 kg (up to 70 lbs)\n     1 = 32  45 kg (71  100 lbs)\n     2 = 46 - 59 kg (101  130 lbs)\n     3 = 60 - 70 kg (131  160 lbs)\n     4 = 71 - 86 kg (161  190 lbs)\n     5 = 87 - 100 kg (191  220 lbs)\n     6 = 101 - 113 kg (221  250 lbs)\n     7 = 114 - 127 kg (251  280 lbs)\n     8 = 128  145 kg (281  320 lbs)\n     9 = 146+ kg (321+ lbs)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"WeightRange\"] = 23] = \"WeightRange\";\n    /**\n     Mandatory on AAMVA 02 barcodes.\n     Optional on AAMVA 01, 03, 04, 05, 06, 07, 08, Magnetic and Compact barcodes.\n\n     Cardholder weight in pounds Example: 185 lb = \"185\"\n     */\n    BarcodeElementKey[BarcodeElementKey[\"WeightPounds\"] = 24] = \"WeightPounds\";\n    /**\n     Mandatory on AAMVA 02 barcodes.\n     Optional on AAMVA 01, 03, 04, 05, 06, 07, 08, Magnetic and Compact barcodes.\n\n     Cardholder weight in kilograms Example: 84 kg = \"084\"\n     */\n    BarcodeElementKey[BarcodeElementKey[\"WeightKilograms\"] = 25] = \"WeightKilograms\";\n    /**\n     Mandatory on all AAMVA and Compact barcodes.\n\n     The number assigned or calculated by the issuing authority.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CustomerIdNumber\"] = 26] = \"CustomerIdNumber\";\n    /**\n     Mandatory on AAMVA 04, 05, 06, 07, 08 barcodes.\n     Optional on Compact barcodes.\n\n     A code that indicates whether a field has been truncated (T), has not been\n     truncated (N), or  unknown whether truncated (U).\n     */\n    BarcodeElementKey[BarcodeElementKey[\"FamilyNameTruncation\"] = 27] = \"FamilyNameTruncation\";\n    /**\n     Mandatory on AAMVA 04, 05, 06, 07, 08 barcodes.\n     Optional on Compact barcodes.\n\n     A code that indicates whether a field has been truncated (T), has not been\n     truncated (N), or  unknown whether truncated (U).\n     */\n    BarcodeElementKey[BarcodeElementKey[\"FirstNameTruncation\"] = 28] = \"FirstNameTruncation\";\n    /**\n     Mandatory on AAMVA 04, 05, 06, 07, 08 barcodes.\n\n     A code that indicates whether a field has been truncated (T), has not been\n     truncated (N), or  unknown whether truncated (U).\n     */\n    BarcodeElementKey[BarcodeElementKey[\"MiddleNameTruncation\"] = 29] = \"MiddleNameTruncation\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Country and municipality and/or state/province.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"PlaceOfBirth\"] = 30] = \"PlaceOfBirth\";\n    /**\n     Optional on all AAMVA barcodes.\n\n     On Compact barcodes, use kFullAddress.\n\n     Second line of street portion of the cardholder address.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AddressStreet2\"] = 31] = \"AddressStreet2\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Codes for race or ethnicity of the cardholder, as defined in ANSI D20.\n\n     Race:\n     Code   Description\n     AI     Alaskan or American Indian (Having Origins in Any of The Original Peoples of\n            North America, and Maintaining Cultural Identification Through Tribal\n            Affiliation of Community Recognition)\n     AP     Asian or Pacific Islander (Having Origins in Any of the Original Peoples of\n            the Far East, Southeast Asia, or Pacific Islands. This Includes China, India,\n            Japan, Korea, the Philippines Islands, and Samoa)\n     BK     Black (Having Origins in Any of the Black Racial Groups of Africa)\n     W      White (Having Origins in Any of The Original Peoples of Europe, North Africa,\n            or the Middle East)\n\n     Ethnicity:\n     Code   Description\n     H      Hispanic Origin (A Person of Mexican, Puerto Rican, Cuban, Central or South\n            American or Other Spanish Culture or Origin, Regardless of Race)\n     O      Not of Hispanic Origin (Any Person Other Than Hispanic)\n     U      Unknown\n\n     */\n    BarcodeElementKey[BarcodeElementKey[\"RaceEthnicity\"] = 32] = \"RaceEthnicity\";\n    /**\n     Optional on AAMVA 01 barcodes.\n\n     PREFIX to Driver Name. Freeform as defined by issuing jurisdiction.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"NamePrefix\"] = 33] = \"NamePrefix\";\n    /**\n     Mandatory on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Country in which DL/ID is issued. U.S. = USA, Canada = CAN.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CountryIdentification\"] = 34] = \"CountryIdentification\";\n    /**\n     Optional on AAMVA version 01.\n\n     Driver Residence Street Address 1.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ResidenceStreetAddress\"] = 35] = \"ResidenceStreetAddress\";\n    /**\n     Optional on AAMVA version 01.\n\n     Driver Residence Street Address 2.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ResidenceStreetAddress2\"] = 36] = \"ResidenceStreetAddress2\";\n    /**\n     Optional on AAMVA version 01.\n\n     Driver Residence City\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ResidenceCity\"] = 37] = \"ResidenceCity\";\n    /**\n     Optional on AAMVA version 01.\n\n     Driver Residence Jurisdiction Code.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ResidenceJurisdictionCode\"] = 38] = \"ResidenceJurisdictionCode\";\n    /**\n     Optional on AAMVA 01 barcodes.\n\n     Driver Residence Postal Code.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ResidencePostalCode\"] = 39] = \"ResidencePostalCode\";\n    /**\n     Optional on AAMVA 01 barcodes.\n\n     Full residence address of the individual holding the Driver's License or ID.\n\n     The full address field contains up to four portions, separated with the \",\" delimiter:\n     Residence Street Address (required)\n     , (required if other address portions follow, otherwise optional)\n     Residence City (optional)\n     , (required if other address portions follow, otherwise optional)\n     Residence Jurisdiction Code (optional)\n     , (required if other address portions follow, otherwise optional)\n     Residence ZIP - Residence Postal Code (optional)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ResidenceFullAddress\"] = 40] = \"ResidenceFullAddress\";\n    /**\n     Optional on AAMVA 05, 06, 07, 08 barcodes.\n\n     Date on which the cardholder turns 18 years old. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"Under18\"] = 41] = \"Under18\";\n    /**\n     Optional on AAMVA 05, 06, 07, 08 barcodes.\n\n     Date on which the cardholder turns 19 years old. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"Under19\"] = 42] = \"Under19\";\n    /**\n     Optional on AAMVA 05, 06, 07, 08 barcodes.\n\n     Date on which the cardholder turns 21 years old. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"Under21\"] = 43] = \"Under21\";\n    /**\n     Optional on AAMVA version 01.\n\n     The number assigned to the individual by the Social Security Administration.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"SocialSecurityNumber\"] = 44] = \"SocialSecurityNumber\";\n    /**\n     Optional on AAMVA version 01.\n\n     Driver \"AKA\" Social Security Number. FORMAT SAME AS DRIVER SOC SEC NUM. ALTERNATIVE NUMBERS(S) used as SS NUM.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKASocialSecurityNumber\"] = 45] = \"AKASocialSecurityNumber\";\n    /**\n     Optional on AAMVA 01 barcodes.\n\n     ALTERNATIVE MIDDLE NAME(s) or INITIALS of the individual holding the Driver License or ID.\n     Hyphenated names acceptable, spaces between names acceptable, but no other\n     use of special symbols.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKAMiddleName\"] = 46] = \"AKAMiddleName\";\n    /**\n     Optional on AAMVA 01 barcodes.\n\n     ALTERNATIVE PREFIX to Driver Name. Freeform as defined by issuing jurisdiction.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKAPrefixName\"] = 47] = \"AKAPrefixName\";\n    /**\n     Optional on AAMVA 01, 06, 07, 08 barcodes.\n\n     Field that indicates that the cardholder is an organ donor = \"1\".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"OrganDonor\"] = 48] = \"OrganDonor\";\n    /**\n     Optional on AAMVA 07, 08 barcodes.\n\n     Field that indicates that the cardholder is a veteran = \"1\"\n     */\n    BarcodeElementKey[BarcodeElementKey[\"Veteran\"] = 49] = \"Veteran\";\n    /**\n     Optional on AAMVA 01. (MMDDCCYY format)\n\n     ALTERNATIVE DATES(S) given as date of birth.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AKADateOfBirth\"] = 50] = \"AKADateOfBirth\";\n    // ==============================================================/\n    // ==========          3. LICENSE DATA KEYS          ============/\n    // ==============================================================/\n    /**\n     Mandatory on all AAMVA, Magnetic and Compact barcodes.\n\n     This number uniquely identifies the issuing jurisdiction and can\n     be obtained by contacting the ISO Issuing Authority (AAMVA)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"IssuerIdentificationNumber\"] = 51] = \"IssuerIdentificationNumber\";\n    /**\n     Mandatory on all AAMVA, Magnetic and Compact barcodes.\n\n     If the document is non expiring then \"Non expiring\" is written in this field.\n\n     Date on which the driving and identification privileges granted by the document are\n     no longer valid. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DocumentExpirationDate\"] = 52] = \"DocumentExpirationDate\";\n    /**\n     Mandatory on all AAMVA and Compact barcodes.\n     Optional on Magnetic barcodes.\n\n     Jurisdiction Version Number: This is a decimal value between 0 and 99 that\n     specifies the jurisdiction version level of the PDF417 barcode format.\n     Notwithstanding iterations of this standard, jurisdictions implement incremental\n     changes to their barcodes, including new jurisdiction-specific data, compression\n     algorithms for digitized images, digital signatures, or new truncation\n     conventions used for names and addresses. Each change to the barcode format\n     within each AAMVA version (above) must be noted, beginning with Jurisdiction\n     Version 00.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionVersionNumber\"] = 53] = \"JurisdictionVersionNumber\";\n    /**\n     Mandatory on all AAMVA and Magnetic barcodes.\n\n     Jurisdiction-specific vehicle class / group code, designating the type\n     of vehicle the cardholder has privilege to drive.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionVehicleClass\"] = 54] = \"JurisdictionVehicleClass\";\n    /**\n     Mandatory on all AAMVA barcodes.\n     Optional on Magnetic barcodes.\n\n     Jurisdiction-specific codes that represent restrictions to driving\n     privileges (such as airbrakes, automatic transmission, daylight only, etc.).\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionRestrictionCodes\"] = 55] = \"JurisdictionRestrictionCodes\";\n    /**\n     Mandatory on all AAMVA barcodes.\n     Optional on Magnetic barcodes.\n\n     Jurisdiction-specific codes that represent additional privileges\n     granted to the cardholder beyond the vehicle class (such as transportation of\n     passengers, hazardous materials, operation of motorcycles, etc.).\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionEndorsementCodes\"] = 56] = \"JurisdictionEndorsementCodes\";\n    /**\n     Mandatory on all AAMVA and Compact barcodes.\n\n     Date on which the document was issued. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DocumentIssueDate\"] = 57] = \"DocumentIssueDate\";\n    /**\n     Mandatory on AAMVA versions 02 and 03.\n\n     Federally established codes for vehicle categories, endorsements, and restrictions\n     that are generally applicable to commercial motor vehicles. If the vehicle is not a\n     commercial vehicle, \"NONE\" is to be entered.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"FederalCommercialVehicleCodes\"] = 58] = \"FederalCommercialVehicleCodes\";\n    /**\n     Optional on all AAMVA barcodes.\n     Mandatory on Compact barcodes.\n\n     Jurisdictions may define a subfile to contain jurisdiction-specific information.\n     These subfiles are designated with the first character of Z and the second\n     character is the first letter of the jurisdiction's name. For example, \"ZC\" would\n     be the designator for a California or Colorado jurisdiction-defined subfile, \"ZQ\"\n     would be the designator for a Quebec jurisdiction-defined subfile. In the case of\n     a jurisdiction-defined subfile that has a first letter that could be more than\n     one jurisdiction (e.g. California, Colorado, Connecticut) then other data, like\n     the IIN or address, must be examined to determine the jurisdiction.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"IssuingJurisdiction\"] = 59] = \"IssuingJurisdiction\";\n    /**\n     Optional on all AAMVA barcodes.\n     Mandatory on Compact barcodes.\n\n     Standard vehicle classification code(s) for cardholder. This data element is a\n     placeholder for future efforts to standardize vehicle classifications.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"StandardVehicleClassification\"] = 60] = \"StandardVehicleClassification\";\n    /**\n      Optional on all AAMVA and Magnetic barcodes.\n\n      Name of issuing jurisdiction, for example: Alabama, Alaska ...\n      */\n    BarcodeElementKey[BarcodeElementKey[\"IssuingJurisdictionName\"] = 61] = \"IssuingJurisdictionName\";\n    /**\n     Optional on all AAMVA barcodes.\n\n     Standard endorsement code(s) for cardholder. See codes in D20. This data element is a\n     placeholder for future efforts to standardize endorsement codes.\n\n     Code   Description\n     H      Hazardous Material - This endorsement is required for the operation of any vehicle\n            transporting hazardous materials requiring placarding, as defined by U.S.\n            Department of Transportation regulations.\n     L      Motorcycles  Including Mopeds/Motorized Bicycles.\n     N      Tank - This endorsement is required for the operation of any vehicle transporting,\n            as its primary cargo, any liquid or gaseous material within a tank attached to the vehicle.\n     O      Other Jurisdiction Specific Endorsement(s) - This code indicates one or more\n            additional jurisdiction assigned endorsements.\n     P      Passenger - This endorsement is required for the operation of any vehicle used for\n            transportation of sixteen or more occupants, including the driver.\n     S      School Bus - This endorsement is required for the operation of a school bus. School bus means a\n            CMV used to transport pre-primary, primary, or secondary school students from home to school,\n            from school to home, or to and from school sponsored events. School bus does not include a\n            bus used as common carrier (49 CRF 383.5).\n     T      Doubles/Triples - This endorsement is required for the operation of any vehicle that would be\n            referred to as a double or triple.\n     X      Combined Tank/HAZ-MAT - This endorsement may be issued to any driver who qualifies for\n            both the N and H endorsements.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"StandardEndorsementCode\"] = 62] = \"StandardEndorsementCode\";\n    /**\n     Optional on all AAMVA barcodes.\n\n     Standard restriction code(s) for cardholder. See codes in D20. This data element is a placeholder\n     for future efforts to standardize restriction codes.\n\n     Code   Description\n     B      Corrective Lenses\n     C      Mechanical Devices (Special Brakes, Hand Controls, or Other Adaptive Devices)\n     D      Prosthetic Aid\n     E      Automatic Transmission\n     F      Outside Mirror\n     G      Limit to Daylight Only\n     H      Limit to Employment\n     I      Limited Other\n     J      Other\n     K      CDL Intrastate Only\n     L      Vehicles without air brakes\n     M      Except Class A bus\n     N      Except Class A and Class B bus\n     O      Except Tractor-Trailer\n     V      Medical Variance Documentation Required\n     W      Farm Waiver\n     */\n    BarcodeElementKey[BarcodeElementKey[\"StandardRestrictionCode\"] = 63] = \"StandardRestrictionCode\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Text that explains the jurisdiction-specific code(s) for classifications\n     of vehicles cardholder is authorized to drive.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionVehicleClassificationDescription\"] = 64] = \"JurisdictionVehicleClassificationDescription\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Text that explains the jurisdiction-specific code(s) that indicates additional\n     driving privileges granted to the cardholder beyond the vehicle class.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionEndorsmentCodeDescription\"] = 65] = \"JurisdictionEndorsmentCodeDescription\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Text describing the jurisdiction-specific restriction code(s) that curtail driving privileges.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"JurisdictionRestrictionCodeDescription\"] = 66] = \"JurisdictionRestrictionCodeDescription\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 barcodes.\n\n     A string of letters and/or numbers that is affixed to the raw materials (card stock,\n     laminate, etc.) used in producing driver's licenses and ID cards. (DHS recommended field)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"InventoryControlNumber\"] = 67] = \"InventoryControlNumber\";\n    /**\n     Optional on AAMVA 04, 05, 06, 07, 08 and Compact barcodes.\n\n     DHS required field that indicates date of the most recent version change or\n     modification to the visible format of the DL/ID. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"CardRevisionDate\"] = 68] = \"CardRevisionDate\";\n    /**\n     Mandatory on AAMVA 02, 03, 04, 05, 06, 07, 08 and Magnetic barcodes.\n     Optional and Compact barcodes.\n\n     Number must uniquely identify a particular document issued to that customer\n     from others that may have been issued in the past. This number may serve multiple\n     purposes of document discrimination, audit information number, and/or inventory control.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DocumentDiscriminator\"] = 69] = \"DocumentDiscriminator\";\n    /**\n     Optional on AAMVA 04, 05, 06, 07, 08 and Compact barcodes.\n\n     DHS required field that indicates that the cardholder has temporary lawful status = \"1\".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"LimitedDurationDocument\"] = 70] = \"LimitedDurationDocument\";\n    /**\n     Optional on AAMVA 02, 03, 04, 05, 06, 07, 08 and Compact barcodes.\n\n     A string of letters and/or numbers that identifies when, where, and by whom a driver's\n     license/ID card was made. If audit information is not used on the card or the MRT, it\n     must be included in the driver record.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"AuditInformation\"] = 71] = \"AuditInformation\";\n    /**\n     Optional on AAMVA 04, 05, 06, 07, 08 and Compact barcodes.\n\n     DHS required field that indicates compliance: \"M\" = materially compliant,\n     \"F\" = fully compliant, and, \"N\" = non-compliant.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"ComplianceType\"] = 72] = \"ComplianceType\";\n    /**\n     Optional on AAMVA version 01 barcodes.\n\n     Issue Timestamp. A string used by some jurisdictions to validate the document against their data base.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"IssueTimestamp\"] = 73] = \"IssueTimestamp\";\n    /**\n     Optional on AAMVA version 01 barcodes.\n\n     Driver Permit Expiration Date. MMDDCCYY format. Date permit expires.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"PermitExpirationDate\"] = 74] = \"PermitExpirationDate\";\n    /**\n     Optional on AAMVA version 01 barcodes..\n\n     Type of permit.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"PermitIdentifier\"] = 75] = \"PermitIdentifier\";\n    /**\n     Optional on AAMVA version 01 barcodes..\n\n     Driver Permit Issue Date. MMDDCCYY format. Date permit was issued.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"PermitIssueDate\"] = 76] = \"PermitIssueDate\";\n    /**\n     Optional on AAMVA version 01.\n\n     Number of duplicate cards issued for a license or ID if any.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"NumberOfDuplicates\"] = 77] = \"NumberOfDuplicates\";\n    /**\n     Optional on AAMVA 04, 05, 06, 07, 08 and Compact barcodes.\n\n     Date on which the hazardous material endorsement granted by the document is\n     no longer valid. (MMDDCCYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"HAZMATExpirationDate\"] = 78] = \"HAZMATExpirationDate\";\n    /**\n     Optional on AAMVA version 01.\n\n     Medical Indicator/Codes.\n     STATE SPECIFIC. Freeform, Standard \"TBD\"\n     */\n    BarcodeElementKey[BarcodeElementKey[\"MedicalIndicator\"] = 79] = \"MedicalIndicator\";\n    /**\n     Optional on AAMVA version 01.\n\n     Non-Resident Indicator. \"Y\". Used by some jurisdictions to indicate holder of the document is a non-resident.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"NonResident\"] = 80] = \"NonResident\";\n    /**\n     Optional on AAMVA version 01.\n\n     A number or alphanumeric string used by some jurisdictions to identify a \"customer\" across multiple data bases.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"UniqueCustomerId\"] = 81] = \"UniqueCustomerId\";\n    /**\n     Optional on compact barcodes.\n\n     Document discriminator.\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DataDiscriminator\"] = 82] = \"DataDiscriminator\";\n    /**\n     Optional on Magnetic barcodes.\n\n     Month on which the driving and identification privileges granted by the document are\n     no longer valid. (MMYY format)\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DocumentExpirationMonth\"] = 83] = \"DocumentExpirationMonth\";\n    /**\n     Optional on Magnetic barcodes.\n\n     Field that indicates that the driving and identification privileges granted by the\n     document are nonexpiring = \"1\".\n     */\n    BarcodeElementKey[BarcodeElementKey[\"DocumentNonexpiring\"] = 84] = \"DocumentNonexpiring\";\n    /**\n      Optional on Magnetic barcodes.\n\n      Security version beeing used.\n    */\n    BarcodeElementKey[BarcodeElementKey[\"SecurityVersion\"] = 85] = \"SecurityVersion\";\n    /**\n      Number of keys in enum.\n    */\n    BarcodeElementKey[BarcodeElementKey[\"Count\"] = 86] = \"Count\";\n})(BarcodeElementKey || (BarcodeElementKey = {}));\n\nvar Country;\n(function (Country) {\n    Country[Country[\"NONE\"] = 0] = \"NONE\";\n    Country[Country[\"ALBANIA\"] = 1] = \"ALBANIA\";\n    Country[Country[\"ALGERIA\"] = 2] = \"ALGERIA\";\n    Country[Country[\"ARGENTINA\"] = 3] = \"ARGENTINA\";\n    Country[Country[\"AUSTRALIA\"] = 4] = \"AUSTRALIA\";\n    Country[Country[\"AUSTRIA\"] = 5] = \"AUSTRIA\";\n    Country[Country[\"AZERBAIJAN\"] = 6] = \"AZERBAIJAN\";\n    Country[Country[\"BAHRAIN\"] = 7] = \"BAHRAIN\";\n    Country[Country[\"BANGLADESH\"] = 8] = \"BANGLADESH\";\n    Country[Country[\"BELGIUM\"] = 9] = \"BELGIUM\";\n    Country[Country[\"BOSNIA_AND_HERZEGOVINA\"] = 10] = \"BOSNIA_AND_HERZEGOVINA\";\n    Country[Country[\"BRUNEI\"] = 11] = \"BRUNEI\";\n    Country[Country[\"BULGARIA\"] = 12] = \"BULGARIA\";\n    Country[Country[\"CAMBODIA\"] = 13] = \"CAMBODIA\";\n    Country[Country[\"CANADA\"] = 14] = \"CANADA\";\n    Country[Country[\"CHILE\"] = 15] = \"CHILE\";\n    Country[Country[\"COLOMBIA\"] = 16] = \"COLOMBIA\";\n    Country[Country[\"COSTA_RICA\"] = 17] = \"COSTA_RICA\";\n    Country[Country[\"CROATIA\"] = 18] = \"CROATIA\";\n    Country[Country[\"CYPRUS\"] = 19] = \"CYPRUS\";\n    Country[Country[\"CZECHIA\"] = 20] = \"CZECHIA\";\n    Country[Country[\"DENMARK\"] = 21] = \"DENMARK\";\n    Country[Country[\"DOMINICAN_REPUBLIC\"] = 22] = \"DOMINICAN_REPUBLIC\";\n    Country[Country[\"EGYPT\"] = 23] = \"EGYPT\";\n    Country[Country[\"ESTONIA\"] = 24] = \"ESTONIA\";\n    Country[Country[\"FINLAND\"] = 25] = \"FINLAND\";\n    Country[Country[\"FRANCE\"] = 26] = \"FRANCE\";\n    Country[Country[\"GEORGIA\"] = 27] = \"GEORGIA\";\n    Country[Country[\"GERMANY\"] = 28] = \"GERMANY\";\n    Country[Country[\"GHANA\"] = 29] = \"GHANA\";\n    Country[Country[\"GREECE\"] = 30] = \"GREECE\";\n    Country[Country[\"GUATEMALA\"] = 31] = \"GUATEMALA\";\n    Country[Country[\"HONG_KONG\"] = 32] = \"HONG_KONG\";\n    Country[Country[\"HUNGARY\"] = 33] = \"HUNGARY\";\n    Country[Country[\"INDIA\"] = 34] = \"INDIA\";\n    Country[Country[\"INDONESIA\"] = 35] = \"INDONESIA\";\n    Country[Country[\"IRELAND\"] = 36] = \"IRELAND\";\n    Country[Country[\"ISRAEL\"] = 37] = \"ISRAEL\";\n    Country[Country[\"ITALY\"] = 38] = \"ITALY\";\n    Country[Country[\"JORDAN\"] = 39] = \"JORDAN\";\n    Country[Country[\"KAZAKHSTAN\"] = 40] = \"KAZAKHSTAN\";\n    Country[Country[\"KENYA\"] = 41] = \"KENYA\";\n    Country[Country[\"KOSOVO\"] = 42] = \"KOSOVO\";\n    Country[Country[\"KUWAIT\"] = 43] = \"KUWAIT\";\n    Country[Country[\"LATVIA\"] = 44] = \"LATVIA\";\n    Country[Country[\"LITHUANIA\"] = 45] = \"LITHUANIA\";\n    Country[Country[\"MALAYSIA\"] = 46] = \"MALAYSIA\";\n    Country[Country[\"MALDIVES\"] = 47] = \"MALDIVES\";\n    Country[Country[\"MALTA\"] = 48] = \"MALTA\";\n    Country[Country[\"MAURITIUS\"] = 49] = \"MAURITIUS\";\n    Country[Country[\"MEXICO\"] = 50] = \"MEXICO\";\n    Country[Country[\"MOROCCO\"] = 51] = \"MOROCCO\";\n    Country[Country[\"NETHERLANDS\"] = 52] = \"NETHERLANDS\";\n    Country[Country[\"NEW_ZEALAND\"] = 53] = \"NEW_ZEALAND\";\n    Country[Country[\"NIGERIA\"] = 54] = \"NIGERIA\";\n    Country[Country[\"PAKISTAN\"] = 55] = \"PAKISTAN\";\n    Country[Country[\"PANAMA\"] = 56] = \"PANAMA\";\n    Country[Country[\"PARAGUAY\"] = 57] = \"PARAGUAY\";\n    Country[Country[\"PHILIPPINES\"] = 58] = \"PHILIPPINES\";\n    Country[Country[\"POLAND\"] = 59] = \"POLAND\";\n    Country[Country[\"PORTUGAL\"] = 60] = \"PORTUGAL\";\n    Country[Country[\"PUERTO_RICO\"] = 61] = \"PUERTO_RICO\";\n    Country[Country[\"QATAR\"] = 62] = \"QATAR\";\n    Country[Country[\"ROMANIA\"] = 63] = \"ROMANIA\";\n    Country[Country[\"RUSSIA\"] = 64] = \"RUSSIA\";\n    Country[Country[\"SAUDI_ARABIA\"] = 65] = \"SAUDI_ARABIA\";\n    Country[Country[\"SERBIA\"] = 66] = \"SERBIA\";\n    Country[Country[\"SINGAPORE\"] = 67] = \"SINGAPORE\";\n    Country[Country[\"SLOVAKIA\"] = 68] = \"SLOVAKIA\";\n    Country[Country[\"SLOVENIA\"] = 69] = \"SLOVENIA\";\n    Country[Country[\"SOUTH_AFRICA\"] = 70] = \"SOUTH_AFRICA\";\n    Country[Country[\"SPAIN\"] = 71] = \"SPAIN\";\n    Country[Country[\"SWEDEN\"] = 72] = \"SWEDEN\";\n    Country[Country[\"SWITZERLAND\"] = 73] = \"SWITZERLAND\";\n    Country[Country[\"TAIWAN\"] = 74] = \"TAIWAN\";\n    Country[Country[\"THAILAND\"] = 75] = \"THAILAND\";\n    Country[Country[\"TUNISIA\"] = 76] = \"TUNISIA\";\n    Country[Country[\"TURKEY\"] = 77] = \"TURKEY\";\n    Country[Country[\"UAE\"] = 78] = \"UAE\";\n    Country[Country[\"UGANDA\"] = 79] = \"UGANDA\";\n    Country[Country[\"UK\"] = 80] = \"UK\";\n    Country[Country[\"UKRAINE\"] = 81] = \"UKRAINE\";\n    Country[Country[\"USA\"] = 82] = \"USA\";\n    Country[Country[\"VIETNAM\"] = 83] = \"VIETNAM\";\n    Country[Country[\"BRAZIL\"] = 84] = \"BRAZIL\";\n    Country[Country[\"NORWAY\"] = 85] = \"NORWAY\";\n    Country[Country[\"OMAN\"] = 86] = \"OMAN\";\n    Country[Country[\"ECUADOR\"] = 87] = \"ECUADOR\";\n    Country[Country[\"EL_SALVADOR\"] = 88] = \"EL_SALVADOR\";\n    Country[Country[\"SRI_LANKA\"] = 89] = \"SRI_LANKA\";\n    Country[Country[\"PERU\"] = 90] = \"PERU\";\n    Country[Country[\"URUGUAY\"] = 91] = \"URUGUAY\";\n    Country[Country[\"BAHAMAS\"] = 92] = \"BAHAMAS\";\n    Country[Country[\"BERMUDA\"] = 93] = \"BERMUDA\";\n    Country[Country[\"BOLIVIA\"] = 94] = \"BOLIVIA\";\n    Country[Country[\"CHINA\"] = 95] = \"CHINA\";\n    Country[Country[\"EUROPEAN_UNION\"] = 96] = \"EUROPEAN_UNION\";\n    Country[Country[\"HAITI\"] = 97] = \"HAITI\";\n    Country[Country[\"HONDURAS\"] = 98] = \"HONDURAS\";\n    Country[Country[\"ICELAND\"] = 99] = \"ICELAND\";\n    Country[Country[\"JAPAN\"] = 100] = \"JAPAN\";\n    Country[Country[\"LUXEMBOURG\"] = 101] = \"LUXEMBOURG\";\n    Country[Country[\"MONTENEGRO\"] = 102] = \"MONTENEGRO\";\n    Country[Country[\"NICARAGUA\"] = 103] = \"NICARAGUA\";\n    Country[Country[\"SOUTH_KOREA\"] = 104] = \"SOUTH_KOREA\";\n    Country[Country[\"VENEZUELA\"] = 105] = \"VENEZUELA\";\n    Country[Country[\"AFGHANISTAN\"] = 106] = \"AFGHANISTAN\";\n    Country[Country[\"ALAND_ISLANDS\"] = 107] = \"ALAND_ISLANDS\";\n    Country[Country[\"AMERICAN_SAMOA\"] = 108] = \"AMERICAN_SAMOA\";\n    Country[Country[\"ANDORRA\"] = 109] = \"ANDORRA\";\n    Country[Country[\"ANGOLA\"] = 110] = \"ANGOLA\";\n    Country[Country[\"ANGUILLA\"] = 111] = \"ANGUILLA\";\n    Country[Country[\"ANTARCTICA\"] = 112] = \"ANTARCTICA\";\n    Country[Country[\"ANTIGUA_AND_BARBUDA\"] = 113] = \"ANTIGUA_AND_BARBUDA\";\n    Country[Country[\"ARMENIA\"] = 114] = \"ARMENIA\";\n    Country[Country[\"ARUBA\"] = 115] = \"ARUBA\";\n    Country[Country[\"BAILIWICK_OF_GUERNSEY\"] = 116] = \"BAILIWICK_OF_GUERNSEY\";\n    Country[Country[\"BAILIWICK_OF_JERSEY\"] = 117] = \"BAILIWICK_OF_JERSEY\";\n    Country[Country[\"BARBADOS\"] = 118] = \"BARBADOS\";\n    Country[Country[\"BELARUS\"] = 119] = \"BELARUS\";\n    Country[Country[\"BELIZE\"] = 120] = \"BELIZE\";\n    Country[Country[\"BENIN\"] = 121] = \"BENIN\";\n    Country[Country[\"BHUTAN\"] = 122] = \"BHUTAN\";\n    Country[Country[\"BONAIRE_SAINT_EUSTATIUS_AND_SABA\"] = 123] = \"BONAIRE_SAINT_EUSTATIUS_AND_SABA\";\n    Country[Country[\"BOTSWANA\"] = 124] = \"BOTSWANA\";\n    Country[Country[\"BOUVET_ISLAND\"] = 125] = \"BOUVET_ISLAND\";\n    Country[Country[\"BRITISH_INDIAN_OCEAN_TERRITORY\"] = 126] = \"BRITISH_INDIAN_OCEAN_TERRITORY\";\n    Country[Country[\"BURKINA_FASO\"] = 127] = \"BURKINA_FASO\";\n    Country[Country[\"BURUNDI\"] = 128] = \"BURUNDI\";\n    Country[Country[\"CAMEROON\"] = 129] = \"CAMEROON\";\n    Country[Country[\"CAPE_VERDE\"] = 130] = \"CAPE_VERDE\";\n    Country[Country[\"CARIBBEAN_NETHERLANDS\"] = 131] = \"CARIBBEAN_NETHERLANDS\";\n    Country[Country[\"CAYMAN_ISLANDS\"] = 132] = \"CAYMAN_ISLANDS\";\n    Country[Country[\"CENTRAL_AFRICAN_REPUBLIC\"] = 133] = \"CENTRAL_AFRICAN_REPUBLIC\";\n    Country[Country[\"CHAD\"] = 134] = \"CHAD\";\n    Country[Country[\"CHRISTMAS_ISLAND\"] = 135] = \"CHRISTMAS_ISLAND\";\n    Country[Country[\"COCOS_ISLANDS\"] = 136] = \"COCOS_ISLANDS\";\n    Country[Country[\"COMOROS\"] = 137] = \"COMOROS\";\n    Country[Country[\"CONGO\"] = 138] = \"CONGO\";\n    Country[Country[\"COOK_ISLANDS\"] = 139] = \"COOK_ISLANDS\";\n    Country[Country[\"CUBA\"] = 140] = \"CUBA\";\n    Country[Country[\"CURACAO\"] = 141] = \"CURACAO\";\n    Country[Country[\"DEMOCRATIC_REPUBLIC_OF_THE_CONGO\"] = 142] = \"DEMOCRATIC_REPUBLIC_OF_THE_CONGO\";\n    Country[Country[\"DJIBOUTI\"] = 143] = \"DJIBOUTI\";\n    Country[Country[\"DOMINICA\"] = 144] = \"DOMINICA\";\n    Country[Country[\"EAST_TIMOR\"] = 145] = \"EAST_TIMOR\";\n    Country[Country[\"EQUATORIAL_GUINEA\"] = 146] = \"EQUATORIAL_GUINEA\";\n    Country[Country[\"ERITREA\"] = 147] = \"ERITREA\";\n    Country[Country[\"ETHIOPIA\"] = 148] = \"ETHIOPIA\";\n    Country[Country[\"FALKLAND_ISLANDS\"] = 149] = \"FALKLAND_ISLANDS\";\n    Country[Country[\"FAROE_ISLANDS\"] = 150] = \"FAROE_ISLANDS\";\n    Country[Country[\"FEDERATED_STATES_OF_MICRONESIA\"] = 151] = \"FEDERATED_STATES_OF_MICRONESIA\";\n    Country[Country[\"FIJI\"] = 152] = \"FIJI\";\n    Country[Country[\"FRENCH_GUIANA\"] = 153] = \"FRENCH_GUIANA\";\n    Country[Country[\"FRENCH_POLYNESIA\"] = 154] = \"FRENCH_POLYNESIA\";\n    Country[Country[\"FRENCH_SOUTHERN_TERRITORIES\"] = 155] = \"FRENCH_SOUTHERN_TERRITORIES\";\n    Country[Country[\"GABON\"] = 156] = \"GABON\";\n    Country[Country[\"GAMBIA\"] = 157] = \"GAMBIA\";\n    Country[Country[\"GIBRALTAR\"] = 158] = \"GIBRALTAR\";\n    Country[Country[\"GREENLAND\"] = 159] = \"GREENLAND\";\n    Country[Country[\"GRENADA\"] = 160] = \"GRENADA\";\n    Country[Country[\"GUADELOUPE\"] = 161] = \"GUADELOUPE\";\n    Country[Country[\"GUAM\"] = 162] = \"GUAM\";\n    Country[Country[\"GUINEA\"] = 163] = \"GUINEA\";\n    Country[Country[\"GUINEA_BISSAU\"] = 164] = \"GUINEA_BISSAU\";\n    Country[Country[\"GUYANA\"] = 165] = \"GUYANA\";\n    Country[Country[\"HEARD_ISLAND_AND_MCDONALD_ISLANDS\"] = 166] = \"HEARD_ISLAND_AND_MCDONALD_ISLANDS\";\n    Country[Country[\"IRAN\"] = 167] = \"IRAN\";\n    Country[Country[\"IRAQ\"] = 168] = \"IRAQ\";\n    Country[Country[\"ISLE_OF_MAN\"] = 169] = \"ISLE_OF_MAN\";\n    Country[Country[\"IVORY_COAST\"] = 170] = \"IVORY_COAST\";\n    Country[Country[\"JAMAICA\"] = 171] = \"JAMAICA\";\n    Country[Country[\"KIRIBATI\"] = 172] = \"KIRIBATI\";\n    Country[Country[\"KYRGYZSTAN\"] = 173] = \"KYRGYZSTAN\";\n    Country[Country[\"LAOS\"] = 174] = \"LAOS\";\n    Country[Country[\"LEBANON\"] = 175] = \"LEBANON\";\n    Country[Country[\"LESOTHO\"] = 176] = \"LESOTHO\";\n    Country[Country[\"LIBERIA\"] = 177] = \"LIBERIA\";\n    Country[Country[\"LIBYA\"] = 178] = \"LIBYA\";\n    Country[Country[\"LIECHTENSTEIN\"] = 179] = \"LIECHTENSTEIN\";\n    Country[Country[\"MACAU\"] = 180] = \"MACAU\";\n    Country[Country[\"MADAGASCAR\"] = 181] = \"MADAGASCAR\";\n    Country[Country[\"MALAWI\"] = 182] = \"MALAWI\";\n    Country[Country[\"MALI\"] = 183] = \"MALI\";\n    Country[Country[\"MARSHALL_ISLANDS\"] = 184] = \"MARSHALL_ISLANDS\";\n    Country[Country[\"MARTINIQUE\"] = 185] = \"MARTINIQUE\";\n    Country[Country[\"MAURITANIA\"] = 186] = \"MAURITANIA\";\n    Country[Country[\"MAYOTTE\"] = 187] = \"MAYOTTE\";\n    Country[Country[\"MOLDOVA\"] = 188] = \"MOLDOVA\";\n    Country[Country[\"MONACO\"] = 189] = \"MONACO\";\n    Country[Country[\"MONGOLIA\"] = 190] = \"MONGOLIA\";\n    Country[Country[\"MONTSERRAT\"] = 191] = \"MONTSERRAT\";\n    Country[Country[\"MOZAMBIQUE\"] = 192] = \"MOZAMBIQUE\";\n    Country[Country[\"MYANMAR\"] = 193] = \"MYANMAR\";\n    Country[Country[\"NAMIBIA\"] = 194] = \"NAMIBIA\";\n    Country[Country[\"NAURU\"] = 195] = \"NAURU\";\n    Country[Country[\"NEPAL\"] = 196] = \"NEPAL\";\n    Country[Country[\"NEW_CALEDONIA\"] = 197] = \"NEW_CALEDONIA\";\n    Country[Country[\"NIGER\"] = 198] = \"NIGER\";\n    Country[Country[\"NIUE\"] = 199] = \"NIUE\";\n    Country[Country[\"NORFOLK_ISLAND\"] = 200] = \"NORFOLK_ISLAND\";\n    Country[Country[\"NORTHERN_CYPRUS\"] = 201] = \"NORTHERN_CYPRUS\";\n    Country[Country[\"NORTHERN_MARIANA_ISLANDS\"] = 202] = \"NORTHERN_MARIANA_ISLANDS\";\n    Country[Country[\"NORTH_KOREA\"] = 203] = \"NORTH_KOREA\";\n    Country[Country[\"NORTH_MACEDONIA\"] = 204] = \"NORTH_MACEDONIA\";\n    Country[Country[\"PALAU\"] = 205] = \"PALAU\";\n    Country[Country[\"PALESTINE\"] = 206] = \"PALESTINE\";\n    Country[Country[\"PAPUA_NEW_GUINEA\"] = 207] = \"PAPUA_NEW_GUINEA\";\n    Country[Country[\"PITCAIRN\"] = 208] = \"PITCAIRN\";\n    Country[Country[\"REUNION\"] = 209] = \"REUNION\";\n    Country[Country[\"RWANDA\"] = 210] = \"RWANDA\";\n    Country[Country[\"SAINT_BARTHELEMY\"] = 211] = \"SAINT_BARTHELEMY\";\n    Country[Country[\"SAINT_HELENA_ASCENSION_AND_TRISTIAN_DA_CUNHA\"] = 212] = \"SAINT_HELENA_ASCENSION_AND_TRISTIAN_DA_CUNHA\";\n    Country[Country[\"SAINT_KITTS_AND_NEVIS\"] = 213] = \"SAINT_KITTS_AND_NEVIS\";\n    Country[Country[\"SAINT_LUCIA\"] = 214] = \"SAINT_LUCIA\";\n    Country[Country[\"SAINT_MARTIN\"] = 215] = \"SAINT_MARTIN\";\n    Country[Country[\"SAINT_PIERRE_AND_MIQUELON\"] = 216] = \"SAINT_PIERRE_AND_MIQUELON\";\n    Country[Country[\"SAINT_VINCENT_AND_THE_GRENADINES\"] = 217] = \"SAINT_VINCENT_AND_THE_GRENADINES\";\n    Country[Country[\"SAMOA\"] = 218] = \"SAMOA\";\n    Country[Country[\"SAN_MARINO\"] = 219] = \"SAN_MARINO\";\n    Country[Country[\"SAO_TOME_AND_PRINCIPE\"] = 220] = \"SAO_TOME_AND_PRINCIPE\";\n    Country[Country[\"SENEGAL\"] = 221] = \"SENEGAL\";\n    Country[Country[\"SEYCHELLES\"] = 222] = \"SEYCHELLES\";\n    Country[Country[\"SIERRA_LEONE\"] = 223] = \"SIERRA_LEONE\";\n    Country[Country[\"SINT_MAARTEN\"] = 224] = \"SINT_MAARTEN\";\n    Country[Country[\"SOLOMON_ISLANDS\"] = 225] = \"SOLOMON_ISLANDS\";\n    Country[Country[\"SOMALIA\"] = 226] = \"SOMALIA\";\n    Country[Country[\"SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS\"] = 227] = \"SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS\";\n    Country[Country[\"SOUTH_SUDAN\"] = 228] = \"SOUTH_SUDAN\";\n    Country[Country[\"SUDAN\"] = 229] = \"SUDAN\";\n    Country[Country[\"SURINAME\"] = 230] = \"SURINAME\";\n    Country[Country[\"SVALBARD_AND_JAN_MAYEN\"] = 231] = \"SVALBARD_AND_JAN_MAYEN\";\n    Country[Country[\"ESWATINI\"] = 232] = \"ESWATINI\";\n    Country[Country[\"SYRIA\"] = 233] = \"SYRIA\";\n    Country[Country[\"TAJIKISTAN\"] = 234] = \"TAJIKISTAN\";\n    Country[Country[\"TANZANIA\"] = 235] = \"TANZANIA\";\n    Country[Country[\"TOGO\"] = 236] = \"TOGO\";\n    Country[Country[\"TOKELAU\"] = 237] = \"TOKELAU\";\n    Country[Country[\"TONGA\"] = 238] = \"TONGA\";\n    Country[Country[\"TRINIDAD_AND_TOBAGO\"] = 239] = \"TRINIDAD_AND_TOBAGO\";\n    Country[Country[\"TURKMENISTAN\"] = 240] = \"TURKMENISTAN\";\n    Country[Country[\"TURKS_AND_CAICOS_ISLANDS\"] = 241] = \"TURKS_AND_CAICOS_ISLANDS\";\n    Country[Country[\"TUVALU\"] = 242] = \"TUVALU\";\n    Country[Country[\"UNITED_STATES_MINOR_OUTLYING_ISLANDS\"] = 243] = \"UNITED_STATES_MINOR_OUTLYING_ISLANDS\";\n    Country[Country[\"UZBEKISTAN\"] = 244] = \"UZBEKISTAN\";\n    Country[Country[\"VANUATU\"] = 245] = \"VANUATU\";\n    Country[Country[\"VATICAN_CITY\"] = 246] = \"VATICAN_CITY\";\n    Country[Country[\"VIRGIN_ISLANDS_BRITISH\"] = 247] = \"VIRGIN_ISLANDS_BRITISH\";\n    Country[Country[\"VIRGIN_ISLANDS_US\"] = 248] = \"VIRGIN_ISLANDS_US\";\n    Country[Country[\"WALLIS_AND_FUTUNA\"] = 249] = \"WALLIS_AND_FUTUNA\";\n    Country[Country[\"WESTERN_SAHARA\"] = 250] = \"WESTERN_SAHARA\";\n    Country[Country[\"YEMEN\"] = 251] = \"YEMEN\";\n    Country[Country[\"YUGOSLAVIA\"] = 252] = \"YUGOSLAVIA\";\n    Country[Country[\"ZAMBIA\"] = 253] = \"ZAMBIA\";\n    Country[Country[\"ZIMBABWE\"] = 254] = \"ZIMBABWE\";\n    Country[Country[\"SCHENGEN_AREA\"] = 255] = \"SCHENGEN_AREA\";\n    Country[Country[\"COUNT\"] = 256] = \"COUNT\";\n})(Country || (Country = {}));\nvar Region;\n(function (Region) {\n    Region[Region[\"NONE\"] = 0] = \"NONE\";\n    Region[Region[\"ALABAMA\"] = 1] = \"ALABAMA\";\n    Region[Region[\"ALASKA\"] = 2] = \"ALASKA\";\n    Region[Region[\"ALBERTA\"] = 3] = \"ALBERTA\";\n    Region[Region[\"ARIZONA\"] = 4] = \"ARIZONA\";\n    Region[Region[\"ARKANSAS\"] = 5] = \"ARKANSAS\";\n    Region[Region[\"AUSTRALIAN_CAPITAL_TERRITORY\"] = 6] = \"AUSTRALIAN_CAPITAL_TERRITORY\";\n    Region[Region[\"BRITISH_COLUMBIA\"] = 7] = \"BRITISH_COLUMBIA\";\n    Region[Region[\"CALIFORNIA\"] = 8] = \"CALIFORNIA\";\n    Region[Region[\"COLORADO\"] = 9] = \"COLORADO\";\n    Region[Region[\"CONNECTICUT\"] = 10] = \"CONNECTICUT\";\n    Region[Region[\"DELAWARE\"] = 11] = \"DELAWARE\";\n    Region[Region[\"DISTRICT_OF_COLUMBIA\"] = 12] = \"DISTRICT_OF_COLUMBIA\";\n    Region[Region[\"FLORIDA\"] = 13] = \"FLORIDA\";\n    Region[Region[\"GEORGIA\"] = 14] = \"GEORGIA\";\n    Region[Region[\"HAWAII\"] = 15] = \"HAWAII\";\n    Region[Region[\"IDAHO\"] = 16] = \"IDAHO\";\n    Region[Region[\"ILLINOIS\"] = 17] = \"ILLINOIS\";\n    Region[Region[\"INDIANA\"] = 18] = \"INDIANA\";\n    Region[Region[\"IOWA\"] = 19] = \"IOWA\";\n    Region[Region[\"KANSAS\"] = 20] = \"KANSAS\";\n    Region[Region[\"KENTUCKY\"] = 21] = \"KENTUCKY\";\n    Region[Region[\"LOUISIANA\"] = 22] = \"LOUISIANA\";\n    Region[Region[\"MAINE\"] = 23] = \"MAINE\";\n    Region[Region[\"MANITOBA\"] = 24] = \"MANITOBA\";\n    Region[Region[\"MARYLAND\"] = 25] = \"MARYLAND\";\n    Region[Region[\"MASSACHUSETTS\"] = 26] = \"MASSACHUSETTS\";\n    Region[Region[\"MICHIGAN\"] = 27] = \"MICHIGAN\";\n    Region[Region[\"MINNESOTA\"] = 28] = \"MINNESOTA\";\n    Region[Region[\"MISSISSIPPI\"] = 29] = \"MISSISSIPPI\";\n    Region[Region[\"MISSOURI\"] = 30] = \"MISSOURI\";\n    Region[Region[\"MONTANA\"] = 31] = \"MONTANA\";\n    Region[Region[\"NEBRASKA\"] = 32] = \"NEBRASKA\";\n    Region[Region[\"NEVADA\"] = 33] = \"NEVADA\";\n    Region[Region[\"NEW_BRUNSWICK\"] = 34] = \"NEW_BRUNSWICK\";\n    Region[Region[\"NEW_HAMPSHIRE\"] = 35] = \"NEW_HAMPSHIRE\";\n    Region[Region[\"NEW_JERSEY\"] = 36] = \"NEW_JERSEY\";\n    Region[Region[\"NEW_MEXICO\"] = 37] = \"NEW_MEXICO\";\n    Region[Region[\"NEW_SOUTH_WALES\"] = 38] = \"NEW_SOUTH_WALES\";\n    Region[Region[\"NEW_YORK\"] = 39] = \"NEW_YORK\";\n    Region[Region[\"NORTHERN_TERRITORY\"] = 40] = \"NORTHERN_TERRITORY\";\n    Region[Region[\"NORTH_CAROLINA\"] = 41] = \"NORTH_CAROLINA\";\n    Region[Region[\"NORTH_DAKOTA\"] = 42] = \"NORTH_DAKOTA\";\n    Region[Region[\"NOVA_SCOTIA\"] = 43] = \"NOVA_SCOTIA\";\n    Region[Region[\"OHIO\"] = 44] = \"OHIO\";\n    Region[Region[\"OKLAHOMA\"] = 45] = \"OKLAHOMA\";\n    Region[Region[\"ONTARIO\"] = 46] = \"ONTARIO\";\n    Region[Region[\"OREGON\"] = 47] = \"OREGON\";\n    Region[Region[\"PENNSYLVANIA\"] = 48] = \"PENNSYLVANIA\";\n    Region[Region[\"QUEBEC\"] = 49] = \"QUEBEC\";\n    Region[Region[\"QUEENSLAND\"] = 50] = \"QUEENSLAND\";\n    Region[Region[\"RHODE_ISLAND\"] = 51] = \"RHODE_ISLAND\";\n    Region[Region[\"SASKATCHEWAN\"] = 52] = \"SASKATCHEWAN\";\n    Region[Region[\"SOUTH_AUSTRALIA\"] = 53] = \"SOUTH_AUSTRALIA\";\n    Region[Region[\"SOUTH_CAROLINA\"] = 54] = \"SOUTH_CAROLINA\";\n    Region[Region[\"SOUTH_DAKOTA\"] = 55] = \"SOUTH_DAKOTA\";\n    Region[Region[\"TASMANIA\"] = 56] = \"TASMANIA\";\n    Region[Region[\"TENNESSEE\"] = 57] = \"TENNESSEE\";\n    Region[Region[\"TEXAS\"] = 58] = \"TEXAS\";\n    Region[Region[\"UTAH\"] = 59] = \"UTAH\";\n    Region[Region[\"VERMONT\"] = 60] = \"VERMONT\";\n    Region[Region[\"VICTORIA\"] = 61] = \"VICTORIA\";\n    Region[Region[\"VIRGINIA\"] = 62] = \"VIRGINIA\";\n    Region[Region[\"WASHINGTON\"] = 63] = \"WASHINGTON\";\n    Region[Region[\"WESTERN_AUSTRALIA\"] = 64] = \"WESTERN_AUSTRALIA\";\n    Region[Region[\"WEST_VIRGINIA\"] = 65] = \"WEST_VIRGINIA\";\n    Region[Region[\"WISCONSIN\"] = 66] = \"WISCONSIN\";\n    Region[Region[\"WYOMING\"] = 67] = \"WYOMING\";\n    Region[Region[\"YUKON\"] = 68] = \"YUKON\";\n    Region[Region[\"CIUDAD_DE_MEXICO\"] = 69] = \"CIUDAD_DE_MEXICO\";\n    Region[Region[\"JALISCO\"] = 70] = \"JALISCO\";\n    Region[Region[\"NEWFOUNDLAND_AND_LABRADOR\"] = 71] = \"NEWFOUNDLAND_AND_LABRADOR\";\n    Region[Region[\"NUEVO_LEON\"] = 72] = \"NUEVO_LEON\";\n    Region[Region[\"BAJA_CALIFORNIA\"] = 73] = \"BAJA_CALIFORNIA\";\n    Region[Region[\"CHIHUAHUA\"] = 74] = \"CHIHUAHUA\";\n    Region[Region[\"GUANAJUATO\"] = 75] = \"GUANAJUATO\";\n    Region[Region[\"GUERRERO\"] = 76] = \"GUERRERO\";\n    Region[Region[\"MEXICO\"] = 77] = \"MEXICO\";\n    Region[Region[\"MICHOACAN\"] = 78] = \"MICHOACAN\";\n    Region[Region[\"NEW_YORK_CITY\"] = 79] = \"NEW_YORK_CITY\";\n    Region[Region[\"TAMAULIPAS\"] = 80] = \"TAMAULIPAS\";\n    Region[Region[\"VERACRUZ\"] = 81] = \"VERACRUZ\";\n    Region[Region[\"CHIAPAS\"] = 82] = \"CHIAPAS\";\n    Region[Region[\"COAHUILA\"] = 83] = \"COAHUILA\";\n    Region[Region[\"DURANGO\"] = 84] = \"DURANGO\";\n    Region[Region[\"GUERRERO_COCULA\"] = 85] = \"GUERRERO_COCULA\";\n    Region[Region[\"GUERRERO_JUCHITAN\"] = 86] = \"GUERRERO_JUCHITAN\";\n    Region[Region[\"GUERRERO_TEPECOACUILCO\"] = 87] = \"GUERRERO_TEPECOACUILCO\";\n    Region[Region[\"GUERRERO_TLACOAPA\"] = 88] = \"GUERRERO_TLACOAPA\";\n    Region[Region[\"GUJARAT\"] = 89] = \"GUJARAT\";\n    Region[Region[\"HIDALGO\"] = 90] = \"HIDALGO\";\n    Region[Region[\"KARNATAKA\"] = 91] = \"KARNATAKA\";\n    Region[Region[\"KERALA\"] = 92] = \"KERALA\";\n    Region[Region[\"KHYBER_PAKHTUNKHWA\"] = 93] = \"KHYBER_PAKHTUNKHWA\";\n    Region[Region[\"MADHYA_PRADESH\"] = 94] = \"MADHYA_PRADESH\";\n    Region[Region[\"MAHARASHTRA\"] = 95] = \"MAHARASHTRA\";\n    Region[Region[\"MORELOS\"] = 96] = \"MORELOS\";\n    Region[Region[\"NAYARIT\"] = 97] = \"NAYARIT\";\n    Region[Region[\"OAXACA\"] = 98] = \"OAXACA\";\n    Region[Region[\"PUEBLA\"] = 99] = \"PUEBLA\";\n    Region[Region[\"PUNJAB\"] = 100] = \"PUNJAB\";\n    Region[Region[\"QUERETARO\"] = 101] = \"QUERETARO\";\n    Region[Region[\"SAN_LUIS_POTOSI\"] = 102] = \"SAN_LUIS_POTOSI\";\n    Region[Region[\"SINALOA\"] = 103] = \"SINALOA\";\n    Region[Region[\"SONORA\"] = 104] = \"SONORA\";\n    Region[Region[\"TABASCO\"] = 105] = \"TABASCO\";\n    Region[Region[\"TAMIL_NADU\"] = 106] = \"TAMIL_NADU\";\n    Region[Region[\"YUCATAN\"] = 107] = \"YUCATAN\";\n    Region[Region[\"ZACATECAS\"] = 108] = \"ZACATECAS\";\n    Region[Region[\"AGUASCALIENTES\"] = 109] = \"AGUASCALIENTES\";\n    Region[Region[\"BAJA_CALIFORNIA_SUR\"] = 110] = \"BAJA_CALIFORNIA_SUR\";\n    Region[Region[\"CAMPECHE\"] = 111] = \"CAMPECHE\";\n    Region[Region[\"COLIMA\"] = 112] = \"COLIMA\";\n    Region[Region[\"QUINTANA_ROO_BENITO_JUAREZ\"] = 113] = \"QUINTANA_ROO_BENITO_JUAREZ\";\n    Region[Region[\"UINTANA_ROO\"] = 114] = \"UINTANA_ROO\";\n    Region[Region[\"QUINTANA_ROO_SOLIDARIDAD\"] = 115] = \"QUINTANA_ROO_SOLIDARIDAD\";\n    Region[Region[\"TLAXCALA\"] = 116] = \"TLAXCALA\";\n    Region[Region[\"QUINTANA_ROO_COZUMEL\"] = 117] = \"QUINTANA_ROO_COZUMEL\";\n    Region[Region[\"SAO_PAOLO\"] = 118] = \"SAO_PAOLO\";\n    Region[Region[\"RIO_DE_JANEIRO\"] = 119] = \"RIO_DE_JANEIRO\";\n    Region[Region[\"RIO_GRANDE_DO_SUL\"] = 120] = \"RIO_GRANDE_DO_SUL\";\n    Region[Region[\"NORTHWEST_TERRITORIES\"] = 121] = \"NORTHWEST_TERRITORIES\";\n    Region[Region[\"NUNAVUT\"] = 122] = \"NUNAVUT\";\n    Region[Region[\"PRINCE_EDWARD_ISLAND\"] = 123] = \"PRINCE_EDWARD_ISLAND\";\n    Region[Region[\"COUNT\"] = 124] = \"COUNT\";\n})(Region || (Region = {}));\nvar DocumentType;\n(function (DocumentType) {\n    DocumentType[DocumentType[\"NONE\"] = 0] = \"NONE\";\n    DocumentType[DocumentType[\"CONSULAR_ID\"] = 1] = \"CONSULAR_ID\";\n    DocumentType[DocumentType[\"DL\"] = 2] = \"DL\";\n    DocumentType[DocumentType[\"DL_PUBLIC_SERVICES_CARD\"] = 3] = \"DL_PUBLIC_SERVICES_CARD\";\n    DocumentType[DocumentType[\"EMPLOYMENT_PASS\"] = 4] = \"EMPLOYMENT_PASS\";\n    DocumentType[DocumentType[\"FIN_CARD\"] = 5] = \"FIN_CARD\";\n    DocumentType[DocumentType[\"ID\"] = 6] = \"ID\";\n    DocumentType[DocumentType[\"MULTIPURPOSE_ID\"] = 7] = \"MULTIPURPOSE_ID\";\n    DocumentType[DocumentType[\"MYKAD\"] = 8] = \"MYKAD\";\n    DocumentType[DocumentType[\"MYKID\"] = 9] = \"MYKID\";\n    DocumentType[DocumentType[\"MYPR\"] = 10] = \"MYPR\";\n    DocumentType[DocumentType[\"MYTENTERA\"] = 11] = \"MYTENTERA\";\n    DocumentType[DocumentType[\"PAN_CARD\"] = 12] = \"PAN_CARD\";\n    DocumentType[DocumentType[\"PROFESSIONAL_ID\"] = 13] = \"PROFESSIONAL_ID\";\n    DocumentType[DocumentType[\"PUBLIC_SERVICES_CARD\"] = 14] = \"PUBLIC_SERVICES_CARD\";\n    DocumentType[DocumentType[\"RESIDENCE_PERMIT\"] = 15] = \"RESIDENCE_PERMIT\";\n    DocumentType[DocumentType[\"RESIDENT_ID\"] = 16] = \"RESIDENT_ID\";\n    DocumentType[DocumentType[\"TEMPORARY_RESIDENCE_PERMIT\"] = 17] = \"TEMPORARY_RESIDENCE_PERMIT\";\n    DocumentType[DocumentType[\"VOTER_ID\"] = 18] = \"VOTER_ID\";\n    DocumentType[DocumentType[\"WORK_PERMIT\"] = 19] = \"WORK_PERMIT\";\n    DocumentType[DocumentType[\"IKAD\"] = 20] = \"IKAD\";\n    DocumentType[DocumentType[\"MILITARY_ID\"] = 21] = \"MILITARY_ID\";\n    DocumentType[DocumentType[\"MYKAS\"] = 22] = \"MYKAS\";\n    DocumentType[DocumentType[\"SOCIAL_SECURITY_CARD\"] = 23] = \"SOCIAL_SECURITY_CARD\";\n    DocumentType[DocumentType[\"HEALTH_INSURANCE_CARD\"] = 24] = \"HEALTH_INSURANCE_CARD\";\n    DocumentType[DocumentType[\"PASSPORT\"] = 25] = \"PASSPORT\";\n    DocumentType[DocumentType[\"S_PASS\"] = 26] = \"S_PASS\";\n    DocumentType[DocumentType[\"ADDRESS_CARD\"] = 27] = \"ADDRESS_CARD\";\n    DocumentType[DocumentType[\"ALIEN_ID\"] = 28] = \"ALIEN_ID\";\n    DocumentType[DocumentType[\"ALIEN_PASSPORT\"] = 29] = \"ALIEN_PASSPORT\";\n    DocumentType[DocumentType[\"GREEN_CARD\"] = 30] = \"GREEN_CARD\";\n    DocumentType[DocumentType[\"MINORS_ID\"] = 31] = \"MINORS_ID\";\n    DocumentType[DocumentType[\"POSTAL_ID\"] = 32] = \"POSTAL_ID\";\n    DocumentType[DocumentType[\"PROFESSIONAL_DL\"] = 33] = \"PROFESSIONAL_DL\";\n    DocumentType[DocumentType[\"TAX_ID\"] = 34] = \"TAX_ID\";\n    DocumentType[DocumentType[\"WEAPON_PERMIT\"] = 35] = \"WEAPON_PERMIT\";\n    DocumentType[DocumentType[\"VISA\"] = 36] = \"VISA\";\n    DocumentType[DocumentType[\"BORDER_CROSSING_CARD\"] = 37] = \"BORDER_CROSSING_CARD\";\n    DocumentType[DocumentType[\"DRIVER_CARD\"] = 38] = \"DRIVER_CARD\";\n    DocumentType[DocumentType[\"GLOBAL_ENTRY_CARD\"] = 39] = \"GLOBAL_ENTRY_CARD\";\n    DocumentType[DocumentType[\"MYPOLIS\"] = 40] = \"MYPOLIS\";\n    DocumentType[DocumentType[\"NEXUS_CARD\"] = 41] = \"NEXUS_CARD\";\n    DocumentType[DocumentType[\"PASSPORT_CARD\"] = 42] = \"PASSPORT_CARD\";\n    DocumentType[DocumentType[\"PROOF_OF_AGE_CARD\"] = 43] = \"PROOF_OF_AGE_CARD\";\n    DocumentType[DocumentType[\"REFUGEE_ID\"] = 44] = \"REFUGEE_ID\";\n    DocumentType[DocumentType[\"TRIBAL_ID\"] = 45] = \"TRIBAL_ID\";\n    DocumentType[DocumentType[\"VETERAN_ID\"] = 46] = \"VETERAN_ID\";\n    DocumentType[DocumentType[\"CITIZENSHIP_CERTIFICATE\"] = 47] = \"CITIZENSHIP_CERTIFICATE\";\n    DocumentType[DocumentType[\"MY_NUMBER_CARD\"] = 48] = \"MY_NUMBER_CARD\";\n    DocumentType[DocumentType[\"CONSULAR_PASSPORT\"] = 49] = \"CONSULAR_PASSPORT\";\n    DocumentType[DocumentType[\"MINORS_PASSPORT\"] = 50] = \"MINORS_PASSPORT\";\n    DocumentType[DocumentType[\"MINORS_PUBLIC_SERVICES_CARD\"] = 51] = \"MINORS_PUBLIC_SERVICES_CARD\";\n    DocumentType[DocumentType[\"DRIVING_PRIVILEGE_CARD\"] = 52] = \"DRIVING_PRIVILEGE_CARD\";\n    DocumentType[DocumentType[\"ASYLUM_REQUEST\"] = 53] = \"ASYLUM_REQUEST\";\n    DocumentType[DocumentType[\"DRIVER_QUALIFICATION_CARD\"] = 54] = \"DRIVER_QUALIFICATION_CARD\";\n    DocumentType[DocumentType[\"PROVISIONAL_DL\"] = 55] = \"PROVISIONAL_DL\";\n    DocumentType[DocumentType[\"REFUGEE_PASSPORT\"] = 56] = \"REFUGEE_PASSPORT\";\n    DocumentType[DocumentType[\"SPECIAL_ID\"] = 57] = \"SPECIAL_ID\";\n    DocumentType[DocumentType[\"UNIFORMED_SERVICES_ID\"] = 58] = \"UNIFORMED_SERVICES_ID\";\n    DocumentType[DocumentType[\"IMMIGRANT_VISA\"] = 59] = \"IMMIGRANT_VISA\";\n    DocumentType[DocumentType[\"COUNT\"] = 60] = \"COUNT\";\n})(DocumentType || (DocumentType = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * DocumentImageColorStatus enum defines possible color statuses determined from scanned image.\n */\nvar DocumentImageColorStatus;\n(function (DocumentImageColorStatus) {\n    /** Determining image color status was not performed */\n    DocumentImageColorStatus[DocumentImageColorStatus[\"NotAvailable\"] = 0] = \"NotAvailable\";\n    /** Black-and-white image scanned */\n    DocumentImageColorStatus[DocumentImageColorStatus[\"BlackAndWhite\"] = 1] = \"BlackAndWhite\";\n    /** Color image scanned */\n    DocumentImageColorStatus[DocumentImageColorStatus[\"Color\"] = 2] = \"Color\";\n})(DocumentImageColorStatus || (DocumentImageColorStatus = {}));\n/**\n *  ImageAnalysisDetectionStatus enum defines possible states of specific image object detection.\n */\nvar ImageAnalysisDetectionStatus;\n(function (ImageAnalysisDetectionStatus) {\n    /** Detection was not performed */\n    ImageAnalysisDetectionStatus[ImageAnalysisDetectionStatus[\"NotAvailable\"] = 0] = \"NotAvailable\";\n    /** Object not detected on input image */\n    ImageAnalysisDetectionStatus[ImageAnalysisDetectionStatus[\"NotDetected\"] = 1] = \"NotDetected\";\n    /** Object detected on input image */\n    ImageAnalysisDetectionStatus[ImageAnalysisDetectionStatus[\"Detected\"] = 2] = \"Detected\";\n})(ImageAnalysisDetectionStatus || (ImageAnalysisDetectionStatus = {}));\n/**\n * CardOrientation enum defines possible states of card orientation.\n */\nvar CardOrientation;\n(function (CardOrientation) {\n    /** Card is horizontally placed inside the camera frame */\n    CardOrientation[CardOrientation[\"Horizontal\"] = 0] = \"Horizontal\";\n    /** Card is vertically placed inside the camera frame */\n    CardOrientation[CardOrientation[\"Vertical\"] = 1] = \"Vertical\";\n})(CardOrientation || (CardOrientation = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/** Detailed information about the recognition process. */\nvar ProcessingStatus;\n(function (ProcessingStatus) {\n    /** The document was fully scanned and data was extracted as expected. */\n    ProcessingStatus[ProcessingStatus[\"Success\"] = 0] = \"Success\";\n    /** The document was not found on the image. */\n    ProcessingStatus[ProcessingStatus[\"DetectionFailed\"] = 1] = \"DetectionFailed\";\n    /** Preprocessing of the input image has failed. */\n    ProcessingStatus[ProcessingStatus[\"ImagePreprocessingFailed\"] = 2] = \"ImagePreprocessingFailed\";\n    /**\n     * Stability is achieved when the same document is provided on consecutive frames,\n     * resulting in a consistent recognition between frames prior to data extraction.\n     * Valid only for video feed.\n     */\n    ProcessingStatus[ProcessingStatus[\"StabilityTestFailed\"] = 3] = \"StabilityTestFailed\";\n    /**\n     * The wrong side of the document is scanned. Front side scan is completed and back side is expected, but not\n     * provided by the end-user.\n     *\n     * Possible also if front is expected at the start of the scanning process and back is presented first\n     * by the end-user.\n     */\n    ProcessingStatus[ProcessingStatus[\"ScanningWrongSide\"] = 4] = \"ScanningWrongSide\";\n    /** Unexpected fields are present on the document and removed from the final result. */\n    ProcessingStatus[ProcessingStatus[\"FieldIdentificationFailed\"] = 5] = \"FieldIdentificationFailed\";\n    /** Fields expected to appear on the scanned document have not been found. */\n    ProcessingStatus[ProcessingStatus[\"MandatoryFieldMissing\"] = 6] = \"MandatoryFieldMissing\";\n    /**\n     * One of the extracted fields contains a character which does not satisfy the rule defined for that\n     * specific field.\n     *\n     * This processing status can only occur if validateResultCharacters setting is set to true.\n     */\n    ProcessingStatus[ProcessingStatus[\"InvalidCharactersFound\"] = 7] = \"InvalidCharactersFound\";\n    /** Failed to return a requested image. */\n    ProcessingStatus[ProcessingStatus[\"ImageReturnFailed\"] = 8] = \"ImageReturnFailed\";\n    /** Reading or parsing of the barcode has failed. */\n    ProcessingStatus[ProcessingStatus[\"BarcodeRecognitionFailed\"] = 9] = \"BarcodeRecognitionFailed\";\n    /** Parsing of the MRZ has failed. */\n    ProcessingStatus[ProcessingStatus[\"MrzParsingFailed\"] = 10] = \"MrzParsingFailed\";\n    /**\n     * Currently scanned document has been filtered out by its class.\n     * Occurrence of this processing status is affected by classFilter setting.\n     */\n    ProcessingStatus[ProcessingStatus[\"ClassFiltered\"] = 11] = \"ClassFiltered\";\n    /** Document currently not supported by the recognizer. */\n    ProcessingStatus[ProcessingStatus[\"UnsupportedClass\"] = 12] = \"UnsupportedClass\";\n    /** Document class is not included in the issued license. */\n    ProcessingStatus[ProcessingStatus[\"UnsupportedByLicense\"] = 13] = \"UnsupportedByLicense\";\n    /**\n     * Front side recognition has completed successfully, and recognizer is waiting for the other side to be scanned.\n     */\n    ProcessingStatus[ProcessingStatus[\"AwaitingOtherSide\"] = 14] = \"AwaitingOtherSide\";\n    /** If front side recognition has not completed successfully, the back side is not scanned. */\n    ProcessingStatus[ProcessingStatus[\"NotScanned\"] = 15] = \"NotScanned\";\n    /** Number of possible processing statuses. */\n    ProcessingStatus[ProcessingStatus[\"Count\"] = 16] = \"Count\";\n})(ProcessingStatus || (ProcessingStatus = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * RecognitionMode enum defines possible recognition modes for BlinkID Single-side and BlinkID Multi-side recognizers.\n */\nvar RecognitionMode;\n(function (RecognitionMode) {\n    /** No recognition performed. */\n    RecognitionMode[RecognitionMode[\"None\"] = 0] = \"None\";\n    /** Recognition of mrz document (does not include visa and passport) */\n    RecognitionMode[RecognitionMode[\"MrzId\"] = 1] = \"MrzId\";\n    /** Recognition of visa mrz. */\n    RecognitionMode[RecognitionMode[\"MrzVisa\"] = 2] = \"MrzVisa\";\n    /** Recognition of passport mrz. */\n    RecognitionMode[RecognitionMode[\"MrzPassport\"] = 3] = \"MrzPassport\";\n    /** Recognition of documents that have face photo on the front. */\n    RecognitionMode[RecognitionMode[\"PhotoId\"] = 4] = \"PhotoId\";\n    /** Detailed document recognition. */\n    RecognitionMode[RecognitionMode[\"FullRecognition\"] = 5] = \"FullRecognition\";\n    /** Recognition of barcode document. */\n    RecognitionMode[RecognitionMode[\"BarcodeId\"] = 6] = \"BarcodeId\";\n    /** Number of possible values */\n    RecognitionMode[RecognitionMode[\"Count\"] = 7] = \"Count\";\n})(RecognitionMode || (RecognitionMode = {}));\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * A settings object that is used for configuring the BlinkIdSingleSideRecognizer.\n */\nclass BlinkIdSingleSideRecognizerSettings {\n    constructor() {\n        /**\n         * Skip processing of the blurred frames.\n         */\n        this.allowBlurFilter = true;\n        /**\n         * Allow reading of non-standard MRZ (Machine Readable Zone). Only raw MRZ result is returned.\n         * Final recognizer state is not affected.\n         */\n        this.allowUnparsedMrzResults = false;\n        /**\n         * Allow reading of standard MRZ (Machine Readable Zone) which gets successfully parsed, but check digits are\n         * incorrect (do not comply with the ICAO standard).\n         *\n         * Final recognizer state is not affected.\n         */\n        this.allowUnverifiedMrzResults = true;\n        /**\n         * Enable or disable recognition of specific document groups supported by the current license.\n         * By default all modes are enabled.\n         */\n        this.recognitionModeFilter = new RecognitionModeFilter();\n        /**\n         * Save the raw camera frames at the moment of the data extraction or timeout.\n         * This significantly increases memory consumption. The scanning performance is not affected.\n         */\n        this.saveCameraFrames = false;\n        /**\n         * Process only cropped document images with corrected perspective (frontal images of a document).\n         * This only applies to still images - video feed will ignore this setting.\n         */\n        this.scanCroppedDocumentImage = false;\n        /**\n         * Allow only results containing expected characters for a given field.\n         *\n         * Each field is validated against a set of rules.\n         *\n         * All fields have to be successfully validated in order for a recognizer state to be valid.\n         * Setting is used to improve scanning accuracy.\n         */\n        this.validateResultCharacters = true;\n        /**\n         * Redact specific fields based on requirements or laws regarding a specific document.\n         *\n         * Data can be redacted from the image, the result or both.\n         *\n         * The setting applies to certain documents only.\n         */\n        this.anonymizationMode = AnonymizationMode.FullResult;\n        /**\n         * Redact fields for specific document class.\n         *\n         * Fields specified by requirements or laws for a specific document will be redacted regardless of this setting.\n         *\n         * Based on anonymizationMode setting, data will be redacted from the image, the result or both.\n         */\n        this.additionalAnonymization = null;\n        /**\n         * Called when barcode scanning step starts.\n         */\n        this.barcodeScanningStartedCallback = null;\n        /**\n         * Called when recognizer classifies a document.\n         */\n        this.classifierCallback = null;\n        /**\n         * If set to `null`, all supported documents will be recognized.\n         * Otherwise, only classes from given array will be recognized and all other\n         * documents will be treated as \"not supported\" (observable via classifierCallback).\n         */\n        this.allowedDocumentClasses = null;\n        /**\n         * Minimum required distance between the edge of the scanning frame and the document.\n         *\n         * Defined as a percentage of the frame width.\n         *\n         * Default value is 0.0f in which case the padding edge and the image edge are the same.\n         * Alternative recommended value is 0.02f.\n         */\n        this.paddingEdge = 0.0;\n        // implementation of the FullDocumentImageOptions interface\n        this.returnFullDocumentImage = false;\n        this.returnEncodedFullDocumentImage = false;\n        this._fullDocumentImageDpi = 250;\n        this.fullDocumentImageExtensionFactors = new ExtensionFactors();\n        // implementation of the FaceImageOptions interface\n        this.returnFaceImage = false;\n        this.returnEncodedFaceImage = false;\n        this._faceImageDpi = 250;\n        // implementation of the SignatureImageOptions interface\n        this.returnSignatureImage = false;\n        this.returnEncodedSignatureImage = false;\n        this._signatureImageDpi = 250;\n    }\n    get fullDocumentImageDpi() {\n        return this._fullDocumentImageDpi;\n    }\n    set fullDocumentImageDpi(value) {\n        validateDpi(value);\n        this._fullDocumentImageDpi = value;\n    }\n    get faceImageDpi() {\n        return this._faceImageDpi;\n    }\n    set faceImageDpi(value) {\n        validateDpi(value);\n        this._faceImageDpi = value;\n    }\n    get signatureImageDpi() {\n        return this._signatureImageDpi;\n    }\n    set signatureImageDpi(value) {\n        validateDpi(value);\n        this._signatureImageDpi = value;\n    }\n}\n/**\n * This function is used to create a new instance of `BlinkIdSingleSideRecognizer`.\n * @param wasmSDK Instance of WasmSDK which will be used to communicate with the WebAssembly module.\n */\nasync function createBlinkIdSingleSideRecognizer(wasmSDK) {\n    return wasmSDK.mbWasmModule.newRecognizer(\"BlinkIdSingleSideRecognizer\");\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * A settings object that is used for configuring the BlinkIdMultiSideRecognizer.\n */\nclass BlinkIdMultiSideRecognizerSettings extends BlinkIdSingleSideRecognizerSettings {\n    constructor() {\n        super(...arguments);\n        /**\n         * Proceed to scan the back side of a document even if some of the validity checks have failed while scanning the\n         * front side of a document.\n         */\n        this.allowUncertainFrontSideScan = false;\n        /**\n         * Configure the number of characters per field that are allowed to be inconsistent in data match.\n         */\n        this.maxAllowedMismatchesPerField = 0;\n        /**\n         * Back side of the document will not be scanned if only the front side is supported for a specific document.\n         *\n         * If set to false, a photo of the back side will be returned, as well as barcode or MRZ (Machine Readable Zone) if\n         * either is present.\n         */\n        this.skipUnsupportedBack = false;\n    }\n}\n/**\n * This function is used to create a new instance of `BlinkIdMultiSideRecognizer`.\n * @param wasmSDK Instance of WasmSDK which will be used to communicate with the WebAssembly module.\n */\nasync function createBlinkIdMultiSideRecognizer(wasmSDK) {\n    return wasmSDK.mbWasmModule.newRecognizer(\"BlinkIdMultiSideRecognizer\");\n}\n\n/**\n * Copyright (c) Microblink Ltd. All rights reserved.\n */\n/**\n * A settings object that is used for configuring the IdBarcodeRecognizer.\n */\nclass IdBarcodeRecognizerSettings {\n}\n/**\n * This function is used to create a new instance of `IdBarcodeRecognizer`.\n * @param wasmSDK Instance of WasmSDK which will be used to communicate with the WebAssembly module.\n */\nasync function createIdBarcodeRecognizer(wasmSDK) {\n    return wasmSDK.mbWasmModule.newRecognizer(\"IdBarcodeRecognizer\");\n}\n/**\n * Represents the type of scanned document\n */\nvar IdBarcodeDocumentType;\n(function (IdBarcodeDocumentType) {\n    /**\n     * No document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"None\"] = 0] = \"None\";\n    /**\n     * AAMVACompliant document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"AAMVACompliant\"] = 1] = \"AAMVACompliant\";\n    /**\n     * ArgentinaID document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"ArgentinaID\"] = 2] = \"ArgentinaID\";\n    /**\n     * ArgentinaAlienID document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"ArgentinaAlienID\"] = 3] = \"ArgentinaAlienID\";\n    /**\n     * ArgentinaDL document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"ArgentinaDL\"] = 4] = \"ArgentinaDL\";\n    /**\n     * ColombiaID document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"ColombiaID\"] = 5] = \"ColombiaID\";\n    /**\n     * ColombiaDL document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"ColombiaDL\"] = 6] = \"ColombiaDL\";\n    /**\n     * NigeriaVoterID document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"NigeriaVoterID\"] = 7] = \"NigeriaVoterID\";\n    /**\n     * NigeriaDL document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"NigeriaDL\"] = 8] = \"NigeriaDL\";\n    /**\n     * PanamaID document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"PanamaID\"] = 9] = \"PanamaID\";\n    /**\n     * SouthAfricaID document was scanned\n     */\n    IdBarcodeDocumentType[IdBarcodeDocumentType[\"SouthAfricaID\"] = 10] = \"SouthAfricaID\";\n})(IdBarcodeDocumentType || (IdBarcodeDocumentType = {}));\n\nexport { AnonymizationMode, BarcodeElementKey, BarcodeFormat, BlinkIdMultiSideRecognizerSettings, BlinkIdSingleSideRecognizerSettings, CapturedFrame, CardOrientation, Country, DetectionStatus, DocumentImageColorStatus, DocumentSide, DocumentType, ErrorCodes, ErrorMessages, ExtensionFactors, IdBarcodeDocumentType, IdBarcodeRecognizerSettings, ImageAnalysisDetectionStatus, ImageOrientation, LicenseErrorType, LicenseTokenState, PreferredCameraType, ProcessingStatus, RecognitionMode, RecognitionModeFilter, RecognizerResultState, Region, SDKError, SelectedCamera, ServerPermissionSubmitResultStatus, VideoRecognitionMode, VideoRecognizer, WasmSDKLoadSettings, WasmType, bindCameraToVideoFeed, captureFrame, createBlinkIdMultiSideRecognizer, createBlinkIdSingleSideRecognizer, createIdBarcodeRecognizer, createRecognizerRunner, detectWasmType, frameCaptureErrors, getCameraDevices, getiOSVersion, isAndroidDevice, isBrowserSupported, isCameraFocusProblematic, isInAppBrowser, licenseErrors, loadWasmModule, localSdkErrors, obtainNewServerPermission, sdkErrors, selectCamera, unlockWasmSDK, validateDpi, videoRecognizerErrors, wasmFolder, workerErrors };\n//# sourceMappingURL=blinkid-sdk.js.map\n","'use strict';\n\nimport { Observable, Subscriber, Subscription } from \"rxjs\"\nimport * as BlinkIDSDK from \"@microblink/blinkid-in-browser-sdk\"\nimport { FaceRecognition } from \"./faceRecognition\"\nimport { emitRxEvent } from \"./utils\"\nimport { Rect } from \"./types\";\nimport {\n    Size,\n    RecognizableFace,\n    DocumentPages,\n    IdCaptureResponse,\n    IdCaptureResult,\n    IdCaptureUI,\n    SupportedRecognizerResult,\n    ProgressListener,\n    SupportedRecognizer,\n    RecognizerName,\n    IdCaptureUIFactory,\n    IdCaptureEvent,\n    IdCaptureEventType,\n    IdCaptureProgressEvent,\n    DocumentSide\n} from \"./types\"\nimport { \n    BlinkIdMultiSideRecognizerSettings, \n    RecognizerRunner, \n    VideoRecognizer, \n    WasmSDK, \n    WasmSDKLoadSettings, \n    BlinkIdMultiSideRecognizer, \n    createBlinkIdMultiSideRecognizer, \n    createRecognizerRunner, \n    RecognizerResultState, \n    MetadataCallbacks,\n    Recognizer,\n    createBlinkIdSingleSideRecognizer,\n    IdBarcodeRecognizer,\n    createIdBarcodeRecognizer,\n    OnScanningDone,\n    DisplayableQuad,\n    ExtensionFactors,\n    BlinkIdSingleSideRecognizer,\n    BlinkIdSingleSideRecognizerSettings,\n    BaseBlinkIdRecognizerResult\n} from \"@microblink/blinkid-in-browser-sdk\"\n\n/**\n * Ver-ID's implementation of the `IdCaptureUI` interface\n * @category ID capture\n */\nclass VerIDIdCaptureUI implements IdCaptureUI {\n\n    private videoContainer: HTMLDivElement\n    private _video: HTMLVideoElement\n    private cameraOverlayCanvas: HTMLCanvasElement\n    private cameraOverlayContext: CanvasRenderingContext2D\n    private _cancelButton: HTMLAnchorElement\n    private prompt: HTMLDivElement\n    private progressBarContainer: HTMLDivElement\n    private progressBar: HTMLDivElement\n    private promptLock = false\n    private flipTimeout: ReturnType<typeof setTimeout> | undefined\n    private animationClassNameTimeout: ReturnType<typeof setTimeout> | undefined\n    private promptLockTimeout: ReturnType<typeof setTimeout> | undefined\n    private eventListeners: {[k in IdCaptureEventType]?: (event: IdCaptureEvent) => void} = {}\n    readonly cardAspectRatio: number = 85.6/53.98\n\n    constructor() {\n        this.videoContainer = this.createVideoContainer()\n        document.body.appendChild(this.videoContainer)\n        this._video = this.createVideoElement()\n        this.cameraOverlayCanvas = this.createCameraOverlayCanvas()\n        this.cameraOverlayContext = this.cameraOverlayCanvas.getContext(\"2d\")!\n        this._cancelButton = this.createCancelButton()\n        this.prompt = this.createPromptElement()\n        this.videoContainer.appendChild(this.video)\n        this.videoContainer.appendChild(this.cameraOverlayCanvas)\n        this.videoContainer.appendChild(this.cancelButton)\n        this.videoContainer.appendChild(this.prompt)\n        this.progressBarContainer = this.createProgressBarContainer()\n        this.progressBar = this.createProgressBarElement()\n        this.progressBarContainer.appendChild(this.progressBar)\n        this.videoContainer.appendChild(this.progressBarContainer)\n        this.cancelButton.onclick = () => {\n            this.trigger({type: IdCaptureEventType.CANCEL})\n        }\n        this.video.onplaying = () => {\n            this.drawCardOutline(\"white\")\n        }\n    }\n\n    get video() {\n        return this._video\n    }\n\n    get cancelButton() {\n        return this._cancelButton\n    }\n\n    on<Event extends IdCaptureEvent>(eventType: IdCaptureEventType, callback: (event: Event) => void) {\n        if (callback) {\n            // @ts-ignore\n            this.eventListeners[eventType] = callback\n        } else {\n            delete this.eventListeners[eventType]\n        }\n    }\n\n    trigger(event: IdCaptureEvent) {\n        switch (event.type) {\n            case IdCaptureEventType.CAPTURE_STARTED:\n                this.showCameraOverlay()\n                break\n            case IdCaptureEventType.CANCEL:\n                break\n            case IdCaptureEventType.CAMERA_ANGLED:\n                this.showPrompt(\"Point straight at the ID card\")\n                this.drawCardOutline(\"white\")\n                break\n            case IdCaptureEventType.CAMERA_TOO_CLOSE:\n                this.showPrompt(\"Move away\")\n                this.drawCardOutline(\"white\")\n                break\n            case IdCaptureEventType.CAMERA_TOO_FAR:\n                this.showPrompt(\"Move closer\")\n                this.drawCardOutline(\"white\")\n                break\n            case IdCaptureEventType.CAPTURING:\n                this.showPrompt(\"Scanning\")\n                this.drawCardOutline(\"white\")\n                break\n            case IdCaptureEventType.CAPTURE_ENDED:\n                this.cleanup()\n                break\n            case IdCaptureEventType.FINDING_FACE:\n                this.showPrompt(\"Finding face on document\", true)\n                this.drawCardOutline(\"white\")\n                break\n            case IdCaptureEventType.PAGE_CAPTURED:\n                this.showPrompt(\"Hold it\")\n                this.drawCardOutline(\"green\")\n                break\n            case IdCaptureEventType.NEXT_PAGE_REQUESTED:\n                this.hideCameraOverlay()\n                this.showPrompt(\"Flip the card\", true)\n                this.showFlipCardInstruction(() => {\n                    this.trigger({type: IdCaptureEventType.CAPTURE_STARTED})\n                })\n                break\n            case IdCaptureEventType.LOADING_PROGRESSED:\n                this.setProgress((event as IdCaptureProgressEvent).progress)\n                break\n            case IdCaptureEventType.LOADED:\n                this.removeProgressBar()\n                break\n        }\n        if (this.eventListeners[event.type]) {\n            // @ts-ignore\n            this.eventListeners[event.type](event)\n        }\n    }\n\n    private createVideoContainer(): HTMLDivElement {\n        const videoContainer = document.createElement(\"div\")\n        videoContainer.style.position = \"fixed\"\n        videoContainer.style.left = \"0px\"\n        videoContainer.style.top = \"0px\"\n        videoContainer.style.right = \"0px\"\n        videoContainer.style.bottom = \"0px\"\n        videoContainer.style.backgroundColor = \"black\"\n        return videoContainer\n    }\n\n    private createVideoElement(): HTMLVideoElement {\n        const video: HTMLVideoElement = document.createElement(\"video\")\n        video.setAttribute(\"autoplay\", \"autoplay\")\n        video.setAttribute(\"muted\", \"muted\")\n        video.setAttribute(\"playsinline\", \"playsinline\")\n        video.style.position = \"absolute\"\n        video.style.left = \"0px\"\n        video.style.top = \"0px\"\n        video.style.right = \"0px\"\n        video.style.bottom = \"0px\"\n        video.style.width = \"100%\"\n        video.style.height = \"100%\"\n        return video\n    }\n\n    private createCameraOverlayCanvas(): HTMLCanvasElement {\n        const cameraOverlayCanvas: HTMLCanvasElement = document.createElement(\"canvas\")\n        cameraOverlayCanvas.style.position = \"absolute\"\n        cameraOverlayCanvas.style.left = \"0px\"\n        cameraOverlayCanvas.style.top = \"0px\"\n        return cameraOverlayCanvas\n    }\n\n    private createCancelButton(): HTMLAnchorElement {\n        const cancelButton: HTMLAnchorElement = document.createElement(\"a\")\n        cancelButton.href = \"javascript:void(0)\"\n        cancelButton.innerText = \"Cancel\"\n        cancelButton.style.textShadow = \"0px 1px 5px rgba(0, 0, 0, 0.5)\"\n        cancelButton.style.fontFamily = \"Helvetica, Arial, sans-serif\"\n        cancelButton.style.color = \"white\"\n        cancelButton.style.textDecoration = \"none\"\n        cancelButton.style.position = \"absolute\"\n        cancelButton.style.bottom = \" 16px\"\n        cancelButton.style.left = \"8px\"\n        cancelButton.style.right = \"8px\"\n        cancelButton.style.textAlign = \"center\"\n        return cancelButton\n    }\n\n    private createPromptElement(): HTMLDivElement {\n        const prompt: HTMLDivElement = document.createElement(\"div\")\n        prompt.style.textShadow = \"0px 1px 5px rgba(0, 0, 0, 0.5)\"\n        prompt.style.fontFamily = \"Helvetica, Arial, sans-serif\"\n        prompt.style.color = \"white\"\n        prompt.style.position = \"absolute\"\n        prompt.style.left = \"8px\"\n        prompt.style.right = \"8px\"\n        prompt.style.top = \"16px\"\n        prompt.style.textAlign = \"center\"\n        return prompt\n    }\n\n    private createProgressBarContainer(): HTMLDivElement {\n        const progressBarContainer: HTMLDivElement = document.createElement(\"div\")\n        progressBarContainer.style.position = \"absolute\"\n        progressBarContainer.style.top = \"0px\"\n        progressBarContainer.style.left = \"0px\"\n        progressBarContainer.style.right = \"0px\"\n        progressBarContainer.style.bottom = \"0px\"\n        progressBarContainer.style.width = \"50%\"\n        progressBarContainer.style.height = \"20px\"\n        progressBarContainer.style.overflow = \"hidden\"\n        progressBarContainer.style.border = \"2px solid white\"\n        progressBarContainer.style.borderRadius = \"4px\"\n        progressBarContainer.style.margin = \"auto\"\n        return progressBarContainer\n    }\n\n    private createProgressBarElement(): HTMLDivElement {\n        const progressBar = document.createElement(\"div\")\n        progressBar.style.position = \"absolute\"\n        progressBar.style.left = \"0px\"\n        progressBar.style.top = \"0px\"\n        progressBar.style.height = \"100%\"\n        progressBar.style.width = \"0%\"\n        progressBar.style.backgroundColor = \"white\"\n        return progressBar\n    }\n\n    private drawCardOutline(strokeStyle: string | CanvasGradient | CanvasPattern) {\n        const scale: number = Math.min(this.videoContainer.clientWidth / this.video.videoWidth, this.videoContainer.clientHeight / this.video.videoHeight)\n        this.cameraOverlayCanvas.width = this.video.videoWidth * scale\n        this.cameraOverlayCanvas.height = this.video.videoHeight * scale\n        this.cameraOverlayCanvas.style.left = ((this.videoContainer.clientWidth - this.cameraOverlayCanvas.width) / 2)+\"px\"\n        this.cameraOverlayCanvas.style.top = ((this.videoContainer.clientHeight - this.cameraOverlayCanvas.height) / 2)+\"px\"\n        this.cameraOverlayContext.clearRect(0, 0, this.cameraOverlayCanvas.width, this.cameraOverlayCanvas.height)\n        \n        const cardSize: Size = {\"width\": 0, \"height\": 0}\n        if (this.cameraOverlayCanvas.width/this.cameraOverlayCanvas.height > this.cardAspectRatio) {\n            cardSize.height = this.cameraOverlayCanvas.height * 0.85\n            cardSize.width = cardSize.height * this.cardAspectRatio\n        } else {\n            cardSize.width = this.cameraOverlayCanvas.width * 0.85\n            cardSize.height = cardSize.width / this.cardAspectRatio\n        }\n        const cardRect: Rect = new Rect(this.cameraOverlayCanvas.width / 2 - cardSize.width / 2, this.cameraOverlayCanvas.height / 2 - cardSize.height / 2, cardSize.width, cardSize.height)\n        const cornerRadius: number = cardRect.width * 0.05\n        const offset: number = cardRect.height * 0.25\n        this.cameraOverlayContext.strokeStyle = strokeStyle\n        this.cameraOverlayContext.lineWidth = 6\n        this.cameraOverlayContext.beginPath()\n        // Top left corner\n        this.cameraOverlayContext.moveTo(cardRect.x, cardRect.y + offset)\n        this.cameraOverlayContext.arcTo(cardRect.x, cardRect.y, cardRect.x + cornerRadius, cardRect.y, cornerRadius)\n        this.cameraOverlayContext.lineTo(cardRect.x + offset, cardRect.y)\n        // Top right corner\n        this.cameraOverlayContext.moveTo(cardRect.right - offset, cardRect.y)\n        this.cameraOverlayContext.arcTo(cardRect.right, cardRect.y, cardRect.right, cardRect.y + offset, cornerRadius)\n        this.cameraOverlayContext.lineTo(cardRect.right, cardRect.y + offset)\n        // Bottom right corner\n        this.cameraOverlayContext.moveTo(cardRect.right, cardRect.bottom - offset)\n        this.cameraOverlayContext.arcTo(cardRect.right, cardRect.bottom, cardRect.right - offset, cardRect.bottom, cornerRadius)\n        this.cameraOverlayContext.lineTo(cardRect.right - offset, cardRect.bottom)\n        // Bottom left corner\n        this.cameraOverlayContext.moveTo(cardRect.x + offset, cardRect.bottom)\n        this.cameraOverlayContext.arcTo(cardRect.x, cardRect.bottom, cardRect.x, cardRect.bottom - offset, cornerRadius)\n        this.cameraOverlayContext.lineTo(cardRect.x, cardRect.bottom - offset)\n        this.cameraOverlayContext.stroke()\n    }\n\n    private setProgress(progress: number) {\n        this.progressBar.style.width = progress+\"%\"\n    }\n\n    private showPrompt(text: string, force: boolean = false) {\n        if (this.promptLock && !force) {\n            return\n        }\n        this.promptLock = true\n        this.prompt.innerText = text\n        this.promptLockTimeout = setTimeout(() => this.promptLock = false, 700)\n    }\n\n    private showFlipCardInstruction(onDone?: () => void) {\n        this.showPrompt(\"Flip the card\", true)\n        const style: HTMLStyleElement = document.createElement(\"style\")\n        style.innerText = \".flipped { transform: rotateY(180deg) !important; transition: transform 2s; }\"\n        document.head.appendChild(style)\n\n        const flipAnimationContainer: HTMLDivElement = document.createElement(\"div\")\n        flipAnimationContainer.style.position = \"absolute\"\n        flipAnimationContainer.style.top = \"0px\"\n        flipAnimationContainer.style.right = \"0px\"\n        flipAnimationContainer.style.bottom = \"0px\"\n        flipAnimationContainer.style.left = \"0px\"\n        flipAnimationContainer.style.perspective = \"500px\"\n\n        const flipAnimation: HTMLDivElement = document.createElement(\"div\")\n        flipAnimation.style.position = \"absolute\"\n        flipAnimation.style.top = \"0px\"\n        flipAnimation.style.right = \"0px\"\n        flipAnimation.style.bottom = \"0px\"\n        flipAnimation.style.left = \"0px\"\n        flipAnimation.style.margin = \"auto\"\n        flipAnimation.style.width = \"172px\"\n        flipAnimation.style.height = \"108px\"\n        flipAnimation.style.borderRadius = \"6px\"\n        flipAnimation.style.backgroundColor = \"white\"\n        flipAnimation.style.transform = \"rotateY(0deg)\"\n\n        flipAnimationContainer.appendChild(flipAnimation)\n        this.videoContainer.appendChild(flipAnimationContainer)\n        this.cameraOverlayCanvas.style.visibility = \"hidden\"\n        this.animationClassNameTimeout = setTimeout(function() {\n            flipAnimation.className = \"flipped\"\n        }, 10)\n        const videoContainer = this.videoContainer\n        this.flipTimeout = setTimeout(() => {\n            videoContainer.removeChild(flipAnimationContainer)\n            document.head.removeChild(style)\n            this.drawCardOutline(\"white\")\n            this.cameraOverlayCanvas.style.visibility = \"visible\"\n            if (onDone) {\n                onDone()\n            }\n        }, 2000)\n    }\n\n    private removeProgressBar() {\n        if (this.progressBarContainer.parentNode) {\n            this.progressBarContainer.parentNode.removeChild(this.progressBarContainer)\n        }\n    }\n\n    private hideCameraOverlay() {\n        this.cameraOverlayCanvas.style.visibility = \"hidden\"\n    }\n    \n    private showCameraOverlay() {\n        this.cameraOverlayCanvas.style.visibility = \"visible\"\n    }\n\n    private clearTimeouts() {\n        clearTimeout(this.animationClassNameTimeout)\n        clearTimeout(this.flipTimeout)\n        clearTimeout(this.promptLockTimeout)\n    }\n\n    private cleanup() {\n        this.clearTimeouts()\n        if (this.videoContainer.parentNode) {\n            this.videoContainer.parentNode.removeChild(this.videoContainer)\n        }\n        this._cancelButton.onclick = () => {}\n    }\n}\n\ntype CombinedResult = {\n    result: SupportedRecognizerResult,\n    pages: DocumentPages\n}\n\n/**\n * @category ID capture\n */\nexport class IdCapture {\n\n    readonly serviceURL: string\n    private readonly faceRecognition: FaceRecognition\n    private readonly loadBlinkWasmModule: Promise<WasmSDK>\n    private percentLoaded = 0\n    private loadListeners: Set<ProgressListener> = new Set()\n\n    constructor(settings: IdCaptureSettings, serviceURL?: string) {\n        this.serviceURL = serviceURL ? serviceURL.replace(/[\\/\\s]+$/, \"\") : settings.serviceURL\n        this.faceRecognition = new FaceRecognition(this.serviceURL)\n        const loadSettings: WasmSDKLoadSettings = new BlinkIDSDK.WasmSDKLoadSettings(settings.licenceKey)\n        loadSettings.engineLocation = location.origin+settings.resourcesPath\n        loadSettings.workerLocation = location.origin+settings.resourcesPath.replace(/\\/+$/, \"\")+`/BlinkIDWasmSDK.worker.min.js`\n        loadSettings.loadProgressCallback = this.onLoadProgressCallback\n        this.loadBlinkWasmModule = new Promise(async (resolve, reject) => {\n            try {\n                const wasmModule = await BlinkIDSDK.loadWasmModule(loadSettings)\n                resolve(wasmModule);\n            } catch (error) {\n                reject(error)\n            }\n        });\n    }\n\n    private onLoadProgressCallback = (percentLoaded: number) => {\n        this.percentLoaded = percentLoaded\n        for (const listener of this.loadListeners) {\n            listener(percentLoaded)\n        }\n    }\n\n    private registerLoadListener(listener: ProgressListener) {\n        listener(this.percentLoaded)\n        this.loadListeners.add(listener)\n    }\n\n    private unregisterLoadListener(listener: ProgressListener) {\n        this.loadListeners.delete(listener)\n    }\n\n    private async createBlinkIdCombinedRecognizer(wasmSDK: WasmSDK): Promise<BlinkIdMultiSideRecognizer> {\n        const recognizer: BlinkIdMultiSideRecognizer = await createBlinkIdMultiSideRecognizer(wasmSDK)\n        const recognizerSettings: BlinkIdMultiSideRecognizerSettings = await recognizer.currentSettings()\n        recognizerSettings.returnFullDocumentImage = true\n        recognizerSettings.fullDocumentImageExtensionFactors = new ExtensionFactors(0.1, 0.1, 0.1, 0.1)\n        recognizerSettings.fullDocumentImageDpi = 600\n        await recognizer.updateSettings(recognizerSettings)\n        return recognizer\n    }\n\n    private async createBlinkIdRecognizer(wasmSDK: WasmSDK): Promise<BlinkIdSingleSideRecognizer> {\n        const recognizer: BlinkIdSingleSideRecognizer = await createBlinkIdSingleSideRecognizer(wasmSDK)\n        const recognizerSettings: BlinkIdSingleSideRecognizerSettings = await recognizer.currentSettings()\n        recognizerSettings.returnFullDocumentImage = true\n        recognizerSettings.fullDocumentImageExtensionFactors = new ExtensionFactors(0.1, 0.1, 0.1, 0.1)\n        recognizerSettings.fullDocumentImageDpi = 600\n        await recognizer.updateSettings(recognizerSettings)\n        return recognizer\n    }\n\n    private createBarcodeRecognizer(wasmSDK: WasmSDK): Promise<IdBarcodeRecognizer> {\n        return createIdBarcodeRecognizer(wasmSDK)\n    }\n\n    private async convertToIdCaptureResult(result: CombinedResult): Promise<IdCaptureResult> {\n        const idCaptureResult: IdCaptureResult = new IdCaptureResult(result.result, result.pages)\n        let face: RecognizableFace|undefined\n        try {\n            const img = await idCaptureResult.documentImage(DocumentSide.FRONT, true, 640)\n            face = await this.faceRecognition.detectRecognizableFace(img)\n        } catch (_error) {\n            face = undefined\n        }\n        idCaptureResult.face = face\n        return idCaptureResult\n    }\n\n    private async getResultFromRecognizer(recognizer: SupportedRecognizer): Promise<CombinedResult> {\n        const recognizerName: RecognizerName = recognizer.recognizerName as RecognizerName\n        const result: SupportedRecognizerResult = await recognizer.getResult() as SupportedRecognizerResult\n        let pages: DocumentPages\n        if (recognizerName == \"IdBarcodeRecognizer\" || (recognizerName == \"BlinkIdRecognizer\" && (<BaseBlinkIdRecognizerResult>result).barcode && (<BaseBlinkIdRecognizerResult>result).barcode.barcodeData && (<BaseBlinkIdRecognizerResult>result).barcode.barcodeData.stringData && (<BaseBlinkIdRecognizerResult>result).barcode.barcodeData.stringData.length > 0)) {\n            pages = DocumentPages.BACK\n        } else if (recognizerName == \"BlinkIdRecognizer\") {\n            pages = DocumentPages.FRONT\n        } else {\n            pages = DocumentPages.FRONT_AND_BACK\n        }\n        if (result.state == RecognizerResultState.Valid) {\n            const combinedResult: CombinedResult = {\n                pages: pages,\n                result: result\n            }\n            return combinedResult\n        } else {\n            throw new Error(\"Invalid recognizer state\")\n        }\n    }\n\n    // private getRecognizerName(recognizer: Recognizer): string {\n    //     if ((recognizer as any).wrappedRecognizer) {\n    //         return (recognizer as any).wrappedRecognizer.recognizerName\n    //     } else {\n    //         return recognizer.recognizerName\n    //     }\n    // }\n\n    // private removeRecognizer(recognizer: SupportedRecognizer, recognizers: SupportedRecognizer[]): SupportedRecognizer[] {\n    //     const recognizerName = this.getRecognizerName(recognizer)\n    //     return recognizers.filter(val => this.getRecognizerName(val) != recognizerName)\n    // }\n\n    private getRecognitionCallback(videoRecognizer: VideoRecognizer, recognizers: SupportedRecognizer[], callback: (error: any, result?: CombinedResult) => void): OnScanningDone {\n        return async (state: RecognizerResultState) => {\n            if (state == RecognizerResultState.Valid || state == RecognizerResultState.StageValid) {\n                videoRecognizer.pauseRecognition()\n                for (const recognizer of recognizers) {\n                    try {\n                        const combinedResult = await this.getResultFromRecognizer(recognizer)\n                        if (combinedResult.result.state == RecognizerResultState.Valid) {\n                            callback(null, combinedResult)\n                            return\n                        }\n                    } catch (err: any) {\n                        if (err && err.message == \"Invalid recognizer state\") {\n                            videoRecognizer.resumeRecognition(false)\n                        } else {\n                            callback(err)\n                        }\n                        return\n                    }\n                }\n                videoRecognizer.resumeRecognition(false)\n            }\n        }\n    }\n\n    private runIdCaptureSession(videoRecognizer: VideoRecognizer, recognizers: SupportedRecognizer[], settings: IdCaptureSessionSettings): Observable<CombinedResult> {\n        return new Observable<CombinedResult>((subscriber: Subscriber<CombinedResult>) => {\n            let emissionCount = 0\n            videoRecognizer.startRecognition(this.getRecognitionCallback(videoRecognizer, recognizers, (error, result) => {\n                if (error) {\n                    emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error})\n                } else if (result) {\n                    emissionCount ++\n                    emitRxEvent(subscriber, {\"type\": \"next\", \"value\": result})\n                    if (emissionCount == recognizers.length) {\n                        emitRxEvent(subscriber, {\"type\": \"complete\"})\n                    }\n                }\n            }), settings.timeout)\n        })\n    }\n\n    /**\n     * Detect ID card in images\n     * @param images Base64-encoded images of the ID card\n     * @returns Promise\n     */\n    async detectIdCard(images: { front?: string, back?: string }): Promise<IdCaptureResponse> {\n        const body: {front?: string, back?: string} = images\n        const response: Response = await fetch(this.serviceURL + \"/\", {\n            \"method\": \"POST\",\n            \"mode\": \"cors\",\n            \"cache\": \"no-cache\",\n            \"headers\": {\n                \"Content-Type\": \"application/json\"\n            },\n            \"body\": JSON.stringify(body)\n        })\n        if (response.status != 200) {\n            throw new Error(\"ID card detection failed\")\n        }\n        return response.json()\n    }\n\n    private recognizerRunner!: RecognizerRunner\n\n    private async getRecognizerRunner(wasmSDK: WasmSDK, recognizers: Recognizer[]): Promise<RecognizerRunner> {\n        if (this.recognizerRunner) {\n            this.recognizerRunner.reconfigureRecognizers(recognizers, false)\n        } else {\n            this.recognizerRunner = await createRecognizerRunner(wasmSDK, recognizers, false)\n        }\n        return this.recognizerRunner\n    }\n\n    private async createRecognizers(wasmSDK: WasmSDK, settings: IdCaptureSessionSettings): Promise<SupportedRecognizer[]> {\n        const recognizers: SupportedRecognizer[] = []\n        if (settings.pages == DocumentPages.FRONT_AND_BACK) {\n            recognizers.push(await this.createBlinkIdCombinedRecognizer(wasmSDK))\n        } else if (settings.pages == DocumentPages.FRONT) {\n            recognizers.push(await this.createBlinkIdRecognizer(wasmSDK))\n        } else {\n            recognizers.push(await this.createBarcodeRecognizer(wasmSDK))\n        }\n        return recognizers\n    }\n\n    private createMetadataCallbacks(ui: IdCaptureUI): MetadataCallbacks {\n        return {\n            onQuadDetection: (quad: DisplayableQuad) => {\n                switch (quad.detectionStatus) {\n                    case BlinkIDSDK.DetectionStatus.Failed:\n                        ui.trigger({type:IdCaptureEventType.CAPTURING})\n                        break\n                    case BlinkIDSDK.DetectionStatus.Success:\n                    case BlinkIDSDK.DetectionStatus.FallbackSuccess:\n                        ui.trigger({type:IdCaptureEventType.PAGE_CAPTURED})\n                        break\n                    case BlinkIDSDK.DetectionStatus.CameraAngleTooSteep:\n                        ui.trigger({type:IdCaptureEventType.CAMERA_ANGLED})\n                        break\n                    case BlinkIDSDK.DetectionStatus.CameraTooFar:\n                        ui.trigger({type:IdCaptureEventType.CAMERA_TOO_FAR})\n                        break\n                    case BlinkIDSDK.DetectionStatus.CameraTooClose:\n                    case BlinkIDSDK.DetectionStatus.DocumentTooCloseToCameraEdge:\n                    case BlinkIDSDK.DetectionStatus.DocumentPartiallyVisible:\n                        ui.trigger({type:IdCaptureEventType.CAMERA_TOO_CLOSE})\n                        break\n                }\n            },\n            onDetectionFailed: () => {\n                ui.trigger({type:IdCaptureEventType.CAPTURING})\n            },\n            onFirstSideResult: () => {\n                ui.trigger({type:IdCaptureEventType.NEXT_PAGE_REQUESTED})\n            }\n        }\n    }\n\n    /**\n     * Capture ID card using the device camera\n     * @param settings Session settings\n     * @returns Observable\n     */\n    captureIdCard(settings?: IdCaptureSessionSettings): Observable<IdCaptureResult> {\n        let sessionSubscription: Subscription|undefined\n        return new Observable((subscriber: Subscriber<IdCaptureResult>) => {\n            if (!BlinkIDSDK.isBrowserSupported()) {\n                emitRxEvent(subscriber, {\"type\": \"error\", \"error\": new Error(\"Unsupported browser\")})\n                return\n            }\n            function disposeVideoRecognizer() {\n                if (videoRecognizer != null) {\n                    videoRecognizer.releaseVideoFeed()\n                }\n            }\n            async function disposeRecognizerRunner() {\n                if (recognizerRunner) {\n                    await recognizerRunner.resetRecognizers(true)\n                    recognizerRunner = undefined\n                }\n            }\n            let resolvedSettings: IdCaptureSessionSettings\n            if (!settings) {\n                resolvedSettings = new IdCaptureSessionSettings()\n            } else {\n                resolvedSettings = settings\n            }\n            let videoRecognizer: VideoRecognizer\n            let recognizerRunner: RecognizerRunner|undefined\n            let recognizers: SupportedRecognizer[]\n            const ui: IdCaptureUI = resolvedSettings.createUI()\n            ui.on(IdCaptureEventType.CANCEL, () => {\n                emitRxEvent(subscriber, {\"type\": \"complete\"})\n            })\n            const progressListener: ProgressListener = (progress: number) => {\n                const event: IdCaptureProgressEvent = {\n                    type: IdCaptureEventType.LOADING_PROGRESSED,\n                    progress: progress\n                }\n                ui.trigger(event)\n            }\n            this.registerLoadListener(progressListener);\n            (async () => {\n                let wasmSDK: WasmSDK\n                try {\n                    wasmSDK = await this.loadBlinkWasmModule;\n                    ui.trigger({type:IdCaptureEventType.LOADED})\n                } catch (error) {\n                    requestAnimationFrame(() => {\n                        ui.trigger({type:IdCaptureEventType.LOADING_FAILED})\n                    })\n                    emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error});\n                    return;\n                } finally {\n                    this.unregisterLoadListener(progressListener)\n                }\n                try {\n                    recognizers = await this.createRecognizers(wasmSDK, resolvedSettings)\n                    const pageCount = recognizers.length\n                    recognizerRunner = await this.getRecognizerRunner(wasmSDK, Object.values(recognizers))\n                    await recognizerRunner.setMetadataCallbacks(this.createMetadataCallbacks(ui))\n                    videoRecognizer = await VideoRecognizer.createVideoRecognizerFromCameraStream(ui.video, recognizerRunner)\n                    ui.trigger({type:IdCaptureEventType.CAPTURE_STARTED})\n                    let emissionCount = 0\n                    sessionSubscription = this.runIdCaptureSession(videoRecognizer, recognizers, resolvedSettings).subscribe({\n                        next: async (combinedResult: CombinedResult) => {\n                            try {\n                                if (combinedResult.pages != DocumentPages.BACK) {\n                                    ui.trigger({type:IdCaptureEventType.FINDING_FACE})\n                                }\n                                const result = await this.convertToIdCaptureResult(combinedResult)\n                                emitRxEvent(subscriber, {\"type\": \"next\", \"value\": result})\n                                if (++emissionCount < pageCount) {\n                                    ui.on(IdCaptureEventType.CAPTURE_STARTED, () => {\n                                        if (videoRecognizer) {\n                                            videoRecognizer.resumeRecognition(true)\n                                            requestAnimationFrame(() => {\n                                                ui.trigger({type: IdCaptureEventType.NEXT_PAGE_REQUESTED})\n                                            })\n                                        }\n                                    })\n                                } else {\n                                    disposeVideoRecognizer()\n                                    emitRxEvent(subscriber, {\"type\": \"complete\"})\n                                }\n                            } catch (error) {\n                                emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error})\n                            }\n                        },\n                        error: (error: any) => {\n                            disposeVideoRecognizer()\n                            emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error})\n                        }\n                    })\n                    sessionSubscription.add(() => {\n                        disposeVideoRecognizer()\n                        disposeRecognizerRunner()\n                    })\n                    recognizerRunner = undefined\n                } catch (error) {\n                    disposeRecognizerRunner()\n                    emitRxEvent(subscriber, {\"type\": \"error\", \"error\": error})\n                }\n            })();\n            return () => {\n                if (sessionSubscription) {\n                    sessionSubscription.unsubscribe()\n                    sessionSubscription = undefined\n                }\n                disposeVideoRecognizer()\n                disposeRecognizerRunner()\n                this.unregisterLoadListener(progressListener)\n                requestAnimationFrame(() => {\n                    ui.trigger({type:IdCaptureEventType.CAPTURE_ENDED})\n                })\n            }\n        })\n    }\n}\n\n/**\n * ID capture settings\n * @category ID capture\n */\nexport class IdCaptureSettings {\n    /**\n     * Microblink licence key (must be issued for the domain name of the running application)\n     */\n    licenceKey: string\n    /**\n     * Path to resources used by the ID capture\n     */\n    resourcesPath: string\n    /**\n     * URL for the server accepting the supporting face detection and ID capture calls\n     */\n    serviceURL: string\n\n    /**\n     * Construtor\n     * @param licenceKey Microblink licence key (must be issued for the domain name of the running application)\n     * @param resourcesPath Path to resources used by the ID capture\n     * @param serviceURL URL for the server accepting the supporting face detection and ID capture calls\n     */\n    constructor(licenceKey: string, resourcesPath: string = \"/node_modules/@microblink/blinkid-in-browser-sdk/resources\", serviceURL: string = \"\") {\n        this.licenceKey = licenceKey\n        this.resourcesPath = resourcesPath\n        this.serviceURL = serviceURL ? serviceURL.replace(/[\\/\\s]+$/, \"\") : \"\"\n    }\n}\n\n/**\n * ID capture session settings\n * @category ID capture\n */\nexport class IdCaptureSessionSettings {\n    /**\n     * Pages to capture\n     */\n    pages: DocumentPages\n    /**\n     * Session timeout in milliseconds\n     */\n    timeout: number\n    /**\n     * Create ID capture UI\n     * @returns Function that creates an instance of the IdCaptureUI interface\n     */\n    createUI: IdCaptureUIFactory = () => new VerIDIdCaptureUI()\n\n    /**\n     * Constructor\n     * @param pages Pages to capture\n     * @param timeout Session timeout in milliseconds (default = infinity)\n     * @param saveCapturedImages Indicates whether the session should save the images obtained from the camera that have been used in successful capture (default = `false`)\n     */\n    constructor(pages: DocumentPages = DocumentPages.FRONT_AND_BACK, timeout: number = Number.POSITIVE_INFINITY) {\n        this.pages = pages\n        this.timeout = timeout\n    }\n}","/**\n *\n * <table width=\"100%\">\n *     <tr>\n *         <td>\n *             <a href=\"https://github.com/rendaw/qrcode-generator-es6\"><img src=\"https://raw.githubusercontent.com/primer/octicons/master/lib/svg/mark-github.svg?sanitize=true\"> Github</a>\n *         </td>\n *         <td>\n *             <a href=\"https://circleci.com/gh/rendaw/qrcode-generator-es6\"><img alt=\"Build Status\" src=\"https://circleci.com/gh/rendaw/qrcode-generator-es6.svg?style=svg\"></a>\n *         </td>\n * </table>\n *\n * ### How to use:\n *\n * First run:\n *\n * ```\n * npm install --save qrcode-generator-es6\n * ```\n *\n * Then use it in your code like:\n *\n * ```\n * import qrcode from './qrcode.js';\n *\n * const qr = new qrcode(0, 'H');\n * qr.addData('This is my data');\n * qr.make();\n * my_element.innerHTML = qr.createSvgTag({});\n * ```\n *\n * @module qrcode-generator-es6\n */\n//---------------------------------------------------------------------\n//\n// QR Code Generator for JavaScript\n//\n// Copyright (c) 2009 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//\thttp://www.opensource.org/licenses/mit-license.php\n//\n// The word 'QR Code' is registered trademark of\n// DENSO WAVE INCORPORATED\n//\thttp://www.denso-wave.com/qrcode/faqpatent-e.html\n//\n//---------------------------------------------------------------------\n\nconst PAD0 = 0xec;\nconst PAD1 = 0x11;\n\n/**\n * Displays a QR code. Set the code data with `addData` and, call `make` and then call `createSvgTag` or `createImgTag`.\n *\n * See `gallery.html` for an example.\n *\n * @param {integer} typeNumber The minimum QR code type number from 1 to 40.  Using 0 allows any QR code type number.\n * @param {String} errorCorrectionLevel 'L','M','Q','H'\n */\nexport default class qrcode {\n  constructor(typeNumber, errorCorrectionLevel) {\n    this._typeNumber = typeNumber;\n    this._errorCorrectionLevel = QRErrorCorrectionLevel[errorCorrectionLevel];\n    this._modules = null;\n    this._moduleCount = 0;\n    this._dataCache = null;\n    this._dataList = [];\n\n    this.makeImpl = (test, maskPattern) => {\n      this._moduleCount = this._typeNumber * 4 + 17;\n      this._modules = (function(moduleCount) {\n        let modules = new Array(moduleCount);\n        for (let row = 0; row < moduleCount; row += 1) {\n          modules[row] = new Array(moduleCount);\n          for (let col = 0; col < moduleCount; col += 1) {\n            modules[row][col] = null;\n          }\n        }\n        return modules;\n      })(this._moduleCount);\n\n      this.setupPositionProbePattern(0, 0);\n      this.setupPositionProbePattern(this._moduleCount - 7, 0);\n      this.setupPositionProbePattern(0, this._moduleCount - 7);\n      this.setupPositionAdjustPattern();\n      this.setupTimingPattern();\n      this.setupTypeInfo(test, maskPattern);\n\n      if (this._typeNumber >= 7) {\n        this.setupTypeNumber(test);\n      }\n\n      if (this._dataCache == null) {\n        this._dataCache = this.createData(\n          this._typeNumber,\n          this._errorCorrectionLevel,\n          this._dataList\n        );\n      }\n\n      this.mapData(this._dataCache, maskPattern);\n    };\n\n    this.setupPositionProbePattern = (row, col) => {\n      for (let r = -1; r <= 7; r += 1) {\n        if (row + r <= -1 || this._moduleCount <= row + r) continue;\n\n        for (let c = -1; c <= 7; c += 1) {\n          if (col + c <= -1 || this._moduleCount <= col + c) continue;\n\n          if (\n            (0 <= r && r <= 6 && (c == 0 || c == 6)) ||\n            (0 <= c && c <= 6 && (r == 0 || r == 6)) ||\n            (2 <= r && r <= 4 && 2 <= c && c <= 4)\n          ) {\n            this._modules[row + r][col + c] = true;\n          } else {\n            this._modules[row + r][col + c] = false;\n          }\n        }\n      }\n    };\n\n    this.getBestMaskPattern = () => {\n      let minLostPoint = 0;\n      let pattern = 0;\n\n      for (let i = 0; i < 8; i += 1) {\n        this.makeImpl(true, i);\n\n        let lostPoint = QRUtil.getLostPoint(this);\n\n        if (i == 0 || minLostPoint > lostPoint) {\n          minLostPoint = lostPoint;\n          pattern = i;\n        }\n      }\n\n      return pattern;\n    };\n\n    this.setupTimingPattern = () => {\n      for (let r = 8; r < this._moduleCount - 8; r += 1) {\n        if (this._modules[r][6] != null) {\n          continue;\n        }\n        this._modules[r][6] = r % 2 == 0;\n      }\n\n      for (let c = 8; c < this._moduleCount - 8; c += 1) {\n        if (this._modules[6][c] != null) {\n          continue;\n        }\n        this._modules[6][c] = c % 2 == 0;\n      }\n    };\n\n    this.setupPositionAdjustPattern = () => {\n      let pos = QRUtil.getPatternPosition(this._typeNumber);\n\n      for (let i = 0; i < pos.length; i += 1) {\n        for (let j = 0; j < pos.length; j += 1) {\n          let row = pos[i];\n          let col = pos[j];\n\n          if (this._modules[row][col] != null) {\n            continue;\n          }\n\n          for (let r = -2; r <= 2; r += 1) {\n            for (let c = -2; c <= 2; c += 1) {\n              if (\n                r == -2 ||\n                r == 2 ||\n                c == -2 ||\n                c == 2 ||\n                (r == 0 && c == 0)\n              ) {\n                this._modules[row + r][col + c] = true;\n              } else {\n                this._modules[row + r][col + c] = false;\n              }\n            }\n          }\n        }\n      }\n    };\n\n    this.setupTypeNumber = test => {\n      let bits = QRUtil.getBCHTypeNumber(this._typeNumber);\n\n      for (let i = 0; i < 18; i += 1) {\n        const mod = !test && ((bits >> i) & 1) == 1;\n        this._modules[Math.floor(i / 3)][\n          (i % 3) + this._moduleCount - 8 - 3\n        ] = mod;\n      }\n\n      for (let i = 0; i < 18; i += 1) {\n        const mod = !test && ((bits >> i) & 1) == 1;\n        this._modules[(i % 3) + this._moduleCount - 8 - 3][\n          Math.floor(i / 3)\n        ] = mod;\n      }\n    };\n\n    this.setupTypeInfo = (test, maskPattern) => {\n      let data = (this._errorCorrectionLevel << 3) | maskPattern;\n      let bits = QRUtil.getBCHTypeInfo(data);\n\n      // vertical\n      for (let i = 0; i < 15; i += 1) {\n        const mod = !test && ((bits >> i) & 1) == 1;\n\n        if (i < 6) {\n          this._modules[i][8] = mod;\n        } else if (i < 8) {\n          this._modules[i + 1][8] = mod;\n        } else {\n          this._modules[this._moduleCount - 15 + i][8] = mod;\n        }\n      }\n\n      // horizontal\n      for (let i = 0; i < 15; i += 1) {\n        const mod = !test && ((bits >> i) & 1) == 1;\n\n        if (i < 8) {\n          this._modules[8][this._moduleCount - i - 1] = mod;\n        } else if (i < 9) {\n          this._modules[8][15 - i - 1 + 1] = mod;\n        } else {\n          this._modules[8][15 - i - 1] = mod;\n        }\n      }\n\n      // fixed module\n      this._modules[this._moduleCount - 8][8] = !test;\n    };\n\n    this.mapData = (data, maskPattern) => {\n      let inc = -1;\n      let row = this._moduleCount - 1;\n      let bitIndex = 7;\n      let byteIndex = 0;\n      let maskFunc = QRUtil.getMaskFunction(maskPattern);\n\n      for (let col = this._moduleCount - 1; col > 0; col -= 2) {\n        if (col == 6) col -= 1;\n\n        while (true) {\n          for (let c = 0; c < 2; c += 1) {\n            if (this._modules[row][col - c] == null) {\n              let dark = false;\n\n              if (byteIndex < data.length) {\n                dark = ((data[byteIndex] >>> bitIndex) & 1) == 1;\n              }\n\n              let mask = maskFunc(row, col - c);\n\n              if (mask) {\n                dark = !dark;\n              }\n\n              this._modules[row][col - c] = dark;\n              bitIndex -= 1;\n\n              if (bitIndex == -1) {\n                byteIndex += 1;\n                bitIndex = 7;\n              }\n            }\n          }\n\n          row += inc;\n\n          if (row < 0 || this._moduleCount <= row) {\n            row -= inc;\n            inc = -inc;\n            break;\n          }\n        }\n      }\n    };\n\n    this.createBytes = (buffer, rsBlocks) => {\n      let offset = 0;\n\n      let maxDcCount = 0;\n      let maxEcCount = 0;\n\n      let dcdata = new Array(rsBlocks.length);\n      let ecdata = new Array(rsBlocks.length);\n\n      for (let r = 0; r < rsBlocks.length; r += 1) {\n        let dcCount = rsBlocks[r].dataCount;\n        let ecCount = rsBlocks[r].totalCount - dcCount;\n\n        maxDcCount = Math.max(maxDcCount, dcCount);\n        maxEcCount = Math.max(maxEcCount, ecCount);\n\n        dcdata[r] = new Array(dcCount);\n\n        for (let i = 0; i < dcdata[r].length; i += 1) {\n          dcdata[r][i] = 0xff & buffer.getBuffer()[i + offset];\n        }\n        offset += dcCount;\n\n        let rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);\n        let rawPoly = qrPolynomial(dcdata[r], rsPoly.getLength() - 1);\n\n        let modPoly = rawPoly.mod(rsPoly);\n        ecdata[r] = new Array(rsPoly.getLength() - 1);\n        for (let i = 0; i < ecdata[r].length; i += 1) {\n          let modIndex = i + modPoly.getLength() - ecdata[r].length;\n          ecdata[r][i] = modIndex >= 0 ? modPoly.getAt(modIndex) : 0;\n        }\n      }\n\n      let totalCodeCount = 0;\n      for (let i = 0; i < rsBlocks.length; i += 1) {\n        totalCodeCount += rsBlocks[i].totalCount;\n      }\n\n      let data = new Array(totalCodeCount);\n      let index = 0;\n\n      for (let i = 0; i < maxDcCount; i += 1) {\n        for (let r = 0; r < rsBlocks.length; r += 1) {\n          if (i < dcdata[r].length) {\n            data[index] = dcdata[r][i];\n            index += 1;\n          }\n        }\n      }\n\n      for (let i = 0; i < maxEcCount; i += 1) {\n        for (let r = 0; r < rsBlocks.length; r += 1) {\n          if (i < ecdata[r].length) {\n            data[index] = ecdata[r][i];\n            index += 1;\n          }\n        }\n      }\n\n      return data;\n    };\n\n    this.createData = (typeNumber, errorCorrectionLevel, dataList) => {\n      let rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectionLevel);\n\n      let buffer = qrBitBuffer();\n\n      for (let i = 0; i < dataList.length; i += 1) {\n        let data = dataList[i];\n        buffer.put(data.getMode(), 4);\n        buffer.put(\n          data.getLength(),\n          QRUtil.getLengthInBits(data.getMode(), typeNumber)\n        );\n        data.write(buffer);\n      }\n\n      // calc num max data.\n      let totalDataCount = 0;\n      for (let i = 0; i < rsBlocks.length; i += 1) {\n        totalDataCount += rsBlocks[i].dataCount;\n      }\n\n      if (buffer.getLengthInBits() > totalDataCount * 8) {\n        throw \"code length overflow. (\" +\n          buffer.getLengthInBits() +\n          \">\" +\n          totalDataCount * 8 +\n          \")\";\n      }\n\n      // end code\n      if (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n        buffer.put(0, 4);\n      }\n\n      // padding\n      while (buffer.getLengthInBits() % 8 != 0) {\n        buffer.putBit(false);\n      }\n\n      // padding\n      while (true) {\n        if (buffer.getLengthInBits() >= totalDataCount * 8) {\n          break;\n        }\n        buffer.put(PAD0, 8);\n\n        if (buffer.getLengthInBits() >= totalDataCount * 8) {\n          break;\n        }\n        buffer.put(PAD1, 8);\n      }\n\n      return this.createBytes(buffer, rsBlocks);\n    };\n  }\n\n  addData(data, mode) {\n    mode = mode || \"Byte\";\n\n    let newData = null;\n\n    switch (mode) {\n      case \"Numeric\":\n        newData = qrNumber(data);\n        break;\n      case \"Alphanumeric\":\n        newData = qrAlphaNum(data);\n        break;\n      case \"Byte\":\n        newData = qr8BitByte(data);\n        break;\n      case \"Kanji\":\n        newData = qrKanji(data);\n        break;\n      default:\n        throw \"mode:\" + mode;\n    }\n\n    this._dataList.push(newData);\n    this._dataCache = null;\n  }\n\n  /**\n   * @returns {boolean} true if the module at `row, col` is dark.\n   */\n  isDark(row, col) {\n    if (\n      row < 0 ||\n      this._moduleCount <= row ||\n      col < 0 ||\n      this._moduleCount <= col\n    ) {\n      throw row + \",\" + col;\n    }\n    return this._modules[row][col];\n  }\n\n  /**\n   * @returns {integer} The module count in one dimension of the QR code.  The total number of modules is the square of this value.\n   */\n  getModuleCount() {\n    return this._moduleCount;\n  }\n\n  /**\n   * Call this when done adding data before getting the generated QR code image.\n   */\n  make() {\n    if (this._typeNumber < 1) {\n      let typeNumber = 1;\n\n      for (; typeNumber < 40; typeNumber++) {\n        let rsBlocks = QRRSBlock.getRSBlocks(\n          typeNumber,\n          this._errorCorrectionLevel\n        );\n        let buffer = qrBitBuffer();\n\n        for (let i = 0; i < this._dataList.length; i++) {\n          let data = this._dataList[i];\n          buffer.put(data.getMode(), 4);\n          buffer.put(\n            data.getLength(),\n            QRUtil.getLengthInBits(data.getMode(), typeNumber)\n          );\n          data.write(buffer);\n        }\n\n        let totalDataCount = 0;\n        for (let i = 0; i < rsBlocks.length; i++) {\n          totalDataCount += rsBlocks[i].dataCount;\n        }\n\n        if (buffer.getLengthInBits() <= totalDataCount * 8) {\n          break;\n        }\n      }\n\n      this._typeNumber = typeNumber;\n    }\n\n    this.makeImpl(false, this.getBestMaskPattern());\n  }\n\n  /**\n   * @param {Object} args\n   * @param {function} [args.drawCell] A callback with arguments `column, row, x, y` to draw a cell.  `x, y` are the coordinates to draw it at.  `c, y` are the QR code module indexes.  Returns the svg element child string for the cell.\n   * @param {function} [args.cellColor] A callback which returns the color for the cell.  By default, a function that returns `black`.  Unused if `drawCell` is provided.\n   * @param {integer} [args.margin] The margin to draw around the QR code, by number of cells.\n   * @param {Object} [args.bg] The background. White by default.\n   * @param {boolean} args.bg.enabled Draw a background\n   * @param {String} args.bg.fill Fill color of the background\n   * @param {Object} [args.obstruction] An image to place in the center of the QR code.\n   * @param {integer} args.obstruction.width Width of the obstruction as a percentage of QR code width.\n   * @param {integer} args.obstruction.height Height of the obstruction as a percentage of QR code height.\n   * @param {String} args.obstruction.path The path of the obstruction image. Exclusive with svgData.\n   * @param {String} args.obstruction.svgData The SVG data to embed as an obstruction. Must start with `<svg`. Exclusive with path.\n   * @returns {String} An svg tag as a string.\n   */\n  createSvgTag({ drawCell, cellColor, cellSize, margin, bg, obstruction }) {\n    drawCell =\n      drawCell ||\n      ((c, r, x, y) =>\n        \"<rect \" +\n        'width=\"' +\n        cellSize +\n        '\" ' +\n        'height=\"' +\n        cellSize +\n        '\" ' +\n        'x=\"' +\n        x +\n        '\" ' +\n        'y=\"' +\n        y +\n        '\" ' +\n        'fill=\"' +\n        cellColor(c, r) +\n        '\" ' +\n        'shape-rendering=\"crispEdges\" ' +\n        \" />\");\n    cellColor = cellColor || (() => \"black\");\n    cellSize = cellSize || 2;\n    margin = typeof margin == \"undefined\" ? cellSize * 4 : margin;\n    let size = this.getModuleCount() * cellSize + margin * 2;\n    let qrSvg = \"\";\n\n    qrSvg += '<svg version=\"1.1\"';\n    qrSvg += ' xmlns=\"http://www.w3.org/2000/svg\"';\n    qrSvg += ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"';\n    qrSvg += ' viewBox=\"0 0 ' + size + \" \" + size + '\" ';\n    qrSvg += ' preserveAspectRatio=\"xMinYMin meet\">';\n    if (!bg) {\n      bg = {\n        enabled: true,\n        fill: \"white\"\n      };\n    }\n    if (bg.enabled) {\n      qrSvg +=\n        '<rect width=\"100%\" height=\"100%\" fill=\"' + bg.fill + '\" x=\"0\" y=\"0\"/>';\n    }\n\n    const modCount = this.getModuleCount();\n    const totalSize = modCount * cellSize + margin * 2;\n    let obstructionCRStart, obstructionCREnd;\n    if (obstruction) {\n      const { width, height } = obstruction;\n      const spans = [Math.ceil(width * modCount), Math.ceil(height * modCount)];\n      obstructionCRStart = spans.map(s => Math.floor(modCount / 2 - s / 2));\n      obstructionCREnd = spans.map(s => Math.ceil(modCount / 2 + s / 2));\n    }\n\n    for (let r = 0; r < modCount; r += 1) {\n      const mr = r * cellSize + margin;\n      for (let c = 0; c < modCount; c += 1) {\n        const mc = c * cellSize + margin;\n        if (\n          obstruction &&\n          c >= obstructionCRStart[0] &&\n          c < obstructionCREnd[0] &&\n          r >= obstructionCRStart[1] &&\n          r < obstructionCREnd[1]\n        ) {\n          if (c == obstructionCRStart[0] && r == obstructionCRStart[1]) {\n            const img_attrs =\n              'x=\"' +\n              (totalSize * (1.0 - obstruction.width) * 0.5).toFixed(3) +\n              '\" ' +\n              'y=\"' +\n              (totalSize * (1.0 - obstruction.height) * 0.5).toFixed(3) +\n              '\" ' +\n              'width=\"' +\n              (totalSize * obstruction.width).toFixed(3) +\n              '\" ' +\n              'height=\"' +\n              (totalSize * obstruction.height).toFixed(3) +\n              '\" ' +\n              'preserveAspectRatio=\"xMidYMid meet\" ';\n            if (obstruction.path) {\n              qrSvg +=\n                \"<image \" +\n                img_attrs +\n                'xlink:href=\"' +\n                obstruction.path +\n                '\" />';\n            } else {\n              qrSvg += \"<svg \" + img_attrs + obstruction.svgData.substring(4);\n            }\n          }\n        } else if (this.isDark(r, c)) {\n          qrSvg += drawCell(c, r, mc, mr);\n        }\n      }\n    }\n\n    qrSvg += \"</svg>\";\n\n    return qrSvg;\n  }\n\n  /**\n   * @param {integer} cellSize The size of a module in pixels.\n   * @param {integer} margin The margin to draw around the QR code in pixels.\n   * @returns {String} An img tag as a string.\n   */\n  createImgTag(cellSize, margin) {\n    cellSize = cellSize || 2;\n    margin = typeof margin == \"undefined\" ? cellSize * 4 : margin;\n\n    let size = this.getModuleCount() * cellSize + margin * 2;\n    let min = margin;\n    let max = size - margin;\n    let self = this;\n\n    return createImgTag(size, size, function(x, y) {\n      if (min <= x && x < max && min <= y && y < max) {\n        let c = Math.floor((x - min) / cellSize);\n        let r = Math.floor((y - min) / cellSize);\n        return self.isDark(r, c) ? 0 : 1;\n      } else {\n        return 1;\n      }\n    });\n  }\n}\n\n/**\n *\n */\nexport const stringToBytesFuncs = {\n  default: function(s) {\n    let bytes = [];\n    for (let i = 0; i < s.length; i += 1) {\n      let c = s.charCodeAt(i);\n      bytes.push(c & 0xff);\n    }\n    return bytes;\n  }\n};\n\n/**\n *\n */\nexport const stringToBytes = stringToBytesFuncs[\"default\"];\n\n//---------------------------------------------------------------------\n// qrcode.createStringToBytes\n//---------------------------------------------------------------------\n\n/**\n *\n */\nconst QRMode = {\n  MODE_NUMBER: 1 << 0,\n  MODE_ALPHA_NUM: 1 << 1,\n  MODE_8BIT_BYTE: 1 << 2,\n  MODE_KANJI: 1 << 3\n};\n\n/**\n *\n */\nexport const QRErrorCorrectionLevel = {\n  L: 1,\n  M: 0,\n  Q: 3,\n  H: 2\n};\n\n/**\n *\n */\nconst QRMaskPattern = {\n  PATTERN000: 0,\n  PATTERN001: 1,\n  PATTERN010: 2,\n  PATTERN011: 3,\n  PATTERN100: 4,\n  PATTERN101: 5,\n  PATTERN110: 6,\n  PATTERN111: 7\n};\n\n//---------------------------------------------------------------------\n// QRUtil\n//---------------------------------------------------------------------\n\nconst QRUtil = (function() {\n  const PATTERN_POSITION_TABLE = [\n    [],\n    [6, 18],\n    [6, 22],\n    [6, 26],\n    [6, 30],\n    [6, 34],\n    [6, 22, 38],\n    [6, 24, 42],\n    [6, 26, 46],\n    [6, 28, 50],\n    [6, 30, 54],\n    [6, 32, 58],\n    [6, 34, 62],\n    [6, 26, 46, 66],\n    [6, 26, 48, 70],\n    [6, 26, 50, 74],\n    [6, 30, 54, 78],\n    [6, 30, 56, 82],\n    [6, 30, 58, 86],\n    [6, 34, 62, 90],\n    [6, 28, 50, 72, 94],\n    [6, 26, 50, 74, 98],\n    [6, 30, 54, 78, 102],\n    [6, 28, 54, 80, 106],\n    [6, 32, 58, 84, 110],\n    [6, 30, 58, 86, 114],\n    [6, 34, 62, 90, 118],\n    [6, 26, 50, 74, 98, 122],\n    [6, 30, 54, 78, 102, 126],\n    [6, 26, 52, 78, 104, 130],\n    [6, 30, 56, 82, 108, 134],\n    [6, 34, 60, 86, 112, 138],\n    [6, 30, 58, 86, 114, 142],\n    [6, 34, 62, 90, 118, 146],\n    [6, 30, 54, 78, 102, 126, 150],\n    [6, 24, 50, 76, 102, 128, 154],\n    [6, 28, 54, 80, 106, 132, 158],\n    [6, 32, 58, 84, 110, 136, 162],\n    [6, 26, 54, 82, 110, 138, 166],\n    [6, 30, 58, 86, 114, 142, 170]\n  ];\n  const G15 =\n    (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0);\n  const G18 =\n    (1 << 12) |\n    (1 << 11) |\n    (1 << 10) |\n    (1 << 9) |\n    (1 << 8) |\n    (1 << 5) |\n    (1 << 2) |\n    (1 << 0);\n  const G15_MASK = (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1);\n\n  let _this = {};\n\n  let getBCHDigit = function(data) {\n    let digit = 0;\n    while (data != 0) {\n      digit += 1;\n      data >>>= 1;\n    }\n    return digit;\n  };\n\n  _this.getBCHTypeInfo = function(data) {\n    let d = data << 10;\n    while (getBCHDigit(d) - getBCHDigit(G15) >= 0) {\n      d ^= G15 << (getBCHDigit(d) - getBCHDigit(G15));\n    }\n    return ((data << 10) | d) ^ G15_MASK;\n  };\n\n  _this.getBCHTypeNumber = function(data) {\n    let d = data << 12;\n    while (getBCHDigit(d) - getBCHDigit(G18) >= 0) {\n      d ^= G18 << (getBCHDigit(d) - getBCHDigit(G18));\n    }\n    return (data << 12) | d;\n  };\n\n  _this.getPatternPosition = function(typeNumber) {\n    return PATTERN_POSITION_TABLE[typeNumber - 1];\n  };\n\n  _this.getMaskFunction = function(maskPattern) {\n    switch (maskPattern) {\n      case QRMaskPattern.PATTERN000:\n        return function(i, j) {\n          return (i + j) % 2 == 0;\n        };\n      case QRMaskPattern.PATTERN001:\n        return function(i, _) {\n          return i % 2 == 0;\n        };\n      case QRMaskPattern.PATTERN010:\n        return function(i, j) {\n          return j % 3 == 0;\n        };\n      case QRMaskPattern.PATTERN011:\n        return function(i, j) {\n          return (i + j) % 3 == 0;\n        };\n      case QRMaskPattern.PATTERN100:\n        return function(i, j) {\n          return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 == 0;\n        };\n      case QRMaskPattern.PATTERN101:\n        return function(i, j) {\n          return ((i * j) % 2) + ((i * j) % 3) == 0;\n        };\n      case QRMaskPattern.PATTERN110:\n        return function(i, j) {\n          return (((i * j) % 2) + ((i * j) % 3)) % 2 == 0;\n        };\n      case QRMaskPattern.PATTERN111:\n        return function(i, j) {\n          return (((i * j) % 3) + ((i + j) % 2)) % 2 == 0;\n        };\n\n      default:\n        throw \"bad maskPattern:\" + maskPattern;\n    }\n  };\n\n  _this.getErrorCorrectPolynomial = function(errorCorrectLength) {\n    let a = qrPolynomial([1], 0);\n    for (let i = 0; i < errorCorrectLength; i += 1) {\n      a = a.multiply(qrPolynomial([1, QRMath.gexp(i)], 0));\n    }\n    return a;\n  };\n\n  _this.getLengthInBits = function(mode, type) {\n    if (1 <= type && type < 10) {\n      // 1 - 9\n\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 10;\n        case QRMode.MODE_ALPHA_NUM:\n          return 9;\n        case QRMode.MODE_8BIT_BYTE:\n          return 8;\n        case QRMode.MODE_KANJI:\n          return 8;\n        default:\n          throw \"mode:\" + mode;\n      }\n    } else if (type < 27) {\n      // 10 - 26\n\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 12;\n        case QRMode.MODE_ALPHA_NUM:\n          return 11;\n        case QRMode.MODE_8BIT_BYTE:\n          return 16;\n        case QRMode.MODE_KANJI:\n          return 10;\n        default:\n          throw \"mode:\" + mode;\n      }\n    } else if (type < 41) {\n      // 27 - 40\n\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 14;\n        case QRMode.MODE_ALPHA_NUM:\n          return 13;\n        case QRMode.MODE_8BIT_BYTE:\n          return 16;\n        case QRMode.MODE_KANJI:\n          return 12;\n        default:\n          throw \"mode:\" + mode;\n      }\n    } else {\n      throw \"type:\" + type;\n    }\n  };\n\n  _this.getLostPoint = function(qrcode) {\n    let moduleCount = qrcode.getModuleCount();\n\n    let lostPoint = 0;\n\n    // LEVEL1\n\n    for (let row = 0; row < moduleCount; row += 1) {\n      for (let col = 0; col < moduleCount; col += 1) {\n        let sameCount = 0;\n        let dark = qrcode.isDark(row, col);\n\n        for (let r = -1; r <= 1; r += 1) {\n          if (row + r < 0 || moduleCount <= row + r) {\n            continue;\n          }\n\n          for (let c = -1; c <= 1; c += 1) {\n            if (col + c < 0 || moduleCount <= col + c) {\n              continue;\n            }\n\n            if (r == 0 && c == 0) {\n              continue;\n            }\n\n            if (dark == qrcode.isDark(row + r, col + c)) {\n              sameCount += 1;\n            }\n          }\n        }\n\n        if (sameCount > 5) {\n          lostPoint += 3 + sameCount - 5;\n        }\n      }\n    }\n\n    // LEVEL2\n\n    for (let row = 0; row < moduleCount - 1; row += 1) {\n      for (let col = 0; col < moduleCount - 1; col += 1) {\n        let count = 0;\n        if (qrcode.isDark(row, col)) count += 1;\n        if (qrcode.isDark(row + 1, col)) count += 1;\n        if (qrcode.isDark(row, col + 1)) count += 1;\n        if (qrcode.isDark(row + 1, col + 1)) count += 1;\n        if (count == 0 || count == 4) {\n          lostPoint += 3;\n        }\n      }\n    }\n\n    // LEVEL3\n\n    for (let row = 0; row < moduleCount; row += 1) {\n      for (let col = 0; col < moduleCount - 6; col += 1) {\n        if (\n          qrcode.isDark(row, col) &&\n          !qrcode.isDark(row, col + 1) &&\n          qrcode.isDark(row, col + 2) &&\n          qrcode.isDark(row, col + 3) &&\n          qrcode.isDark(row, col + 4) &&\n          !qrcode.isDark(row, col + 5) &&\n          qrcode.isDark(row, col + 6)\n        ) {\n          lostPoint += 40;\n        }\n      }\n    }\n\n    for (let col = 0; col < moduleCount; col += 1) {\n      for (let row = 0; row < moduleCount - 6; row += 1) {\n        if (\n          qrcode.isDark(row, col) &&\n          !qrcode.isDark(row + 1, col) &&\n          qrcode.isDark(row + 2, col) &&\n          qrcode.isDark(row + 3, col) &&\n          qrcode.isDark(row + 4, col) &&\n          !qrcode.isDark(row + 5, col) &&\n          qrcode.isDark(row + 6, col)\n        ) {\n          lostPoint += 40;\n        }\n      }\n    }\n\n    // LEVEL4\n\n    let darkCount = 0;\n\n    for (let col = 0; col < moduleCount; col += 1) {\n      for (let row = 0; row < moduleCount; row += 1) {\n        if (qrcode.isDark(row, col)) {\n          darkCount += 1;\n        }\n      }\n    }\n\n    let ratio =\n      Math.abs((100 * darkCount) / moduleCount / moduleCount - 50) / 5;\n    lostPoint += ratio * 10;\n\n    return lostPoint;\n  };\n\n  return _this;\n})();\n\n//---------------------------------------------------------------------\n// QRMath\n//---------------------------------------------------------------------\n\nlet QRMath = (function() {\n  let EXP_TABLE = new Array(256);\n  let LOG_TABLE = new Array(256);\n\n  // initialize tables\n  for (let i = 0; i < 8; i += 1) {\n    EXP_TABLE[i] = 1 << i;\n  }\n  for (let i = 8; i < 256; i += 1) {\n    EXP_TABLE[i] =\n      EXP_TABLE[i - 4] ^ EXP_TABLE[i - 5] ^ EXP_TABLE[i - 6] ^ EXP_TABLE[i - 8];\n  }\n  for (let i = 0; i < 255; i += 1) {\n    LOG_TABLE[EXP_TABLE[i]] = i;\n  }\n\n  let _this = {};\n\n  _this.glog = function(n) {\n    if (n < 1) {\n      throw \"glog(\" + n + \")\";\n    }\n\n    return LOG_TABLE[n];\n  };\n\n  _this.gexp = function(n) {\n    while (n < 0) {\n      n += 255;\n    }\n\n    while (n >= 256) {\n      n -= 255;\n    }\n\n    return EXP_TABLE[n];\n  };\n\n  return _this;\n})();\n\n//---------------------------------------------------------------------\n// qrPolynomial\n//---------------------------------------------------------------------\n\nfunction qrPolynomial(num, shift) {\n  if (typeof num.length == \"undefined\") {\n    throw num.length + \"/\" + shift;\n  }\n\n  let _num = (function() {\n    let offset = 0;\n    while (offset < num.length && num[offset] == 0) {\n      offset += 1;\n    }\n    let _num = new Array(num.length - offset + shift);\n    for (let i = 0; i < num.length - offset; i += 1) {\n      _num[i] = num[i + offset];\n    }\n    return _num;\n  })();\n\n  let _this = {};\n\n  _this.getAt = function(index) {\n    return _num[index];\n  };\n\n  _this.getLength = function() {\n    return _num.length;\n  };\n\n  _this.multiply = function(e) {\n    let num = new Array(_this.getLength() + e.getLength() - 1);\n\n    for (let i = 0; i < _this.getLength(); i += 1) {\n      for (let j = 0; j < e.getLength(); j += 1) {\n        num[i + j] ^= QRMath.gexp(\n          QRMath.glog(_this.getAt(i)) + QRMath.glog(e.getAt(j))\n        );\n      }\n    }\n\n    return qrPolynomial(num, 0);\n  };\n\n  _this.mod = function(e) {\n    if (_this.getLength() - e.getLength() < 0) {\n      return _this;\n    }\n\n    let ratio = QRMath.glog(_this.getAt(0)) - QRMath.glog(e.getAt(0));\n\n    let num = new Array(_this.getLength());\n    for (let i = 0; i < _this.getLength(); i += 1) {\n      num[i] = _this.getAt(i);\n    }\n\n    for (let i = 0; i < e.getLength(); i += 1) {\n      num[i] ^= QRMath.gexp(QRMath.glog(e.getAt(i)) + ratio);\n    }\n\n    // recursive call\n    return qrPolynomial(num, 0).mod(e);\n  };\n\n  return _this;\n}\n\n//---------------------------------------------------------------------\n// QRRSBlock\n//---------------------------------------------------------------------\n\nconst QRRSBlock = (function() {\n  let RS_BLOCK_TABLE = [\n    // L\n    // M\n    // Q\n    // H\n\n    // 1\n    [1, 26, 19],\n    [1, 26, 16],\n    [1, 26, 13],\n    [1, 26, 9],\n\n    // 2\n    [1, 44, 34],\n    [1, 44, 28],\n    [1, 44, 22],\n    [1, 44, 16],\n\n    // 3\n    [1, 70, 55],\n    [1, 70, 44],\n    [2, 35, 17],\n    [2, 35, 13],\n\n    // 4\n    [1, 100, 80],\n    [2, 50, 32],\n    [2, 50, 24],\n    [4, 25, 9],\n\n    // 5\n    [1, 134, 108],\n    [2, 67, 43],\n    [2, 33, 15, 2, 34, 16],\n    [2, 33, 11, 2, 34, 12],\n\n    // 6\n    [2, 86, 68],\n    [4, 43, 27],\n    [4, 43, 19],\n    [4, 43, 15],\n\n    // 7\n    [2, 98, 78],\n    [4, 49, 31],\n    [2, 32, 14, 4, 33, 15],\n    [4, 39, 13, 1, 40, 14],\n\n    // 8\n    [2, 121, 97],\n    [2, 60, 38, 2, 61, 39],\n    [4, 40, 18, 2, 41, 19],\n    [4, 40, 14, 2, 41, 15],\n\n    // 9\n    [2, 146, 116],\n    [3, 58, 36, 2, 59, 37],\n    [4, 36, 16, 4, 37, 17],\n    [4, 36, 12, 4, 37, 13],\n\n    // 10\n    [2, 86, 68, 2, 87, 69],\n    [4, 69, 43, 1, 70, 44],\n    [6, 43, 19, 2, 44, 20],\n    [6, 43, 15, 2, 44, 16],\n\n    // 11\n    [4, 101, 81],\n    [1, 80, 50, 4, 81, 51],\n    [4, 50, 22, 4, 51, 23],\n    [3, 36, 12, 8, 37, 13],\n\n    // 12\n    [2, 116, 92, 2, 117, 93],\n    [6, 58, 36, 2, 59, 37],\n    [4, 46, 20, 6, 47, 21],\n    [7, 42, 14, 4, 43, 15],\n\n    // 13\n    [4, 133, 107],\n    [8, 59, 37, 1, 60, 38],\n    [8, 44, 20, 4, 45, 21],\n    [12, 33, 11, 4, 34, 12],\n\n    // 14\n    [3, 145, 115, 1, 146, 116],\n    [4, 64, 40, 5, 65, 41],\n    [11, 36, 16, 5, 37, 17],\n    [11, 36, 12, 5, 37, 13],\n\n    // 15\n    [5, 109, 87, 1, 110, 88],\n    [5, 65, 41, 5, 66, 42],\n    [5, 54, 24, 7, 55, 25],\n    [11, 36, 12, 7, 37, 13],\n\n    // 16\n    [5, 122, 98, 1, 123, 99],\n    [7, 73, 45, 3, 74, 46],\n    [15, 43, 19, 2, 44, 20],\n    [3, 45, 15, 13, 46, 16],\n\n    // 17\n    [1, 135, 107, 5, 136, 108],\n    [10, 74, 46, 1, 75, 47],\n    [1, 50, 22, 15, 51, 23],\n    [2, 42, 14, 17, 43, 15],\n\n    // 18\n    [5, 150, 120, 1, 151, 121],\n    [9, 69, 43, 4, 70, 44],\n    [17, 50, 22, 1, 51, 23],\n    [2, 42, 14, 19, 43, 15],\n\n    // 19\n    [3, 141, 113, 4, 142, 114],\n    [3, 70, 44, 11, 71, 45],\n    [17, 47, 21, 4, 48, 22],\n    [9, 39, 13, 16, 40, 14],\n\n    // 20\n    [3, 135, 107, 5, 136, 108],\n    [3, 67, 41, 13, 68, 42],\n    [15, 54, 24, 5, 55, 25],\n    [15, 43, 15, 10, 44, 16],\n\n    // 21\n    [4, 144, 116, 4, 145, 117],\n    [17, 68, 42],\n    [17, 50, 22, 6, 51, 23],\n    [19, 46, 16, 6, 47, 17],\n\n    // 22\n    [2, 139, 111, 7, 140, 112],\n    [17, 74, 46],\n    [7, 54, 24, 16, 55, 25],\n    [34, 37, 13],\n\n    // 23\n    [4, 151, 121, 5, 152, 122],\n    [4, 75, 47, 14, 76, 48],\n    [11, 54, 24, 14, 55, 25],\n    [16, 45, 15, 14, 46, 16],\n\n    // 24\n    [6, 147, 117, 4, 148, 118],\n    [6, 73, 45, 14, 74, 46],\n    [11, 54, 24, 16, 55, 25],\n    [30, 46, 16, 2, 47, 17],\n\n    // 25\n    [8, 132, 106, 4, 133, 107],\n    [8, 75, 47, 13, 76, 48],\n    [7, 54, 24, 22, 55, 25],\n    [22, 45, 15, 13, 46, 16],\n\n    // 26\n    [10, 142, 114, 2, 143, 115],\n    [19, 74, 46, 4, 75, 47],\n    [28, 50, 22, 6, 51, 23],\n    [33, 46, 16, 4, 47, 17],\n\n    // 27\n    [8, 152, 122, 4, 153, 123],\n    [22, 73, 45, 3, 74, 46],\n    [8, 53, 23, 26, 54, 24],\n    [12, 45, 15, 28, 46, 16],\n\n    // 28\n    [3, 147, 117, 10, 148, 118],\n    [3, 73, 45, 23, 74, 46],\n    [4, 54, 24, 31, 55, 25],\n    [11, 45, 15, 31, 46, 16],\n\n    // 29\n    [7, 146, 116, 7, 147, 117],\n    [21, 73, 45, 7, 74, 46],\n    [1, 53, 23, 37, 54, 24],\n    [19, 45, 15, 26, 46, 16],\n\n    // 30\n    [5, 145, 115, 10, 146, 116],\n    [19, 75, 47, 10, 76, 48],\n    [15, 54, 24, 25, 55, 25],\n    [23, 45, 15, 25, 46, 16],\n\n    // 31\n    [13, 145, 115, 3, 146, 116],\n    [2, 74, 46, 29, 75, 47],\n    [42, 54, 24, 1, 55, 25],\n    [23, 45, 15, 28, 46, 16],\n\n    // 32\n    [17, 145, 115],\n    [10, 74, 46, 23, 75, 47],\n    [10, 54, 24, 35, 55, 25],\n    [19, 45, 15, 35, 46, 16],\n\n    // 33\n    [17, 145, 115, 1, 146, 116],\n    [14, 74, 46, 21, 75, 47],\n    [29, 54, 24, 19, 55, 25],\n    [11, 45, 15, 46, 46, 16],\n\n    // 34\n    [13, 145, 115, 6, 146, 116],\n    [14, 74, 46, 23, 75, 47],\n    [44, 54, 24, 7, 55, 25],\n    [59, 46, 16, 1, 47, 17],\n\n    // 35\n    [12, 151, 121, 7, 152, 122],\n    [12, 75, 47, 26, 76, 48],\n    [39, 54, 24, 14, 55, 25],\n    [22, 45, 15, 41, 46, 16],\n\n    // 36\n    [6, 151, 121, 14, 152, 122],\n    [6, 75, 47, 34, 76, 48],\n    [46, 54, 24, 10, 55, 25],\n    [2, 45, 15, 64, 46, 16],\n\n    // 37\n    [17, 152, 122, 4, 153, 123],\n    [29, 74, 46, 14, 75, 47],\n    [49, 54, 24, 10, 55, 25],\n    [24, 45, 15, 46, 46, 16],\n\n    // 38\n    [4, 152, 122, 18, 153, 123],\n    [13, 74, 46, 32, 75, 47],\n    [48, 54, 24, 14, 55, 25],\n    [42, 45, 15, 32, 46, 16],\n\n    // 39\n    [20, 147, 117, 4, 148, 118],\n    [40, 75, 47, 7, 76, 48],\n    [43, 54, 24, 22, 55, 25],\n    [10, 45, 15, 67, 46, 16],\n\n    // 40\n    [19, 148, 118, 6, 149, 119],\n    [18, 75, 47, 31, 76, 48],\n    [34, 54, 24, 34, 55, 25],\n    [20, 45, 15, 61, 46, 16]\n  ];\n\n  let qrRSBlock = function(totalCount, dataCount) {\n    let _this = {};\n    _this.totalCount = totalCount;\n    _this.dataCount = dataCount;\n    return _this;\n  };\n\n  let _this = {};\n\n  let getRsBlockTable = function(typeNumber, errorCorrectionLevel) {\n    switch (errorCorrectionLevel) {\n      case QRErrorCorrectionLevel.L:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n      case QRErrorCorrectionLevel.M:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n      case QRErrorCorrectionLevel.Q:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n      case QRErrorCorrectionLevel.H:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n      default:\n        return undefined;\n    }\n  };\n\n  _this.getRSBlocks = function(typeNumber, errorCorrectionLevel) {\n    let rsBlock = getRsBlockTable(typeNumber, errorCorrectionLevel);\n\n    if (typeof rsBlock == \"undefined\") {\n      throw \"bad rs block @ typeNumber:\" +\n        typeNumber +\n        \"/errorCorrectionLevel:\" +\n        errorCorrectionLevel;\n    }\n\n    let length = rsBlock.length / 3;\n\n    let list = [];\n\n    for (let i = 0; i < length; i += 1) {\n      let count = rsBlock[i * 3 + 0];\n      let totalCount = rsBlock[i * 3 + 1];\n      let dataCount = rsBlock[i * 3 + 2];\n\n      for (let j = 0; j < count; j += 1) {\n        list.push(qrRSBlock(totalCount, dataCount));\n      }\n    }\n\n    return list;\n  };\n\n  return _this;\n})();\n\n//---------------------------------------------------------------------\n// qrBitBuffer\n//---------------------------------------------------------------------\n\nlet qrBitBuffer = function() {\n  let _buffer = [];\n  let _length = 0;\n\n  let _this = {};\n\n  _this.getBuffer = function() {\n    return _buffer;\n  };\n\n  _this.getAt = function(index) {\n    let bufIndex = Math.floor(index / 8);\n    return ((_buffer[bufIndex] >>> (7 - (index % 8))) & 1) == 1;\n  };\n\n  _this.put = function(num, length) {\n    for (let i = 0; i < length; i += 1) {\n      _this.putBit(((num >>> (length - i - 1)) & 1) == 1);\n    }\n  };\n\n  _this.getLengthInBits = function() {\n    return _length;\n  };\n\n  _this.putBit = function(bit) {\n    let bufIndex = Math.floor(_length / 8);\n    if (_buffer.length <= bufIndex) {\n      _buffer.push(0);\n    }\n\n    if (bit) {\n      _buffer[bufIndex] |= 0x80 >>> _length % 8;\n    }\n\n    _length += 1;\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// qrNumber\n//---------------------------------------------------------------------\n\nlet qrNumber = function(data) {\n  let _mode = QRMode.MODE_NUMBER;\n  let _data = data;\n\n  let _this = {};\n\n  _this.getMode = function() {\n    return _mode;\n  };\n\n  _this.getLength = function(_) {\n    return _data.length;\n  };\n\n  _this.write = function(buffer) {\n    let data = _data;\n\n    let i = 0;\n\n    while (i + 2 < data.length) {\n      buffer.put(strToNum(data.substring(i, i + 3)), 10);\n      i += 3;\n    }\n\n    if (i < data.length) {\n      if (data.length - i == 1) {\n        buffer.put(strToNum(data.substring(i, i + 1)), 4);\n      } else if (data.length - i == 2) {\n        buffer.put(strToNum(data.substring(i, i + 2)), 7);\n      }\n    }\n  };\n\n  const strToNum = function(s) {\n    let num = 0;\n    for (let i = 0; i < s.length; i += 1) {\n      num = num * 10 + chatToNum(s.charAt(i));\n    }\n    return num;\n  };\n\n  const chatToNum = function(c) {\n    if (\"0\" <= c && c <= \"9\") {\n      return c.charCodeAt(0) - \"0\".charCodeAt(0);\n    }\n    throw \"illegal char :\" + c;\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// qrAlphaNum\n//---------------------------------------------------------------------\n\nconst qrAlphaNum = function(data) {\n  let _mode = QRMode.MODE_ALPHA_NUM;\n  let _data = data;\n\n  let _this = {};\n\n  _this.getMode = function() {\n    return _mode;\n  };\n\n  _this.getLength = function(_) {\n    return _data.length;\n  };\n\n  _this.write = function(buffer) {\n    let s = _data;\n\n    let i = 0;\n\n    while (i + 1 < s.length) {\n      buffer.put(getCode(s.charAt(i)) * 45 + getCode(s.charAt(i + 1)), 11);\n      i += 2;\n    }\n\n    if (i < s.length) {\n      buffer.put(getCode(s.charAt(i)), 6);\n    }\n  };\n\n  const getCode = function(c) {\n    if (\"0\" <= c && c <= \"9\") {\n      return c.charCodeAt(0) - \"0\".charCodeAt(0);\n    } else if (\"A\" <= c && c <= \"Z\") {\n      return c.charCodeAt(0) - \"A\".charCodeAt(0) + 10;\n    } else {\n      switch (c) {\n        case \" \":\n          return 36;\n        case \"$\":\n          return 37;\n        case \"%\":\n          return 38;\n        case \"*\":\n          return 39;\n        case \"+\":\n          return 40;\n        case \"-\":\n          return 41;\n        case \".\":\n          return 42;\n        case \"/\":\n          return 43;\n        case \":\":\n          return 44;\n        default:\n          throw \"illegal char :\" + c;\n      }\n    }\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// qr8BitByte\n//---------------------------------------------------------------------\n\nconst qr8BitByte = function(data) {\n  let _mode = QRMode.MODE_8BIT_BYTE;\n  let _bytes = stringToBytes(data);\n\n  let _this = {};\n\n  _this.getMode = function() {\n    return _mode;\n  };\n\n  _this.getLength = function(_) {\n    return _bytes.length;\n  };\n\n  _this.write = function(buffer) {\n    for (let i = 0; i < _bytes.length; i += 1) {\n      buffer.put(_bytes[i], 8);\n    }\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// qrKanji\n//---------------------------------------------------------------------\n\nconst qrKanji = function(data) {\n  let _mode = QRMode.MODE_KANJI;\n\n  let stringToBytes = stringToBytesFuncs[\"SJIS\"];\n  if (!stringToBytes) {\n    throw \"sjis not supported.\";\n  }\n  !(function(c, code) {\n    // self test for sjis support.\n    let test = stringToBytes(c);\n    if (test.length != 2 || ((test[0] << 8) | test[1]) != code) {\n      throw \"sjis not supported.\";\n    }\n  })(\"\\u53cb\", 0x9746);\n\n  let _bytes = stringToBytes(data);\n\n  let _this = {};\n\n  _this.getMode = function() {\n    return _mode;\n  };\n\n  _this.getLength = function(_) {\n    return ~~(_bytes.length / 2);\n  };\n\n  _this.write = function(buffer) {\n    let data = _bytes;\n\n    let i = 0;\n\n    while (i + 1 < data.length) {\n      let c = ((0xff & data[i]) << 8) | (0xff & data[i + 1]);\n\n      if (0x8140 <= c && c <= 0x9ffc) {\n        c -= 0x8140;\n      } else if (0xe040 <= c && c <= 0xebbf) {\n        c -= 0xc140;\n      } else {\n        throw \"illegal char at \" + (i + 1) + \"/\" + c;\n      }\n\n      c = ((c >>> 8) & 0xff) * 0xc0 + (c & 0xff);\n\n      buffer.put(c, 13);\n\n      i += 2;\n    }\n\n    if (i < data.length) {\n      throw \"illegal char at \" + (i + 1);\n    }\n  };\n\n  return _this;\n};\n\n//=====================================================================\n// GIF Support etc.\n//\n\n//---------------------------------------------------------------------\n// byteArrayOutputStream\n//---------------------------------------------------------------------\n\nlet byteArrayOutputStream = function() {\n  let _bytes = [];\n\n  let _this = {};\n\n  _this.writeByte = function(b) {\n    _bytes.push(b & 0xff);\n  };\n\n  _this.writeShort = function(i) {\n    _this.writeByte(i);\n    _this.writeByte(i >>> 8);\n  };\n\n  _this.writeBytes = function(b, off, len) {\n    off = off || 0;\n    len = len || b.length;\n    for (let i = 0; i < len; i += 1) {\n      _this.writeByte(b[i + off]);\n    }\n  };\n\n  _this.writeString = function(s) {\n    for (let i = 0; i < s.length; i += 1) {\n      _this.writeByte(s.charCodeAt(i));\n    }\n  };\n\n  _this.toByteArray = function() {\n    return _bytes;\n  };\n\n  _this.toString = function() {\n    let s = \"\";\n    s += \"[\";\n    for (let i = 0; i < _bytes.length; i += 1) {\n      if (i > 0) {\n        s += \",\";\n      }\n      s += _bytes[i];\n    }\n    s += \"]\";\n    return s;\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// base64EncodeOutputStream\n//---------------------------------------------------------------------\n\nlet base64EncodeOutputStream = function() {\n  let _buffer = 0;\n  let _buflen = 0;\n  let _length = 0;\n  let _base64 = \"\";\n\n  let _this = {};\n\n  let writeEncoded = function(b) {\n    _base64 += String.fromCharCode(encode(b & 0x3f));\n  };\n\n  const encode = function(n) {\n    if (n < 0) {\n      // error.\n    } else if (n < 26) {\n      return 0x41 + n;\n    } else if (n < 52) {\n      return 0x61 + (n - 26);\n    } else if (n < 62) {\n      return 0x30 + (n - 52);\n    } else if (n == 62) {\n      return 0x2b;\n    } else if (n == 63) {\n      return 0x2f;\n    }\n    throw \"n:\" + n;\n  };\n\n  _this.writeByte = function(n) {\n    _buffer = (_buffer << 8) | (n & 0xff);\n    _buflen += 8;\n    _length += 1;\n\n    while (_buflen >= 6) {\n      writeEncoded(_buffer >>> (_buflen - 6));\n      _buflen -= 6;\n    }\n  };\n\n  _this.flush = function() {\n    if (_buflen > 0) {\n      writeEncoded(_buffer << (6 - _buflen));\n      _buffer = 0;\n      _buflen = 0;\n    }\n\n    if (_length % 3 != 0) {\n      // padding\n      let padlen = 3 - (_length % 3);\n      for (let i = 0; i < padlen; i += 1) {\n        _base64 += \"=\";\n      }\n    }\n  };\n\n  _this.toString = function() {\n    return _base64;\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// base64DecodeInputStream\n//---------------------------------------------------------------------\n\nconst base64DecodeInputStream = function(str) {\n  let _str = str;\n  let _pos = 0;\n  let _buffer = 0;\n  let _buflen = 0;\n\n  let _this = {};\n\n  _this.read = function() {\n    while (_buflen < 8) {\n      if (_pos >= _str.length) {\n        if (_buflen == 0) {\n          return -1;\n        }\n        throw \"unexpected end of file./\" + _buflen;\n      }\n\n      let c = _str.charAt(_pos);\n      _pos += 1;\n\n      if (c == \"=\") {\n        _buflen = 0;\n        return -1;\n      } else if (c.match(/^\\s$/)) {\n        // ignore if whitespace.\n        continue;\n      }\n\n      _buffer = (_buffer << 6) | decode(c.charCodeAt(0));\n      _buflen += 6;\n    }\n\n    let n = (_buffer >>> (_buflen - 8)) & 0xff;\n    _buflen -= 8;\n    return n;\n  };\n\n  const decode = function(c) {\n    if (0x41 <= c && c <= 0x5a) {\n      return c - 0x41;\n    } else if (0x61 <= c && c <= 0x7a) {\n      return c - 0x61 + 26;\n    } else if (0x30 <= c && c <= 0x39) {\n      return c - 0x30 + 52;\n    } else if (c == 0x2b) {\n      return 62;\n    } else if (c == 0x2f) {\n      return 63;\n    } else {\n      throw \"c:\" + c;\n    }\n  };\n\n  return _this;\n};\n\n//---------------------------------------------------------------------\n// gifImage (B/W)\n//---------------------------------------------------------------------\n\nlet gifImage = function(width, height) {\n  let _width = width;\n  let _height = height;\n  let _data = new Array(width * height);\n\n  let _this = {};\n\n  _this.setPixel = function(x, y, pixel) {\n    _data[y * _width + x] = pixel;\n  };\n\n  _this.write = function(out) {\n    //---------------------------------\n    // GIF Signature\n\n    out.writeString(\"GIF87a\");\n\n    //---------------------------------\n    // Screen Descriptor\n\n    out.writeShort(_width);\n    out.writeShort(_height);\n\n    out.writeByte(0x80); // 2bit\n    out.writeByte(0);\n    out.writeByte(0);\n\n    //---------------------------------\n    // Global Color Map\n\n    // black\n    out.writeByte(0x00);\n    out.writeByte(0x00);\n    out.writeByte(0x00);\n\n    // white\n    out.writeByte(0xff);\n    out.writeByte(0xff);\n    out.writeByte(0xff);\n\n    //---------------------------------\n    // Image Descriptor\n\n    out.writeString(\",\");\n    out.writeShort(0);\n    out.writeShort(0);\n    out.writeShort(_width);\n    out.writeShort(_height);\n    out.writeByte(0);\n\n    //---------------------------------\n    // Local Color Map\n\n    //---------------------------------\n    // Raster Data\n\n    let lzwMinCodeSize = 2;\n    let raster = getLZWRaster(lzwMinCodeSize);\n\n    out.writeByte(lzwMinCodeSize);\n\n    let offset = 0;\n\n    while (raster.length - offset > 255) {\n      out.writeByte(255);\n      out.writeBytes(raster, offset, 255);\n      offset += 255;\n    }\n\n    out.writeByte(raster.length - offset);\n    out.writeBytes(raster, offset, raster.length - offset);\n    out.writeByte(0x00);\n\n    //---------------------------------\n    // GIF Terminator\n    out.writeString(\";\");\n  };\n\n  let bitOutputStream = function(out) {\n    let _out = out;\n    let _bitLength = 0;\n    let _bitBuffer = 0;\n\n    let _this = {};\n\n    _this.write = function(data, length) {\n      if (data >>> length != 0) {\n        throw \"length over\";\n      }\n\n      while (_bitLength + length >= 8) {\n        _out.writeByte(0xff & ((data << _bitLength) | _bitBuffer));\n        length -= 8 - _bitLength;\n        data >>>= 8 - _bitLength;\n        _bitBuffer = 0;\n        _bitLength = 0;\n      }\n\n      _bitBuffer = (data << _bitLength) | _bitBuffer;\n      _bitLength = _bitLength + length;\n    };\n\n    _this.flush = function() {\n      if (_bitLength > 0) {\n        _out.writeByte(_bitBuffer);\n      }\n    };\n\n    return _this;\n  };\n\n  const getLZWRaster = function(lzwMinCodeSize) {\n    let clearCode = 1 << lzwMinCodeSize;\n    let endCode = (1 << lzwMinCodeSize) + 1;\n    let bitLength = lzwMinCodeSize + 1;\n\n    // Setup LZWTable\n    let table = lzwTable();\n\n    for (let i = 0; i < clearCode; i += 1) {\n      table.add(String.fromCharCode(i));\n    }\n    table.add(String.fromCharCode(clearCode));\n    table.add(String.fromCharCode(endCode));\n\n    let byteOut = byteArrayOutputStream();\n    let bitOut = bitOutputStream(byteOut);\n\n    // clear code\n    bitOut.write(clearCode, bitLength);\n\n    let dataIndex = 0;\n\n    let s = String.fromCharCode(_data[dataIndex]);\n    dataIndex += 1;\n\n    while (dataIndex < _data.length) {\n      let c = String.fromCharCode(_data[dataIndex]);\n      dataIndex += 1;\n\n      if (table.contains(s + c)) {\n        s = s + c;\n      } else {\n        bitOut.write(table.indexOf(s), bitLength);\n\n        if (table.size() < 0xfff) {\n          if (table.size() == 1 << bitLength) {\n            bitLength += 1;\n          }\n\n          table.add(s + c);\n        }\n\n        s = c;\n      }\n    }\n\n    bitOut.write(table.indexOf(s), bitLength);\n\n    // end code\n    bitOut.write(endCode, bitLength);\n\n    bitOut.flush();\n\n    return byteOut.toByteArray();\n  };\n\n  const lzwTable = function() {\n    let _map = {};\n    let _size = 0;\n\n    let _this = {};\n\n    _this.add = function(key) {\n      if (_this.contains(key)) {\n        throw \"dup key:\" + key;\n      }\n      _map[key] = _size;\n      _size += 1;\n    };\n\n    _this.size = function() {\n      return _size;\n    };\n\n    _this.indexOf = function(key) {\n      return _map[key];\n    };\n\n    _this.contains = function(key) {\n      return typeof _map[key] != \"undefined\";\n    };\n\n    return _this;\n  };\n\n  return _this;\n};\n\nconst createImgTag = function(width, height, getPixel, alt) {\n  let gif = gifImage(width, height);\n  for (let y = 0; y < height; y += 1) {\n    for (let x = 0; x < width; x += 1) {\n      gif.setPixel(x, y, getPixel(x, y));\n    }\n  }\n\n  let b = byteArrayOutputStream();\n  gif.write(b);\n\n  let base64 = base64EncodeOutputStream();\n  let bytes = b.toByteArray();\n  for (let i = 0; i < bytes.length; i += 1) {\n    base64.writeByte(bytes[i]);\n  }\n  base64.flush();\n\n  let img = \"\";\n  img += \"<img\";\n  img += '\\u0020src=\"';\n  img += \"data:image/gif;base64,\";\n  img += base64;\n  img += '\"';\n  img += '\\u0020width=\"';\n  img += width;\n  img += '\"';\n  img += '\\u0020height=\"';\n  img += height;\n  img += '\"';\n  if (alt) {\n    img += '\\u0020alt=\"';\n    img += alt;\n    img += '\"';\n  }\n  img += \"/>\";\n\n  return img;\n};\n\n// multibyte support\nstringToBytesFuncs[\"UTF-8\"] = function(s) {\n  // http://stackoverflow.com/questions/18729405/how-to-convert-utf8-string-to-byte-array\n  function toUTF8Array(str) {\n    let utf8 = [];\n    for (let i = 0; i < str.length; i++) {\n      let charcode = str.charCodeAt(i);\n      if (charcode < 0x80) utf8.push(charcode);\n      else if (charcode < 0x800) {\n        utf8.push(0xc0 | (charcode >> 6), 0x80 | (charcode & 0x3f));\n      } else if (charcode < 0xd800 || charcode >= 0xe000) {\n        utf8.push(\n          0xe0 | (charcode >> 12),\n          0x80 | ((charcode >> 6) & 0x3f),\n          0x80 | (charcode & 0x3f)\n        );\n      }\n      // surrogate pair\n      else {\n        i++;\n        // UTF-16 encodes 0x10000-0x10FFFF by\n        // subtracting 0x10000 and splitting the\n        // 20 bits of 0x0-0xFFFFF into two halves\n        charcode =\n          0x10000 + (((charcode & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n        utf8.push(\n          0xf0 | (charcode >> 18),\n          0x80 | ((charcode >> 12) & 0x3f),\n          0x80 | ((charcode >> 6) & 0x3f),\n          0x80 | (charcode & 0x3f)\n        );\n      }\n    }\n    return utf8;\n  }\n  return toUTF8Array(s);\n};\n","import qrcode from \"qrcode-generator-es6\"\n\n/**\n * @param text Text to encode in the QR code\n * @returns Image with a QR code\n * @category QR codes\n */\nexport function generateQRCode(text: string): HTMLImageElement {\n    const qr = new qrcode(0, 'H')\n    qr.addData(text)\n    qr.make()\n    const div: HTMLDivElement = document.createElement(\"div\")\n    div.innerHTML = qr.createImgTag(4)\n    return div.firstChild as HTMLImageElement\n}","'use strict';\n\n/**\n * @internal\n */\nexport class NormalDistribution {\n\n    readonly mean: number\n    readonly standardDeviation: number\n\n    constructor(mean: number = 0, standardDeviation: number = 1) {\n        this.mean = mean\n        this.standardDeviation = standardDeviation\n    }\n\n    private erf(x: number): number {\n        if (Math.abs(x) > 40.0) {\n            return x > 0 ? 1 : -1\n        }\n        const ret = Gamma.regularizedGammaP(0.5, x * x, 1.0e-15, 10000)\n        return x < 0 ? 0-ret : ret\n    }\n\n    cumulativeProbability(x: number): number {\n        const dev = x - this.mean\n        if (Math.abs(dev) > 40.0 * this.standardDeviation) {\n            return dev < 0 ? 0.0 : 1.0\n        }\n        return 0.5 * (1 + this.erf(dev / (this.standardDeviation * Math.sqrt(2))))\n    }\n}\n\nclass Gamma {\n    \n    static lanczos: number[] = [\n        0.99999999999999709182,\n        57.156235665862923517,\n        -59.597960355475491248,\n        14.136097974741747174,\n        -0.49191381609762019978,\n        0.33994649984811888699e-4,\n        0.46523628927048575665e-4,\n        -0.98374475304879564677e-4,\n        0.15808870322491248884e-3,\n        -0.21026444172410488319e-3,\n        0.21743961811521264320e-3,\n        -0.16431810653676389022e-3,\n        0.84418223983852743293e-4,\n        -0.26190838401581408670e-4,\n        0.36899182659531622704e-5\n    ]\n    \n    static halfLog2Pi: number = 0.5 * Math.log(2.0 * Math.PI)\n    \n    static regularizedGammaP(a: number, x: number, epsilon: number, maxIterations: number): number {\n        if (isNaN(a) || isNaN(x) || a <= 0.0 || x < 0.0) {\n            return NaN\n        } else if (x == 0.0) {\n            return 0.0\n        } else if (x >= a + 1) {\n            return 1.0 - Gamma.regularizedGammaQ(a, x, epsilon, maxIterations)\n        } else {\n            let n: number = 0\n            let an: number = 1.0 / a\n            let sum: number = an\n            while (Math.abs(an/sum) > epsilon && n < maxIterations && sum < Infinity) {\n                n = n + 1.0\n                an = an * (x / (a + n))\n                sum += an\n            }\n            if (n >= maxIterations) {\n                throw new Error()\n            } else if (!isFinite(sum)) {\n                return 1.0\n            } else {\n                return Math.exp(0 - x + (a * Math.log(x)) - Gamma.logGamma(a)) * sum\n            }\n        }\n    }\n    \n    static regularizedGammaQ(a: number, x: number, epsilon: number, maxIterations: number): number {\n        if (isNaN(a) || isNaN(x) || a <= 0.0 || x < 0.0) {\n            return NaN\n        }\n        if (x == 0.0) {\n            return 1.0\n        }\n        if (x < a + 1.0) {\n            return 1.0 - Gamma.regularizedGammaP(a, x, epsilon, maxIterations)\n        }\n        const cf = new ContinuedFraction((n: number, x1: number) => {\n            return ((2.0 * n) + 1.0) - a + x1\n        }, (n: number, x1: number) => {\n            return n * (a - n)\n        })\n        let ret = 1.0 / cf.evaluate(x, epsilon, maxIterations)\n        ret = Math.exp(0 - x + (a * Math.log(x)) - Gamma.logGamma(a)) * ret\n        return ret\n    }\n    \n    static logGamma(x: number): number {\n        if (isNaN(x) || x <= 0.0) {\n            return NaN\n        }\n        const g: number = 607.0 / 128.0\n        let sum: number = 0.0\n        let i = this.lanczos.length-1\n        while (i>0) {\n            sum += this.lanczos[i] / (x + i)\n            i -= 1\n        }\n        sum += this.lanczos[0]\n        \n        const tmp: number = x + g + 0.5\n        return ((x + 0.5) * Math.log(tmp)) - tmp + Gamma.halfLog2Pi + Math.log(sum / x)\n    }\n}\n\nclass ContinuedFraction {\n    \n    readonly getA: (a: number, b: number) => number\n    readonly getB: (a: number ,b: number) => number\n    \n    constructor(getA: (a: number, b: number) => number, getB: (a: number, b: number) => number) {\n        this.getA = getA\n        this.getB = getB\n    }\n    \n    evaluate(x: number, epsilon: number, maxIterations: number): number {\n        let p0 = 1.0\n        let p1 = this.getA(0, x)\n        let q0 = 0.0\n        let q1 = 1.0\n        let c = p1 / q1\n        let n: number = 0\n        let relativeError = Number.MAX_VALUE\n        while (n < maxIterations && relativeError > epsilon) {\n            n += 1\n            const a = this.getA(n, x)\n            const b = this.getB(n, x)\n            let p2 = a * p1 + b * p0\n            let q2 = a * q1 + b * q0\n            let infinite = false\n            if (!isFinite(p2) || !isFinite(q2)) {\n                /*\n                 * Need to scale. Try successive powers of the larger of a or b\n                 * up to 5th power. Throw ConvergenceException if one or both\n                 * of p2, q2 still overflow.\n                 */\n                var scaleFactor = 1.0\n                var lastScaleFactor = 1.0\n                let maxPower = 5\n                let scale = Math.max(a,b)\n                if (scale <= 0) {  // Can't scale\n                    throw new Error()\n                }\n                infinite = true\n                for (let i=0; i<maxPower; i++) {\n                    lastScaleFactor = scaleFactor\n                    scaleFactor *= scale\n                    if (a != 0.0 && a > b) {\n                        p2 = p1 / lastScaleFactor + (b / scaleFactor * p0)\n                        q2 = q1 / lastScaleFactor + (b / scaleFactor * q0)\n                    } else if (b != 0) {\n                        p2 = (a / scaleFactor * p1) + p0 / lastScaleFactor\n                        q2 = (a / scaleFactor * q1) + q0 / lastScaleFactor\n                    }\n                    infinite = !isFinite(p2) || !isFinite(q2)\n                    if (!infinite) {\n                        break\n                    }\n                }\n            }\n\n            if (infinite) {\n               // Scaling failed\n               throw new Error()\n            }\n\n            const r = p2 / q2\n\n            if (isNaN(r)) {\n                throw new Error()\n            }\n            relativeError = Math.abs(r / c - 1.0)\n\n            // prepare for next iteration\n            c = p2 / q2\n            p0 = p1\n            p1 = p2\n            q0 = q1\n            q1 = q2\n        }\n\n        if (n >= maxIterations) {\n            throw new Error()\n        }\n\n        return c\n    }\n}","'use strict';\n\nimport { Face } from \"./types\";\nimport { FaceCapture } from \"./types\";\nimport { FaceDetectionSource, FaceDetector, FaceDetectorFactory } from \"./faceDetector\";\nimport { FaceRequirements, FaceRequirementListener } from \"./types\";\nimport { sizeOfImageSource, canvasToBlob } from \"./utils\";\n\nenum FaceImageSrc {\n    STRAIGHT = \"/images/straight.jpg\",\n    LEFT = \"/images/left.jpg\",\n    RIGHT = \"/images/right.jpg\",\n    UP_LEFT = \"/images/up-left.jpg\",\n    UP_RIGHT = \"/images/up-right.jpg\"\n}\n\n/**\n * @category Face detection testing\n */\nexport class TestFaceDetector implements FaceDetector, FaceRequirementListener {\n\n    private face: Face|undefined\n    private requestedFace: Face|undefined\n    private lastRequestTime: Date|undefined\n    private turnDurationMs: number = 2000\n    private canvas: HTMLCanvasElement\n    private readonly images: Record<keyof typeof FaceImageSrc, HTMLImageElement>\n\n    constructor(images: Record<keyof typeof FaceImageSrc, HTMLImageElement>) {\n        this.images = images\n        this.canvas = document.createElement(\"canvas\")\n    }\n    \n    onChange = (requirements: FaceRequirements) => {\n        this.requestedFace = new Face(requirements.ideal.bounds, requirements.ideal.angle)\n        this.lastRequestTime = new Date()\n    }\n\n    private valueBetween(origin: number, destination: number, progress: number): number {\n        return origin + (destination - origin) * progress\n    }\n\n    private jitterValue = (value: number, delta: number): number => {\n        const jitter: number = (0.5 - Math.random()) * delta\n        return value + jitter\n    }\n\n    private jitterFace = (face: Face) => {\n        let delta = face.bounds.width * 0.01\n        face.bounds.x = this.jitterValue(face.bounds.x, delta)\n        face.bounds.y = this.jitterValue(face.bounds.y, delta)\n        face.bounds.width = this.jitterValue(face.bounds.width, delta)\n        face.bounds.height = face.bounds.width * 1.25\n        delta = 4\n        face.angle.yaw = this.jitterValue(face.angle.yaw, delta)\n        face.angle.pitch = this.jitterValue(face.angle.pitch, delta)\n    }\n\n    readonly detectFace = async (source: FaceDetectionSource): Promise<FaceCapture> => {\n        let face: Face|undefined\n        if (!this.face) {\n            this.face = this.requestedFace\n        }\n        if (!this.face) {\n            throw new Error(\"Face not detected\")\n        }\n        face = this.face\n        if (this.lastRequestTime) {\n            const now = new Date().getTime();\n            const progress = Math.min((now - this.lastRequestTime.getTime()) / this.turnDurationMs, 1)\n            if (progress == 1) {\n                face = this.face = this.requestedFace\n            } else if (this.requestedFace) {\n                face.bounds.x = this.valueBetween(this.face.bounds.x, this.requestedFace.bounds.x, progress)\n                face.bounds.y = this.valueBetween(this.face.bounds.y, this.requestedFace.bounds.y, progress)\n                face.bounds.width = this.valueBetween(this.face.bounds.width, this.requestedFace.bounds.width, progress)\n                face.bounds.height = this.valueBetween(this.face.bounds.height, this.requestedFace.bounds.height, progress)\n                face.angle.yaw = this.valueBetween(this.face.angle.yaw, this.requestedFace.angle.yaw, progress)\n                face.angle.pitch = this.valueBetween(this.face.angle.pitch, this.requestedFace.angle.pitch, progress)\n            }\n        }\n        const nameParts: string[] = []\n        if (!this.requestedFace) {\n            nameParts.push(\"STRAIGHT\")\n        } else {\n            if (this.requestedFace.angle.pitch > 0) {\n                nameParts.push(\"UP\")\n            }\n            if (this.requestedFace.angle.yaw < 0) {\n                nameParts.push(\"LEFT\")\n            } else if (this.requestedFace.angle.yaw > 0) {\n                nameParts.push(\"RIGHT\")\n            } else {\n                nameParts.push(\"STRAIGHT\")\n            }\n        }\n        const imageKey: keyof typeof FaceImageSrc = nameParts.join(\"_\") as keyof typeof FaceImageSrc\n        const image: HTMLImageElement = this.images[imageKey]\n        const size = await sizeOfImageSource(source.element)\n        let scale: number = 1\n        if (size.width / size.height > image.naturalWidth / image.naturalHeight) {\n            // The source image is \"fatter\", constrain height and crop the width\n            scale = size.height / image.naturalHeight\n        } else {\n            scale = size.width / image.naturalWidth\n        }\n        this.canvas.width = size.width\n        this.canvas.height = size.height\n        this.canvas.getContext(\"2d\")!.drawImage(image, size.width / 2 - image.naturalWidth * scale / 2, size.height / 2 - image.naturalHeight * scale / 2, image.naturalWidth * scale, image.naturalHeight * scale)\n        const blob = await canvasToBlob(this.canvas)\n        if (face) {\n            this.jitterFace(face)\n        } else {\n            throw new Error(\"Face not detected\")\n        }\n        return FaceCapture.create(blob, face)\n    }\n\n}\n\n/**\n * @category Face detection testing\n */\nexport class TestFaceDetectorFactory implements FaceDetectorFactory {\n\n    async createFaceDetector(): Promise<FaceDetector> {\n        const images: Record<keyof typeof FaceImageSrc, HTMLImageElement> = {\n            \"STRAIGHT\": document.createElement(\"img\"),\n            \"LEFT\": document.createElement(\"img\"),\n            \"RIGHT\": document.createElement(\"img\"),\n            \"UP_LEFT\": document.createElement(\"img\"),\n            \"UP_RIGHT\": document.createElement(\"img\")\n        }\n        await Promise.all(Object.entries(images).map(entry => {\n            // @ts-ignore\n            entry[1].src = FaceImageSrc[entry[0]]\n            return entry[1].decode()\n        }))\n        return Promise.resolve(new TestFaceDetector(images))\n    }\n    \n}","import { ImageSource } from \"./types\"\n\nexport abstract class LivenessCheck {\n\n    async checkLiveness(image: ImageSource): Promise<number> {\n        try {\n            const body = await this.createLivenessCheckRequestBody(image)\n            const headers = await this.createLivenessCheckRequestHeaders()\n            const response = await fetch(\"/check_liveness\", {\"method\": \"POST\", \"cache\": \"no-cache\", \"body\": JSON.stringify(body), \"headers\": headers})\n            return this.parseLivenessCheckResponse(response)\n        } catch (error: any) {\n            throw new Error(\"Liveness check failed: \"+error?.message)\n        }\n    }\n\n    abstract createLivenessCheckRequestBody(image: ImageSource): Promise<any>\n\n    abstract createLivenessCheckRequestHeaders(): Promise<any>\n\n    abstract parseLivenessCheckResponse(response: Response): Promise<number>\n}","import { LivenessCheck } from \"./livenessCheck\"\nimport { ImageSource } from \"./types\"\nimport { canvasFromImageSource } from \"./utils\"\n\nexport class TrustmaticLivenessCheck extends LivenessCheck {\n\n    async createLivenessCheckRequestBody(image: ImageSource): Promise<any> {\n        const canvas = await canvasFromImageSource(image)\n        const dataURL = canvas.toDataURL()\n        return {\n            \"faceImageBase\": dataURL,\n            // @ts-ignore\n            \"sessionId\": crypto[\"randomUUID\"]()\n        }\n    }\n\n    createLivenessCheckRequestHeaders(): Promise<any> {\n        return Promise.resolve({\n            \"Accept\": \"application/json\",\n            \"Content-Type\": \"application/json\"\n        })\n    }\n\n    async parseLivenessCheckResponse(response: Response): Promise<number> {\n        const json = await response.json()\n        if (json.hasError) {\n            throw json.error\n        }\n        return json.score\n    }\n\n}"],"names":["isFunction","value","createErrorClass","createImpl","_super","instance","Error","call","stack","ctorFunc","prototype","Object","create","constructor","UnsubscriptionError","UnsubscriptionErrorImpl","errors","message","length","map","err","i","toString","join","name","arrRemove","arr","item","index","indexOf","splice","Subscription","initialTeardown","closed","_parentage","_teardowns","unsubscribe","Array","isArray","_parentage_1","__values","_parentage_1_1","next","done","parent_1","remove","e","_teardowns_1","_teardowns_1_1","teardown_1","execTeardown","__spreadArray","__read","push","add","teardown","_hasParent","_addParent","_a","parent","includes","_removeParent","EMPTY","empty","isSubscription","config","onUnhandledError","onStoppedNotification","Promise","undefined","useDeprecatedSynchronousErrorHandling","useDeprecatedNextContext","timeoutProvider","setTimeout","args","_i","arguments","delegate","apply","clearTimeout","handle","reportUnhandledError","noop","Subscriber","__extends","destination","_this","isStopped","EMPTY_OBSERVER","error","complete","SafeSubscriber","_next","_error","_complete","observerOrNext","context_1","bind","wrapForErrorHandling","defaultErrorHandler","handler","observable","Symbol","identity","x","pipeFromArray","fns","piped","input","reduce","prev","fn","Observable","subscribe","_subscribe","lift","operator","source","subscriber","isSubscriber","_trySubscribe","_deprecatedSyncErrorSubscribe","localSubscriber","_syncErrorHack_isSubscribing","__syncError","dest","sink","forEach","promiseCtor","getPromiseCtor","resolve","reject","subscription","Symbol_observable","pipe","operations","toPromise","isObserver","hasLift","operate","init","liftedSource","TypeError","OperatorSubscriber","onNext","onComplete","onError","onFinalize","scheduleArray","scheduler","schedule","isArrayLike","isPromise","then","scheduleObservable","sub","schedulePromise","getSymbolIterator","iterator","caughtSchedule","execute","delay","scheduleIterable","Symbol_iterator","return","scheduleAsyncIterable","asyncIterator","result","isInteropObservable","isIterable","isAsyncIterable","obj","createInvalidObservableTypeError","readableStreamLikeToAsyncGenerator","readableStream","reader","getReader","__await","read","_b","sent","releaseLock","isReadableStreamLike","scheduleReadableStreamLike","scheduled","from","innerFrom","fromInteropObservable","fromArrayLike","fromPromise","fromAsyncIterable","fromIterable","fromReadableStreamLike","obs","array","promise","iterable","iterable_1","iterable_1_1","asyncIterable","process","catch","asyncIterable_1","__asyncValues","asyncIterable_1_1","internalFromArray","isScheduler","last","popScheduler","pop","of","throwError","errorOrErrorFactory","errorFactory","project","thisArg","mergeInternals","concurrent","onBeforeNext","expand","innerSubScheduler","additionalTeardown","buffer","active","isComplete","checkComplete","outerNext","doInnerSub","innerComplete","innerValue","bufferedValue","shift","mergeMap","resultSelector","Infinity","a","b","ii","filter","predicate","scanInternals","accumulator","seed","hasSeed","emitOnNext","emitBeforeComplete","hasState","state","arrReducer","toArray","take","count","seen","tap","tapObserver","DocumentPages","DocumentSide","IdCaptureEventType","Axis","FaceAlignmentStatus","Bearing","Point","Rect","LivenessDetectionSessionEventType","o","t","global","flags","flagRegistry","urlFlags","populateURLFlags","setPlatform","platform","console","warn","platformName","registerFlag","n","evaluationFn","setHook","r","set","get","evaluateFlag","getNumber","getBool","getFlags","defineProperty","enumerable","configurable","setFlags","assign","reset","location","search","replace","tfjsflags","split","toLowerCase","decodeURIComponent","s","Dimensions","width","height","isValidNumber","JSON","stringify","_width","_height","reverse","isTensor","tensor","dim","tf","shape","isTensor2D","isTensor3D","isTensor4D","isFloat","num","isEven","round","prec","f","Math","pow","floor","isDimensions","computeReshapedDimensions","inputSize","scale","max","getCenterPoint","pts","sum","pt","div","range","start","step","fill","_","isNaN","isValidProbablitiy","y","_x","_y","mul","abs","magnitude","sqrt","Box","_box","allowNegativeDimensions","box","isBbox","left","top","right","bottom","every","isRect","assertIsValidBox","rect","callee","toSquare","diff","rescale","scaleX","scaleY","pad","padX","padY","clipAtImageBorders","imgWidth","imgHeight","clippedX","clippedY","newWidth","newHeight","clippedWidth","min","clippedHeight","sx","sy","padAtBorders","imageHeight","imageWidth","w","h","dx","dy","edx","edy","ex","ey","calibrate","region","BoundingBox","ObjectDetection","score","classScore","className","relativeBox","imageDims","_imageDims","_score","_classScore","_className","forSize","FaceDetection","iou","box1","box2","isIOU","interSection","area","minBbox","xs","ys","minX","minY","maxX","maxY","nonMaxSuppression","boxes","scores","iouThreshold","indicesSortedByScore","boxIndex","sort","c1","c2","c","pick","curr","indices","outputs","idx","currBox","idxBox","j","normalize","meanRgb","g","avg_r","__spreadArrays","slice","avg_g","avg_b","avg_rgb","padToSquare","imgTensor","isCenterImage","dimDiff","paddingAmount","paddingAxis","createPaddingTensor","paddingTensorShape","paddingTensorAppend","remainingPaddingAmount","paddingTensorPrepend","tensorsToStack","toFloat","sigmoid","exp","relX","relY","relScale","FaceLandmarks","relativeFaceLandmarkPositions","imgDims","_imgDims","_shift","_positions","relativePositions","shiftBy","shiftByPoint","align","detection","options","useDlibAlignment","minBoxPadding","alignDlib","alignMinBbox","centers","getRefPointsForAlignment","leftEyeCenter","rightEyeCenter","mouthCenter","distToMouth","eyeToMouthDist","size","refPoint","padding","positions","FaceLandmarks5","FaceLandmarks68","getJawOutline","getLeftEyeBrow","getRightEyeBrow","getNose","getLeftEye","getRightEye","getMouth","FaceMatch","label","distance","_label","_distance","withDistance","LabeledBox","assertIsValidLabeledBox","LabeledFaceDescriptors","descriptors","some","desc","Float32Array","_descriptors","toJSON","d","fromJSON","json","PredictedBox","assertIsValidPredictedBox","isWithFaceDetection","extendWithFaceDetection","sourceObj","extension","createBrowserEnv","fetch","window","readFile","Canvas","HTMLCanvasElement","CanvasRenderingContext2D","Image","HTMLImageElement","ImageData","Video","HTMLVideoElement","createCanvasElement","document","createElement","createImageElement","createFileSystem","fs","requireFsError","require","filePath","res","rej","createNodejsEnv","fileSystem","__assign","class_1","class_2","class_3","isBrowser","isNodejs","module","version","environment","getEnv","setEnv","env","initialize","monkeyPatch","resolveInput","arg","getElementById","getContext2dOrThrow","canvasArg","canvas","ctx","getContext","AnchorPosition","isMediaLoaded","media","readyState","awaitMediaLoaded","onLoad","currentTarget","removeEventListener","addEventListener","getMediaDimensions","naturalWidth","naturalHeight","videoWidth","videoHeight","createCanvas","createCanvasFromMedia","dims","putImageData","drawImage","imageTensorToCanvas","targetCanvas","numChannels","imgTensor3D","as3D","toInt","toPixels","dispose","isMediaElement","imageToSquare","centerImage","inputCanvas","offset","NetInput","inputs","treatAsBatchInput","_imageTensors","_canvases","_treatAsBatchInput","_inputDimensions","_batchSize","batchSize","_inputSize","batchIdx","getReshapedInputDimensions","getInput","canvases","imageTensors","getInputDimensions","getInputHeight","getInputWidth","toBatchTensor","isCenterInputs","inputTensors","expandDims","resizeBilinear","fromPixels","batchTensor","as4D","toNetInput","inputArgArray","getIdxHint","inputArray","all","extractFaces","detections","netInput","tensorOrCanvas","det","faceImg","getImageData","extractFaceTensors","imageTensor","faceTensors","fetchOrThrow","url","status","statusText","fetchJson","uri","getModelUris","defaultModelName","defaultManifestFilename","modelBaseUri","manifestUri","protocol","startsWith","parts","manifestFile","endsWith","loadWeightMap","manifest","loadWeights","NeuralNetwork","_name","_params","_paramMappings","params","getParamFromPath","paramPath","traversePropertyPath","objProp","reassignParamFromPath","getParamList","path","getTrainableParams","param","getFrozenParams","variable","freeze","dataSync","throwOnRedispose","isDisposed","serializeParams","flat","concat","load","weightsOrUrl","extractWeights","loadFromUri","getDefaultModelName","weightMap","loadFromWeightMap","loadFromDisk","fetchWeightsFromDisk","filePaths","buf","weightsLoaderFactory","_c","parse","_d","extractParamsFromWeigthMap","paramMappings","weights","extractParams","nextObj","hasOwnProperty","depthwiseSeparableConv","stride","out","depthwise_filter","pointwise_filter","bias","denseBlock3","denseBlockParams","isFirstLayer","out1","conv0","filters","out2","conv1","in3","out3","conv2","denseBlock4","isScaleDown","in4","out4","conv3","convLayer","withRelu","disposeUnusedWeightTensors","keys","pm","originalPath","extractConvParamsFactory","channelsIn","channelsOut","filterSize","mappedPrefix","extractFCParamsFactory","fc_weights","fc_bias","SeparableConvParams","extractSeparableConvParamsFactory","loadSeparableConvParamsFactory","extractWeightEntry","prefix","extractWeightEntryFactory","paramRank","mappedPath","extractWeightsFactory","remainingWeights","numWeights","ret","getRemainingWeights","extractorsFactory","extractConvParams","extractSeparableConvParams","extractDenseBlock3Params","extractDenseBlock4Params","dense0","dense1","dense2","dense3","loadConvParamsFactory","loadParamsFactory","FaceFeatureExtractor","forwardInput","normalized","forward","fullyConnectedLayer","extractFCParams","fc","extractFcParams","seperateWeightMaps","featureExtractorMap","classifierMap","key","FaceProcessor","faceFeatureExtractor","_faceFeatureExtractor","runNet","bottleneckFeatures","as2D","loadClassifierParams","extractClassifierParams","getClassifierChannelsIn","getClassifierChannelsOut","cIn","cOut","classifierWeightSize","featureExtractorWeights","classifierWeights","FACE_EXPRESSION_LABELS","FaceExpressions","probabilities","expression","asSortedArray","probability","e0","e1","FaceExpressionNet","predictExpressions","__awaiter","data","probabilitesByBatch","predictionsByBatch","probabilites","isBatchInput","extendWithFaceExpressions","expressions","isWithFaceLandmarks","extendWithFaceLandmarks","unshiftedLandmarks","landmarks","alignedRect","extractReductionBlockParams","separable_conv0","separable_conv1","expansion_conv","extractMainBlockParams","channels","separable_conv2","numMainBlocks","entry_flow_conv_in","entry_flow_reduction_block_0","entry_flow_reduction_block_1","entry_flow","conv_in","reduction_block_0","reduction_block_1","middle_flow","exit_flow_reduction_block","exit_flow_separable_conv","exit_flow","reduction_block","separable_conv","conv","reductionBlock","isActivateInput","mainBlock","TinyXception","_numMainBlocks","age","gender","Gender","AgeGenderNet","pooled","as1D","predictAgeAndGender","ages","genders","ageAndGenderTensors","ageTensor","genderTensor","probMale","isMale","MALE","FEMALE","genderProbability","FaceLandmark68NetBase","postProcess","output","originalDimensions","inputDimensions","createInterleavedTensor","fillX","fillY","getPadding","cond","getPaddingX","getPaddingY","landmarkTensors","detectLandmarks","landmarkTensor","landmarksArray","xCoords","yCoords","landmarksForBatch","FaceLandmark68Net","extractParamsFromWeigthMapTiny","extractParamsTiny","TinyFaceFeatureExtractor","FaceLandmark68TinyNet","FaceLandmarkNet","biases","strides","convNoRelu","convDown","extractFilterValues","numFilterValues","numFilters","depth","extractScaleLayerParams","extractConvLayerParams","extractResidualLayerParams","isDown","conv32_down","conv32_1","conv32_2","conv32_3","conv64_down","conv64_1","conv64_2","conv64_3","conv128_down","conv128_1","conv128_2","conv256_down","conv256_1","conv256_2","conv256_down_out","residual","residualDown","zeros","isPad","isAdjustShape","padShapeX","zerosW","padShapeY","zerosH","FaceRecognitionNet","globalAvg","mean","fullyConnected","computeFaceDescriptor","faceDescriptorTensors","faceDescriptorsForBatch","extendWithFaceDescriptor","descriptor","extendWithAge","extendWithGender","MtcnnOptions","minFaceSize","scaleFactor","maxNumScales","scoreThresholds","scaleSteps","_minFaceSize","_scaleFactor","_maxNumScales","_scoreThresholds","_scaleSteps","th","extractDepthwiseConvParams","batch_norm_scale","batch_norm_offset","batch_norm_mean","batch_norm_variance","isPointwiseConv","extractPointwiseConvParams","extractConvPairParams","depthwise_conv","pointwise_conv","extractMobilenetV1Params","conv_0","conv_1","conv_2","conv_3","conv_4","conv_5","conv_6","conv_7","conv_8","conv_9","conv_10","conv_11","conv_12","conv_13","extractPredictionLayerParams","box_encoding_0_predictor","class_predictor_0","box_encoding_1_predictor","class_predictor_1","box_encoding_2_predictor","class_predictor_2","box_encoding_3_predictor","class_predictor_3","box_encoding_4_predictor","class_predictor_4","box_encoding_5_predictor","class_predictor_5","box_predictor_0","box_encoding_predictor","class_predictor","box_predictor_1","box_predictor_2","box_predictor_3","box_predictor_4","box_predictor_5","mobilenetv1","prediction_layer","extra_dim","output_layer","prefixDepthwiseConv","mappedPrefixDepthwiseConv","mappedPrefixPointwiseConv","extractBoxPredictorParams","pointwiseConvLayer","epsilon","depthwiseConvLayer","getStridesForLayerIdx","layerIdx","mobileNetV1","conv11","convPairParams","depthwiseConvStrides","maxOutputSize","scoreThreshold","numBoxes","outputSize","candidates","suppressFunc","selected","originalScore","IOU","boxesData","arraySync","yminI","xminI","ymaxI","xmaxI","yminJ","xminJ","ymaxJ","xmaxJ","areaI","areaJ","intersectionYmin","intersectionXmin","intersectionYmax","intersectionXmax","intersectionArea","getCenterCoordinatesAndSizesLayer","vec","sizes","decodeBoxesLayer","x0","x1","div0_out","add0_out","div1_out","add1_out","outputLayer","boxPredictions","classPredictions","scoresAndClasses","boxesByBatch","scoresByBatch","boxPredictionLayer","boxPredictionEncoding","classPrediction","predictionLayer","conv4","conv5","conv6","conv7","boxPrediction0","boxPrediction1","boxPrediction2","boxPrediction3","boxPrediction4","boxPrediction5","SsdMobilenetv1Options","minConfidence","maxResults","_minConfidence","_maxResults","SsdMobilenetv1","features","locateFaces","_e","_boxes","_scores","scoresData","reshapedDims","results","FaceDetectionNet","IOU_THRESHOLD","BOX_ANCHORS","BOX_ANCHORS_SEPARABLE","MEAN_RGB_SEPARABLE","DEFAULT_MODEL_NAME","DEFAULT_MODEL_NAME_SEPARABLE_CONV","isNumber","validateConfig","withSeparableConvs","classes","anchors","leaky","convWithBatchNorm","bn","truediv","extractBatchNormParams","extractConvWithBatchNormParams","boxEncodingSize","filterSizes","s0","s1","s2","s3","s4","s5","s6","s7","s8","isFirstLayerConv2d","conv8","TinyYolov2SizeType","TinyYolov2Options","_scoreThreshold","TinyYolov2Base","_config","withClassScores","runTinyYolov2","runMobilenet","detect","forwardParams","out0","extractBoxes","classScores","classNames","DEFAULT_FILTER_SIZES","outputTensor","inputBlobDimensions","correctionFactorX","correctionFactorY","numCells","reshaped","reshape","boxesTensor","scoresTensor","classScoresTensor","row","col","anchor","ctX","ctY","width_1","height_1","pos","extractPredictedClass","classesTensor","classesData","TinyYolov2","objectDetections","TinyFaceDetectorOptions","ComposableTask","onfulfilled","run","extractAllFacesAndComputeResults","parentResults","computeResults","extractedFaces","getRectForAlignment","faceBoxes","parentResult","faces","extractSingleFaceAndComputeResult","computeResult","__generator","bgrToRgbTensor","CELL_STRIDE","CELL_SIZE","extractPReluParams","alpha","extractSharedParams","isRnet","prelu1_alpha","prelu2_alpha","prelu3_alpha","extractPNetParams","sharedParams","conv4_1","conv4_2","extractRNetParams","fc1","prelu4_alpha","fc2_1","fc2_2","extractONetParams","prelu5_alpha","fc2_3","pnet","rnet","onet","getSizesForScale","pyramidDown","m","scales","minLayer","MtcnnBox","prelu","sharedLayer","isPnet","PNet","prob","regions","rescaleAndNormalize","resized","extractBoundingBoxes","regionsTensor","boundingBoxes","cell","regionsData","stage1","stats","pnetOutputs","statsForScale","ts","Date","now","boxesForScale","bbox","nms","boxIdx","allBoxes","finalBoxes","finalScores","stage1_nms","extractImagePatches","img","imgCtx","fromX","fromY","imgData","createImageBitmap","bitmaps","imagePatchesDatas","bmp","patch","patchCtx","currData","imagePatchTensor","RNet","convOut","vectorized","prelu4","stage2","inputBoxes","rnetInputs","stage2_extractImagePatches","rnetOuts","rnetInput","stage2_rnet","filteredBoxes","filteredScores","indicesNms","stage2_nms","regions_1","ONet","prelu5","points","stage3","onetInputs","stage3_extractImagePatches","onetOuts","onetInput","stage3_onet","filteredRegions","stage3_nms","ptIdx","pointsData","Mtcnn","tsTotal","onReturn","total","pyramid","total_stage1","stage2_numInputBoxes","total_stage2","stage3_numInputBoxes","total_stage3","forwardWithStats","MEAN_RGB","TinyFaceDetector","nets","ssdMobilenetv1","tinyFaceDetector","tinyYolov2","mtcnn","faceLandmark68Net","faceLandmark68TinyNet","faceRecognitionNet","faceExpressionNet","ageGenderNet","PredictFaceExpressionsTaskBase","parentTask","PredictAllFaceExpressionsTask","face","faceExpressionsByFace","withAgeAndGender","PredictAllAgeAndGenderTask","PredictSingleFaceExpressionsTask","faceExpressions","PredictSingleAgeAndGenderTask","PredictAllFaceExpressionsWithFaceAlignmentTask","PredictAllAgeAndGenderWithFaceAlignmentTask","withFaceDescriptors","ComputeAllFaceDescriptorsTask","PredictSingleFaceExpressionsWithFaceAlignmentTask","PredictSingleAgeAndGenderWithFaceAlignmentTask","withFaceDescriptor","ComputeSingleFaceDescriptorTask","PredictAgeAndGenderTaskBase","ageAndGenderByFace","withFaceExpressions","ComputeFaceDescriptorsTaskBase","DetectFaceLandmarksTaskBase","useTinyLandmarkNet","DetectAllFaceLandmarksTask","landmarkNet","faceLandmarksByFace","DetectSingleFaceLandmarksTask","DetectFacesTaskBase","DetectAllFacesTask","faceDetectionFunction","runAndExtendWithFaceDetections","withFaceLandmarks","DetectSingleFaceTask","faceDetections","faceDetectionWithHighestScore","faceDetection","runAndExtendWithFaceDetection","detectSingleFace","euclideanDistance","arr1","arr2","desc1","desc2","val","FaceMatcher","distanceThreshold","_distanceThreshold","createUniqueLabel","_labeledDescriptors","computeMeanDistance","queryDescriptor","d1","d2","matchDescriptor","labeledDescriptors","best","findBestMatch","bestMatch","ld","estimateFaceAngle","faceapi.detectSingleFace","faceapi.TinyFaceDetectorOptions","estimateFaceAngleNoseTip","faceapi.nets","nextMessageID","getNextMessageID","msgId","BaseRequestMessage","action","messageID","InitMessage","wasmLoadSettings","userId","wasmModuleName","licenseKey","registerLoadCallback","loadProgressCallback","allowHelloMessage","engineLocation","wasmType","numberOfWorkers","ParameterType","CreateNewRecognizer","CreateRecognizerRunner","recognizerHandles","allowMultipleResults","registeredMetadataCallbacks","ReconfigureRecognizerRunner","DeleteRecognizerRunner","InvokeObjectMethod","objectHandle","methodName","ProcessImage","image","frame","getTransferrables","imageData","ResetRecognizers","hardReset","RegisteredMetadataCallbacks","onDebugText","onDetectionFailed","onQuadDetection","onPointsDetection","onFirstSideResult","onGlare","RegisterMetadataCallbacks","SetDetectionOnly","detectionOnlyMode","SetClearTimeoutCallback","callbackNonEmpty","SetCameraPreviewMirrored","cameraPreviewMirrored","GetProductIntegrationInfo","MetadataCallback","BlinkIDSDK.WasmSDKLoadSettings","BlinkIDSDK.loadWasmModule","BlinkIDSDK.DetectionStatus","BlinkIDSDK.isBrowserSupported","PAD0","PAD1","qrcode","typeNumber","errorCorrectionLevel","_typeNumber","_errorCorrectionLevel","QRErrorCorrectionLevel","_modules","_moduleCount","_dataCache","_dataList","makeImpl","test","maskPattern","moduleCount","modules","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","getBestMaskPattern","minLostPoint","pattern","lostPoint","QRUtil","getLostPoint","getPatternPosition","bits","getBCHTypeNumber","mod","getBCHTypeInfo","inc","bitIndex","byteIndex","maskFunc","getMaskFunction","dark","mask","createBytes","rsBlocks","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","dataCount","ecCount","totalCount","getBuffer","rsPoly","getErrorCorrectPolynomial","rawPoly","qrPolynomial","getLength","modPoly","modIndex","getAt","totalCodeCount","dataList","QRRSBlock","getRSBlocks","qrBitBuffer","put","getMode","getLengthInBits","write","totalDataCount","putBit","addData","mode","newData","qrNumber","qrAlphaNum","qr8BitByte","qrKanji","isDark","getModuleCount","make","createSvgTag","drawCell","cellColor","cellSize","margin","bg","obstruction","qrSvg","enabled","modCount","totalSize","obstructionCRStart","obstructionCREnd","spans","ceil","mr","mc","img_attrs","toFixed","svgData","substring","createImgTag","self","stringToBytesFuncs","default","bytes","charCodeAt","stringToBytes","QRMode","MODE_NUMBER","MODE_ALPHA_NUM","MODE_8BIT_BYTE","MODE_KANJI","L","M","Q","H","QRMaskPattern","PATTERN000","PATTERN001","PATTERN010","PATTERN011","PATTERN100","PATTERN101","PATTERN110","PATTERN111","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","getBCHDigit","digit","errorCorrectLength","multiply","QRMath","gexp","type","sameCount","darkCount","ratio","EXP_TABLE","LOG_TABLE","glog","_num","RS_BLOCK_TABLE","qrRSBlock","getRsBlockTable","rsBlock","list","_buffer","_length","bufIndex","bit","_mode","_data","strToNum","chatToNum","charAt","getCode","_bytes","code","byteArrayOutputStream","writeByte","writeShort","writeBytes","off","len","writeString","toByteArray","base64EncodeOutputStream","_buflen","_base64","writeEncoded","String","fromCharCode","encode","flush","padlen","gifImage","setPixel","pixel","lzwMinCodeSize","raster","getLZWRaster","bitOutputStream","_out","_bitLength","_bitBuffer","clearCode","endCode","bitLength","table","lzwTable","byteOut","bitOut","dataIndex","contains","_map","_size","getPixel","alt","gif","base64","toUTF8Array","str","utf8","charcode"],"mappings":"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AAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,SAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA,GAAA,EAAA,CAAA,CAAA,CAAA,IAAA,CAAA,GAAA,EAAA,CAAA,SAAA,QAAA,GAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,EAAA,MAAA,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,SAAA,CAAA,GAAA,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAA,GAAA,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAA,GAAA,CAAA,EAAA,CAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,GAAA,CAAA,GAAA,EAAA,CAAA,CAAA,CAAA,IAAA,CAAA,GAAA,EAAA,CAAA,SAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,C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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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Cf,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACf,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACnB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACnB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EACpB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EACpB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EACpB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EACpB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EACpB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EACxB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACzB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACzB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACzB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACzB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACzB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACzB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,EAC9B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,EAC9B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,E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AE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEtB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EACb,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEtB;EACA,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEtB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,EACZ,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEtB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,EACxB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEtB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EACb,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,EACxB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,EACxB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACtB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACZ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;AACA,EAAA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACZ,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAEZ;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC1B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EACd,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAEvB;EACA,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,EAC3B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EACxB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AAExB;EACA,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,208,210]}